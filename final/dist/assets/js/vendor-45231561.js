var Dh=Math.pow;import{r as K,a as yw,R as O,A as Tr}from"./vendor-react-21dabc43.js";var yo=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function _e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qy={exports:{}},Vy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(R,j){var q=R.length;R.push(j);e:for(;0<q;){var J=q-1>>>1,W=R[J];if(0<i(W,j))R[J]=j,R[q]=W,q=J;else break e}}function n(R){return R.length===0?null:R[0]}function r(R){if(R.length===0)return null;var j=R[0],q=R.pop();if(q!==j){R[0]=q;e:for(var J=0,W=R.length,ee=W>>>1;J<ee;){var de=2*(J+1)-1,Se=R[de],xe=de+1,_t=R[xe];if(0>i(Se,q))xe<W&&0>i(_t,Se)?(R[J]=_t,R[xe]=q,J=xe):(R[J]=Se,R[de]=q,J=de);else if(xe<W&&0>i(_t,q))R[J]=_t,R[xe]=q,J=xe;else break e}}return j}function i(R,j){var q=R.sortIndex-j.sortIndex;return q!==0?q:R.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,s=o.now();t.unstable_now=function(){return o.now()-s}}var c=[],u=[],l=1,d=null,f=3,h=!1,m=!1,p=!1,v=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(R){for(var j=n(u);j!==null;){if(j.callback===null)r(u);else if(j.startTime<=R)r(u),j.sortIndex=j.expirationTime,e(c,j);else break;j=n(u)}}function S(R){if(p=!1,T(R),!m)if(n(c)!==null)m=!0,$(g);else{var j=n(u);j!==null&&F(S,j.startTime-R)}}function g(R,j){m=!1,p&&(p=!1,b(C),C=-1),h=!0;var q=f;try{for(T(j),d=n(c);d!==null&&(!(d.expirationTime>j)||R&&!P());){var J=d.callback;if(typeof J=="function"){d.callback=null,f=d.priorityLevel;var W=J(d.expirationTime<=j);j=t.unstable_now(),typeof W=="function"?d.callback=W:d===n(c)&&r(c),T(j)}else r(c);d=n(c)}if(d!==null)var ee=!0;else{var de=n(u);de!==null&&F(S,de.startTime-j),ee=!1}return ee}finally{d=null,f=q,h=!1}}var y=!1,w=null,C=-1,_=5,A=-1;function P(){return!(t.unstable_now()-A<_)}function E(){if(w!==null){var R=t.unstable_now();A=R;var j=!0;try{j=w(!0,R)}finally{j?M():(y=!1,w=null)}}else y=!1}var M;if(typeof k=="function")M=function(){k(E)};else if(typeof MessageChannel!="undefined"){var N=new MessageChannel,D=N.port2;N.port1.onmessage=E,M=function(){D.postMessage(null)}}else M=function(){v(E,0)};function $(R){w=R,y||(y=!0,M())}function F(R,j){C=v(function(){R(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(R){R.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,$(g))},t.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<R?Math.floor(1e3/R):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(R){switch(f){case 1:case 2:case 3:var j=3;break;default:j=f}var q=f;f=j;try{return R()}finally{f=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(R,j){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var q=f;f=R;try{return j()}finally{f=q}},t.unstable_scheduleCallback=function(R,j,q){var J=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?J+q:J):q=J,R){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=q+W,R={id:l++,callback:j,priorityLevel:R,startTime:q,expirationTime:W,sortIndex:-1},q>J?(R.sortIndex=q,e(u,R),n(c)===null&&R===n(u)&&(p?(b(C),C=-1):p=!0,F(S,q-J))):(R.sortIndex=W,e(c,R),m||h||(m=!0,$(g))),R},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(R){var j=f;return function(){var q=f;f=j;try{return R.apply(this,arguments)}finally{f=q}}}})(Vy);qy.exports=Vy;var $K=qy.exports;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ka(){return ka=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ka.apply(this,arguments)}var zr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(zr||(zr={}));const Nh="popstate";function BK(t){t===void 0&&(t={});function e(r,i){let{pathname:a,search:o,hash:s}=r.location;return Qu("",{pathname:a,search:o,hash:s},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:zy(i)}return Sw(e,n,null,t)}function Jr(t,e){if(t===!1||t===null||typeof t=="undefined")throw new Error(e)}function Wy(t,e){if(!t){typeof console!="undefined"&&console.warn(e);try{throw new Error(e)}catch(n){}}}function bw(){return Math.random().toString(36).substr(2,8)}function Lh(t,e){return{usr:t.state,key:t.key,idx:e}}function Qu(t,e,n,r){return n===void 0&&(n=null),ka({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?dc(e):e,{state:n,key:e&&e.key||r||bw()})}function zy(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function dc(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function Sw(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,s=zr.Pop,c=null,u=l();u==null&&(u=0,o.replaceState(ka({},o.state,{idx:u}),""));function l(){return(o.state||{idx:null}).idx}function d(){s=zr.Pop;let v=l(),b=v==null?null:v-u;u=v,c&&c({action:s,location:p.location,delta:b})}function f(v,b){s=zr.Push;let k=Qu(p.location,v,b);n&&n(k,v),u=l()+1;let T=Lh(k,u),S=p.createHref(k);try{o.pushState(T,"",S)}catch(g){if(g instanceof DOMException&&g.name==="DataCloneError")throw g;i.location.assign(S)}a&&c&&c({action:s,location:p.location,delta:1})}function h(v,b){s=zr.Replace;let k=Qu(p.location,v,b);n&&n(k,v),u=l();let T=Lh(k,u),S=p.createHref(k);o.replaceState(T,"",S),a&&c&&c({action:s,location:p.location,delta:0})}function m(v){let b=i.location.origin!=="null"?i.location.origin:i.location.href,k=typeof v=="string"?v:zy(v);return k=k.replace(/ $/,"%20"),Jr(b,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,b)}let p={get action(){return s},get location(){return t(i,o)},listen(v){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(Nh,d),c=v,()=>{i.removeEventListener(Nh,d),c=null}},createHref(v){return e(i,v)},createURL:m,encodeLocation(v){let b=m(v);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:f,replace:h,go(v){return o.go(v)}};return p}var jh;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(jh||(jh={}));function UK(t,e,n){return n===void 0&&(n="/"),Tw(t,e,n,!1)}function Tw(t,e,n,r){let i=typeof e=="string"?dc(e):e,a=Dw(i.pathname||"/",n);if(a==null)return null;let o=Gy(t);kw(o);let s=null;for(let c=0;s==null&&c<o.length;++c){let u=Mw(a);s=Iw(o[c],u,r)}return s}function Gy(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(a,o,s)=>{let c={relativePath:s===void 0?a.path||"":s,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};c.relativePath.startsWith("/")&&(Jr(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=jo([r,c.relativePath]),l=n.concat(c);a.children&&a.children.length>0&&(Jr(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Gy(a.children,e,l,u)),!(a.path==null&&!a.index)&&e.push({path:u,score:Ew(u,a.index),routesMeta:l})};return t.forEach((a,o)=>{var s;if(a.path===""||!((s=a.path)!=null&&s.includes("?")))i(a,o);else for(let c of Hy(a.path))i(a,o,c)}),e}function Hy(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=Hy(r.join("/")),s=[];return s.push(...o.map(c=>c===""?a:[a,c].join("/"))),i&&s.push(...o),s.map(c=>t.startsWith("/")&&c===""?"/":c)}function kw(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Aw(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const ww=/^:[\w-]+$/,Cw=3,_w=2,xw=1,Pw=10,Ow=-2,$h=t=>t==="*";function Ew(t,e){let n=t.split("/"),r=n.length;return n.some($h)&&(r+=Ow),e&&(r+=_w),n.filter(i=>!$h(i)).reduce((i,a)=>i+(ww.test(a)?Cw:a===""?xw:Pw),r)}function Aw(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function Iw(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,i={},a="/",o=[];for(let s=0;s<r.length;++s){let c=r[s],u=s===r.length-1,l=a==="/"?e:e.slice(a.length)||"/",d=Bh({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},l),f=c.route;if(!d&&u&&n&&!r[r.length-1].route.index&&(d=Bh({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},l)),!d)return null;Object.assign(i,d.params),o.push({params:i,pathname:jo([a,d.pathname]),pathnameBase:$w(jo([a,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(a=jo([a,d.pathnameBase]))}return o}function Bh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=Rw(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:r.reduce((u,l,d)=>{let{paramName:f,isOptional:h}=l;if(f==="*"){let p=s[d]||"";o=a.slice(0,a.length-p.length).replace(/(.)\/+$/,"$1")}const m=s[d];return h&&!m?u[f]=void 0:u[f]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:o,pattern:t}}function Rw(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Wy(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,s,c)=>(r.push({paramName:s,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function Mw(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Wy(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Dw(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function Nw(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?dc(t):t;return{pathname:n?n.startsWith("/")?n:Lw(n,e):e,search:Bw(r),hash:Uw(i)}}function Lw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function tu(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function jw(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function FK(t,e){let n=jw(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function qK(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=dc(t):(i=ka({},t),Jr(!i.pathname||!i.pathname.includes("?"),tu("?","pathname","search",i)),Jr(!i.pathname||!i.pathname.includes("#"),tu("#","pathname","hash",i)),Jr(!i.search||!i.search.includes("#"),tu("#","search","hash",i)));let a=t===""||i.pathname==="",o=a?"/":i.pathname,s;if(o==null)s=n;else{let d=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}s=d>=0?e[d]:"/"}let c=Nw(i,s),u=o&&o!=="/"&&o.endsWith("/"),l=(a||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||l)&&(c.pathname+="/"),c}const jo=t=>t.join("/").replace(/\/\/+/g,"/"),$w=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Bw=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Uw=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function VK(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Ky=["post","put","patch","delete"];new Set(Ky);const Fw=["get",...Ky];new Set(Fw);function Xy(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=Xy(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function he(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=Xy(t))&&(r&&(r+=" "),r+=e);return r}var qw=Array.isArray,yt=qw,Vw=typeof yo=="object"&&yo&&yo.Object===Object&&yo,Yy=Vw,Ww=Yy,zw=typeof self=="object"&&self&&self.Object===Object&&self,Gw=Ww||zw||Function("return this")(),dn=Gw,Hw=dn,Kw=Hw.Symbol,so=Kw,Uh=so,Jy=Object.prototype,Xw=Jy.hasOwnProperty,Yw=Jy.toString,Ki=Uh?Uh.toStringTag:void 0;function Jw(t){var e=Xw.call(t,Ki),n=t[Ki];try{t[Ki]=void 0;var r=!0}catch(a){}var i=Yw.call(t);return r&&(e?t[Ki]=n:delete t[Ki]),i}var Qw=Jw,Zw=Object.prototype,eC=Zw.toString;function tC(t){return eC.call(t)}var nC=tC,Fh=so,rC=Qw,iC=nC,aC="[object Null]",oC="[object Undefined]",qh=Fh?Fh.toStringTag:void 0;function sC(t){return t==null?t===void 0?oC:aC:qh&&qh in Object(t)?rC(t):iC(t)}var Rn=sC;function cC(t){return t!=null&&typeof t=="object"}var Mn=cC,uC=Rn,lC=Mn,dC="[object Symbol]";function fC(t){return typeof t=="symbol"||lC(t)&&uC(t)==dC}var Ri=fC,hC=yt,pC=Ri,mC=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gC=/^\w*$/;function vC(t,e){if(hC(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||pC(t)?!0:gC.test(t)||!mC.test(t)||e!=null&&t in Object(e)}var Yd=vC;function yC(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Zn=yC;const Mi=_e(Zn);var bC=Rn,SC=Zn,TC="[object AsyncFunction]",kC="[object Function]",wC="[object GeneratorFunction]",CC="[object Proxy]";function _C(t){if(!SC(t))return!1;var e=bC(t);return e==kC||e==wC||e==TC||e==CC}var Jd=_C;const ne=_e(Jd);var xC=dn,PC=xC["__core-js_shared__"],OC=PC,nu=OC,Vh=function(){var t=/[^.]+$/.exec(nu&&nu.keys&&nu.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function EC(t){return!!Vh&&Vh in t}var AC=EC,IC=Function.prototype,RC=IC.toString;function MC(t){if(t!=null){try{return RC.call(t)}catch(e){}try{return t+""}catch(e){}}return""}var Qy=MC,DC=Jd,NC=AC,LC=Zn,jC=Qy,$C=/[\\^$.*+?()[\]{}|]/g,BC=/^\[object .+?Constructor\]$/,UC=Function.prototype,FC=Object.prototype,qC=UC.toString,VC=FC.hasOwnProperty,WC=RegExp("^"+qC.call(VC).replace($C,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function zC(t){if(!LC(t)||NC(t))return!1;var e=DC(t)?WC:BC;return e.test(jC(t))}var GC=zC;function HC(t,e){return t==null?void 0:t[e]}var KC=HC,XC=GC,YC=KC;function JC(t,e){var n=YC(t,e);return XC(n)?n:void 0}var Ir=JC,QC=Ir,ZC=QC(Object,"create"),fc=ZC,Wh=fc;function e_(){this.__data__=Wh?Wh(null):{},this.size=0}var t_=e_;function n_(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var r_=n_,i_=fc,a_="__lodash_hash_undefined__",o_=Object.prototype,s_=o_.hasOwnProperty;function c_(t){var e=this.__data__;if(i_){var n=e[t];return n===a_?void 0:n}return s_.call(e,t)?e[t]:void 0}var u_=c_,l_=fc,d_=Object.prototype,f_=d_.hasOwnProperty;function h_(t){var e=this.__data__;return l_?e[t]!==void 0:f_.call(e,t)}var p_=h_,m_=fc,g_="__lodash_hash_undefined__";function v_(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=m_&&e===void 0?g_:e,this}var y_=v_,b_=t_,S_=r_,T_=u_,k_=p_,w_=y_;function Di(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Di.prototype.clear=b_;Di.prototype.delete=S_;Di.prototype.get=T_;Di.prototype.has=k_;Di.prototype.set=w_;var C_=Di;function __(){this.__data__=[],this.size=0}var x_=__;function P_(t,e){return t===e||t!==t&&e!==e}var Qd=P_,O_=Qd;function E_(t,e){for(var n=t.length;n--;)if(O_(t[n][0],e))return n;return-1}var hc=E_,A_=hc,I_=Array.prototype,R_=I_.splice;function M_(t){var e=this.__data__,n=A_(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():R_.call(e,n,1),--this.size,!0}var D_=M_,N_=hc;function L_(t){var e=this.__data__,n=N_(e,t);return n<0?void 0:e[n][1]}var j_=L_,$_=hc;function B_(t){return $_(this.__data__,t)>-1}var U_=B_,F_=hc;function q_(t,e){var n=this.__data__,r=F_(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}var V_=q_,W_=x_,z_=D_,G_=j_,H_=U_,K_=V_;function Ni(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Ni.prototype.clear=W_;Ni.prototype.delete=z_;Ni.prototype.get=G_;Ni.prototype.has=H_;Ni.prototype.set=K_;var pc=Ni,X_=Ir,Y_=dn,J_=X_(Y_,"Map"),Zd=J_,zh=C_,Q_=pc,Z_=Zd;function ex(){this.size=0,this.__data__={hash:new zh,map:new(Z_||Q_),string:new zh}}var tx=ex;function nx(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var rx=nx,ix=rx;function ax(t,e){var n=t.__data__;return ix(e)?n[typeof e=="string"?"string":"hash"]:n.map}var mc=ax,ox=mc;function sx(t){var e=ox(this,t).delete(t);return this.size-=e?1:0,e}var cx=sx,ux=mc;function lx(t){return ux(this,t).get(t)}var dx=lx,fx=mc;function hx(t){return fx(this,t).has(t)}var px=hx,mx=mc;function gx(t,e){var n=mx(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}var vx=gx,yx=tx,bx=cx,Sx=dx,Tx=px,kx=vx;function Li(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Li.prototype.clear=yx;Li.prototype.delete=bx;Li.prototype.get=Sx;Li.prototype.has=Tx;Li.prototype.set=kx;var ef=Li,Zy=ef,wx="Expected a function";function tf(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(wx);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=t.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(tf.Cache||Zy),n}tf.Cache=Zy;var eb=tf;const Cx=_e(eb);var _x=eb,xx=500;function Px(t){var e=_x(t,function(r){return n.size===xx&&n.clear(),r}),n=e.cache;return e}var Ox=Px,Ex=Ox,Ax=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ix=/\\(\\)?/g,Rx=Ex(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Ax,function(n,r,i,a){e.push(i?a.replace(Ix,"$1"):r||n)}),e}),Mx=Rx;function Dx(t,e){for(var n=-1,r=t==null?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}var nf=Dx,Gh=so,Nx=nf,Lx=yt,jx=Ri,$x=1/0,Hh=Gh?Gh.prototype:void 0,Kh=Hh?Hh.toString:void 0;function tb(t){if(typeof t=="string")return t;if(Lx(t))return Nx(t,tb)+"";if(jx(t))return Kh?Kh.call(t):"";var e=t+"";return e=="0"&&1/t==-$x?"-0":e}var Bx=tb,Ux=Bx;function Fx(t){return t==null?"":Ux(t)}var nb=Fx,qx=yt,Vx=Yd,Wx=Mx,zx=nb;function Gx(t,e){return qx(t)?t:Vx(t,e)?[t]:Wx(zx(t))}var rb=Gx,Hx=Ri,Kx=1/0;function Xx(t){if(typeof t=="string"||Hx(t))return t;var e=t+"";return e=="0"&&1/t==-Kx?"-0":e}var gc=Xx,Yx=rb,Jx=gc;function Qx(t,e){e=Yx(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[Jx(e[n++])];return n&&n==r?t:void 0}var rf=Qx,Zx=rf;function eP(t,e,n){var r=t==null?void 0:Zx(t,e);return r===void 0?n:r}var ib=eP;const Dt=_e(ib);function tP(t){return t==null}var nP=tP;const ce=_e(nP);var rP=Rn,iP=yt,aP=Mn,oP="[object String]";function sP(t){return typeof t=="string"||!iP(t)&&aP(t)&&rP(t)==oP}var cP=sP;const kr=_e(cP);var uP=Rn,lP=Mn,dP="[object Number]";function fP(t){return typeof t=="number"||lP(t)&&uP(t)==dP}var ab=fP;const hP=_e(ab);var pP=ab;function mP(t){return pP(t)&&t!=+t}var gP=mP;const ji=_e(gP);var Gt=function(e){return e===0?0:e>0?1:-1},hr=function(e){return kr(e)&&e.indexOf("%")===e.length-1},H=function(e){return hP(e)&&!ji(e)},vP=function(e){return ce(e)},Ke=function(e){return H(e)||kr(e)},yP=0,$i=function(e){var n=++yP;return"".concat(e||"").concat(n)},wr=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!H(e)&&!kr(e))return r;var a;if(hr(e)){var o=e.indexOf("%");a=n*parseFloat(e.slice(0,o))/100}else a=+e;return ji(a)&&(a=r),i&&a>n&&(a=n),a},qn=function(e){if(!e)return null;var n=Object.keys(e);return n&&n.length?e[n[0]]:null},bP=function(e){if(!Array.isArray(e))return!1;for(var n=e.length,r={},i=0;i<n;i++)if(!r[e[i]])r[e[i]]=!0;else return!0;return!1},et=function(e,n){return H(e)&&H(n)?function(r){return e+r*(n-e)}:function(){return n}};function es(t,e,n){return!t||!t.length?null:t.find(function(r){return r&&(typeof e=="function"?e(r):Dt(r,e))===n})}var SP=function(e,n){return H(e)&&H(n)?e-n:kr(e)&&kr(n)?e.localeCompare(n):e instanceof Date&&n instanceof Date?e.getTime()-n.getTime():String(e).localeCompare(String(n))};function Qr(t,e){for(var n in t)if({}.hasOwnProperty.call(t,n)&&(!{}.hasOwnProperty.call(e,n)||t[n]!==e[n]))return!1;for(var r in e)if({}.hasOwnProperty.call(e,r)&&!{}.hasOwnProperty.call(t,r))return!1;return!0}function Zu(t){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zu(t)}var TP=["viewBox","children"],kP=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Xh=["points","pathLength"],ru={svg:TP,polygon:Xh,polyline:Xh},af=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],ts=function(e,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(K.isValidElement(e)&&(r=e.props),!Mi(r))return null;var i={};return Object.keys(r).forEach(function(a){af.includes(a)&&(i[a]=n||function(o){return r[a](r,o)})}),i},wP=function(e,n,r){return function(i){return e(n,r,i),null}},ns=function(e,n,r){if(!Mi(e)||Zu(e)!=="object")return null;var i=null;return Object.keys(e).forEach(function(a){var o=e[a];af.includes(a)&&typeof o=="function"&&(i||(i={}),i[a]=wP(o,n,r))}),i},CP=["children"],_P=["children"];function Yh(t,e){if(t==null)return{};var n=xP(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function xP(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function el(t){"@babel/helpers - typeof";return el=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},el(t)}var Jh={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Cn=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},Qh=null,iu=null,of=function t(e){if(e===Qh&&Array.isArray(iu))return iu;var n=[];return K.Children.forEach(e,function(r){ce(r)||(yw.isFragment(r)?n=n.concat(t(r.props.children)):n.push(r))}),iu=n,Qh=e,n};function Nt(t,e){var n=[],r=[];return Array.isArray(e)?r=e.map(function(i){return Cn(i)}):r=[Cn(e)],of(t).forEach(function(i){var a=Dt(i,"type.displayName")||Dt(i,"type.name");r.indexOf(a)!==-1&&n.push(i)}),n}function Tt(t,e){var n=Nt(t,e);return n&&n[0]}var Zh=function(e){if(!e||!e.props)return!1;var n=e.props,r=n.width,i=n.height;return!(!H(r)||r<=0||!H(i)||i<=0)},PP=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],OP=function(e){return e&&e.type&&kr(e.type)&&PP.indexOf(e.type)>=0},ob=function(e){return e&&el(e)==="object"&&"clipDot"in e},EP=function(e,n,r,i){var a,o=(a=ru==null?void 0:ru[i])!==null&&a!==void 0?a:[];return n.startsWith("data-")||!ne(e)&&(i&&o.includes(n)||kP.includes(n))||r&&af.includes(n)},ie=function(e,n,r){if(!e||typeof e=="function"||typeof e=="boolean")return null;var i=e;if(K.isValidElement(e)&&(i=e.props),!Mi(i))return null;var a={};return Object.keys(i).forEach(function(o){var s;EP((s=i)===null||s===void 0?void 0:s[o],o,n,r)&&(a[o]=i[o])}),a},tl=function t(e,n){if(e===n)return!0;var r=K.Children.count(e);if(r!==K.Children.count(n))return!1;if(r===0)return!0;if(r===1)return ep(Array.isArray(e)?e[0]:e,Array.isArray(n)?n[0]:n);for(var i=0;i<r;i++){var a=e[i],o=n[i];if(Array.isArray(a)||Array.isArray(o)){if(!t(a,o))return!1}else if(!ep(a,o))return!1}return!0},ep=function(e,n){if(ce(e)&&ce(n))return!0;if(!ce(e)&&!ce(n)){var r=e.props||{},i=r.children,a=Yh(r,CP),o=n.props||{},s=o.children,c=Yh(o,_P);return i&&s?Qr(a,c)&&tl(i,s):!i&&!s?Qr(a,c):!1}return!1},tp=function(e,n){var r=[],i={};return of(e).forEach(function(a,o){if(OP(a))r.push(a);else if(a){var s=Cn(a.type),c=n[s]||{},u=c.handler,l=c.once;if(u&&(!l||!i[s])){var d=u(a,s,o);r.push(d),i[s]=!0}}}),r},AP=function(e){var n=e&&e.type;return n&&Jh[n]?Jh[n]:null},IP=function(e,n){return of(n).indexOf(e)},RP=["children","width","height","viewBox","className","style","title","desc"];function nl(){return nl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},nl.apply(this,arguments)}function MP(t,e){if(t==null)return{};var n=DP(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function DP(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function rl(t){var e=t.children,n=t.width,r=t.height,i=t.viewBox,a=t.className,o=t.style,s=t.title,c=t.desc,u=MP(t,RP),l=i||{width:n,height:r,x:0,y:0},d=he("recharts-surface",a);return O.createElement("svg",nl({},ie(u,!0,"svg"),{className:d,width:n,height:r,style:o,viewBox:"".concat(l.x," ").concat(l.y," ").concat(l.width," ").concat(l.height)}),O.createElement("title",null,s),O.createElement("desc",null,c),e)}var NP=["children","className"];function il(){return il=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},il.apply(this,arguments)}function LP(t,e){if(t==null)return{};var n=jP(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function jP(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var Ce=O.forwardRef(function(t,e){var n=t.children,r=t.className,i=LP(t,NP),a=he("recharts-layer",r);return O.createElement("g",il({className:a},ie(i,!0),{ref:e}),n)}),_n=function(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a]};function $P(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),n=n>i?i:n,n<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var a=Array(i);++r<i;)a[r]=t[r+e];return a}var BP=$P,UP=BP;function FP(t,e,n){var r=t.length;return n=n===void 0?r:n,!e&&n>=r?t:UP(t,e,n)}var qP=FP,VP="\\ud800-\\udfff",WP="\\u0300-\\u036f",zP="\\ufe20-\\ufe2f",GP="\\u20d0-\\u20ff",HP=WP+zP+GP,KP="\\ufe0e\\ufe0f",XP="\\u200d",YP=RegExp("["+XP+VP+HP+KP+"]");function JP(t){return YP.test(t)}var sb=JP;function QP(t){return t.split("")}var ZP=QP,cb="\\ud800-\\udfff",eO="\\u0300-\\u036f",tO="\\ufe20-\\ufe2f",nO="\\u20d0-\\u20ff",rO=eO+tO+nO,iO="\\ufe0e\\ufe0f",aO="["+cb+"]",al="["+rO+"]",ol="\\ud83c[\\udffb-\\udfff]",oO="(?:"+al+"|"+ol+")",ub="[^"+cb+"]",lb="(?:\\ud83c[\\udde6-\\uddff]){2}",db="[\\ud800-\\udbff][\\udc00-\\udfff]",sO="\\u200d",fb=oO+"?",hb="["+iO+"]?",cO="(?:"+sO+"(?:"+[ub,lb,db].join("|")+")"+hb+fb+")*",uO=hb+fb+cO,lO="(?:"+[ub+al+"?",al,lb,db,aO].join("|")+")",dO=RegExp(ol+"(?="+ol+")|"+lO+uO,"g");function fO(t){return t.match(dO)||[]}var hO=fO,pO=ZP,mO=sb,gO=hO;function vO(t){return mO(t)?gO(t):pO(t)}var yO=vO,bO=qP,SO=sb,TO=yO,kO=nb;function wO(t){return function(e){e=kO(e);var n=SO(e)?TO(e):void 0,r=n?n[0]:e.charAt(0),i=n?bO(n,1).join(""):e.slice(1);return r[t]()+i}}var CO=wO,_O=CO,xO=_O("toUpperCase"),PO=xO;const vc=_e(PO);function we(t){return function(){return t}}const pb=Math.cos,rs=Math.sin,Xt=Math.sqrt,is=Math.PI,yc=2*is,sl=Math.PI,cl=2*sl,ur=1e-6,OO=cl-ur;function mb(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function EO(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return mb;const n=Dh(10,e);return function(r){this._+=r[0];for(let i=1,a=r.length;i<a;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class AO{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?mb:EO(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,a,o){this._append`C${+e},${+n},${+r},${+i},${this._x1=+a},${this._y1=+o}`}arcTo(e,n,r,i,a){if(e=+e,n=+n,r=+r,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let o=this._x1,s=this._y1,c=r-e,u=i-n,l=o-e,d=s-n,f=l*l+d*d;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(f>ur)if(!(Math.abs(d*c-u*l)>ur)||!a)this._append`L${this._x1=e},${this._y1=n}`;else{let h=r-o,m=i-s,p=c*c+u*u,v=h*h+m*m,b=Math.sqrt(p),k=Math.sqrt(f),T=a*Math.tan((sl-Math.acos((p+f-v)/(2*b*k)))/2),S=T/k,g=T/b;Math.abs(S-1)>ur&&this._append`L${e+S*l},${n+S*d}`,this._append`A${a},${a},0,0,${+(d*h>l*m)},${this._x1=e+g*c},${this._y1=n+g*u}`}}arc(e,n,r,i,a,o){if(e=+e,n=+n,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(i),c=r*Math.sin(i),u=e+s,l=n+c,d=1^o,f=o?i-a:a-i;this._x1===null?this._append`M${u},${l}`:(Math.abs(this._x1-u)>ur||Math.abs(this._y1-l)>ur)&&this._append`L${u},${l}`,r&&(f<0&&(f=f%cl+cl),f>OO?this._append`A${r},${r},0,1,${d},${e-s},${n-c}A${r},${r},0,1,${d},${this._x1=u},${this._y1=l}`:f>ur&&this._append`A${r},${r},0,${+(f>=sl)},${d},${this._x1=e+r*Math.cos(a)},${this._y1=n+r*Math.sin(a)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function sf(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new AO(e)}function cf(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function gb(t){this._context=t}gb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function bc(t){return new gb(t)}function vb(t){return t[0]}function yb(t){return t[1]}function bb(t,e){var n=we(!0),r=null,i=bc,a=null,o=sf(s);t=typeof t=="function"?t:t===void 0?vb:we(t),e=typeof e=="function"?e:e===void 0?yb:we(e);function s(c){var u,l=(c=cf(c)).length,d,f=!1,h;for(r==null&&(a=i(h=o())),u=0;u<=l;++u)!(u<l&&n(d=c[u],u,c))===f&&((f=!f)?a.lineStart():a.lineEnd()),f&&a.point(+t(d,u,c),+e(d,u,c));if(h)return a=null,h+""||null}return s.x=function(c){return arguments.length?(t=typeof c=="function"?c:we(+c),s):t},s.y=function(c){return arguments.length?(e=typeof c=="function"?c:we(+c),s):e},s.defined=function(c){return arguments.length?(n=typeof c=="function"?c:we(!!c),s):n},s.curve=function(c){return arguments.length?(i=c,r!=null&&(a=i(r)),s):i},s.context=function(c){return arguments.length?(c==null?r=a=null:a=i(r=c),s):r},s}function bo(t,e,n){var r=null,i=we(!0),a=null,o=bc,s=null,c=sf(u);t=typeof t=="function"?t:t===void 0?vb:we(+t),e=typeof e=="function"?e:we(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?yb:we(+n);function u(d){var f,h,m,p=(d=cf(d)).length,v,b=!1,k,T=new Array(p),S=new Array(p);for(a==null&&(s=o(k=c())),f=0;f<=p;++f){if(!(f<p&&i(v=d[f],f,d))===b)if(b=!b)h=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),m=f-1;m>=h;--m)s.point(T[m],S[m]);s.lineEnd(),s.areaEnd()}b&&(T[f]=+t(v,f,d),S[f]=+e(v,f,d),s.point(r?+r(v,f,d):T[f],n?+n(v,f,d):S[f]))}if(k)return s=null,k+""||null}function l(){return bb().defined(i).curve(o).context(a)}return u.x=function(d){return arguments.length?(t=typeof d=="function"?d:we(+d),r=null,u):t},u.x0=function(d){return arguments.length?(t=typeof d=="function"?d:we(+d),u):t},u.x1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:we(+d),u):r},u.y=function(d){return arguments.length?(e=typeof d=="function"?d:we(+d),n=null,u):e},u.y0=function(d){return arguments.length?(e=typeof d=="function"?d:we(+d),u):e},u.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:we(+d),u):n},u.lineX0=u.lineY0=function(){return l().x(t).y(e)},u.lineY1=function(){return l().x(t).y(n)},u.lineX1=function(){return l().x(r).y(e)},u.defined=function(d){return arguments.length?(i=typeof d=="function"?d:we(!!d),u):i},u.curve=function(d){return arguments.length?(o=d,a!=null&&(s=o(a)),u):o},u.context=function(d){return arguments.length?(d==null?a=s=null:s=o(a=d),u):a},u}class Sb{constructor(e,n){this._context=e,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,n){switch(e=+e,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,n,e,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,e,this._y0,e,n);break}}this._x0=e,this._y0=n}}function IO(t){return new Sb(t,!0)}function RO(t){return new Sb(t,!1)}const uf={draw(t,e){const n=Xt(e/is);t.moveTo(n,0),t.arc(0,0,n,0,yc)}},MO={draw(t,e){const n=Xt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},Tb=Xt(1/3),DO=Tb*2,NO={draw(t,e){const n=Xt(e/DO),r=n*Tb;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},LO={draw(t,e){const n=Xt(e),r=-n/2;t.rect(r,r,n,n)}},jO=.8908130915292852,kb=rs(is/10)/rs(7*is/10),$O=rs(yc/10)*kb,BO=-pb(yc/10)*kb,UO={draw(t,e){const n=Xt(e*jO),r=$O*n,i=BO*n;t.moveTo(0,-n),t.lineTo(r,i);for(let a=1;a<5;++a){const o=yc*a/5,s=pb(o),c=rs(o);t.lineTo(c*n,-s*n),t.lineTo(s*r-c*i,c*r+s*i)}t.closePath()}},au=Xt(3),FO={draw(t,e){const n=-Xt(e/(au*3));t.moveTo(0,n*2),t.lineTo(-au*n,-n),t.lineTo(au*n,-n),t.closePath()}},xt=-.5,Pt=Xt(3)/2,ul=1/Xt(12),qO=(ul/2+1)*3,VO={draw(t,e){const n=Xt(e/qO),r=n/2,i=n*ul,a=r,o=n*ul+n,s=-a,c=o;t.moveTo(r,i),t.lineTo(a,o),t.lineTo(s,c),t.lineTo(xt*r-Pt*i,Pt*r+xt*i),t.lineTo(xt*a-Pt*o,Pt*a+xt*o),t.lineTo(xt*s-Pt*c,Pt*s+xt*c),t.lineTo(xt*r+Pt*i,xt*i-Pt*r),t.lineTo(xt*a+Pt*o,xt*o-Pt*a),t.lineTo(xt*s+Pt*c,xt*c-Pt*s),t.closePath()}};function WO(t,e){let n=null,r=sf(i);t=typeof t=="function"?t:we(t||uf),e=typeof e=="function"?e:we(e===void 0?64:+e);function i(){let a;if(n||(n=a=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),a)return n=null,a+""||null}return i.type=function(a){return arguments.length?(t=typeof a=="function"?a:we(a),i):t},i.size=function(a){return arguments.length?(e=typeof a=="function"?a:we(+a),i):e},i.context=function(a){return arguments.length?(n=a==null?null:a,i):n},i}function as(){}function os(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function wb(t){this._context=t}wb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:os(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:os(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function zO(t){return new wb(t)}function Cb(t){this._context=t}Cb.prototype={areaStart:as,areaEnd:as,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:os(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function GO(t){return new Cb(t)}function _b(t){this._context=t}_b.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:os(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function HO(t){return new _b(t)}function xb(t){this._context=t}xb.prototype={areaStart:as,areaEnd:as,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function KO(t){return new xb(t)}function np(t){return t<0?-1:1}function rp(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(np(a)+np(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function ip(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function ou(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,s=(a-r)/3;t._context.bezierCurveTo(r+s,i+s*e,a-s,o-s*n,a,o)}function ss(t){this._context=t}ss.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ou(this,this._t0,ip(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,ou(this,ip(this,n=rp(this,t,e)),n);break;default:ou(this,this._t0,n=rp(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function Pb(t){this._context=new Ob(t)}(Pb.prototype=Object.create(ss.prototype)).point=function(t,e){ss.prototype.point.call(this,e,t)};function Ob(t){this._context=t}Ob.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}};function XO(t){return new ss(t)}function YO(t){return new Pb(t)}function Eb(t){this._context=t}Eb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var r=ap(t),i=ap(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function ap(t){var e,n=t.length-1,r,i=new Array(n),a=new Array(n),o=new Array(n);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<n-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[n-1]=2,a[n-1]=7,o[n-1]=8*t[n-1]+t[n],e=1;e<n;++e)r=i[e]/a[e-1],a[e]-=r,o[e]-=r*o[e-1];for(i[n-1]=o[n-1]/a[n-1],e=n-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[n-1]=(t[n]+i[n-1])/2,e=0;e<n-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function JO(t){return new Eb(t)}function Sc(t,e){this._context=t,this._t=e}Sc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function QO(t){return new Sc(t,.5)}function ZO(t){return new Sc(t,0)}function eE(t){return new Sc(t,1)}function ci(t,e){if((o=t.length)>1)for(var n=1,r,i,a=t[e[0]],o,s=a.length;n<o;++n)for(i=a,a=t[e[n]],r=0;r<s;++r)a[r][1]+=a[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}function ll(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function tE(t,e){return t[e]}function nE(t){const e=[];return e.key=t,e}function rE(){var t=we([]),e=ll,n=ci,r=tE;function i(a){var o=Array.from(t.apply(this,arguments),nE),s,c=o.length,u=-1,l;for(const d of a)for(s=0,++u;s<c;++s)(o[s][u]=[0,+r(d,o[s].key,u,a)]).data=d;for(s=0,l=cf(e(o));s<c;++s)o[l[s]].index=s;return n(o,l),o}return i.keys=function(a){return arguments.length?(t=typeof a=="function"?a:we(Array.from(a)),i):t},i.value=function(a){return arguments.length?(r=typeof a=="function"?a:we(+a),i):r},i.order=function(a){return arguments.length?(e=a==null?ll:typeof a=="function"?a:we(Array.from(a)),i):e},i.offset=function(a){return arguments.length?(n=a==null?ci:a,i):n},i}function iE(t,e){if((r=t.length)>0){for(var n,r,i=0,a=t[0].length,o;i<a;++i){for(o=n=0;n<r;++n)o+=t[n][i][1]||0;if(o)for(n=0;n<r;++n)t[n][i][1]/=o}ci(t,e)}}function aE(t,e){if((i=t.length)>0){for(var n=0,r=t[e[0]],i,a=r.length;n<a;++n){for(var o=0,s=0;o<i;++o)s+=t[o][n][1]||0;r[n][1]+=r[n][0]=-s/2}ci(t,e)}}function oE(t,e){if(!(!((o=t.length)>0)||!((a=(i=t[e[0]]).length)>0))){for(var n=0,r=1,i,a,o;r<a;++r){for(var s=0,c=0,u=0;s<o;++s){for(var l=t[e[s]],d=l[r][1]||0,f=l[r-1][1]||0,h=(d-f)/2,m=0;m<s;++m){var p=t[e[m]],v=p[r][1]||0,b=p[r-1][1]||0;h+=v-b}c+=d,u+=h*d}i[r-1][1]+=i[r-1][0]=n,c&&(n-=u/c)}i[r-1][1]+=i[r-1][0]=n,ci(t,e)}}function wa(t){"@babel/helpers - typeof";return wa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wa(t)}var sE=["type","size","sizeType"];function dl(){return dl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},dl.apply(this,arguments)}function op(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function sp(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?op(Object(n),!0).forEach(function(r){cE(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):op(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function cE(t,e,n){return e=uE(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uE(t){var e=lE(t,"string");return wa(e)=="symbol"?e:e+""}function lE(t,e){if(wa(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(wa(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dE(t,e){if(t==null)return{};var n=fE(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function fE(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var Ab={symbolCircle:uf,symbolCross:MO,symbolDiamond:NO,symbolSquare:LO,symbolStar:UO,symbolTriangle:FO,symbolWye:VO},hE=Math.PI/180,pE=function(e){var n="symbol".concat(vc(e));return Ab[n]||uf},mE=function(e,n,r){if(n==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var i=18*hE;return 1.25*e*e*(Math.tan(i)-Math.tan(i*2)*Math.pow(Math.tan(i),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},gE=function(e,n){Ab["symbol".concat(vc(e))]=n},lf=function(e){var n=e.type,r=n===void 0?"circle":n,i=e.size,a=i===void 0?64:i,o=e.sizeType,s=o===void 0?"area":o,c=dE(e,sE),u=sp(sp({},c),{},{type:r,size:a,sizeType:s}),l=function(){var v=pE(r),b=WO().type(v).size(mE(a,s,r));return b()},d=u.className,f=u.cx,h=u.cy,m=ie(u,!0);return f===+f&&h===+h&&a===+a?O.createElement("path",dl({},m,{className:he("recharts-symbols",d),transform:"translate(".concat(f,", ").concat(h,")"),d:l()})):null};lf.registerSymbol=gE;function ui(t){"@babel/helpers - typeof";return ui=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ui(t)}function fl(){return fl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},fl.apply(this,arguments)}function cp(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function vE(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?cp(Object(n),!0).forEach(function(r){Ca(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cp(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function yE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function up(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Rb(r.key),r)}}function bE(t,e,n){return e&&up(t.prototype,e),n&&up(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function SE(t,e,n){return e=cs(e),TE(t,Ib()?Reflect.construct(e,n||[],cs(t).constructor):e.apply(t,n))}function TE(t,e){if(e&&(ui(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kE(t)}function kE(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ib(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ib=function(){return!!t})()}function cs(t){return cs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},cs(t)}function wE(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hl(t,e)}function hl(t,e){return hl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},hl(t,e)}function Ca(t,e,n){return e=Rb(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rb(t){var e=CE(t,"string");return ui(e)=="symbol"?e:e+""}function CE(t,e){if(ui(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(ui(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ot=32,df=function(t){function e(){return yE(this,e),SE(this,e,arguments)}return wE(e,t),bE(e,[{key:"renderIcon",value:function(r){var i=this.props.inactiveColor,a=Ot/2,o=Ot/6,s=Ot/3,c=r.inactive?i:r.color;if(r.type==="plainline")return O.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:r.payload.strokeDasharray,x1:0,y1:a,x2:Ot,y2:a,className:"recharts-legend-icon"});if(r.type==="line")return O.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(a,"h").concat(s,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*s,",").concat(a,`
            H`).concat(Ot,"M").concat(2*s,",").concat(a,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(s,",").concat(a),className:"recharts-legend-icon"});if(r.type==="rect")return O.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Ot/8,"h").concat(Ot,"v").concat(Ot*3/4,"h").concat(-Ot,"z"),className:"recharts-legend-icon"});if(O.isValidElement(r.legendIcon)){var u=vE({},r);return delete u.legendIcon,O.cloneElement(r.legendIcon,u)}return O.createElement(lf,{fill:c,cx:a,cy:a,size:Ot,sizeType:"diameter",type:r.type})}},{key:"renderItems",value:function(){var r=this,i=this.props,a=i.payload,o=i.iconSize,s=i.layout,c=i.formatter,u=i.inactiveColor,l={x:0,y:0,width:Ot,height:Ot},d={display:s==="horizontal"?"inline-block":"block",marginRight:10},f={display:"inline-block",verticalAlign:"middle",marginRight:4};return a.map(function(h,m){var p=h.formatter||c,v=he(Ca(Ca({"recharts-legend-item":!0},"legend-item-".concat(m),!0),"inactive",h.inactive));if(h.type==="none")return null;var b=ne(h.value)?null:h.value;_n(!ne(h.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var k=h.inactive?u:h.color;return O.createElement("li",fl({className:v,style:d,key:"legend-item-".concat(m)},ns(r.props,h,m)),O.createElement(rl,{width:o,height:o,viewBox:l,style:f},r.renderIcon(h)),O.createElement("span",{className:"recharts-legend-item-text",style:{color:k}},p?p(b,h,m):b))})}},{key:"render",value:function(){var r=this.props,i=r.payload,a=r.layout,o=r.align;if(!i||!i.length)return null;var s={padding:0,margin:0,textAlign:a==="horizontal"?o:"left"};return O.createElement("ul",{className:"recharts-default-legend",style:s},this.renderItems())}}])}(K.PureComponent);Ca(df,"displayName","Legend");Ca(df,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var _E=pc;function xE(){this.__data__=new _E,this.size=0}var PE=xE;function OE(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var EE=OE;function AE(t){return this.__data__.get(t)}var IE=AE;function RE(t){return this.__data__.has(t)}var ME=RE,DE=pc,NE=Zd,LE=ef,jE=200;function $E(t,e){var n=this.__data__;if(n instanceof DE){var r=n.__data__;if(!NE||r.length<jE-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new LE(r)}return n.set(t,e),this.size=n.size,this}var BE=$E,UE=pc,FE=PE,qE=EE,VE=IE,WE=ME,zE=BE;function Bi(t){var e=this.__data__=new UE(t);this.size=e.size}Bi.prototype.clear=FE;Bi.prototype.delete=qE;Bi.prototype.get=VE;Bi.prototype.has=WE;Bi.prototype.set=zE;var Mb=Bi,GE="__lodash_hash_undefined__";function HE(t){return this.__data__.set(t,GE),this}var KE=HE;function XE(t){return this.__data__.has(t)}var YE=XE,JE=ef,QE=KE,ZE=YE;function us(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new JE;++e<n;)this.add(t[e])}us.prototype.add=us.prototype.push=QE;us.prototype.has=ZE;var Db=us;function e1(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var Nb=e1;function t1(t,e){return t.has(e)}var Lb=t1,n1=Db,r1=Nb,i1=Lb,a1=1,o1=2;function s1(t,e,n,r,i,a){var o=n&a1,s=t.length,c=e.length;if(s!=c&&!(o&&c>s))return!1;var u=a.get(t),l=a.get(e);if(u&&l)return u==e&&l==t;var d=-1,f=!0,h=n&o1?new n1:void 0;for(a.set(t,e),a.set(e,t);++d<s;){var m=t[d],p=e[d];if(r)var v=o?r(p,m,d,e,t,a):r(m,p,d,t,e,a);if(v!==void 0){if(v)continue;f=!1;break}if(h){if(!r1(e,function(b,k){if(!i1(h,k)&&(m===b||i(m,b,n,r,a)))return h.push(k)})){f=!1;break}}else if(!(m===p||i(m,p,n,r,a))){f=!1;break}}return a.delete(t),a.delete(e),f}var jb=s1,c1=dn,u1=c1.Uint8Array,l1=u1;function d1(t){var e=-1,n=Array(t.size);return t.forEach(function(r,i){n[++e]=[i,r]}),n}var f1=d1;function h1(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n}var ff=h1,lp=so,dp=l1,p1=Qd,m1=jb,g1=f1,v1=ff,y1=1,b1=2,S1="[object Boolean]",T1="[object Date]",k1="[object Error]",w1="[object Map]",C1="[object Number]",_1="[object RegExp]",x1="[object Set]",P1="[object String]",O1="[object Symbol]",E1="[object ArrayBuffer]",A1="[object DataView]",fp=lp?lp.prototype:void 0,su=fp?fp.valueOf:void 0;function I1(t,e,n,r,i,a,o){switch(n){case A1:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case E1:return!(t.byteLength!=e.byteLength||!a(new dp(t),new dp(e)));case S1:case T1:case C1:return p1(+t,+e);case k1:return t.name==e.name&&t.message==e.message;case _1:case P1:return t==e+"";case w1:var s=g1;case x1:var c=r&y1;if(s||(s=v1),t.size!=e.size&&!c)return!1;var u=o.get(t);if(u)return u==e;r|=b1,o.set(t,e);var l=m1(s(t),s(e),r,i,a,o);return o.delete(t),l;case O1:if(su)return su.call(t)==su.call(e)}return!1}var R1=I1;function M1(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}var $b=M1,D1=$b,N1=yt;function L1(t,e,n){var r=e(t);return N1(t)?r:D1(r,n(t))}var j1=L1;function $1(t,e){for(var n=-1,r=t==null?0:t.length,i=0,a=[];++n<r;){var o=t[n];e(o,n,t)&&(a[i++]=o)}return a}var B1=$1;function U1(){return[]}var F1=U1,q1=B1,V1=F1,W1=Object.prototype,z1=W1.propertyIsEnumerable,hp=Object.getOwnPropertySymbols,G1=hp?function(t){return t==null?[]:(t=Object(t),q1(hp(t),function(e){return z1.call(t,e)}))}:V1,H1=G1;function K1(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var X1=K1,Y1=Rn,J1=Mn,Q1="[object Arguments]";function Z1(t){return J1(t)&&Y1(t)==Q1}var eA=Z1,pp=eA,tA=Mn,Bb=Object.prototype,nA=Bb.hasOwnProperty,rA=Bb.propertyIsEnumerable,iA=pp(function(){return arguments}())?pp:function(t){return tA(t)&&nA.call(t,"callee")&&!rA.call(t,"callee")},hf=iA,ls={exports:{}};function aA(){return!1}var oA=aA;ls.exports;(function(t,e){var n=dn,r=oA,i=e&&!e.nodeType&&e,a=i&&!0&&t&&!t.nodeType&&t,o=a&&a.exports===i,s=o?n.Buffer:void 0,c=s?s.isBuffer:void 0,u=c||r;t.exports=u})(ls,ls.exports);var Ub=ls.exports,sA=9007199254740991,cA=/^(?:0|[1-9]\d*)$/;function uA(t,e){var n=typeof t;return e=e==null?sA:e,!!e&&(n=="number"||n!="symbol"&&cA.test(t))&&t>-1&&t%1==0&&t<e}var pf=uA,lA=9007199254740991;function dA(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=lA}var mf=dA,fA=Rn,hA=mf,pA=Mn,mA="[object Arguments]",gA="[object Array]",vA="[object Boolean]",yA="[object Date]",bA="[object Error]",SA="[object Function]",TA="[object Map]",kA="[object Number]",wA="[object Object]",CA="[object RegExp]",_A="[object Set]",xA="[object String]",PA="[object WeakMap]",OA="[object ArrayBuffer]",EA="[object DataView]",AA="[object Float32Array]",IA="[object Float64Array]",RA="[object Int8Array]",MA="[object Int16Array]",DA="[object Int32Array]",NA="[object Uint8Array]",LA="[object Uint8ClampedArray]",jA="[object Uint16Array]",$A="[object Uint32Array]",Oe={};Oe[AA]=Oe[IA]=Oe[RA]=Oe[MA]=Oe[DA]=Oe[NA]=Oe[LA]=Oe[jA]=Oe[$A]=!0;Oe[mA]=Oe[gA]=Oe[OA]=Oe[vA]=Oe[EA]=Oe[yA]=Oe[bA]=Oe[SA]=Oe[TA]=Oe[kA]=Oe[wA]=Oe[CA]=Oe[_A]=Oe[xA]=Oe[PA]=!1;function BA(t){return pA(t)&&hA(t.length)&&!!Oe[fA(t)]}var UA=BA;function FA(t){return function(e){return t(e)}}var Fb=FA,ds={exports:{}};ds.exports;(function(t,e){var n=Yy,r=e&&!e.nodeType&&e,i=r&&!0&&t&&!t.nodeType&&t,a=i&&i.exports===r,o=a&&n.process,s=function(){try{var c=i&&i.require&&i.require("util").types;return c||o&&o.binding&&o.binding("util")}catch(u){}}();t.exports=s})(ds,ds.exports);var qA=ds.exports,VA=UA,WA=Fb,mp=qA,gp=mp&&mp.isTypedArray,zA=gp?WA(gp):VA,qb=zA,GA=X1,HA=hf,KA=yt,XA=Ub,YA=pf,JA=qb,QA=Object.prototype,ZA=QA.hasOwnProperty;function eI(t,e){var n=KA(t),r=!n&&HA(t),i=!n&&!r&&XA(t),a=!n&&!r&&!i&&JA(t),o=n||r||i||a,s=o?GA(t.length,String):[],c=s.length;for(var u in t)(e||ZA.call(t,u))&&!(o&&(u=="length"||i&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||YA(u,c)))&&s.push(u);return s}var tI=eI,nI=Object.prototype;function rI(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||nI;return t===n}var iI=rI;function aI(t,e){return function(n){return t(e(n))}}var Vb=aI,oI=Vb,sI=oI(Object.keys,Object),cI=sI,uI=iI,lI=cI,dI=Object.prototype,fI=dI.hasOwnProperty;function hI(t){if(!uI(t))return lI(t);var e=[];for(var n in Object(t))fI.call(t,n)&&n!="constructor"&&e.push(n);return e}var pI=hI,mI=Jd,gI=mf;function vI(t){return t!=null&&gI(t.length)&&!mI(t)}var co=vI,yI=tI,bI=pI,SI=co;function TI(t){return SI(t)?yI(t):bI(t)}var Tc=TI,kI=j1,wI=H1,CI=Tc;function _I(t){return kI(t,CI,wI)}var xI=_I,vp=xI,PI=1,OI=Object.prototype,EI=OI.hasOwnProperty;function AI(t,e,n,r,i,a){var o=n&PI,s=vp(t),c=s.length,u=vp(e),l=u.length;if(c!=l&&!o)return!1;for(var d=c;d--;){var f=s[d];if(!(o?f in e:EI.call(e,f)))return!1}var h=a.get(t),m=a.get(e);if(h&&m)return h==e&&m==t;var p=!0;a.set(t,e),a.set(e,t);for(var v=o;++d<c;){f=s[d];var b=t[f],k=e[f];if(r)var T=o?r(k,b,f,e,t,a):r(b,k,f,t,e,a);if(!(T===void 0?b===k||i(b,k,n,r,a):T)){p=!1;break}v||(v=f=="constructor")}if(p&&!v){var S=t.constructor,g=e.constructor;S!=g&&"constructor"in t&&"constructor"in e&&!(typeof S=="function"&&S instanceof S&&typeof g=="function"&&g instanceof g)&&(p=!1)}return a.delete(t),a.delete(e),p}var II=AI,RI=Ir,MI=dn,DI=RI(MI,"DataView"),NI=DI,LI=Ir,jI=dn,$I=LI(jI,"Promise"),BI=$I,UI=Ir,FI=dn,qI=UI(FI,"Set"),Wb=qI,VI=Ir,WI=dn,zI=VI(WI,"WeakMap"),GI=zI,pl=NI,ml=Zd,gl=BI,vl=Wb,yl=GI,zb=Rn,Ui=Qy,yp="[object Map]",HI="[object Object]",bp="[object Promise]",Sp="[object Set]",Tp="[object WeakMap]",kp="[object DataView]",KI=Ui(pl),XI=Ui(ml),YI=Ui(gl),JI=Ui(vl),QI=Ui(yl),lr=zb;(pl&&lr(new pl(new ArrayBuffer(1)))!=kp||ml&&lr(new ml)!=yp||gl&&lr(gl.resolve())!=bp||vl&&lr(new vl)!=Sp||yl&&lr(new yl)!=Tp)&&(lr=function(t){var e=zb(t),n=e==HI?t.constructor:void 0,r=n?Ui(n):"";if(r)switch(r){case KI:return kp;case XI:return yp;case YI:return bp;case JI:return Sp;case QI:return Tp}return e});var ZI=lr,cu=Mb,eR=jb,tR=R1,nR=II,wp=ZI,Cp=yt,_p=Ub,rR=qb,iR=1,xp="[object Arguments]",Pp="[object Array]",So="[object Object]",aR=Object.prototype,Op=aR.hasOwnProperty;function oR(t,e,n,r,i,a){var o=Cp(t),s=Cp(e),c=o?Pp:wp(t),u=s?Pp:wp(e);c=c==xp?So:c,u=u==xp?So:u;var l=c==So,d=u==So,f=c==u;if(f&&_p(t)){if(!_p(e))return!1;o=!0,l=!1}if(f&&!l)return a||(a=new cu),o||rR(t)?eR(t,e,n,r,i,a):tR(t,e,c,n,r,i,a);if(!(n&iR)){var h=l&&Op.call(t,"__wrapped__"),m=d&&Op.call(e,"__wrapped__");if(h||m){var p=h?t.value():t,v=m?e.value():e;return a||(a=new cu),i(p,v,n,r,a)}}return f?(a||(a=new cu),nR(t,e,n,r,i,a)):!1}var sR=oR,cR=sR,Ep=Mn;function Gb(t,e,n,r,i){return t===e?!0:t==null||e==null||!Ep(t)&&!Ep(e)?t!==t&&e!==e:cR(t,e,n,r,Gb,i)}var gf=Gb,uR=Mb,lR=gf,dR=1,fR=2;function hR(t,e,n,r){var i=n.length,a=i,o=!r;if(t==null)return!a;for(t=Object(t);i--;){var s=n[i];if(o&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<a;){s=n[i];var c=s[0],u=t[c],l=s[1];if(o&&s[2]){if(u===void 0&&!(c in t))return!1}else{var d=new uR;if(r)var f=r(u,l,c,t,e,d);if(!(f===void 0?lR(l,u,dR|fR,r,d):f))return!1}}return!0}var pR=hR,mR=Zn;function gR(t){return t===t&&!mR(t)}var Hb=gR,vR=Hb,yR=Tc;function bR(t){for(var e=yR(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,vR(i)]}return e}var SR=bR;function TR(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}var Kb=TR,kR=pR,wR=SR,CR=Kb;function _R(t){var e=wR(t);return e.length==1&&e[0][2]?CR(e[0][0],e[0][1]):function(n){return n===t||kR(n,t,e)}}var xR=_R;function PR(t,e){return t!=null&&e in Object(t)}var OR=PR,ER=rb,AR=hf,IR=yt,RR=pf,MR=mf,DR=gc;function NR(t,e,n){e=ER(e,t);for(var r=-1,i=e.length,a=!1;++r<i;){var o=DR(e[r]);if(!(a=t!=null&&n(t,o)))break;t=t[o]}return a||++r!=i?a:(i=t==null?0:t.length,!!i&&MR(i)&&RR(o,i)&&(IR(t)||AR(t)))}var LR=NR,jR=OR,$R=LR;function BR(t,e){return t!=null&&$R(t,e,jR)}var UR=BR,FR=gf,qR=ib,VR=UR,WR=Yd,zR=Hb,GR=Kb,HR=gc,KR=1,XR=2;function YR(t,e){return WR(t)&&zR(e)?GR(HR(t),e):function(n){var r=qR(n,t);return r===void 0&&r===e?VR(n,t):FR(e,r,KR|XR)}}var JR=YR;function QR(t){return t}var Fi=QR;function ZR(t){return function(e){return e==null?void 0:e[t]}}var eM=ZR,tM=rf;function nM(t){return function(e){return tM(e,t)}}var rM=nM,iM=eM,aM=rM,oM=Yd,sM=gc;function cM(t){return oM(t)?iM(sM(t)):aM(t)}var uM=cM,lM=xR,dM=JR,fM=Fi,hM=yt,pM=uM;function mM(t){return typeof t=="function"?t:t==null?fM:typeof t=="object"?hM(t)?dM(t[0],t[1]):lM(t):pM(t)}var er=mM;function gM(t,e,n,r){for(var i=t.length,a=n+(r?1:-1);r?a--:++a<i;)if(e(t[a],a,t))return a;return-1}var Xb=gM;function vM(t){return t!==t}var yM=vM;function bM(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}var SM=bM,TM=Xb,kM=yM,wM=SM;function CM(t,e,n){return e===e?wM(t,e,n):TM(t,kM,n)}var _M=CM,xM=_M;function PM(t,e){var n=t==null?0:t.length;return!!n&&xM(t,e,0)>-1}var OM=PM;function EM(t,e,n){for(var r=-1,i=t==null?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}var AM=EM;function IM(){}var RM=IM,uu=Wb,MM=RM,DM=ff,NM=1/0,LM=uu&&1/DM(new uu([,-0]))[1]==NM?function(t){return new uu(t)}:MM,jM=LM,$M=Db,BM=OM,UM=AM,FM=Lb,qM=jM,VM=ff,WM=200;function zM(t,e,n){var r=-1,i=BM,a=t.length,o=!0,s=[],c=s;if(n)o=!1,i=UM;else if(a>=WM){var u=e?null:qM(t);if(u)return VM(u);o=!1,i=FM,c=new $M}else c=e?[]:s;e:for(;++r<a;){var l=t[r],d=e?e(l):l;if(l=n||l!==0?l:0,o&&d===d){for(var f=c.length;f--;)if(c[f]===d)continue e;e&&c.push(d),s.push(l)}else i(c,d,n)||(c!==s&&c.push(d),s.push(l))}return s}var GM=zM,HM=er,KM=GM;function XM(t,e){return t&&t.length?KM(t,HM(e)):[]}var YM=XM;const Ap=_e(YM);function Yb(t,e,n){return e===!0?Ap(t,n):ne(e)?Ap(t,e):t}function li(t){"@babel/helpers - typeof";return li=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},li(t)}var JM=["ref"];function Ip(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function hn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ip(Object(n),!0).forEach(function(r){kc(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ip(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function QM(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Qb(r.key),r)}}function ZM(t,e,n){return e&&Rp(t.prototype,e),n&&Rp(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function eD(t,e,n){return e=fs(e),tD(t,Jb()?Reflect.construct(e,n||[],fs(t).constructor):e.apply(t,n))}function tD(t,e){if(e&&(li(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nD(t)}function nD(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jb(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Jb=function(){return!!t})()}function fs(t){return fs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},fs(t)}function rD(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bl(t,e)}function bl(t,e){return bl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},bl(t,e)}function kc(t,e,n){return e=Qb(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qb(t){var e=iD(t,"string");return li(e)=="symbol"?e:e+""}function iD(t,e){if(li(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(li(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aD(t,e){if(t==null)return{};var n=oD(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function oD(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function sD(t){return t.value}function cD(t,e){if(O.isValidElement(t))return O.cloneElement(t,e);if(typeof t=="function")return O.createElement(t,e);e.ref;var n=aD(e,JM);return O.createElement(df,n)}var Mp=1,Zr=function(t){function e(){var n;QM(this,e);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=eD(this,e,[].concat(i)),kc(n,"lastBoundingBox",{width:-1,height:-1}),n}return rD(e,t),ZM(e,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();return r.height=this.wrapperNode.offsetHeight,r.width=this.wrapperNode.offsetWidth,r}return null}},{key:"updateBBox",value:function(){var r=this.props.onBBoxUpdate,i=this.getBBox();i?(Math.abs(i.width-this.lastBoundingBox.width)>Mp||Math.abs(i.height-this.lastBoundingBox.height)>Mp)&&(this.lastBoundingBox.width=i.width,this.lastBoundingBox.height=i.height,r&&r(i)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,r&&r(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?hn({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(r){var i=this.props,a=i.layout,o=i.align,s=i.verticalAlign,c=i.margin,u=i.chartWidth,l=i.chartHeight,d,f;if(!r||(r.left===void 0||r.left===null)&&(r.right===void 0||r.right===null))if(o==="center"&&a==="vertical"){var h=this.getBBoxSnapshot();d={left:((u||0)-h.width)/2}}else d=o==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!r||(r.top===void 0||r.top===null)&&(r.bottom===void 0||r.bottom===null))if(s==="middle"){var m=this.getBBoxSnapshot();f={top:((l||0)-m.height)/2}}else f=s==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return hn(hn({},d),f)}},{key:"render",value:function(){var r=this,i=this.props,a=i.content,o=i.width,s=i.height,c=i.wrapperStyle,u=i.payloadUniqBy,l=i.payload,d=hn(hn({position:"absolute",width:o||"auto",height:s||"auto"},this.getDefaultPosition(c)),c);return O.createElement("div",{className:"recharts-legend-wrapper",style:d,ref:function(h){r.wrapperNode=h}},cD(a,hn(hn({},this.props),{},{payload:Yb(l,u,sD)})))}}],[{key:"getWithHeight",value:function(r,i){var a=hn(hn({},this.defaultProps),r.props),o=a.layout;return o==="vertical"&&H(r.props.height)?{height:r.props.height}:o==="horizontal"?{width:r.props.width||i}:null}}])}(K.PureComponent);kc(Zr,"displayName","Legend");kc(Zr,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var Dp=so,uD=hf,lD=yt,Np=Dp?Dp.isConcatSpreadable:void 0;function dD(t){return lD(t)||uD(t)||!!(Np&&t&&t[Np])}var fD=dD,hD=$b,pD=fD;function Zb(t,e,n,r,i){var a=-1,o=t.length;for(n||(n=pD),i||(i=[]);++a<o;){var s=t[a];e>0&&n(s)?e>1?Zb(s,e-1,n,r,i):hD(i,s):r||(i[i.length]=s)}return i}var e0=Zb;function mD(t){return function(e,n,r){for(var i=-1,a=Object(e),o=r(e),s=o.length;s--;){var c=o[t?s:++i];if(n(a[c],c,a)===!1)break}return e}}var gD=mD,vD=gD,yD=vD(),bD=yD,SD=bD,TD=Tc;function kD(t,e){return t&&SD(t,e,TD)}var t0=kD,wD=co;function CD(t,e){return function(n,r){if(n==null)return n;if(!wD(n))return t(n,r);for(var i=n.length,a=e?i:-1,o=Object(n);(e?a--:++a<i)&&r(o[a],a,o)!==!1;);return n}}var _D=CD,xD=t0,PD=_D,OD=PD(xD),vf=OD,ED=vf,AD=co;function ID(t,e){var n=-1,r=AD(t)?Array(t.length):[];return ED(t,function(i,a,o){r[++n]=e(i,a,o)}),r}var n0=ID;function RD(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}var MD=RD,Lp=Ri;function DD(t,e){if(t!==e){var n=t!==void 0,r=t===null,i=t===t,a=Lp(t),o=e!==void 0,s=e===null,c=e===e,u=Lp(e);if(!s&&!u&&!a&&t>e||a&&o&&c&&!s&&!u||r&&o&&c||!n&&c||!i)return 1;if(!r&&!a&&!u&&t<e||u&&n&&i&&!r&&!a||s&&n&&i||!o&&i||!c)return-1}return 0}var ND=DD,LD=ND;function jD(t,e,n){for(var r=-1,i=t.criteria,a=e.criteria,o=i.length,s=n.length;++r<o;){var c=LD(i[r],a[r]);if(c){if(r>=s)return c;var u=n[r];return c*(u=="desc"?-1:1)}}return t.index-e.index}var $D=jD,lu=nf,BD=rf,UD=er,FD=n0,qD=MD,VD=Fb,WD=$D,zD=Fi,GD=yt;function HD(t,e,n){e.length?e=lu(e,function(a){return GD(a)?function(o){return BD(o,a.length===1?a[0]:a)}:a}):e=[zD];var r=-1;e=lu(e,VD(UD));var i=FD(t,function(a,o,s){var c=lu(e,function(u){return u(a)});return{criteria:c,index:++r,value:a}});return qD(i,function(a,o){return WD(a,o,n)})}var KD=HD;function XD(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var YD=XD,JD=YD,jp=Math.max;function QD(t,e,n){return e=jp(e===void 0?t.length-1:e,0),function(){for(var r=arguments,i=-1,a=jp(r.length-e,0),o=Array(a);++i<a;)o[i]=r[e+i];i=-1;for(var s=Array(e+1);++i<e;)s[i]=r[i];return s[e]=n(o),JD(t,this,s)}}var ZD=QD;function eN(t){return function(){return t}}var tN=eN,nN=Ir,rN=function(){try{var t=nN(Object,"defineProperty");return t({},"",{}),t}catch(e){}}(),r0=rN,iN=tN,$p=r0,aN=Fi,oN=$p?function(t,e){return $p(t,"toString",{configurable:!0,enumerable:!1,value:iN(e),writable:!0})}:aN,sN=oN,cN=800,uN=16,lN=Date.now;function dN(t){var e=0,n=0;return function(){var r=lN(),i=uN-(r-n);if(n=r,i>0){if(++e>=cN)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var fN=dN,hN=sN,pN=fN,mN=pN(hN),gN=mN,vN=Fi,yN=ZD,bN=gN;function SN(t,e){return bN(yN(t,e,vN),t+"")}var TN=SN,kN=Qd,wN=co,CN=pf,_N=Zn;function xN(t,e,n){if(!_N(n))return!1;var r=typeof e;return(r=="number"?wN(n)&&CN(e,n.length):r=="string"&&e in n)?kN(n[e],t):!1}var wc=xN,PN=e0,ON=KD,EN=TN,Bp=wc,AN=EN(function(t,e){if(t==null)return[];var n=e.length;return n>1&&Bp(t,e[0],e[1])?e=[]:n>2&&Bp(e[0],e[1],e[2])&&(e=[e[0]]),ON(t,PN(e,1),[])}),IN=AN;const yf=_e(IN);function _a(t){"@babel/helpers - typeof";return _a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_a(t)}function Sl(){return Sl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Sl.apply(this,arguments)}function RN(t,e){return LN(t)||NN(t,e)||DN(t,e)||MN()}function MN(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DN(t,e){if(t){if(typeof t=="string")return Up(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Up(t,e)}}function Up(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function NN(t,e){var n=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,a,o,s=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(l){u=!0,i=l}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function LN(t){if(Array.isArray(t))return t}function Fp(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function du(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Fp(Object(n),!0).forEach(function(r){jN(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fp(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function jN(t,e,n){return e=$N(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $N(t){var e=BN(t,"string");return _a(e)=="symbol"?e:e+""}function BN(t,e){if(_a(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(_a(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UN(t){return Array.isArray(t)&&Ke(t[0])&&Ke(t[1])?t.join(" ~ "):t}var FN=function(e){var n=e.separator,r=n===void 0?" : ":n,i=e.contentStyle,a=i===void 0?{}:i,o=e.itemStyle,s=o===void 0?{}:o,c=e.labelStyle,u=c===void 0?{}:c,l=e.payload,d=e.formatter,f=e.itemSorter,h=e.wrapperClassName,m=e.labelClassName,p=e.label,v=e.labelFormatter,b=e.accessibilityLayer,k=b===void 0?!1:b,T=function(){if(l&&l.length){var E={padding:0,margin:0},M=(f?yf(l,f):l).map(function(N,D){if(N.type==="none")return null;var $=du({display:"block",paddingTop:4,paddingBottom:4,color:N.color||"#000"},s),F=N.formatter||d||UN,R=N.value,j=N.name,q=R,J=j;if(F&&q!=null&&J!=null){var W=F(R,j,N,D,l);if(Array.isArray(W)){var ee=RN(W,2);q=ee[0],J=ee[1]}else q=W}return O.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(D),style:$},Ke(J)?O.createElement("span",{className:"recharts-tooltip-item-name"},J):null,Ke(J)?O.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,O.createElement("span",{className:"recharts-tooltip-item-value"},q),O.createElement("span",{className:"recharts-tooltip-item-unit"},N.unit||""))});return O.createElement("ul",{className:"recharts-tooltip-item-list",style:E},M)}return null},S=du({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},a),g=du({margin:0},u),y=!ce(p),w=y?p:"",C=he("recharts-default-tooltip",h),_=he("recharts-tooltip-label",m);y&&v&&l!==void 0&&l!==null&&(w=v(p,l));var A=k?{role:"status","aria-live":"assertive"}:{};return O.createElement("div",Sl({className:C,style:S},A),O.createElement("p",{className:_,style:g},O.isValidElement(w)?w:"".concat(w)),T())};function xa(t){"@babel/helpers - typeof";return xa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xa(t)}function To(t,e,n){return e=qN(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qN(t){var e=VN(t,"string");return xa(e)=="symbol"?e:e+""}function VN(t,e){if(xa(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(xa(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Xi="recharts-tooltip-wrapper",WN={visibility:"hidden"};function zN(t){var e=t.coordinate,n=t.translateX,r=t.translateY;return he(Xi,To(To(To(To({},"".concat(Xi,"-right"),H(n)&&e&&H(e.x)&&n>=e.x),"".concat(Xi,"-left"),H(n)&&e&&H(e.x)&&n<e.x),"".concat(Xi,"-bottom"),H(r)&&e&&H(e.y)&&r>=e.y),"".concat(Xi,"-top"),H(r)&&e&&H(e.y)&&r<e.y))}function qp(t){var e=t.allowEscapeViewBox,n=t.coordinate,r=t.key,i=t.offsetTopLeft,a=t.position,o=t.reverseDirection,s=t.tooltipDimension,c=t.viewBox,u=t.viewBoxDimension;if(a&&H(a[r]))return a[r];var l=n[r]-s-i,d=n[r]+i;if(e[r])return o[r]?l:d;if(o[r]){var f=l,h=c[r];return f<h?Math.max(d,c[r]):Math.max(l,c[r])}var m=d+s,p=c[r]+u;return m>p?Math.max(l,c[r]):Math.max(d,c[r])}function GN(t){var e=t.translateX,n=t.translateY,r=t.useTranslate3d;return{transform:r?"translate3d(".concat(e,"px, ").concat(n,"px, 0)"):"translate(".concat(e,"px, ").concat(n,"px)")}}function HN(t){var e=t.allowEscapeViewBox,n=t.coordinate,r=t.offsetTopLeft,i=t.position,a=t.reverseDirection,o=t.tooltipBox,s=t.useTranslate3d,c=t.viewBox,u,l,d;return o.height>0&&o.width>0&&n?(l=qp({allowEscapeViewBox:e,coordinate:n,key:"x",offsetTopLeft:r,position:i,reverseDirection:a,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),d=qp({allowEscapeViewBox:e,coordinate:n,key:"y",offsetTopLeft:r,position:i,reverseDirection:a,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),u=GN({translateX:l,translateY:d,useTranslate3d:s})):u=WN,{cssProperties:u,cssClasses:zN({translateX:l,translateY:d,coordinate:n})}}function di(t){"@babel/helpers - typeof";return di=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},di(t)}function Vp(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Wp(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Vp(Object(n),!0).forEach(function(r){kl(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vp(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function KN(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,a0(r.key),r)}}function XN(t,e,n){return e&&zp(t.prototype,e),n&&zp(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function YN(t,e,n){return e=hs(e),JN(t,i0()?Reflect.construct(e,n||[],hs(t).constructor):e.apply(t,n))}function JN(t,e){if(e&&(di(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QN(t)}function QN(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function i0(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(i0=function(){return!!t})()}function hs(t){return hs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},hs(t)}function ZN(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tl(t,e)}function Tl(t,e){return Tl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Tl(t,e)}function kl(t,e,n){return e=a0(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a0(t){var e=eL(t,"string");return di(e)=="symbol"?e:e+""}function eL(t,e){if(di(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(di(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Gp=1,tL=function(t){function e(){var n;KN(this,e);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=YN(this,e,[].concat(i)),kl(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),kl(n,"handleKeyDown",function(o){if(o.key==="Escape"){var s,c,u,l;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(c=n.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&s!==void 0?s:0,y:(u=(l=n.props.coordinate)===null||l===void 0?void 0:l.y)!==null&&u!==void 0?u:0}})}}),n}return ZN(e,t),XN(e,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();(Math.abs(r.width-this.state.lastBoundingBox.width)>Gp||Math.abs(r.height-this.state.lastBoundingBox.height)>Gp)&&this.setState({lastBoundingBox:{width:r.width,height:r.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var r,i;this.props.active&&this.updateBBox(),this.state.dismissed&&(((r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==this.state.dismissedAtCoordinate.x||((i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var r=this,i=this.props,a=i.active,o=i.allowEscapeViewBox,s=i.animationDuration,c=i.animationEasing,u=i.children,l=i.coordinate,d=i.hasPayload,f=i.isAnimationActive,h=i.offset,m=i.position,p=i.reverseDirection,v=i.useTranslate3d,b=i.viewBox,k=i.wrapperStyle,T=HN({allowEscapeViewBox:o,coordinate:l,offsetTopLeft:h,position:m,reverseDirection:p,tooltipBox:this.state.lastBoundingBox,useTranslate3d:v,viewBox:b}),S=T.cssClasses,g=T.cssProperties,y=Wp(Wp({transition:f&&a?"transform ".concat(s,"ms ").concat(c):void 0},g),{},{pointerEvents:"none",visibility:!this.state.dismissed&&a&&d?"visible":"hidden",position:"absolute",top:0,left:0},k);return O.createElement("div",{tabIndex:-1,className:S,style:y,ref:function(C){r.wrapperNode=C}},u)}}])}(K.PureComponent),nL=function(){return!(typeof window!="undefined"&&window.document&&window.document.createElement&&window.setTimeout)},tn={isSsr:nL(),get:function(e){return tn[e]},set:function(e,n){if(typeof e=="string")tn[e]=n;else{var r=Object.keys(e);r&&r.length&&r.forEach(function(i){tn[i]=e[i]})}}};function fi(t){"@babel/helpers - typeof";return fi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fi(t)}function Hp(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Kp(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Hp(Object(n),!0).forEach(function(r){bf(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Hp(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function rL(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,s0(r.key),r)}}function iL(t,e,n){return e&&Xp(t.prototype,e),n&&Xp(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function aL(t,e,n){return e=ps(e),oL(t,o0()?Reflect.construct(e,n||[],ps(t).constructor):e.apply(t,n))}function oL(t,e){if(e&&(fi(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sL(t)}function sL(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function o0(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(o0=function(){return!!t})()}function ps(t){return ps=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ps(t)}function cL(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wl(t,e)}function wl(t,e){return wl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},wl(t,e)}function bf(t,e,n){return e=s0(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s0(t){var e=uL(t,"string");return fi(e)=="symbol"?e:e+""}function uL(t,e){if(fi(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(fi(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lL(t){return t.dataKey}function dL(t,e){return O.isValidElement(t)?O.cloneElement(t,e):typeof t=="function"?O.createElement(t,e):O.createElement(FN,e)}var mn=function(t){function e(){return rL(this,e),aL(this,e,arguments)}return cL(e,t),iL(e,[{key:"render",value:function(){var r=this,i=this.props,a=i.active,o=i.allowEscapeViewBox,s=i.animationDuration,c=i.animationEasing,u=i.content,l=i.coordinate,d=i.filterNull,f=i.isAnimationActive,h=i.offset,m=i.payload,p=i.payloadUniqBy,v=i.position,b=i.reverseDirection,k=i.useTranslate3d,T=i.viewBox,S=i.wrapperStyle,g=m!=null?m:[];d&&g.length&&(g=Yb(m.filter(function(w){return w.value!=null&&(w.hide!==!0||r.props.includeHidden)}),p,lL));var y=g.length>0;return O.createElement(tL,{allowEscapeViewBox:o,animationDuration:s,animationEasing:c,isAnimationActive:f,active:a,coordinate:l,hasPayload:y,offset:h,position:v,reverseDirection:b,useTranslate3d:k,viewBox:T,wrapperStyle:S},dL(u,Kp(Kp({},this.props),{},{payload:g})))}}])}(K.PureComponent);bf(mn,"displayName","Tooltip");bf(mn,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!tn.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var fL=dn,hL=function(){return fL.Date.now()},pL=hL,mL=/\s/;function gL(t){for(var e=t.length;e--&&mL.test(t.charAt(e)););return e}var vL=gL,yL=vL,bL=/^\s+/;function SL(t){return t&&t.slice(0,yL(t)+1).replace(bL,"")}var TL=SL,kL=TL,Yp=Zn,wL=Ri,Jp=0/0,CL=/^[-+]0x[0-9a-f]+$/i,_L=/^0b[01]+$/i,xL=/^0o[0-7]+$/i,PL=parseInt;function OL(t){if(typeof t=="number")return t;if(wL(t))return Jp;if(Yp(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Yp(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=kL(t);var n=_L.test(t);return n||xL.test(t)?PL(t.slice(2),n?2:8):CL.test(t)?Jp:+t}var c0=OL,EL=Zn,fu=pL,Qp=c0,AL="Expected a function",IL=Math.max,RL=Math.min;function ML(t,e,n){var r,i,a,o,s,c,u=0,l=!1,d=!1,f=!0;if(typeof t!="function")throw new TypeError(AL);e=Qp(e)||0,EL(n)&&(l=!!n.leading,d="maxWait"in n,a=d?IL(Qp(n.maxWait)||0,e):a,f="trailing"in n?!!n.trailing:f);function h(y){var w=r,C=i;return r=i=void 0,u=y,o=t.apply(C,w),o}function m(y){return u=y,s=setTimeout(b,e),l?h(y):o}function p(y){var w=y-c,C=y-u,_=e-w;return d?RL(_,a-C):_}function v(y){var w=y-c,C=y-u;return c===void 0||w>=e||w<0||d&&C>=a}function b(){var y=fu();if(v(y))return k(y);s=setTimeout(b,p(y))}function k(y){return s=void 0,f&&r?h(y):(r=i=void 0,o)}function T(){s!==void 0&&clearTimeout(s),u=0,r=c=i=s=void 0}function S(){return s===void 0?o:k(fu())}function g(){var y=fu(),w=v(y);if(r=arguments,i=this,c=y,w){if(s===void 0)return m(c);if(d)return clearTimeout(s),s=setTimeout(b,e),h(c)}return s===void 0&&(s=setTimeout(b,e)),o}return g.cancel=T,g.flush=S,g}var DL=ML,NL=DL,LL=Zn,jL="Expected a function";function $L(t,e,n){var r=!0,i=!0;if(typeof t!="function")throw new TypeError(jL);return LL(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),NL(t,e,{leading:r,maxWait:e,trailing:i})}var BL=$L;const u0=_e(BL);function Pa(t){"@babel/helpers - typeof";return Pa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pa(t)}function Zp(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function ko(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Zp(Object(n),!0).forEach(function(r){UL(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zp(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function UL(t,e,n){return e=FL(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FL(t){var e=qL(t,"string");return Pa(e)=="symbol"?e:e+""}function qL(t,e){if(Pa(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Pa(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VL(t,e){return HL(t)||GL(t,e)||zL(t,e)||WL()}function WL(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zL(t,e){if(t){if(typeof t=="string")return em(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return em(t,e)}}function em(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function GL(t,e){var n=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,a,o,s=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(l){u=!0,i=l}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function HL(t){if(Array.isArray(t))return t}var WK=K.forwardRef(function(t,e){var n=t.aspect,r=t.initialDimension,i=r===void 0?{width:-1,height:-1}:r,a=t.width,o=a===void 0?"100%":a,s=t.height,c=s===void 0?"100%":s,u=t.minWidth,l=u===void 0?0:u,d=t.minHeight,f=t.maxHeight,h=t.children,m=t.debounce,p=m===void 0?0:m,v=t.id,b=t.className,k=t.onResize,T=t.style,S=T===void 0?{}:T,g=K.useRef(null),y=K.useRef();y.current=k,K.useImperativeHandle(e,function(){return Object.defineProperty(g.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),g.current},configurable:!0})});var w=K.useState({containerWidth:i.width,containerHeight:i.height}),C=VL(w,2),_=C[0],A=C[1],P=K.useCallback(function(M,N){A(function(D){var $=Math.round(M),F=Math.round(N);return D.containerWidth===$&&D.containerHeight===F?D:{containerWidth:$,containerHeight:F}})},[]);K.useEffect(function(){var M=function(j){var q,J=j[0].contentRect,W=J.width,ee=J.height;P(W,ee),(q=y.current)===null||q===void 0||q.call(y,W,ee)};p>0&&(M=u0(M,p,{trailing:!0,leading:!1}));var N=new ResizeObserver(M),D=g.current.getBoundingClientRect(),$=D.width,F=D.height;return P($,F),N.observe(g.current),function(){N.disconnect()}},[P,p]);var E=K.useMemo(function(){var M=_.containerWidth,N=_.containerHeight;if(M<0||N<0)return null;_n(hr(o)||hr(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,c),_n(!n||n>0,"The aspect(%s) must be greater than zero.",n);var D=hr(o)?M:o,$=hr(c)?N:c;n&&n>0&&(D?$=D/n:$&&(D=$*n),f&&$>f&&($=f)),_n(D>0||$>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,D,$,o,c,l,d,n);var F=!Array.isArray(h)&&Cn(h.type).endsWith("Chart");return O.Children.map(h,function(R){return O.isValidElement(R)?K.cloneElement(R,ko({width:D,height:$},F?{style:ko({height:"100%",width:"100%",maxHeight:$,maxWidth:D},R.props.style)}:{})):R})},[n,h,c,f,d,l,_,o]);return O.createElement("div",{id:v?"".concat(v):void 0,className:he("recharts-responsive-container",b),style:ko(ko({},S),{},{width:o,height:c,minWidth:l,minHeight:d,maxHeight:f}),ref:g},E)}),l0=function(e){return null};l0.displayName="Cell";function Oa(t){"@babel/helpers - typeof";return Oa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oa(t)}function tm(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Cl(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?tm(Object(n),!0).forEach(function(r){KL(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tm(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function KL(t,e,n){return e=XL(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XL(t){var e=YL(t,"string");return Oa(e)=="symbol"?e:e+""}function YL(t,e){if(Oa(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Oa(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $r={widthCache:{},cacheCount:0},JL=2e3,QL={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},nm="recharts_measurement_span";function ZL(t){var e=Cl({},t);return Object.keys(e).forEach(function(n){e[n]||delete e[n]}),e}var pa=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||tn.isSsr)return{width:0,height:0};var r=ZL(n),i=JSON.stringify({text:e,copyStyle:r});if($r.widthCache[i])return $r.widthCache[i];try{var a=document.getElementById(nm);a||(a=document.createElement("span"),a.setAttribute("id",nm),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var o=Cl(Cl({},QL),r);Object.assign(a.style,o),a.textContent="".concat(e);var s=a.getBoundingClientRect(),c={width:s.width,height:s.height};return $r.widthCache[i]=c,++$r.cacheCount>JL&&($r.cacheCount=0,$r.widthCache={}),c}catch(u){return{width:0,height:0}}},ej=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function Ea(t){"@babel/helpers - typeof";return Ea=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ea(t)}function ms(t,e){return ij(t)||rj(t,e)||nj(t,e)||tj()}function tj(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nj(t,e){if(t){if(typeof t=="string")return rm(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rm(t,e)}}function rm(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function rj(t,e){var n=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,a,o,s=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(l){u=!0,i=l}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function ij(t){if(Array.isArray(t))return t}function aj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function im(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,sj(r.key),r)}}function oj(t,e,n){return e&&im(t.prototype,e),n&&im(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function sj(t){var e=cj(t,"string");return Ea(e)=="symbol"?e:e+""}function cj(t,e){if(Ea(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ea(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var am=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,om=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,uj=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,lj=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,d0={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},dj=Object.keys(d0),Gr="NaN";function fj(t,e){return t*d0[e]}var wo=function(){function t(e,n){aj(this,t),this.num=e,this.unit=n,this.num=e,this.unit=n,Number.isNaN(e)&&(this.unit=""),n!==""&&!uj.test(n)&&(this.num=NaN,this.unit=""),dj.includes(n)&&(this.num=fj(e,n),this.unit="px")}return oj(t,[{key:"add",value:function(n){return this.unit!==n.unit?new t(NaN,""):new t(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new t(NaN,""):new t(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new t(NaN,""):new t(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new t(NaN,""):new t(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var r,i=(r=lj.exec(n))!==null&&r!==void 0?r:[],a=ms(i,3),o=a[1],s=a[2];return new t(parseFloat(o),s!=null?s:"")}}])}();function f0(t){if(t.includes(Gr))return Gr;for(var e=t;e.includes("*")||e.includes("/");){var n,r=(n=am.exec(e))!==null&&n!==void 0?n:[],i=ms(r,4),a=i[1],o=i[2],s=i[3],c=wo.parse(a!=null?a:""),u=wo.parse(s!=null?s:""),l=o==="*"?c.multiply(u):c.divide(u);if(l.isNaN())return Gr;e=e.replace(am,l.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var d,f=(d=om.exec(e))!==null&&d!==void 0?d:[],h=ms(f,4),m=h[1],p=h[2],v=h[3],b=wo.parse(m!=null?m:""),k=wo.parse(v!=null?v:""),T=p==="+"?b.add(k):b.subtract(k);if(T.isNaN())return Gr;e=e.replace(om,T.toString())}return e}var sm=/\(([^()]*)\)/;function hj(t){for(var e=t;e.includes("(");){var n=sm.exec(e),r=ms(n,2),i=r[1];e=e.replace(sm,f0(i))}return e}function pj(t){var e=t.replace(/\s+/g,"");return e=hj(e),e=f0(e),e}function mj(t){try{return pj(t)}catch(e){return Gr}}function hu(t){var e=mj(t.slice(5,-1));return e===Gr?"":e}var gj=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],vj=["dx","dy","angle","className","breakAll"];function _l(){return _l=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_l.apply(this,arguments)}function cm(t,e){if(t==null)return{};var n=yj(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function yj(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function um(t,e){return kj(t)||Tj(t,e)||Sj(t,e)||bj()}function bj(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sj(t,e){if(t){if(typeof t=="string")return lm(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lm(t,e)}}function lm(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Tj(t,e){var n=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,a,o,s=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(l){u=!0,i=l}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function kj(t){if(Array.isArray(t))return t}var h0=/[ \f\n\r\t\v\u2028\u2029]+/,p0=function(e){var n=e.children,r=e.breakAll,i=e.style;try{var a=[];ce(n)||(r?a=n.toString().split(""):a=n.toString().split(h0));var o=a.map(function(c){return{word:c,width:pa(c,i).width}}),s=r?0:pa("",i).width;return{wordsWithComputedWidth:o,spaceWidth:s}}catch(c){return null}},wj=function(e,n,r,i,a){var o=e.maxLines,s=e.children,c=e.style,u=e.breakAll,l=H(o),d=s,f=function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return D.reduce(function($,F){var R=F.word,j=F.width,q=$[$.length-1];if(q&&(i==null||a||q.width+j+r<Number(i)))q.words.push(R),q.width+=j+r;else{var J={words:[R],width:j};$.push(J)}return $},[])},h=f(n),m=function(D){return D.reduce(function($,F){return $.width>F.width?$:F})};if(!l)return h;for(var p="",v=function(D){var $=d.slice(0,D),F=p0({breakAll:u,style:c,children:$+p}).wordsWithComputedWidth,R=f(F),j=R.length>o||m(R).width>Number(i);return[j,R]},b=0,k=d.length-1,T=0,S;b<=k&&T<=d.length-1;){var g=Math.floor((b+k)/2),y=g-1,w=v(y),C=um(w,2),_=C[0],A=C[1],P=v(g),E=um(P,1),M=E[0];if(!_&&!M&&(b=g+1),_&&M&&(k=g-1),!_&&M){S=A;break}T++}return S||h},dm=function(e){var n=ce(e)?[]:e.toString().split(h0);return[{words:n}]},Cj=function(e){var n=e.width,r=e.scaleToFit,i=e.children,a=e.style,o=e.breakAll,s=e.maxLines;if((n||r)&&!tn.isSsr){var c,u,l=p0({breakAll:o,children:i,style:a});if(l){var d=l.wordsWithComputedWidth,f=l.spaceWidth;c=d,u=f}else return dm(i);return wj({breakAll:o,children:i,maxLines:s,style:a},c,u,n,r)}return dm(i)},fm="#808080",gs=function(e){var n=e.x,r=n===void 0?0:n,i=e.y,a=i===void 0?0:i,o=e.lineHeight,s=o===void 0?"1em":o,c=e.capHeight,u=c===void 0?"0.71em":c,l=e.scaleToFit,d=l===void 0?!1:l,f=e.textAnchor,h=f===void 0?"start":f,m=e.verticalAnchor,p=m===void 0?"end":m,v=e.fill,b=v===void 0?fm:v,k=cm(e,gj),T=K.useMemo(function(){return Cj({breakAll:k.breakAll,children:k.children,maxLines:k.maxLines,scaleToFit:d,style:k.style,width:k.width})},[k.breakAll,k.children,k.maxLines,d,k.style,k.width]),S=k.dx,g=k.dy,y=k.angle,w=k.className,C=k.breakAll,_=cm(k,vj);if(!Ke(r)||!Ke(a))return null;var A=r+(H(S)?S:0),P=a+(H(g)?g:0),E;switch(p){case"start":E=hu("calc(".concat(u,")"));break;case"middle":E=hu("calc(".concat((T.length-1)/2," * -").concat(s," + (").concat(u," / 2))"));break;default:E=hu("calc(".concat(T.length-1," * -").concat(s,")"));break}var M=[];if(d){var N=T[0].width,D=k.width;M.push("scale(".concat((H(D)?D/N:1)/N,")"))}return y&&M.push("rotate(".concat(y,", ").concat(A,", ").concat(P,")")),M.length&&(_.transform=M.join(" ")),O.createElement("text",_l({},ie(_,!0),{x:A,y:P,className:he("recharts-text",w),textAnchor:h,fill:b.includes("url")?fm:b}),T.map(function($,F){var R=$.words.join(C?"":" ");return O.createElement("tspan",{x:A,dy:F===0?E:s,key:"".concat(R,"-").concat(F)},R)}))};function Hn(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function _j(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Sf(t){let e,n,r;t.length!==2?(e=Hn,n=(s,c)=>Hn(t(s),c),r=(s,c)=>t(s)-c):(e=t===Hn||t===_j?t:xj,n=t,r=t);function i(s,c,u=0,l=s.length){if(u<l){if(e(c,c)!==0)return l;do{const d=u+l>>>1;n(s[d],c)<0?u=d+1:l=d}while(u<l)}return u}function a(s,c,u=0,l=s.length){if(u<l){if(e(c,c)!==0)return l;do{const d=u+l>>>1;n(s[d],c)<=0?u=d+1:l=d}while(u<l)}return u}function o(s,c,u=0,l=s.length){const d=i(s,c,u,l-1);return d>u&&r(s[d-1],c)>-r(s[d],c)?d-1:d}return{left:i,center:o,right:a}}function xj(){return 0}function m0(t){return t===null?NaN:+t}function*Pj(t,e){if(e===void 0)for(let n of t)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)(r=e(r,++n,t))!=null&&(r=+r)>=r&&(yield r)}}const Oj=Sf(Hn),Ej=Oj.right;Sf(m0).center;const uo=Ej;class hm extends Map{constructor(e,n=Rj){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(pm(this,e))}has(e){return super.has(pm(this,e))}set(e,n){return super.set(Aj(this,e),n)}delete(e){return super.delete(Ij(this,e))}}function pm({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Aj({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Ij({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function Rj(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Mj(t=Hn){if(t===Hn)return g0;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||r===0?r:(t(n,n)===0)-(t(e,e)===0)}}function g0(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const Dj=Math.sqrt(50),Nj=Math.sqrt(10),Lj=Math.sqrt(2);function vs(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=Dj?10:a>=Nj?5:a>=Lj?2:1;let s,c,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),c=Math.round(e*u),s/u<t&&++s,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),c=Math.round(e/u),s*u<t&&++s,c*u>e&&--c),c<s&&.5<=n&&n<2?vs(t,e,n*2):[s,c,u]}function xl(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,a,o]=r?vs(e,t,n):vs(t,e,n);if(!(a>=i))return[];const s=a-i+1,c=new Array(s);if(r)if(o<0)for(let u=0;u<s;++u)c[u]=(a-u)/-o;else for(let u=0;u<s;++u)c[u]=(a-u)*o;else if(o<0)for(let u=0;u<s;++u)c[u]=(i+u)/-o;else for(let u=0;u<s;++u)c[u]=(i+u)*o;return c}function Pl(t,e,n){return e=+e,t=+t,n=+n,vs(t,e,n)[2]}function Ol(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?Pl(e,t,n):Pl(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function mm(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function gm(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function v0(t,e,n=0,r=1/0,i){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(i=i===void 0?g0:Mj(i);r>n;){if(r-n>600){const c=r-n+1,u=e-n+1,l=Math.log(c),d=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*d*(c-d)/c)*(u-c/2<0?-1:1),h=Math.max(n,Math.floor(e-u*d/c+f)),m=Math.min(r,Math.floor(e+(c-u)*d/c+f));v0(t,e,h,m,i)}const a=t[e];let o=n,s=r;for(Yi(t,n,e),i(t[r],a)>0&&Yi(t,n,r);o<s;){for(Yi(t,o,s),++o,--s;i(t[o],a)<0;)++o;for(;i(t[s],a)>0;)--s}i(t[n],a)===0?Yi(t,n,s):(++s,Yi(t,s,r)),s<=e&&(n=s+1),e<=s&&(r=s-1)}return t}function Yi(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function jj(t,e,n){if(t=Float64Array.from(Pj(t,n)),!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return gm(t);if(e>=1)return mm(t);var r,i=(r-1)*e,a=Math.floor(i),o=mm(v0(t,a).subarray(0,a+1)),s=gm(t.subarray(a+1));return o+(s-o)*(i-a)}}function $j(t,e,n=m0){if(!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t),s=+n(t[a+1],a+1,t);return o+(s-o)*(i-a)}}function Bj(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(i);++r<i;)a[r]=t+r*n;return a}function jt(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Dn(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const El=Symbol("implicit");function Tf(){var t=new hm,e=[],n=[],r=El;function i(a){let o=t.get(a);if(o===void 0){if(r!==El)return r;t.set(a,o=e.push(a)-1)}return n[o%n.length]}return i.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new hm;for(const o of a)t.has(o)||t.set(o,e.push(o)-1);return i},i.range=function(a){return arguments.length?(n=Array.from(a),i):n.slice()},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return Tf(e,n).unknown(r)},jt.apply(i,arguments),i}function Aa(){var t=Tf().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,a,o,s=!1,c=0,u=0,l=.5;delete t.unknown;function d(){var f=e().length,h=i<r,m=h?i:r,p=h?r:i;a=(p-m)/Math.max(1,f-c+u*2),s&&(a=Math.floor(a)),m+=(p-m-a*(f-c))*l,o=a*(1-c),s&&(m=Math.round(m),o=Math.round(o));var v=Bj(f).map(function(b){return m+a*b});return n(h?v.reverse():v)}return t.domain=function(f){return arguments.length?(e(f),d()):e()},t.range=function(f){return arguments.length?([r,i]=f,r=+r,i=+i,d()):[r,i]},t.rangeRound=function(f){return[r,i]=f,r=+r,i=+i,s=!0,d()},t.bandwidth=function(){return o},t.step=function(){return a},t.round=function(f){return arguments.length?(s=!!f,d()):s},t.padding=function(f){return arguments.length?(c=Math.min(1,u=+f),d()):c},t.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),d()):c},t.paddingOuter=function(f){return arguments.length?(u=+f,d()):u},t.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),d()):l},t.copy=function(){return Aa(e(),[r,i]).round(s).paddingInner(c).paddingOuter(u).align(l)},jt.apply(d(),arguments)}function y0(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return y0(e())},t}function ma(){return y0(Aa.apply(null,arguments).paddingInner(1))}function kf(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function b0(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function lo(){}var Ia=.7,ys=1/Ia,ei="\\s*([+-]?\\d+)\\s*",Ra="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",nn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Uj=/^#([0-9a-f]{3,8})$/,Fj=new RegExp(`^rgb\\(${ei},${ei},${ei}\\)$`),qj=new RegExp(`^rgb\\(${nn},${nn},${nn}\\)$`),Vj=new RegExp(`^rgba\\(${ei},${ei},${ei},${Ra}\\)$`),Wj=new RegExp(`^rgba\\(${nn},${nn},${nn},${Ra}\\)$`),zj=new RegExp(`^hsl\\(${Ra},${nn},${nn}\\)$`),Gj=new RegExp(`^hsla\\(${Ra},${nn},${nn},${Ra}\\)$`),vm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};kf(lo,Ma,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:ym,formatHex:ym,formatHex8:Hj,formatHsl:Kj,formatRgb:bm,toString:bm});function ym(){return this.rgb().formatHex()}function Hj(){return this.rgb().formatHex8()}function Kj(){return S0(this).formatHsl()}function bm(){return this.rgb().formatRgb()}function Ma(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Uj.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Sm(e):n===3?new pt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Co(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Co(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Fj.exec(t))?new pt(e[1],e[2],e[3],1):(e=qj.exec(t))?new pt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Vj.exec(t))?Co(e[1],e[2],e[3],e[4]):(e=Wj.exec(t))?Co(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=zj.exec(t))?wm(e[1],e[2]/100,e[3]/100,1):(e=Gj.exec(t))?wm(e[1],e[2]/100,e[3]/100,e[4]):vm.hasOwnProperty(t)?Sm(vm[t]):t==="transparent"?new pt(NaN,NaN,NaN,0):null}function Sm(t){return new pt(t>>16&255,t>>8&255,t&255,1)}function Co(t,e,n,r){return r<=0&&(t=e=n=NaN),new pt(t,e,n,r)}function Xj(t){return t instanceof lo||(t=Ma(t)),t?(t=t.rgb(),new pt(t.r,t.g,t.b,t.opacity)):new pt}function Al(t,e,n,r){return arguments.length===1?Xj(t):new pt(t,e,n,r==null?1:r)}function pt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}kf(pt,Al,b0(lo,{brighter(t){return t=t==null?ys:Math.pow(ys,t),new pt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Ia:Math.pow(Ia,t),new pt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new pt(yr(this.r),yr(this.g),yr(this.b),bs(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Tm,formatHex:Tm,formatHex8:Yj,formatRgb:km,toString:km}));function Tm(){return`#${pr(this.r)}${pr(this.g)}${pr(this.b)}`}function Yj(){return`#${pr(this.r)}${pr(this.g)}${pr(this.b)}${pr((isNaN(this.opacity)?1:this.opacity)*255)}`}function km(){const t=bs(this.opacity);return`${t===1?"rgb(":"rgba("}${yr(this.r)}, ${yr(this.g)}, ${yr(this.b)}${t===1?")":`, ${t})`}`}function bs(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function yr(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function pr(t){return t=yr(t),(t<16?"0":"")+t.toString(16)}function wm(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Vt(t,e,n,r)}function S0(t){if(t instanceof Vt)return new Vt(t.h,t.s,t.l,t.opacity);if(t instanceof lo||(t=Ma(t)),!t)return new Vt;if(t instanceof Vt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(e===a?o=(n-r)/s+(n<r)*6:n===a?o=(r-e)/s+2:o=(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new Vt(o,s,c,t.opacity)}function Jj(t,e,n,r){return arguments.length===1?S0(t):new Vt(t,e,n,r==null?1:r)}function Vt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}kf(Vt,Jj,b0(lo,{brighter(t){return t=t==null?ys:Math.pow(ys,t),new Vt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Ia:Math.pow(Ia,t),new Vt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new pt(pu(t>=240?t-240:t+120,i,r),pu(t,i,r),pu(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Vt(Cm(this.h),_o(this.s),_o(this.l),bs(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=bs(this.opacity);return`${t===1?"hsl(":"hsla("}${Cm(this.h)}, ${_o(this.s)*100}%, ${_o(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Cm(t){return t=(t||0)%360,t<0?t+360:t}function _o(t){return Math.max(0,Math.min(1,t||0))}function pu(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const wf=t=>()=>t;function Qj(t,e){return function(n){return t+n*e}}function Zj(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function e$(t){return(t=+t)==1?T0:function(e,n){return n-e?Zj(e,n,t):wf(isNaN(e)?n:e)}}function T0(t,e){var n=e-t;return n?Qj(t,n):wf(isNaN(t)?e:t)}const _m=function t(e){var n=e$(e);function r(i,a){var o=n((i=Al(i)).r,(a=Al(a)).r),s=n(i.g,a.g),c=n(i.b,a.b),u=T0(i.opacity,a.opacity);return function(l){return i.r=o(l),i.g=s(l),i.b=c(l),i.opacity=u(l),i+""}}return r.gamma=t,r}(1);function t$(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=t[i]*(1-a)+e[i]*a;return r}}function n$(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function r$(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=qi(t[o],e[o]);for(;o<n;++o)a[o]=e[o];return function(s){for(o=0;o<r;++o)a[o]=i[o](s);return a}}function i$(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Ss(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function a$(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=qi(t[i],e[i]):r[i]=e[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var Il=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,mu=new RegExp(Il.source,"g");function o$(t){return function(){return t}}function s$(t){return function(e){return t(e)+""}}function c$(t,e){var n=Il.lastIndex=mu.lastIndex=0,r,i,a,o=-1,s=[],c=[];for(t=t+"",e=e+"";(r=Il.exec(t))&&(i=mu.exec(e));)(a=i.index)>n&&(a=e.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,c.push({i:o,x:Ss(r,i)})),n=mu.lastIndex;return n<e.length&&(a=e.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?c[0]?s$(c[0].x):o$(e):(e=c.length,function(u){for(var l=0,d;l<e;++l)s[(d=c[l]).i]=d.x(u);return s.join("")})}function qi(t,e){var n=typeof e,r;return e==null||n==="boolean"?wf(e):(n==="number"?Ss:n==="string"?(r=Ma(e))?(e=r,_m):c$:e instanceof Ma?_m:e instanceof Date?i$:n$(e)?t$:Array.isArray(e)?r$:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?a$:Ss)(t,e)}function Cf(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function u$(t,e){e===void 0&&(e=t,t=qi);for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(o){var s=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return a[s](o-s)}}function l$(t){return function(){return t}}function Ts(t){return+t}var xm=[0,1];function ct(t){return t}function Rl(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:l$(isNaN(e)?NaN:.5)}function d$(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function f$(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=Rl(i,r),a=n(o,a)):(r=Rl(r,i),a=n(a,o)),function(s){return a(r(s))}}function h$(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=Rl(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(s){var c=uo(t,s,1,r)-1;return a[c](i[c](s))}}function fo(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Cc(){var t=xm,e=xm,n=qi,r,i,a,o=ct,s,c,u;function l(){var f=Math.min(t.length,e.length);return o!==ct&&(o=d$(t[0],t[f-1])),s=f>2?h$:f$,c=u=null,d}function d(f){return f==null||isNaN(f=+f)?a:(c||(c=s(t.map(r),e,n)))(r(o(f)))}return d.invert=function(f){return o(i((u||(u=s(e,t.map(r),Ss)))(f)))},d.domain=function(f){return arguments.length?(t=Array.from(f,Ts),l()):t.slice()},d.range=function(f){return arguments.length?(e=Array.from(f),l()):e.slice()},d.rangeRound=function(f){return e=Array.from(f),n=Cf,l()},d.clamp=function(f){return arguments.length?(o=f?!0:ct,l()):o!==ct},d.interpolate=function(f){return arguments.length?(n=f,l()):n},d.unknown=function(f){return arguments.length?(a=f,d):a},function(f,h){return r=f,i=h,l()}}function _f(){return Cc()(ct,ct)}function p$(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function ks(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function hi(t){return t=ks(Math.abs(t)),t?t[1]:NaN}function m$(t,e){return function(n,r){for(var i=n.length,a=[],o=0,s=t[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(n.substring(i-=s,i+s)),!((c+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(e)}}function g$(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var v$=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Da(t){if(!(e=v$.exec(t)))throw new Error("invalid format: "+t);var e;return new xf({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Da.prototype=xf.prototype;function xf(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}xf.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function y$(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var k0;function b$(t,e){var n=ks(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(k0=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+ks(t,Math.max(0,e+a-1))[0]}function Pm(t,e){var n=ks(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Om={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:p$,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Pm(t*100,e),r:Pm,s:b$,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Em(t){return t}var Am=Array.prototype.map,Im=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function S$(t){var e=t.grouping===void 0||t.thousands===void 0?Em:m$(Am.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?Em:g$(Am.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(d){d=Da(d);var f=d.fill,h=d.align,m=d.sign,p=d.symbol,v=d.zero,b=d.width,k=d.comma,T=d.precision,S=d.trim,g=d.type;g==="n"?(k=!0,g="g"):Om[g]||(T===void 0&&(T=12),S=!0,g="g"),(v||f==="0"&&h==="=")&&(v=!0,f="0",h="=");var y=p==="$"?n:p==="#"&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",w=p==="$"?r:/[%p]/.test(g)?o:"",C=Om[g],_=/[defgprs%]/.test(g);T=T===void 0?6:/[gprs]/.test(g)?Math.max(1,Math.min(21,T)):Math.max(0,Math.min(20,T));function A(P){var E=y,M=w,N,D,$;if(g==="c")M=C(P)+M,P="";else{P=+P;var F=P<0||1/P<0;if(P=isNaN(P)?c:C(Math.abs(P),T),S&&(P=y$(P)),F&&+P==0&&m!=="+"&&(F=!1),E=(F?m==="("?m:s:m==="-"||m==="("?"":m)+E,M=(g==="s"?Im[8+k0/3]:"")+M+(F&&m==="("?")":""),_){for(N=-1,D=P.length;++N<D;)if($=P.charCodeAt(N),48>$||$>57){M=($===46?i+P.slice(N+1):P.slice(N))+M,P=P.slice(0,N);break}}}k&&!v&&(P=e(P,1/0));var R=E.length+P.length+M.length,j=R<b?new Array(b-R+1).join(f):"";switch(k&&v&&(P=e(j+P,j.length?b-M.length:1/0),j=""),h){case"<":P=E+P+M+j;break;case"=":P=E+j+P+M;break;case"^":P=j.slice(0,R=j.length>>1)+E+P+M+j.slice(R);break;default:P=j+E+P+M;break}return a(P)}return A.toString=function(){return d+""},A}function l(d,f){var h=u((d=Da(d),d.type="f",d)),m=Math.max(-8,Math.min(8,Math.floor(hi(f)/3)))*3,p=Math.pow(10,-m),v=Im[8+m/3];return function(b){return h(p*b)+v}}return{format:u,formatPrefix:l}}var xo,Pf,w0;T$({thousands:",",grouping:[3],currency:["$",""]});function T$(t){return xo=S$(t),Pf=xo.format,w0=xo.formatPrefix,xo}function k$(t){return Math.max(0,-hi(Math.abs(t)))}function w$(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(hi(e)/3)))*3-hi(Math.abs(t)))}function C$(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,hi(e)-hi(t))+1}function C0(t,e,n,r){var i=Ol(t,e,n),a;switch(r=Da(r==null?",f":r),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(a=w$(i,o))&&(r.precision=a),w0(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=C$(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=k$(i))&&(r.precision=a-(r.type==="%")*2);break}}return Pf(r)}function tr(t){var e=t.domain;return t.ticks=function(n){var r=e();return xl(r[0],r[r.length-1],n==null?10:n)},t.tickFormat=function(n,r){var i=e();return C0(i[0],i[i.length-1],n==null?10:n,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,a=r.length-1,o=r[i],s=r[a],c,u,l=10;for(s<o&&(u=o,o=s,s=u,u=i,i=a,a=u);l-- >0;){if(u=Pl(o,s,n),u===c)return r[i]=o,r[a]=s,e(r);if(u>0)o=Math.floor(o/u)*u,s=Math.ceil(s/u)*u;else if(u<0)o=Math.ceil(o*u)/u,s=Math.floor(s*u)/u;else break;c=u}return t},t}function ws(){var t=_f();return t.copy=function(){return fo(t,ws())},jt.apply(t,arguments),tr(t)}function _0(t){var e;function n(r){return r==null||isNaN(r=+r)?e:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(t=Array.from(r,Ts),n):t.slice()},n.unknown=function(r){return arguments.length?(e=r,n):e},n.copy=function(){return _0(t).unknown(e)},t=arguments.length?Array.from(t,Ts):[0,1],tr(n)}function x0(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],a=t[r],o;return a<i&&(o=n,n=r,r=o,o=i,i=a,a=o),t[n]=e.floor(i),t[r]=e.ceil(a),t}function Rm(t){return Math.log(t)}function Mm(t){return Math.exp(t)}function _$(t){return-Math.log(-t)}function x$(t){return-Math.exp(-t)}function P$(t){return isFinite(t)?+("1e"+t):t<0?0:t}function O$(t){return t===10?P$:t===Math.E?Math.exp:e=>Math.pow(t,e)}function E$(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function Dm(t){return(e,n)=>-t(-e,n)}function Of(t){const e=t(Rm,Mm),n=e.domain;let r=10,i,a;function o(){return i=E$(r),a=O$(r),n()[0]<0?(i=Dm(i),a=Dm(a),t(_$,x$)):t(Rm,Mm),e}return e.base=function(s){return arguments.length?(r=+s,o()):r},e.domain=function(s){return arguments.length?(n(s),o()):n()},e.ticks=s=>{const c=n();let u=c[0],l=c[c.length-1];const d=l<u;d&&([u,l]=[l,u]);let f=i(u),h=i(l),m,p;const v=s==null?10:+s;let b=[];if(!(r%1)&&h-f<v){if(f=Math.floor(f),h=Math.ceil(h),u>0){for(;f<=h;++f)for(m=1;m<r;++m)if(p=f<0?m/a(-f):m*a(f),!(p<u)){if(p>l)break;b.push(p)}}else for(;f<=h;++f)for(m=r-1;m>=1;--m)if(p=f>0?m/a(-f):m*a(f),!(p<u)){if(p>l)break;b.push(p)}b.length*2<v&&(b=xl(u,l,v))}else b=xl(f,h,Math.min(h-f,v)).map(a);return d?b.reverse():b},e.tickFormat=(s,c)=>{if(s==null&&(s=10),c==null&&(c=r===10?"s":","),typeof c!="function"&&(!(r%1)&&(c=Da(c)).precision==null&&(c.trim=!0),c=Pf(c)),s===1/0)return c;const u=Math.max(1,r*s/e.ticks().length);return l=>{let d=l/a(Math.round(i(l)));return d*r<r-.5&&(d*=r),d<=u?c(l):""}},e.nice=()=>n(x0(n(),{floor:s=>a(Math.floor(i(s))),ceil:s=>a(Math.ceil(i(s)))})),e}function P0(){const t=Of(Cc()).domain([1,10]);return t.copy=()=>fo(t,P0()).base(t.base()),jt.apply(t,arguments),t}function Nm(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Lm(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Ef(t){var e=1,n=t(Nm(e),Lm(e));return n.constant=function(r){return arguments.length?t(Nm(e=+r),Lm(e)):e},tr(n)}function O0(){var t=Ef(Cc());return t.copy=function(){return fo(t,O0()).constant(t.constant())},jt.apply(t,arguments)}function jm(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function A$(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function I$(t){return t<0?-t*t:t*t}function Af(t){var e=t(ct,ct),n=1;function r(){return n===1?t(ct,ct):n===.5?t(A$,I$):t(jm(n),jm(1/n))}return e.exponent=function(i){return arguments.length?(n=+i,r()):n},tr(e)}function If(){var t=Af(Cc());return t.copy=function(){return fo(t,If()).exponent(t.exponent())},jt.apply(t,arguments),t}function R$(){return If.apply(null,arguments).exponent(.5)}function $m(t){return Math.sign(t)*t*t}function M$(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function E0(){var t=_f(),e=[0,1],n=!1,r;function i(a){var o=M$(t(a));return isNaN(o)?r:n?Math.round(o):o}return i.invert=function(a){return t.invert($m(a))},i.domain=function(a){return arguments.length?(t.domain(a),i):t.domain()},i.range=function(a){return arguments.length?(t.range((e=Array.from(a,Ts)).map($m)),i):e.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(n=!!a,i):n},i.clamp=function(a){return arguments.length?(t.clamp(a),i):t.clamp()},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return E0(t.domain(),e).round(n).clamp(t.clamp()).unknown(r)},jt.apply(i,arguments),tr(i)}function A0(){var t=[],e=[],n=[],r;function i(){var o=0,s=Math.max(1,e.length);for(n=new Array(s-1);++o<s;)n[o-1]=$j(t,o/s);return a}function a(o){return o==null||isNaN(o=+o)?r:e[uo(n,o)]}return a.invertExtent=function(o){var s=e.indexOf(o);return s<0?[NaN,NaN]:[s>0?n[s-1]:t[0],s<n.length?n[s]:t[t.length-1]]},a.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let s of o)s!=null&&!isNaN(s=+s)&&t.push(s);return t.sort(Hn),i()},a.range=function(o){return arguments.length?(e=Array.from(o),i()):e.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.quantiles=function(){return n.slice()},a.copy=function(){return A0().domain(t).range(e).unknown(r)},jt.apply(a,arguments)}function I0(){var t=0,e=1,n=1,r=[.5],i=[0,1],a;function o(c){return c!=null&&c<=c?i[uo(r,c,0,n)]:a}function s(){var c=-1;for(r=new Array(n);++c<n;)r[c]=((c+1)*e-(c-n)*t)/(n+1);return o}return o.domain=function(c){return arguments.length?([t,e]=c,t=+t,e=+e,s()):[t,e]},o.range=function(c){return arguments.length?(n=(i=Array.from(c)).length-1,s()):i.slice()},o.invertExtent=function(c){var u=i.indexOf(c);return u<0?[NaN,NaN]:u<1?[t,r[0]]:u>=n?[r[n-1],e]:[r[u-1],r[u]]},o.unknown=function(c){return arguments.length&&(a=c),o},o.thresholds=function(){return r.slice()},o.copy=function(){return I0().domain([t,e]).range(i).unknown(a)},jt.apply(tr(o),arguments)}function R0(){var t=[.5],e=[0,1],n,r=1;function i(a){return a!=null&&a<=a?e[uo(t,a,0,r)]:n}return i.domain=function(a){return arguments.length?(t=Array.from(a),r=Math.min(t.length,e.length-1),i):t.slice()},i.range=function(a){return arguments.length?(e=Array.from(a),r=Math.min(t.length,e.length-1),i):e.slice()},i.invertExtent=function(a){var o=e.indexOf(a);return[t[o-1],t[o]]},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return R0().domain(t).range(e).unknown(n)},jt.apply(i,arguments)}const gu=new Date,vu=new Date;function Xe(t,e,n,r){function i(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(t(a=new Date(+a)),a),i.ceil=a=>(t(a=new Date(a-1)),e(a,1),t(a),a),i.round=a=>{const o=i(a),s=i.ceil(a);return a-o<s-a?o:s},i.offset=(a,o)=>(e(a=new Date(+a),o==null?1:Math.floor(o)),a),i.range=(a,o,s)=>{const c=[];if(a=i.ceil(a),s=s==null?1:Math.floor(s),!(a<o)||!(s>0))return c;let u;do c.push(u=new Date(+a)),e(a,s),t(a);while(u<a&&a<o);return c},i.filter=a=>Xe(o=>{if(o>=o)for(;t(o),!a(o);)o.setTime(o-1)},(o,s)=>{if(o>=o)if(s<0)for(;++s<=0;)for(;e(o,-1),!a(o););else for(;--s>=0;)for(;e(o,1),!a(o););}),n&&(i.count=(a,o)=>(gu.setTime(+a),vu.setTime(+o),t(gu),t(vu),Math.floor(n(gu,vu))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(r?o=>r(o)%a===0:o=>i.count(0,o)%a===0):i)),i}const Cs=Xe(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Cs.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Xe(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):Cs);Cs.range;const Tn=1e3,Rt=Tn*60,kn=Rt*60,On=kn*24,Rf=On*7,Bm=On*30,yu=On*365,mr=Xe(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Tn)},(t,e)=>(e-t)/Tn,t=>t.getUTCSeconds());mr.range;const Mf=Xe(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Tn)},(t,e)=>{t.setTime(+t+e*Rt)},(t,e)=>(e-t)/Rt,t=>t.getMinutes());Mf.range;const Df=Xe(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Rt)},(t,e)=>(e-t)/Rt,t=>t.getUTCMinutes());Df.range;const Nf=Xe(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Tn-t.getMinutes()*Rt)},(t,e)=>{t.setTime(+t+e*kn)},(t,e)=>(e-t)/kn,t=>t.getHours());Nf.range;const Lf=Xe(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*kn)},(t,e)=>(e-t)/kn,t=>t.getUTCHours());Lf.range;const ho=Xe(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Rt)/On,t=>t.getDate()-1);ho.range;const _c=Xe(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/On,t=>t.getUTCDate()-1);_c.range;const M0=Xe(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/On,t=>Math.floor(t/On));M0.range;function Rr(t){return Xe(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*Rt)/Rf)}const xc=Rr(0),_s=Rr(1),D$=Rr(2),N$=Rr(3),pi=Rr(4),L$=Rr(5),j$=Rr(6);xc.range;_s.range;D$.range;N$.range;pi.range;L$.range;j$.range;function Mr(t){return Xe(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/Rf)}const Pc=Mr(0),xs=Mr(1),$$=Mr(2),B$=Mr(3),mi=Mr(4),U$=Mr(5),F$=Mr(6);Pc.range;xs.range;$$.range;B$.range;mi.range;U$.range;F$.range;const jf=Xe(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());jf.range;const $f=Xe(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());$f.range;const En=Xe(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());En.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Xe(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});En.range;const An=Xe(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());An.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Xe(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});An.range;function D0(t,e,n,r,i,a){const o=[[mr,1,Tn],[mr,5,5*Tn],[mr,15,15*Tn],[mr,30,30*Tn],[a,1,Rt],[a,5,5*Rt],[a,15,15*Rt],[a,30,30*Rt],[i,1,kn],[i,3,3*kn],[i,6,6*kn],[i,12,12*kn],[r,1,On],[r,2,2*On],[n,1,Rf],[e,1,Bm],[e,3,3*Bm],[t,1,yu]];function s(u,l,d){const f=l<u;f&&([u,l]=[l,u]);const h=d&&typeof d.range=="function"?d:c(u,l,d),m=h?h.range(u,+l+1):[];return f?m.reverse():m}function c(u,l,d){const f=Math.abs(l-u)/d,h=Sf(([,,v])=>v).right(o,f);if(h===o.length)return t.every(Ol(u/yu,l/yu,d));if(h===0)return Cs.every(Math.max(Ol(u,l,d),1));const[m,p]=o[f/o[h-1][2]<o[h][2]/f?h-1:h];return m.every(p)}return[s,c]}const[q$,V$]=D0(An,$f,Pc,M0,Lf,Df),[W$,z$]=D0(En,jf,xc,ho,Nf,Mf);function bu(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Su(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Ji(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function G$(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,s=t.months,c=t.shortMonths,u=Qi(i),l=Zi(i),d=Qi(a),f=Zi(a),h=Qi(o),m=Zi(o),p=Qi(s),v=Zi(s),b=Qi(c),k=Zi(c),T={a:F,A:R,b:j,B:q,c:null,d:zm,e:zm,f:m2,g:_2,G:P2,H:f2,I:h2,j:p2,L:N0,m:g2,M:v2,p:J,q:W,Q:Km,s:Xm,S:y2,u:b2,U:S2,V:T2,w:k2,W:w2,x:null,X:null,y:C2,Y:x2,Z:O2,"%":Hm},S={a:ee,A:de,b:Se,B:xe,c:null,d:Gm,e:Gm,f:R2,g:q2,G:W2,H:E2,I:A2,j:I2,L:j0,m:M2,M:D2,p:_t,q:dt,Q:Km,s:Xm,S:N2,u:L2,U:j2,V:$2,w:B2,W:U2,x:null,X:null,y:F2,Y:V2,Z:z2,"%":Hm},g={a:A,A:P,b:E,B:M,c:N,d:Vm,e:Vm,f:c2,g:qm,G:Fm,H:Wm,I:Wm,j:i2,L:s2,m:r2,M:a2,p:_,q:n2,Q:l2,s:d2,S:o2,u:J$,U:Q$,V:Z$,w:Y$,W:e2,x:D,X:$,y:qm,Y:Fm,Z:t2,"%":u2};T.x=y(n,T),T.X=y(r,T),T.c=y(e,T),S.x=y(n,S),S.X=y(r,S),S.c=y(e,S);function y(Q,re){return function(oe){var V=[],Re=-1,me=0,qe=Q.length,Ve,ft,Ln;for(oe instanceof Date||(oe=new Date(+oe));++Re<qe;)Q.charCodeAt(Re)===37&&(V.push(Q.slice(me,Re)),(ft=Um[Ve=Q.charAt(++Re)])!=null?Ve=Q.charAt(++Re):ft=Ve==="e"?" ":"0",(Ln=re[Ve])&&(Ve=Ln(oe,ft)),V.push(Ve),me=Re+1);return V.push(Q.slice(me,Re)),V.join("")}}function w(Q,re){return function(oe){var V=Ji(1900,void 0,1),Re=C(V,Q,oe+="",0),me,qe;if(Re!=oe.length)return null;if("Q"in V)return new Date(V.Q);if("s"in V)return new Date(V.s*1e3+("L"in V?V.L:0));if(re&&!("Z"in V)&&(V.Z=0),"p"in V&&(V.H=V.H%12+V.p*12),V.m===void 0&&(V.m="q"in V?V.q:0),"V"in V){if(V.V<1||V.V>53)return null;"w"in V||(V.w=1),"Z"in V?(me=Su(Ji(V.y,0,1)),qe=me.getUTCDay(),me=qe>4||qe===0?xs.ceil(me):xs(me),me=_c.offset(me,(V.V-1)*7),V.y=me.getUTCFullYear(),V.m=me.getUTCMonth(),V.d=me.getUTCDate()+(V.w+6)%7):(me=bu(Ji(V.y,0,1)),qe=me.getDay(),me=qe>4||qe===0?_s.ceil(me):_s(me),me=ho.offset(me,(V.V-1)*7),V.y=me.getFullYear(),V.m=me.getMonth(),V.d=me.getDate()+(V.w+6)%7)}else("W"in V||"U"in V)&&("w"in V||(V.w="u"in V?V.u%7:"W"in V?1:0),qe="Z"in V?Su(Ji(V.y,0,1)).getUTCDay():bu(Ji(V.y,0,1)).getDay(),V.m=0,V.d="W"in V?(V.w+6)%7+V.W*7-(qe+5)%7:V.w+V.U*7-(qe+6)%7);return"Z"in V?(V.H+=V.Z/100|0,V.M+=V.Z%100,Su(V)):bu(V)}}function C(Q,re,oe,V){for(var Re=0,me=re.length,qe=oe.length,Ve,ft;Re<me;){if(V>=qe)return-1;if(Ve=re.charCodeAt(Re++),Ve===37){if(Ve=re.charAt(Re++),ft=g[Ve in Um?re.charAt(Re++):Ve],!ft||(V=ft(Q,oe,V))<0)return-1}else if(Ve!=oe.charCodeAt(V++))return-1}return V}function _(Q,re,oe){var V=u.exec(re.slice(oe));return V?(Q.p=l.get(V[0].toLowerCase()),oe+V[0].length):-1}function A(Q,re,oe){var V=h.exec(re.slice(oe));return V?(Q.w=m.get(V[0].toLowerCase()),oe+V[0].length):-1}function P(Q,re,oe){var V=d.exec(re.slice(oe));return V?(Q.w=f.get(V[0].toLowerCase()),oe+V[0].length):-1}function E(Q,re,oe){var V=b.exec(re.slice(oe));return V?(Q.m=k.get(V[0].toLowerCase()),oe+V[0].length):-1}function M(Q,re,oe){var V=p.exec(re.slice(oe));return V?(Q.m=v.get(V[0].toLowerCase()),oe+V[0].length):-1}function N(Q,re,oe){return C(Q,e,re,oe)}function D(Q,re,oe){return C(Q,n,re,oe)}function $(Q,re,oe){return C(Q,r,re,oe)}function F(Q){return o[Q.getDay()]}function R(Q){return a[Q.getDay()]}function j(Q){return c[Q.getMonth()]}function q(Q){return s[Q.getMonth()]}function J(Q){return i[+(Q.getHours()>=12)]}function W(Q){return 1+~~(Q.getMonth()/3)}function ee(Q){return o[Q.getUTCDay()]}function de(Q){return a[Q.getUTCDay()]}function Se(Q){return c[Q.getUTCMonth()]}function xe(Q){return s[Q.getUTCMonth()]}function _t(Q){return i[+(Q.getUTCHours()>=12)]}function dt(Q){return 1+~~(Q.getUTCMonth()/3)}return{format:function(Q){var re=y(Q+="",T);return re.toString=function(){return Q},re},parse:function(Q){var re=w(Q+="",!1);return re.toString=function(){return Q},re},utcFormat:function(Q){var re=y(Q+="",S);return re.toString=function(){return Q},re},utcParse:function(Q){var re=w(Q+="",!0);return re.toString=function(){return Q},re}}}var Um={"-":"",_:" ",0:"0"},Ze=/^\s*\d+/,H$=/^%/,K$=/[\\^$*+?|[\]().{}]/g;function ge(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function X$(t){return t.replace(K$,"\\$&")}function Qi(t){return new RegExp("^(?:"+t.map(X$).join("|")+")","i")}function Zi(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function Y$(t,e,n){var r=Ze.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function J$(t,e,n){var r=Ze.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Q$(t,e,n){var r=Ze.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Z$(t,e,n){var r=Ze.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function e2(t,e,n){var r=Ze.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Fm(t,e,n){var r=Ze.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function qm(t,e,n){var r=Ze.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function t2(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function n2(t,e,n){var r=Ze.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function r2(t,e,n){var r=Ze.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Vm(t,e,n){var r=Ze.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function i2(t,e,n){var r=Ze.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Wm(t,e,n){var r=Ze.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function a2(t,e,n){var r=Ze.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function o2(t,e,n){var r=Ze.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function s2(t,e,n){var r=Ze.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function c2(t,e,n){var r=Ze.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function u2(t,e,n){var r=H$.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function l2(t,e,n){var r=Ze.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function d2(t,e,n){var r=Ze.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function zm(t,e){return ge(t.getDate(),e,2)}function f2(t,e){return ge(t.getHours(),e,2)}function h2(t,e){return ge(t.getHours()%12||12,e,2)}function p2(t,e){return ge(1+ho.count(En(t),t),e,3)}function N0(t,e){return ge(t.getMilliseconds(),e,3)}function m2(t,e){return N0(t,e)+"000"}function g2(t,e){return ge(t.getMonth()+1,e,2)}function v2(t,e){return ge(t.getMinutes(),e,2)}function y2(t,e){return ge(t.getSeconds(),e,2)}function b2(t){var e=t.getDay();return e===0?7:e}function S2(t,e){return ge(xc.count(En(t)-1,t),e,2)}function L0(t){var e=t.getDay();return e>=4||e===0?pi(t):pi.ceil(t)}function T2(t,e){return t=L0(t),ge(pi.count(En(t),t)+(En(t).getDay()===4),e,2)}function k2(t){return t.getDay()}function w2(t,e){return ge(_s.count(En(t)-1,t),e,2)}function C2(t,e){return ge(t.getFullYear()%100,e,2)}function _2(t,e){return t=L0(t),ge(t.getFullYear()%100,e,2)}function x2(t,e){return ge(t.getFullYear()%1e4,e,4)}function P2(t,e){var n=t.getDay();return t=n>=4||n===0?pi(t):pi.ceil(t),ge(t.getFullYear()%1e4,e,4)}function O2(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+ge(e/60|0,"0",2)+ge(e%60,"0",2)}function Gm(t,e){return ge(t.getUTCDate(),e,2)}function E2(t,e){return ge(t.getUTCHours(),e,2)}function A2(t,e){return ge(t.getUTCHours()%12||12,e,2)}function I2(t,e){return ge(1+_c.count(An(t),t),e,3)}function j0(t,e){return ge(t.getUTCMilliseconds(),e,3)}function R2(t,e){return j0(t,e)+"000"}function M2(t,e){return ge(t.getUTCMonth()+1,e,2)}function D2(t,e){return ge(t.getUTCMinutes(),e,2)}function N2(t,e){return ge(t.getUTCSeconds(),e,2)}function L2(t){var e=t.getUTCDay();return e===0?7:e}function j2(t,e){return ge(Pc.count(An(t)-1,t),e,2)}function $0(t){var e=t.getUTCDay();return e>=4||e===0?mi(t):mi.ceil(t)}function $2(t,e){return t=$0(t),ge(mi.count(An(t),t)+(An(t).getUTCDay()===4),e,2)}function B2(t){return t.getUTCDay()}function U2(t,e){return ge(xs.count(An(t)-1,t),e,2)}function F2(t,e){return ge(t.getUTCFullYear()%100,e,2)}function q2(t,e){return t=$0(t),ge(t.getUTCFullYear()%100,e,2)}function V2(t,e){return ge(t.getUTCFullYear()%1e4,e,4)}function W2(t,e){var n=t.getUTCDay();return t=n>=4||n===0?mi(t):mi.ceil(t),ge(t.getUTCFullYear()%1e4,e,4)}function z2(){return"+0000"}function Hm(){return"%"}function Km(t){return+t}function Xm(t){return Math.floor(+t/1e3)}var Br,B0,U0;G2({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function G2(t){return Br=G$(t),B0=Br.format,Br.parse,U0=Br.utcFormat,Br.utcParse,Br}function H2(t){return new Date(t)}function K2(t){return t instanceof Date?+t:+new Date(+t)}function Bf(t,e,n,r,i,a,o,s,c,u){var l=_f(),d=l.invert,f=l.domain,h=u(".%L"),m=u(":%S"),p=u("%I:%M"),v=u("%I %p"),b=u("%a %d"),k=u("%b %d"),T=u("%B"),S=u("%Y");function g(y){return(c(y)<y?h:s(y)<y?m:o(y)<y?p:a(y)<y?v:r(y)<y?i(y)<y?b:k:n(y)<y?T:S)(y)}return l.invert=function(y){return new Date(d(y))},l.domain=function(y){return arguments.length?f(Array.from(y,K2)):f().map(H2)},l.ticks=function(y){var w=f();return t(w[0],w[w.length-1],y==null?10:y)},l.tickFormat=function(y,w){return w==null?g:u(w)},l.nice=function(y){var w=f();return(!y||typeof y.range!="function")&&(y=e(w[0],w[w.length-1],y==null?10:y)),y?f(x0(w,y)):l},l.copy=function(){return fo(l,Bf(t,e,n,r,i,a,o,s,c,u))},l}function X2(){return jt.apply(Bf(W$,z$,En,jf,xc,ho,Nf,Mf,mr,B0).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Y2(){return jt.apply(Bf(q$,V$,An,$f,Pc,_c,Lf,Df,mr,U0).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Oc(){var t=0,e=1,n,r,i,a,o=ct,s=!1,c;function u(d){return d==null||isNaN(d=+d)?c:o(i===0?.5:(d=(a(d)-n)*i,s?Math.max(0,Math.min(1,d)):d))}u.domain=function(d){return arguments.length?([t,e]=d,n=a(t=+t),r=a(e=+e),i=n===r?0:1/(r-n),u):[t,e]},u.clamp=function(d){return arguments.length?(s=!!d,u):s},u.interpolator=function(d){return arguments.length?(o=d,u):o};function l(d){return function(f){var h,m;return arguments.length?([h,m]=f,o=d(h,m),u):[o(0),o(1)]}}return u.range=l(qi),u.rangeRound=l(Cf),u.unknown=function(d){return arguments.length?(c=d,u):c},function(d){return a=d,n=d(t),r=d(e),i=n===r?0:1/(r-n),u}}function nr(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function F0(){var t=tr(Oc()(ct));return t.copy=function(){return nr(t,F0())},Dn.apply(t,arguments)}function q0(){var t=Of(Oc()).domain([1,10]);return t.copy=function(){return nr(t,q0()).base(t.base())},Dn.apply(t,arguments)}function V0(){var t=Ef(Oc());return t.copy=function(){return nr(t,V0()).constant(t.constant())},Dn.apply(t,arguments)}function Uf(){var t=Af(Oc());return t.copy=function(){return nr(t,Uf()).exponent(t.exponent())},Dn.apply(t,arguments)}function J2(){return Uf.apply(null,arguments).exponent(.5)}function W0(){var t=[],e=ct;function n(r){if(r!=null&&!isNaN(r=+r))return e((uo(t,r,1)-1)/(t.length-1))}return n.domain=function(r){if(!arguments.length)return t.slice();t=[];for(let i of r)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(Hn),n},n.interpolator=function(r){return arguments.length?(e=r,n):e},n.range=function(){return t.map((r,i)=>e(i/(t.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(i,a)=>jj(t,a/r))},n.copy=function(){return W0(e).domain(t)},Dn.apply(n,arguments)}function Ec(){var t=0,e=.5,n=1,r=1,i,a,o,s,c,u=ct,l,d=!1,f;function h(p){return isNaN(p=+p)?f:(p=.5+((p=+l(p))-a)*(r*p<r*a?s:c),u(d?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([t,e,n]=p,i=l(t=+t),a=l(e=+e),o=l(n=+n),s=i===a?0:.5/(a-i),c=a===o?0:.5/(o-a),r=a<i?-1:1,h):[t,e,n]},h.clamp=function(p){return arguments.length?(d=!!p,h):d},h.interpolator=function(p){return arguments.length?(u=p,h):u};function m(p){return function(v){var b,k,T;return arguments.length?([b,k,T]=v,u=u$(p,[b,k,T]),h):[u(0),u(.5),u(1)]}}return h.range=m(qi),h.rangeRound=m(Cf),h.unknown=function(p){return arguments.length?(f=p,h):f},function(p){return l=p,i=p(t),a=p(e),o=p(n),s=i===a?0:.5/(a-i),c=a===o?0:.5/(o-a),r=a<i?-1:1,h}}function z0(){var t=tr(Ec()(ct));return t.copy=function(){return nr(t,z0())},Dn.apply(t,arguments)}function G0(){var t=Of(Ec()).domain([.1,1,10]);return t.copy=function(){return nr(t,G0()).base(t.base())},Dn.apply(t,arguments)}function H0(){var t=Ef(Ec());return t.copy=function(){return nr(t,H0()).constant(t.constant())},Dn.apply(t,arguments)}function Ff(){var t=Af(Ec());return t.copy=function(){return nr(t,Ff()).exponent(t.exponent())},Dn.apply(t,arguments)}function Q2(){return Ff.apply(null,arguments).exponent(.5)}const Ym=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Aa,scaleDiverging:z0,scaleDivergingLog:G0,scaleDivergingPow:Ff,scaleDivergingSqrt:Q2,scaleDivergingSymlog:H0,scaleIdentity:_0,scaleImplicit:El,scaleLinear:ws,scaleLog:P0,scaleOrdinal:Tf,scalePoint:ma,scalePow:If,scaleQuantile:A0,scaleQuantize:I0,scaleRadial:E0,scaleSequential:F0,scaleSequentialLog:q0,scaleSequentialPow:Uf,scaleSequentialQuantile:W0,scaleSequentialSqrt:J2,scaleSequentialSymlog:V0,scaleSqrt:R$,scaleSymlog:O0,scaleThreshold:R0,scaleTime:X2,scaleUtc:Y2,tickFormat:C0},Symbol.toStringTag,{value:"Module"}));var Z2=Ri;function eB(t,e,n){for(var r=-1,i=t.length;++r<i;){var a=t[r],o=e(a);if(o!=null&&(s===void 0?o===o&&!Z2(o):n(o,s)))var s=o,c=a}return c}var K0=eB;function tB(t,e){return t>e}var nB=tB,rB=K0,iB=nB,aB=Fi;function oB(t){return t&&t.length?rB(t,aB,iB):void 0}var sB=oB;const Wn=_e(sB);function cB(t,e){return t<e}var uB=cB,lB=K0,dB=uB,fB=Fi;function hB(t){return t&&t.length?lB(t,fB,dB):void 0}var pB=hB;const Ac=_e(pB);var mB=nf,gB=er,vB=n0,yB=yt;function bB(t,e){var n=yB(t)?mB:vB;return n(t,gB(e))}var SB=bB,TB=e0,kB=SB;function wB(t,e){return TB(kB(t,e),1)}var CB=wB;const _B=_e(CB);var xB=gf;function PB(t,e){return xB(t,e)}var OB=PB;const gi=_e(OB);var Vi=1e9,EB={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Vf,Ie=!0,Lt="[DecimalError] ",br=Lt+"Invalid argument: ",qf=Lt+"Exponent out of range: ",Wi=Math.floor,dr=Math.pow,AB=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,kt,Ye=1e7,Ee=7,X0=9007199254740991,Ps=Wi(X0/Ee),Z={};Z.absoluteValue=Z.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};Z.comparedTo=Z.cmp=function(t){var e,n,r,i,a=this;if(t=new a.constructor(t),a.s!==t.s)return a.s||-t.s;if(a.e!==t.e)return a.e>t.e^a.s<0?1:-1;for(r=a.d.length,i=t.d.length,e=0,n=r<i?r:i;e<n;++e)if(a.d[e]!==t.d[e])return a.d[e]>t.d[e]^a.s<0?1:-1;return r===i?0:r>i^a.s<0?1:-1};Z.decimalPlaces=Z.dp=function(){var t=this,e=t.d.length-1,n=(e-t.e)*Ee;if(e=t.d[e],e)for(;e%10==0;e/=10)n--;return n<0?0:n};Z.dividedBy=Z.div=function(t){return xn(this,new this.constructor(t))};Z.dividedToIntegerBy=Z.idiv=function(t){var e=this,n=e.constructor;return ke(xn(e,new n(t),0,1),n.precision)};Z.equals=Z.eq=function(t){return!this.cmp(t)};Z.exponent=function(){return Fe(this)};Z.greaterThan=Z.gt=function(t){return this.cmp(t)>0};Z.greaterThanOrEqualTo=Z.gte=function(t){return this.cmp(t)>=0};Z.isInteger=Z.isint=function(){return this.e>this.d.length-2};Z.isNegative=Z.isneg=function(){return this.s<0};Z.isPositive=Z.ispos=function(){return this.s>0};Z.isZero=function(){return this.s===0};Z.lessThan=Z.lt=function(t){return this.cmp(t)<0};Z.lessThanOrEqualTo=Z.lte=function(t){return this.cmp(t)<1};Z.logarithm=Z.log=function(t){var e,n=this,r=n.constructor,i=r.precision,a=i+5;if(t===void 0)t=new r(10);else if(t=new r(t),t.s<1||t.eq(kt))throw Error(Lt+"NaN");if(n.s<1)throw Error(Lt+(n.s?"NaN":"-Infinity"));return n.eq(kt)?new r(0):(Ie=!1,e=xn(Na(n,a),Na(t,a),a),Ie=!0,ke(e,i))};Z.minus=Z.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Q0(e,t):Y0(e,(t.s=-t.s,t))};Z.modulo=Z.mod=function(t){var e,n=this,r=n.constructor,i=r.precision;if(t=new r(t),!t.s)throw Error(Lt+"NaN");return n.s?(Ie=!1,e=xn(n,t,0,1).times(t),Ie=!0,n.minus(e)):ke(new r(n),i)};Z.naturalExponential=Z.exp=function(){return J0(this)};Z.naturalLogarithm=Z.ln=function(){return Na(this)};Z.negated=Z.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};Z.plus=Z.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Y0(e,t):Q0(e,(t.s=-t.s,t))};Z.precision=Z.sd=function(t){var e,n,r,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(br+t);if(e=Fe(i)+1,r=i.d.length-1,n=r*Ee+1,r=i.d[r],r){for(;r%10==0;r/=10)n--;for(r=i.d[0];r>=10;r/=10)n++}return t&&e>n?e:n};Z.squareRoot=Z.sqrt=function(){var t,e,n,r,i,a,o,s=this,c=s.constructor;if(s.s<1){if(!s.s)return new c(0);throw Error(Lt+"NaN")}for(t=Fe(s),Ie=!1,i=Math.sqrt(+s),i==0||i==1/0?(e=Zt(s.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=Wi((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),r=new c(e)):r=new c(i.toString()),n=c.precision,i=o=n+3;;)if(a=r,r=a.plus(xn(s,a,o+2)).times(.5),Zt(a.d).slice(0,o)===(e=Zt(r.d)).slice(0,o)){if(e=e.slice(o-3,o+1),i==o&&e=="4999"){if(ke(a,n+1,0),a.times(a).eq(s)){r=a;break}}else if(e!="9999")break;o+=4}return Ie=!0,ke(r,n)};Z.times=Z.mul=function(t){var e,n,r,i,a,o,s,c,u,l=this,d=l.constructor,f=l.d,h=(t=new d(t)).d;if(!l.s||!t.s)return new d(0);for(t.s*=l.s,n=l.e+t.e,c=f.length,u=h.length,c<u&&(a=f,f=h,h=a,o=c,c=u,u=o),a=[],o=c+u,r=o;r--;)a.push(0);for(r=u;--r>=0;){for(e=0,i=c+r;i>r;)s=a[i]+h[r]*f[i-r-1]+e,a[i--]=s%Ye|0,e=s/Ye|0;a[i]=(a[i]+e)%Ye|0}for(;!a[--o];)a.pop();return e?++n:a.shift(),t.d=a,t.e=n,Ie?ke(t,d.precision):t};Z.toDecimalPlaces=Z.todp=function(t,e){var n=this,r=n.constructor;return n=new r(n),t===void 0?n:(sn(t,0,Vi),e===void 0?e=r.rounding:sn(e,0,8),ke(n,t+Fe(n)+1,e))};Z.toExponential=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=Cr(r,!0):(sn(t,0,Vi),e===void 0?e=i.rounding:sn(e,0,8),r=ke(new i(r),t+1,e),n=Cr(r,!0,t+1)),n};Z.toFixed=function(t,e){var n,r,i=this,a=i.constructor;return t===void 0?Cr(i):(sn(t,0,Vi),e===void 0?e=a.rounding:sn(e,0,8),r=ke(new a(i),t+Fe(i)+1,e),n=Cr(r.abs(),!1,t+Fe(r)+1),i.isneg()&&!i.isZero()?"-"+n:n)};Z.toInteger=Z.toint=function(){var t=this,e=t.constructor;return ke(new e(t),Fe(t)+1,e.rounding)};Z.toNumber=function(){return+this};Z.toPower=Z.pow=function(t){var e,n,r,i,a,o,s=this,c=s.constructor,u=12,l=+(t=new c(t));if(!t.s)return new c(kt);if(s=new c(s),!s.s){if(t.s<1)throw Error(Lt+"Infinity");return s}if(s.eq(kt))return s;if(r=c.precision,t.eq(kt))return ke(s,r);if(e=t.e,n=t.d.length-1,o=e>=n,a=s.s,o){if((n=l<0?-l:l)<=X0){for(i=new c(kt),e=Math.ceil(r/Ee+4),Ie=!1;n%2&&(i=i.times(s),Qm(i.d,e)),n=Wi(n/2),n!==0;)s=s.times(s),Qm(s.d,e);return Ie=!0,t.s<0?new c(kt).div(i):ke(i,r)}}else if(a<0)throw Error(Lt+"NaN");return a=a<0&&t.d[Math.max(e,n)]&1?-1:1,s.s=1,Ie=!1,i=t.times(Na(s,r+u)),Ie=!0,i=J0(i),i.s=a,i};Z.toPrecision=function(t,e){var n,r,i=this,a=i.constructor;return t===void 0?(n=Fe(i),r=Cr(i,n<=a.toExpNeg||n>=a.toExpPos)):(sn(t,1,Vi),e===void 0?e=a.rounding:sn(e,0,8),i=ke(new a(i),t,e),n=Fe(i),r=Cr(i,t<=n||n<=a.toExpNeg,t)),r};Z.toSignificantDigits=Z.tosd=function(t,e){var n=this,r=n.constructor;return t===void 0?(t=r.precision,e=r.rounding):(sn(t,1,Vi),e===void 0?e=r.rounding:sn(e,0,8)),ke(new r(n),t,e)};Z.toString=Z.valueOf=Z.val=Z.toJSON=Z[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=Fe(t),n=t.constructor;return Cr(t,e<=n.toExpNeg||e>=n.toExpPos)};function Y0(t,e){var n,r,i,a,o,s,c,u,l=t.constructor,d=l.precision;if(!t.s||!e.s)return e.s||(e=new l(t)),Ie?ke(e,d):e;if(c=t.d,u=e.d,o=t.e,i=e.e,c=c.slice(),a=o-i,a){for(a<0?(r=c,a=-a,s=u.length):(r=u,i=o,s=c.length),o=Math.ceil(d/Ee),s=o>s?o+1:s+1,a>s&&(a=s,r.length=1),r.reverse();a--;)r.push(0);r.reverse()}for(s=c.length,a=u.length,s-a<0&&(a=s,r=u,u=c,c=r),n=0;a;)n=(c[--a]=c[a]+u[a]+n)/Ye|0,c[a]%=Ye;for(n&&(c.unshift(n),++i),s=c.length;c[--s]==0;)c.pop();return e.d=c,e.e=i,Ie?ke(e,d):e}function sn(t,e,n){if(t!==~~t||t<e||t>n)throw Error(br+t)}function Zt(t){var e,n,r,i=t.length-1,a="",o=t[0];if(i>0){for(a+=o,e=1;e<i;e++)r=t[e]+"",n=Ee-r.length,n&&(a+=Fn(n)),a+=r;o=t[e],r=o+"",n=Ee-r.length,n&&(a+=Fn(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}var xn=function(){function t(r,i){var a,o=0,s=r.length;for(r=r.slice();s--;)a=r[s]*i+o,r[s]=a%Ye|0,o=a/Ye|0;return o&&r.unshift(o),r}function e(r,i,a,o){var s,c;if(a!=o)c=a>o?1:-1;else for(s=c=0;s<a;s++)if(r[s]!=i[s]){c=r[s]>i[s]?1:-1;break}return c}function n(r,i,a){for(var o=0;a--;)r[a]-=o,o=r[a]<i[a]?1:0,r[a]=o*Ye+r[a]-i[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,a,o){var s,c,u,l,d,f,h,m,p,v,b,k,T,S,g,y,w,C,_=r.constructor,A=r.s==i.s?1:-1,P=r.d,E=i.d;if(!r.s)return new _(r);if(!i.s)throw Error(Lt+"Division by zero");for(c=r.e-i.e,w=E.length,g=P.length,h=new _(A),m=h.d=[],u=0;E[u]==(P[u]||0);)++u;if(E[u]>(P[u]||0)&&--c,a==null?k=a=_.precision:o?k=a+(Fe(r)-Fe(i))+1:k=a,k<0)return new _(0);if(k=k/Ee+2|0,u=0,w==1)for(l=0,E=E[0],k++;(u<g||l)&&k--;u++)T=l*Ye+(P[u]||0),m[u]=T/E|0,l=T%E|0;else{for(l=Ye/(E[0]+1)|0,l>1&&(E=t(E,l),P=t(P,l),w=E.length,g=P.length),S=w,p=P.slice(0,w),v=p.length;v<w;)p[v++]=0;C=E.slice(),C.unshift(0),y=E[0],E[1]>=Ye/2&&++y;do l=0,s=e(E,p,w,v),s<0?(b=p[0],w!=v&&(b=b*Ye+(p[1]||0)),l=b/y|0,l>1?(l>=Ye&&(l=Ye-1),d=t(E,l),f=d.length,v=p.length,s=e(d,p,f,v),s==1&&(l--,n(d,w<f?C:E,f))):(l==0&&(s=l=1),d=E.slice()),f=d.length,f<v&&d.unshift(0),n(p,d,v),s==-1&&(v=p.length,s=e(E,p,w,v),s<1&&(l++,n(p,w<v?C:E,v))),v=p.length):s===0&&(l++,p=[0]),m[u++]=l,s&&p[0]?p[v++]=P[S]||0:(p=[P[S]],v=1);while((S++<g||p[0]!==void 0)&&k--)}return m[0]||m.shift(),h.e=c,ke(h,o?a+Fe(h)+1:a)}}();function J0(t,e){var n,r,i,a,o,s,c=0,u=0,l=t.constructor,d=l.precision;if(Fe(t)>16)throw Error(qf+Fe(t));if(!t.s)return new l(kt);for(e==null?(Ie=!1,s=d):s=e,o=new l(.03125);t.abs().gte(.1);)t=t.times(o),u+=5;for(r=Math.log(dr(2,u))/Math.LN10*2+5|0,s+=r,n=i=a=new l(kt),l.precision=s;;){if(i=ke(i.times(t),s),n=n.times(++c),o=a.plus(xn(i,n,s)),Zt(o.d).slice(0,s)===Zt(a.d).slice(0,s)){for(;u--;)a=ke(a.times(a),s);return l.precision=d,e==null?(Ie=!0,ke(a,d)):a}a=o}}function Fe(t){for(var e=t.e*Ee,n=t.d[0];n>=10;n/=10)e++;return e}function Tu(t,e,n){if(e>t.LN10.sd())throw Ie=!0,n&&(t.precision=n),Error(Lt+"LN10 precision limit exceeded");return ke(new t(t.LN10),e)}function Fn(t){for(var e="";t--;)e+="0";return e}function Na(t,e){var n,r,i,a,o,s,c,u,l,d=1,f=10,h=t,m=h.d,p=h.constructor,v=p.precision;if(h.s<1)throw Error(Lt+(h.s?"NaN":"-Infinity"));if(h.eq(kt))return new p(0);if(e==null?(Ie=!1,u=v):u=e,h.eq(10))return e==null&&(Ie=!0),Tu(p,u);if(u+=f,p.precision=u,n=Zt(m),r=n.charAt(0),a=Fe(h),Math.abs(a)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)h=h.times(t),n=Zt(h.d),r=n.charAt(0),d++;a=Fe(h),r>1?(h=new p("0."+n),a++):h=new p(r+"."+n.slice(1))}else return c=Tu(p,u+2,v).times(a+""),h=Na(new p(r+"."+n.slice(1)),u-f).plus(c),p.precision=v,e==null?(Ie=!0,ke(h,v)):h;for(s=o=h=xn(h.minus(kt),h.plus(kt),u),l=ke(h.times(h),u),i=3;;){if(o=ke(o.times(l),u),c=s.plus(xn(o,new p(i),u)),Zt(c.d).slice(0,u)===Zt(s.d).slice(0,u))return s=s.times(2),a!==0&&(s=s.plus(Tu(p,u+2,v).times(a+""))),s=xn(s,new p(d),u),p.precision=v,e==null?(Ie=!0,ke(s,v)):s;s=c,i+=2}}function Jm(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;e.charCodeAt(r)===48;)++r;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(r,i),e){if(i-=r,n=n-r-1,t.e=Wi(n/Ee),t.d=[],r=(n+1)%Ee,n<0&&(r+=Ee),r<i){for(r&&t.d.push(+e.slice(0,r)),i-=Ee;r<i;)t.d.push(+e.slice(r,r+=Ee));e=e.slice(r),r=Ee-e.length}else r-=i;for(;r--;)e+="0";if(t.d.push(+e),Ie&&(t.e>Ps||t.e<-Ps))throw Error(qf+n)}else t.s=0,t.e=0,t.d=[0];return t}function ke(t,e,n){var r,i,a,o,s,c,u,l,d=t.d;for(o=1,a=d[0];a>=10;a/=10)o++;if(r=e-o,r<0)r+=Ee,i=e,u=d[l=0];else{if(l=Math.ceil((r+1)/Ee),a=d.length,l>=a)return t;for(u=a=d[l],o=1;a>=10;a/=10)o++;r%=Ee,i=r-Ee+o}if(n!==void 0&&(a=dr(10,o-i-1),s=u/a%10|0,c=e<0||d[l+1]!==void 0||u%a,c=n<4?(s||c)&&(n==0||n==(t.s<0?3:2)):s>5||s==5&&(n==4||c||n==6&&(r>0?i>0?u/dr(10,o-i):0:d[l-1])%10&1||n==(t.s<0?8:7))),e<1||!d[0])return c?(a=Fe(t),d.length=1,e=e-a-1,d[0]=dr(10,(Ee-e%Ee)%Ee),t.e=Wi(-e/Ee)||0):(d.length=1,d[0]=t.e=t.s=0),t;if(r==0?(d.length=l,a=1,l--):(d.length=l+1,a=dr(10,Ee-r),d[l]=i>0?(u/dr(10,o-i)%dr(10,i)|0)*a:0),c)for(;;)if(l==0){(d[0]+=a)==Ye&&(d[0]=1,++t.e);break}else{if(d[l]+=a,d[l]!=Ye)break;d[l--]=0,a=1}for(r=d.length;d[--r]===0;)d.pop();if(Ie&&(t.e>Ps||t.e<-Ps))throw Error(qf+Fe(t));return t}function Q0(t,e){var n,r,i,a,o,s,c,u,l,d,f=t.constructor,h=f.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new f(t),Ie?ke(e,h):e;if(c=t.d,d=e.d,r=e.e,u=t.e,c=c.slice(),o=u-r,o){for(l=o<0,l?(n=c,o=-o,s=d.length):(n=d,r=u,s=c.length),i=Math.max(Math.ceil(h/Ee),s)+2,o>i&&(o=i,n.length=1),n.reverse(),i=o;i--;)n.push(0);n.reverse()}else{for(i=c.length,s=d.length,l=i<s,l&&(s=i),i=0;i<s;i++)if(c[i]!=d[i]){l=c[i]<d[i];break}o=0}for(l&&(n=c,c=d,d=n,e.s=-e.s),s=c.length,i=d.length-s;i>0;--i)c[s++]=0;for(i=d.length;i>o;){if(c[--i]<d[i]){for(a=i;a&&c[--a]===0;)c[a]=Ye-1;--c[a],c[i]+=Ye}c[i]-=d[i]}for(;c[--s]===0;)c.pop();for(;c[0]===0;c.shift())--r;return c[0]?(e.d=c,e.e=r,Ie?ke(e,h):e):new f(0)}function Cr(t,e,n){var r,i=Fe(t),a=Zt(t.d),o=a.length;return e?(n&&(r=n-o)>0?a=a.charAt(0)+"."+a.slice(1)+Fn(r):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+Fn(-i-1)+a,n&&(r=n-o)>0&&(a+=Fn(r))):i>=o?(a+=Fn(i+1-o),n&&(r=n-i-1)>0&&(a=a+"."+Fn(r))):((r=i+1)<o&&(a=a.slice(0,r)+"."+a.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(a+="."),a+=Fn(r))),t.s<0?"-"+a:a}function Qm(t,e){if(t.length>e)return t.length=e,!0}function Z0(t){var e,n,r;function i(a){var o=this;if(!(o instanceof i))return new i(a);if(o.constructor=i,a instanceof i){o.s=a.s,o.e=a.e,o.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(br+a);if(a>0)o.s=1;else if(a<0)a=-a,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(a===~~a&&a<1e7){o.e=0,o.d=[a];return}return Jm(o,a.toString())}else if(typeof a!="string")throw Error(br+a);if(a.charCodeAt(0)===45?(a=a.slice(1),o.s=-1):o.s=1,AB.test(a))Jm(o,a);else throw Error(br+a)}if(i.prototype=Z,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=Z0,i.config=i.set=IB,t===void 0&&(t={}),t)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return i.config(t),i}function IB(t){if(!t||typeof t!="object")throw Error(Lt+"Object expected");var e,n,r,i=["precision",1,Vi,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((r=t[n=i[e]])!==void 0)if(Wi(r)===r&&r>=i[e+1]&&r<=i[e+2])this[n]=r;else throw Error(br+n+": "+r);if((r=t[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(br+n+": "+r);return this}var Vf=Z0(EB);kt=new Vf(1);const ye=Vf;function RB(t){return LB(t)||NB(t)||DB(t)||MB()}function MB(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DB(t,e){if(t){if(typeof t=="string")return Ml(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ml(t,e)}}function NB(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}function LB(t){if(Array.isArray(t))return Ml(t)}function Ml(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var jB=function(e){return e},eS={"@@functional/placeholder":!0},tS=function(e){return e===eS},Zm=function(e){return function n(){return arguments.length===0||arguments.length===1&&tS(arguments.length<=0?void 0:arguments[0])?n:e.apply(void 0,arguments)}},$B=function t(e,n){return e===1?n:Zm(function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=i.filter(function(s){return s!==eS}).length;return o>=e?n.apply(void 0,i):t(e-o,Zm(function(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];var l=i.map(function(d){return tS(d)?c.shift():d});return n.apply(void 0,RB(l).concat(c))}))})},Ic=function(e){return $B(e.length,e)},Dl=function(e,n){for(var r=[],i=e;i<n;++i)r[i-e]=i;return r},BB=Ic(function(t,e){return Array.isArray(e)?e.map(t):Object.keys(e).map(function(n){return e[n]}).map(t)}),UB=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(!n.length)return jB;var i=n.reverse(),a=i[0],o=i.slice(1);return function(){return o.reduce(function(s,c){return c(s)},a.apply(void 0,arguments))}},Nl=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},nS=function(e){var n=null,r=null;return function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n&&a.every(function(s,c){return s===n[c]})||(n=a,r=e.apply(void 0,a)),r}};function FB(t){var e;return t===0?e=1:e=Math.floor(new ye(t).abs().log(10).toNumber())+1,e}function qB(t,e,n){for(var r=new ye(t),i=0,a=[];r.lt(e)&&i<1e5;)a.push(r.toNumber()),r=r.add(n),i++;return a}var VB=Ic(function(t,e,n){var r=+t,i=+e;return r+n*(i-r)}),WB=Ic(function(t,e,n){var r=e-+t;return r=r||1/0,(n-t)/r}),zB=Ic(function(t,e,n){var r=e-+t;return r=r||1/0,Math.max(0,Math.min(1,(n-t)/r))});const Rc={rangeStep:qB,getDigitCount:FB,interpolateNumber:VB,uninterpolateNumber:WB,uninterpolateTruncation:zB};function Ll(t){return KB(t)||HB(t)||rS(t)||GB()}function GB(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HB(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}function KB(t){if(Array.isArray(t))return jl(t)}function La(t,e){return JB(t)||YB(t,e)||rS(t,e)||XB()}function XB(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rS(t,e){if(t){if(typeof t=="string")return jl(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jl(t,e)}}function jl(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function YB(t,e){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,a=void 0;try{for(var o=t[Symbol.iterator](),s;!(r=(s=o.next()).done)&&(n.push(s.value),!(e&&n.length===e));r=!0);}catch(c){i=!0,a=c}finally{try{!r&&o.return!=null&&o.return()}finally{if(i)throw a}}return n}}function JB(t){if(Array.isArray(t))return t}function iS(t){var e=La(t,2),n=e[0],r=e[1],i=n,a=r;return n>r&&(i=r,a=n),[i,a]}function aS(t,e,n){if(t.lte(0))return new ye(0);var r=Rc.getDigitCount(t.toNumber()),i=new ye(10).pow(r),a=t.div(i),o=r!==1?.05:.1,s=new ye(Math.ceil(a.div(o).toNumber())).add(n).mul(o),c=s.mul(i);return e?c:new ye(Math.ceil(c))}function QB(t,e,n){var r=1,i=new ye(t);if(!i.isint()&&n){var a=Math.abs(t);a<1?(r=new ye(10).pow(Rc.getDigitCount(t)-1),i=new ye(Math.floor(i.div(r).toNumber())).mul(r)):a>1&&(i=new ye(Math.floor(t)))}else t===0?i=new ye(Math.floor((e-1)/2)):n||(i=new ye(Math.floor(t)));var o=Math.floor((e-1)/2),s=UB(BB(function(c){return i.add(new ye(c-o).mul(r)).toNumber()}),Dl);return s(0,e)}function oS(t,e,n,r){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((e-t)/(n-1)))return{step:new ye(0),tickMin:new ye(0),tickMax:new ye(0)};var a=aS(new ye(e).sub(t).div(n-1),r,i),o;t<=0&&e>=0?o=new ye(0):(o=new ye(t).add(e).div(2),o=o.sub(new ye(o).mod(a)));var s=Math.ceil(o.sub(t).div(a).toNumber()),c=Math.ceil(new ye(e).sub(o).div(a).toNumber()),u=s+c+1;return u>n?oS(t,e,n,r,i+1):(u<n&&(c=e>0?c+(n-u):c,s=e>0?s:s+(n-u)),{step:a,tickMin:o.sub(new ye(s).mul(a)),tickMax:o.add(new ye(c).mul(a))})}function ZB(t){var e=La(t,2),n=e[0],r=e[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(i,2),s=iS([n,r]),c=La(s,2),u=c[0],l=c[1];if(u===-1/0||l===1/0){var d=l===1/0?[u].concat(Ll(Dl(0,i-1).map(function(){return 1/0}))):[].concat(Ll(Dl(0,i-1).map(function(){return-1/0})),[l]);return n>r?Nl(d):d}if(u===l)return QB(u,i,a);var f=oS(u,l,o,a),h=f.step,m=f.tickMin,p=f.tickMax,v=Rc.rangeStep(m,p.add(new ye(.1).mul(h)),h);return n>r?Nl(v):v}function eU(t,e){var n=La(t,2),r=n[0],i=n[1],a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=iS([r,i]),s=La(o,2),c=s[0],u=s[1];if(c===-1/0||u===1/0)return[r,i];if(c===u)return[c];var l=Math.max(e,2),d=aS(new ye(u).sub(c).div(l-1),a,0),f=[].concat(Ll(Rc.rangeStep(new ye(c),new ye(u).sub(new ye(.99).mul(d)),d)),[u]);return r>i?Nl(f):f}var tU=nS(ZB),nU=nS(eU),rU=!0,ku="Invariant failed";function _r(t,e){if(!t){if(rU)throw new Error(ku);var n=typeof e=="function"?e():e,r=n?"".concat(ku,": ").concat(n):ku;throw new Error(r)}}var iU=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function vi(t){"@babel/helpers - typeof";return vi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vi(t)}function Os(){return Os=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Os.apply(this,arguments)}function aU(t,e){return uU(t)||cU(t,e)||sU(t,e)||oU()}function oU(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sU(t,e){if(t){if(typeof t=="string")return eg(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eg(t,e)}}function eg(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function cU(t,e){var n=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,a,o,s=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(l){u=!0,i=l}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function uU(t){if(Array.isArray(t))return t}function lU(t,e){if(t==null)return{};var n=dU(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function dU(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function fU(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,uS(r.key),r)}}function hU(t,e,n){return e&&tg(t.prototype,e),n&&tg(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function pU(t,e,n){return e=Es(e),mU(t,sS()?Reflect.construct(e,n||[],Es(t).constructor):e.apply(t,n))}function mU(t,e){if(e&&(vi(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gU(t)}function gU(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sS(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(sS=function(){return!!t})()}function Es(t){return Es=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Es(t)}function vU(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$l(t,e)}function $l(t,e){return $l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},$l(t,e)}function cS(t,e,n){return e=uS(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uS(t){var e=yU(t,"string");return vi(e)=="symbol"?e:e+""}function yU(t,e){if(vi(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(vi(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var po=function(t){function e(){return fU(this,e),pU(this,e,arguments)}return vU(e,t),hU(e,[{key:"render",value:function(){var r=this.props,i=r.offset,a=r.layout,o=r.width,s=r.dataKey,c=r.data,u=r.dataPointFormatter,l=r.xAxis,d=r.yAxis,f=lU(r,iU),h=ie(f,!1);this.props.direction==="x"&&l.type!=="number"&&_r(!1);var m=c.map(function(p){var v=u(p,s),b=v.x,k=v.y,T=v.value,S=v.errorVal;if(!S)return null;var g=[],y,w;if(Array.isArray(S)){var C=aU(S,2);y=C[0],w=C[1]}else y=w=S;if(a==="vertical"){var _=l.scale,A=k+i,P=A+o,E=A-o,M=_(T-y),N=_(T+w);g.push({x1:N,y1:P,x2:N,y2:E}),g.push({x1:M,y1:A,x2:N,y2:A}),g.push({x1:M,y1:P,x2:M,y2:E})}else if(a==="horizontal"){var D=d.scale,$=b+i,F=$-o,R=$+o,j=D(T-y),q=D(T+w);g.push({x1:F,y1:q,x2:R,y2:q}),g.push({x1:$,y1:j,x2:$,y2:q}),g.push({x1:F,y1:j,x2:R,y2:j})}return O.createElement(Ce,Os({className:"recharts-errorBar",key:"bar-".concat(g.map(function(J){return"".concat(J.x1,"-").concat(J.x2,"-").concat(J.y1,"-").concat(J.y2)}))},h),g.map(function(J){return O.createElement("line",Os({},J,{key:"line-".concat(J.x1,"-").concat(J.x2,"-").concat(J.y1,"-").concat(J.y2)}))}))});return O.createElement(Ce,{className:"recharts-errorBars"},m)}}])}(O.Component);cS(po,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});cS(po,"displayName","ErrorBar");function ja(t){"@babel/helpers - typeof";return ja=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ja(t)}function ng(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function cr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ng(Object(n),!0).forEach(function(r){bU(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ng(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function bU(t,e,n){return e=SU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SU(t){var e=TU(t,"string");return ja(e)=="symbol"?e:e+""}function TU(t,e){if(ja(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(ja(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lS=function(e){var n=e.children,r=e.formattedGraphicalItems,i=e.legendWidth,a=e.legendContent,o=Tt(n,Zr);if(!o)return null;var s=Zr.defaultProps,c=s!==void 0?cr(cr({},s),o.props):{},u;return o.props&&o.props.payload?u=o.props&&o.props.payload:a==="children"?u=(r||[]).reduce(function(l,d){var f=d.item,h=d.props,m=h.sectors||h.data||[];return l.concat(m.map(function(p){return{type:o.props.iconType||f.props.legendType,value:p.name,color:p.fill,payload:p}}))},[]):u=(r||[]).map(function(l){var d=l.item,f=d.type.defaultProps,h=f!==void 0?cr(cr({},f),d.props):{},m=h.dataKey,p=h.name,v=h.legendType,b=h.hide;return{inactive:b,dataKey:m,type:c.iconType||v||"square",color:Wf(d),value:p||m,payload:h}}),cr(cr(cr({},c),Zr.getWithHeight(o,i)),{},{payload:u,item:o})};function $a(t){"@babel/helpers - typeof";return $a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$a(t)}function rg(t){return _U(t)||CU(t)||wU(t)||kU()}function kU(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wU(t,e){if(t){if(typeof t=="string")return Bl(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bl(t,e)}}function CU(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function _U(t){if(Array.isArray(t))return Bl(t)}function Bl(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ig(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function De(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ig(Object(n),!0).forEach(function(r){ti(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ig(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ti(t,e,n){return e=xU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xU(t){var e=PU(t,"string");return $a(e)=="symbol"?e:e+""}function PU(t,e){if($a(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if($a(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ut(t,e,n){return ce(t)||ce(e)?n:Ke(e)?Dt(t,e,n):ne(e)?e(t):n}function ga(t,e,n,r){var i=_B(t,function(s){return ut(s,e)});if(n==="number"){var a=i.filter(function(s){return H(s)||parseFloat(s)});return a.length?[Ac(a),Wn(a)]:[1/0,-1/0]}var o=r?i.filter(function(s){return!ce(s)}):i;return o.map(function(s){return Ke(s)||s instanceof Date?s:""})}var OU=function(e){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=-1,s=(n=r==null?void 0:r.length)!==null&&n!==void 0?n:0;if(s<=1)return 0;if(a&&a.axisType==="angleAxis"&&Math.abs(Math.abs(a.range[1]-a.range[0])-360)<=1e-6)for(var c=a.range,u=0;u<s;u++){var l=u>0?i[u-1].coordinate:i[s-1].coordinate,d=i[u].coordinate,f=u>=s-1?i[0].coordinate:i[u+1].coordinate,h=void 0;if(Gt(d-l)!==Gt(f-d)){var m=[];if(Gt(f-d)===Gt(c[1]-c[0])){h=f;var p=d+c[1]-c[0];m[0]=Math.min(p,(p+l)/2),m[1]=Math.max(p,(p+l)/2)}else{h=l;var v=f+c[1]-c[0];m[0]=Math.min(d,(v+d)/2),m[1]=Math.max(d,(v+d)/2)}var b=[Math.min(d,(h+d)/2),Math.max(d,(h+d)/2)];if(e>b[0]&&e<=b[1]||e>=m[0]&&e<=m[1]){o=i[u].index;break}}else{var k=Math.min(l,f),T=Math.max(l,f);if(e>(k+d)/2&&e<=(T+d)/2){o=i[u].index;break}}}else for(var S=0;S<s;S++)if(S===0&&e<=(r[S].coordinate+r[S+1].coordinate)/2||S>0&&S<s-1&&e>(r[S].coordinate+r[S-1].coordinate)/2&&e<=(r[S].coordinate+r[S+1].coordinate)/2||S===s-1&&e>(r[S].coordinate+r[S-1].coordinate)/2){o=r[S].index;break}return o},Wf=function(e){var n,r=e,i=r.type.displayName,a=(n=e.type)!==null&&n!==void 0&&n.defaultProps?De(De({},e.type.defaultProps),e.props):e.props,o=a.stroke,s=a.fill,c;switch(i){case"Line":c=o;break;case"Area":case"Radar":c=o&&o!=="none"?o:s;break;default:c=s;break}return c},EU=function(e){var n=e.barSize,r=e.totalSize,i=e.stackGroups,a=i===void 0?{}:i;if(!a)return{};for(var o={},s=Object.keys(a),c=0,u=s.length;c<u;c++)for(var l=a[s[c]].stackGroups,d=Object.keys(l),f=0,h=d.length;f<h;f++){var m=l[d[f]],p=m.items,v=m.cateAxisId,b=p.filter(function(w){return Cn(w.type).indexOf("Bar")>=0});if(b&&b.length){var k=b[0].type.defaultProps,T=k!==void 0?De(De({},k),b[0].props):b[0].props,S=T.barSize,g=T[v];o[g]||(o[g]=[]);var y=ce(S)?n:S;o[g].push({item:b[0],stackList:b.slice(1),barSize:ce(y)?void 0:wr(y,r,0)})}}return o},AU=function(e){var n=e.barGap,r=e.barCategoryGap,i=e.bandSize,a=e.sizeList,o=a===void 0?[]:a,s=e.maxBarSize,c=o.length;if(c<1)return null;var u=wr(n,i,0,!0),l,d=[];if(o[0].barSize===+o[0].barSize){var f=!1,h=i/c,m=o.reduce(function(S,g){return S+g.barSize||0},0);m+=(c-1)*u,m>=i&&(m-=(c-1)*u,u=0),m>=i&&h>0&&(f=!0,h*=.9,m=c*h);var p=(i-m)/2>>0,v={offset:p-u,size:0};l=o.reduce(function(S,g){var y={item:g.item,position:{offset:v.offset+v.size+u,size:f?h:g.barSize}},w=[].concat(rg(S),[y]);return v=w[w.length-1].position,g.stackList&&g.stackList.length&&g.stackList.forEach(function(C){w.push({item:C,position:v})}),w},d)}else{var b=wr(r,i,0,!0);i-2*b-(c-1)*u<=0&&(u=0);var k=(i-2*b-(c-1)*u)/c;k>1&&(k>>=0);var T=s===+s?Math.min(k,s):k;l=o.reduce(function(S,g,y){var w=[].concat(rg(S),[{item:g.item,position:{offset:b+(k+u)*y+(k-T)/2,size:T}}]);return g.stackList&&g.stackList.length&&g.stackList.forEach(function(C){w.push({item:C,position:w[w.length-1].position})}),w},d)}return l},IU=function(e,n,r,i){var a=r.children,o=r.width,s=r.margin,c=o-(s.left||0)-(s.right||0),u=lS({children:a,legendWidth:c});if(u){var l=i||{},d=l.width,f=l.height,h=u.align,m=u.verticalAlign,p=u.layout;if((p==="vertical"||p==="horizontal"&&m==="middle")&&h!=="center"&&H(e[h]))return De(De({},e),{},ti({},h,e[h]+(d||0)));if((p==="horizontal"||p==="vertical"&&h==="center")&&m!=="middle"&&H(e[m]))return De(De({},e),{},ti({},m,e[m]+(f||0)))}return e},RU=function(e,n,r){return ce(n)?!0:e==="horizontal"?n==="yAxis":e==="vertical"||r==="x"?n==="xAxis":r==="y"?n==="yAxis":!0},dS=function(e,n,r,i,a){var o=n.props.children,s=Nt(o,po).filter(function(u){return RU(i,a,u.props.direction)});if(s&&s.length){var c=s.map(function(u){return u.props.dataKey});return e.reduce(function(u,l){var d=ut(l,r);if(ce(d))return u;var f=Array.isArray(d)?[Ac(d),Wn(d)]:[d,d],h=c.reduce(function(m,p){var v=ut(l,p,0),b=f[0]-Math.abs(Array.isArray(v)?v[0]:v),k=f[1]+Math.abs(Array.isArray(v)?v[1]:v);return[Math.min(b,m[0]),Math.max(k,m[1])]},[1/0,-1/0]);return[Math.min(h[0],u[0]),Math.max(h[1],u[1])]},[1/0,-1/0])}return null},MU=function(e,n,r,i,a){var o=n.map(function(s){return dS(e,s,r,a,i)}).filter(function(s){return!ce(s)});return o&&o.length?o.reduce(function(s,c){return[Math.min(s[0],c[0]),Math.max(s[1],c[1])]},[1/0,-1/0]):null},fS=function(e,n,r,i,a){var o=n.map(function(c){var u=c.props.dataKey;return r==="number"&&u&&dS(e,c,u,i)||ga(e,u,r,a)});if(r==="number")return o.reduce(function(c,u){return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);var s={};return o.reduce(function(c,u){for(var l=0,d=u.length;l<d;l++)s[u[l]]||(s[u[l]]=!0,c.push(u[l]));return c},[])},hS=function(e,n){return e==="horizontal"&&n==="xAxis"||e==="vertical"&&n==="yAxis"||e==="centric"&&n==="angleAxis"||e==="radial"&&n==="radiusAxis"},pS=function(e,n,r,i){if(i)return e.map(function(c){return c.coordinate});var a,o,s=e.map(function(c){return c.coordinate===n&&(a=!0),c.coordinate===r&&(o=!0),c.coordinate});return a||s.push(n),o||s.push(r),s},wn=function(e,n,r){if(!e)return null;var i=e.scale,a=e.duplicateDomain,o=e.type,s=e.range,c=e.realScaleType==="scaleBand"?i.bandwidth()/2:2,u=(n||r)&&o==="category"&&i.bandwidth?i.bandwidth()/c:0;if(u=e.axisType==="angleAxis"&&(s==null?void 0:s.length)>=2?Gt(s[0]-s[1])*2*u:u,n&&(e.ticks||e.niceTicks)){var l=(e.ticks||e.niceTicks).map(function(d){var f=a?a.indexOf(d):d;return{coordinate:i(f)+u,value:d,offset:u}});return l.filter(function(d){return!ji(d.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(d,f){return{coordinate:i(d)+u,value:d,index:f,offset:u}}):i.ticks&&!r?i.ticks(e.tickCount).map(function(d){return{coordinate:i(d)+u,value:d,offset:u}}):i.domain().map(function(d,f){return{coordinate:i(d)+u,value:a?a[d]:d,index:f,offset:u}})},wu=new WeakMap,Po=function(e,n){if(typeof n!="function")return e;wu.has(e)||wu.set(e,new WeakMap);var r=wu.get(e);if(r.has(n))return r.get(n);var i=function(){e.apply(void 0,arguments),n.apply(void 0,arguments)};return r.set(n,i),i},DU=function(e,n,r){var i=e.scale,a=e.type,o=e.layout,s=e.axisType;if(i==="auto")return o==="radial"&&s==="radiusAxis"?{scale:Aa(),realScaleType:"band"}:o==="radial"&&s==="angleAxis"?{scale:ws(),realScaleType:"linear"}:a==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?{scale:ma(),realScaleType:"point"}:a==="category"?{scale:Aa(),realScaleType:"band"}:{scale:ws(),realScaleType:"linear"};if(kr(i)){var c="scale".concat(vc(i));return{scale:(Ym[c]||ma)(),realScaleType:Ym[c]?c:"point"}}return ne(i)?{scale:i}:{scale:ma(),realScaleType:"point"}},ag=1e-4,NU=function(e){var n=e.domain();if(!(!n||n.length<=2)){var r=n.length,i=e.range(),a=Math.min(i[0],i[1])-ag,o=Math.max(i[0],i[1])+ag,s=e(n[0]),c=e(n[r-1]);(s<a||s>o||c<a||c>o)&&e.domain([n[0],n[r-1]])}},LU=function(e,n){if(!e)return null;for(var r=0,i=e.length;r<i;r++)if(e[r].item===n)return e[r].position;return null},jU=function(e,n){if(!n||n.length!==2||!H(n[0])||!H(n[1]))return e;var r=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]),a=[e[0],e[1]];return(!H(e[0])||e[0]<r)&&(a[0]=r),(!H(e[1])||e[1]>i)&&(a[1]=i),a[0]>i&&(a[0]=i),a[1]<r&&(a[1]=r),a},$U=function(e){var n=e.length;if(!(n<=0))for(var r=0,i=e[0].length;r<i;++r)for(var a=0,o=0,s=0;s<n;++s){var c=ji(e[s][r][1])?e[s][r][0]:e[s][r][1];c>=0?(e[s][r][0]=a,e[s][r][1]=a+c,a=e[s][r][1]):(e[s][r][0]=o,e[s][r][1]=o+c,o=e[s][r][1])}},BU=function(e){var n=e.length;if(!(n<=0))for(var r=0,i=e[0].length;r<i;++r)for(var a=0,o=0;o<n;++o){var s=ji(e[o][r][1])?e[o][r][0]:e[o][r][1];s>=0?(e[o][r][0]=a,e[o][r][1]=a+s,a=e[o][r][1]):(e[o][r][0]=0,e[o][r][1]=0)}},UU={sign:$U,expand:iE,none:ci,silhouette:aE,wiggle:oE,positive:BU},FU=function(e,n,r){var i=n.map(function(s){return s.props.dataKey}),a=UU[r],o=rE().keys(i).value(function(s,c){return+ut(s,c,0)}).order(ll).offset(a);return o(e)},qU=function(e,n,r,i,a,o){if(!e)return null;var s=o?n.reverse():n,c={},u=s.reduce(function(d,f){var h,m=(h=f.type)!==null&&h!==void 0&&h.defaultProps?De(De({},f.type.defaultProps),f.props):f.props,p=m.stackId,v=m.hide;if(v)return d;var b=m[r],k=d[b]||{hasStack:!1,stackGroups:{}};if(Ke(p)){var T=k.stackGroups[p]||{numericAxisId:r,cateAxisId:i,items:[]};T.items.push(f),k.hasStack=!0,k.stackGroups[p]=T}else k.stackGroups[$i("_stackId_")]={numericAxisId:r,cateAxisId:i,items:[f]};return De(De({},d),{},ti({},b,k))},c),l={};return Object.keys(u).reduce(function(d,f){var h=u[f];if(h.hasStack){var m={};h.stackGroups=Object.keys(h.stackGroups).reduce(function(p,v){var b=h.stackGroups[v];return De(De({},p),{},ti({},v,{numericAxisId:r,cateAxisId:i,items:b.items,stackedData:FU(e,b.items,a)}))},m)}return De(De({},d),{},ti({},f,h))},l)},VU=function(e,n){var r=n.realScaleType,i=n.type,a=n.tickCount,o=n.originalDomain,s=n.allowDecimals,c=r||n.scale;if(c!=="auto"&&c!=="linear")return null;if(a&&i==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var u=e.domain();if(!u.length)return null;var l=tU(u,a,s);return e.domain([Ac(l),Wn(l)]),{niceTicks:l}}if(a&&i==="number"){var d=e.domain(),f=nU(d,a,s);return{niceTicks:f}}return null};function As(t){var e=t.axis,n=t.ticks,r=t.bandSize,i=t.entry,a=t.index,o=t.dataKey;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!ce(i[e.dataKey])){var s=es(n,"value",i[e.dataKey]);if(s)return s.coordinate+r/2}return n[a]?n[a].coordinate+r/2:null}var c=ut(i,ce(o)?e.dataKey:o);return ce(c)?null:e.scale(c)}var og=function(e){var n=e.axis,r=e.ticks,i=e.offset,a=e.bandSize,o=e.entry,s=e.index;if(n.type==="category")return r[s]?r[s].coordinate+i:null;var c=ut(o,n.dataKey,n.domain[s]);return ce(c)?null:n.scale(c)-a/2+i},WU=function(e){var n=e.numericAxis,r=n.scale.domain();if(n.type==="number"){var i=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return i<=0&&a>=0?0:a<0?a:i}return r[0]},zU=function(e,n){var r,i=(r=e.type)!==null&&r!==void 0&&r.defaultProps?De(De({},e.type.defaultProps),e.props):e.props,a=i.stackId;if(Ke(a)){var o=n[a];if(o){var s=o.items.indexOf(e);return s>=0?o.stackedData[s]:null}}return null},GU=function(e){return e.reduce(function(n,r){return[Ac(r.concat([n[0]]).filter(H)),Wn(r.concat([n[1]]).filter(H))]},[1/0,-1/0])},mS=function(e,n,r){return Object.keys(e).reduce(function(i,a){var o=e[a],s=o.stackedData,c=s.reduce(function(u,l){var d=GU(l.slice(n,r+1));return[Math.min(u[0],d[0]),Math.max(u[1],d[1])]},[1/0,-1/0]);return[Math.min(c[0],i[0]),Math.max(c[1],i[1])]},[1/0,-1/0]).map(function(i){return i===1/0||i===-1/0?0:i})},sg=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,cg=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ul=function(e,n,r){if(ne(e))return e(n,r);if(!Array.isArray(e))return n;var i=[];if(H(e[0]))i[0]=r?e[0]:Math.min(e[0],n[0]);else if(sg.test(e[0])){var a=+sg.exec(e[0])[1];i[0]=n[0]-a}else ne(e[0])?i[0]=e[0](n[0]):i[0]=n[0];if(H(e[1]))i[1]=r?e[1]:Math.max(e[1],n[1]);else if(cg.test(e[1])){var o=+cg.exec(e[1])[1];i[1]=n[1]+o}else ne(e[1])?i[1]=e[1](n[1]):i[1]=n[1];return i},Is=function(e,n,r){if(e&&e.scale&&e.scale.bandwidth){var i=e.scale.bandwidth();if(!r||i>0)return i}if(e&&n&&n.length>=2){for(var a=yf(n,function(d){return d.coordinate}),o=1/0,s=1,c=a.length;s<c;s++){var u=a[s],l=a[s-1];o=Math.min((u.coordinate||0)-(l.coordinate||0),o)}return o===1/0?0:o}return r?void 0:0},ug=function(e,n,r){return!e||!e.length||gi(e,Dt(r,"type.defaultProps.domain"))?n:e},gS=function(e,n){var r=e.type.defaultProps?De(De({},e.type.defaultProps),e.props):e.props,i=r.dataKey,a=r.name,o=r.unit,s=r.formatter,c=r.tooltipType,u=r.chartType,l=r.hide;return De(De({},ie(e,!1)),{},{dataKey:i,unit:o,formatter:s,name:a||i,color:Wf(e),value:ut(n,i),type:c,payload:n,chartType:u,hide:l})};function Ba(t){"@babel/helpers - typeof";return Ba=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ba(t)}function lg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function dg(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?lg(Object(n),!0).forEach(function(r){HU(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lg(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function HU(t,e,n){return e=KU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KU(t){var e=XU(t,"string");return Ba(e)=="symbol"?e:e+""}function XU(t,e){if(Ba(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ba(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Rs=Math.PI/180,YU=function(e){return e*180/Math.PI},tt=function(e,n,r,i){return{x:e+Math.cos(-Rs*i)*r,y:n+Math.sin(-Rs*i)*r}},JU=function(e,n){var r=e.x,i=e.y,a=n.x,o=n.y;return Math.sqrt(Math.pow(r-a,2)+Math.pow(i-o,2))},QU=function(e,n){var r=e.x,i=e.y,a=n.cx,o=n.cy,s=JU({x:r,y:i},{x:a,y:o});if(s<=0)return{radius:s};var c=(r-a)/s,u=Math.acos(c);return i>o&&(u=2*Math.PI-u),{radius:s,angle:YU(u),angleInRadian:u}},ZU=function(e){var n=e.startAngle,r=e.endAngle,i=Math.floor(n/360),a=Math.floor(r/360),o=Math.min(i,a);return{startAngle:n-o*360,endAngle:r-o*360}},eF=function(e,n){var r=n.startAngle,i=n.endAngle,a=Math.floor(r/360),o=Math.floor(i/360),s=Math.min(a,o);return e+s*360},fg=function(e,n){var r=e.x,i=e.y,a=QU({x:r,y:i},n),o=a.radius,s=a.angle,c=n.innerRadius,u=n.outerRadius;if(o<c||o>u)return!1;if(o===0)return!0;var l=ZU(n),d=l.startAngle,f=l.endAngle,h=s,m;if(d<=f){for(;h>f;)h-=360;for(;h<d;)h+=360;m=h>=d&&h<=f}else{for(;h>d;)h-=360;for(;h<f;)h+=360;m=h>=f&&h<=d}return m?dg(dg({},n),{},{radius:o,angle:eF(h,n)}):null};function Ua(t){"@babel/helpers - typeof";return Ua=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ua(t)}var tF=["offset"];function nF(t){return oF(t)||aF(t)||iF(t)||rF()}function rF(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iF(t,e){if(t){if(typeof t=="string")return Fl(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fl(t,e)}}function aF(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function oF(t){if(Array.isArray(t))return Fl(t)}function Fl(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function sF(t,e){if(t==null)return{};var n=cF(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function cF(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function hg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function ze(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?hg(Object(n),!0).forEach(function(r){uF(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):hg(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function uF(t,e,n){return e=lF(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lF(t){var e=dF(t,"string");return Ua(e)=="symbol"?e:e+""}function dF(t,e){if(Ua(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ua(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fa(){return Fa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Fa.apply(this,arguments)}var fF=function(e){var n=e.value,r=e.formatter,i=ce(e.children)?n:e.children;return ne(r)?r(i):i},hF=function(e,n){var r=Gt(n-e),i=Math.min(Math.abs(n-e),360);return r*i},pF=function(e,n,r){var i=e.position,a=e.viewBox,o=e.offset,s=e.className,c=a,u=c.cx,l=c.cy,d=c.innerRadius,f=c.outerRadius,h=c.startAngle,m=c.endAngle,p=c.clockWise,v=(d+f)/2,b=hF(h,m),k=b>=0?1:-1,T,S;i==="insideStart"?(T=h+k*o,S=p):i==="insideEnd"?(T=m-k*o,S=!p):i==="end"&&(T=m+k*o,S=p),S=b<=0?S:!S;var g=tt(u,l,v,T),y=tt(u,l,v,T+(S?1:-1)*359),w="M".concat(g.x,",").concat(g.y,`
    A`).concat(v,",").concat(v,",0,1,").concat(S?0:1,`,
    `).concat(y.x,",").concat(y.y),C=ce(e.id)?$i("recharts-radial-line-"):e.id;return O.createElement("text",Fa({},r,{dominantBaseline:"central",className:he("recharts-radial-bar-label",s)}),O.createElement("defs",null,O.createElement("path",{id:C,d:w})),O.createElement("textPath",{xlinkHref:"#".concat(C)},n))},mF=function(e){var n=e.viewBox,r=e.offset,i=e.position,a=n,o=a.cx,s=a.cy,c=a.innerRadius,u=a.outerRadius,l=a.startAngle,d=a.endAngle,f=(l+d)/2;if(i==="outside"){var h=tt(o,s,u+r,f),m=h.x,p=h.y;return{x:m,y:p,textAnchor:m>=o?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:o,y:s,textAnchor:"middle",verticalAnchor:"end"};var v=(c+u)/2,b=tt(o,s,v,f),k=b.x,T=b.y;return{x:k,y:T,textAnchor:"middle",verticalAnchor:"middle"}},gF=function(e){var n=e.viewBox,r=e.parentViewBox,i=e.offset,a=e.position,o=n,s=o.x,c=o.y,u=o.width,l=o.height,d=l>=0?1:-1,f=d*i,h=d>0?"end":"start",m=d>0?"start":"end",p=u>=0?1:-1,v=p*i,b=p>0?"end":"start",k=p>0?"start":"end";if(a==="top"){var T={x:s+u/2,y:c-d*i,textAnchor:"middle",verticalAnchor:h};return ze(ze({},T),r?{height:Math.max(c-r.y,0),width:u}:{})}if(a==="bottom"){var S={x:s+u/2,y:c+l+f,textAnchor:"middle",verticalAnchor:m};return ze(ze({},S),r?{height:Math.max(r.y+r.height-(c+l),0),width:u}:{})}if(a==="left"){var g={x:s-v,y:c+l/2,textAnchor:b,verticalAnchor:"middle"};return ze(ze({},g),r?{width:Math.max(g.x-r.x,0),height:l}:{})}if(a==="right"){var y={x:s+u+v,y:c+l/2,textAnchor:k,verticalAnchor:"middle"};return ze(ze({},y),r?{width:Math.max(r.x+r.width-y.x,0),height:l}:{})}var w=r?{width:u,height:l}:{};return a==="insideLeft"?ze({x:s+v,y:c+l/2,textAnchor:k,verticalAnchor:"middle"},w):a==="insideRight"?ze({x:s+u-v,y:c+l/2,textAnchor:b,verticalAnchor:"middle"},w):a==="insideTop"?ze({x:s+u/2,y:c+f,textAnchor:"middle",verticalAnchor:m},w):a==="insideBottom"?ze({x:s+u/2,y:c+l-f,textAnchor:"middle",verticalAnchor:h},w):a==="insideTopLeft"?ze({x:s+v,y:c+f,textAnchor:k,verticalAnchor:m},w):a==="insideTopRight"?ze({x:s+u-v,y:c+f,textAnchor:b,verticalAnchor:m},w):a==="insideBottomLeft"?ze({x:s+v,y:c+l-f,textAnchor:k,verticalAnchor:h},w):a==="insideBottomRight"?ze({x:s+u-v,y:c+l-f,textAnchor:b,verticalAnchor:h},w):Mi(a)&&(H(a.x)||hr(a.x))&&(H(a.y)||hr(a.y))?ze({x:s+wr(a.x,u),y:c+wr(a.y,l),textAnchor:"end",verticalAnchor:"end"},w):ze({x:s+u/2,y:c+l/2,textAnchor:"middle",verticalAnchor:"middle"},w)},vF=function(e){return"cx"in e&&H(e.cx)};function it(t){var e=t.offset,n=e===void 0?5:e,r=sF(t,tF),i=ze({offset:n},r),a=i.viewBox,o=i.position,s=i.value,c=i.children,u=i.content,l=i.className,d=l===void 0?"":l,f=i.textBreakAll;if(!a||ce(s)&&ce(c)&&!K.isValidElement(u)&&!ne(u))return null;if(K.isValidElement(u))return K.cloneElement(u,i);var h;if(ne(u)){if(h=K.createElement(u,i),K.isValidElement(h))return h}else h=fF(i);var m=vF(a),p=ie(i,!0);if(m&&(o==="insideStart"||o==="insideEnd"||o==="end"))return pF(i,h,p);var v=m?mF(i):gF(i);return O.createElement(gs,Fa({className:he("recharts-label",d)},p,v,{breakAll:f}),h)}it.displayName="Label";var vS=function(e){var n=e.cx,r=e.cy,i=e.angle,a=e.startAngle,o=e.endAngle,s=e.r,c=e.radius,u=e.innerRadius,l=e.outerRadius,d=e.x,f=e.y,h=e.top,m=e.left,p=e.width,v=e.height,b=e.clockWise,k=e.labelViewBox;if(k)return k;if(H(p)&&H(v)){if(H(d)&&H(f))return{x:d,y:f,width:p,height:v};if(H(h)&&H(m))return{x:h,y:m,width:p,height:v}}return H(d)&&H(f)?{x:d,y:f,width:0,height:0}:H(n)&&H(r)?{cx:n,cy:r,startAngle:a||i||0,endAngle:o||i||0,innerRadius:u||0,outerRadius:l||c||s||0,clockWise:b}:e.viewBox?e.viewBox:{}},yF=function(e,n){return e?e===!0?O.createElement(it,{key:"label-implicit",viewBox:n}):Ke(e)?O.createElement(it,{key:"label-implicit",viewBox:n,value:e}):K.isValidElement(e)?e.type===it?K.cloneElement(e,{key:"label-implicit",viewBox:n}):O.createElement(it,{key:"label-implicit",content:e,viewBox:n}):ne(e)?O.createElement(it,{key:"label-implicit",content:e,viewBox:n}):Mi(e)?O.createElement(it,Fa({viewBox:n},e,{key:"label-implicit"})):null:null},bF=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var i=e.children,a=vS(e),o=Nt(i,it).map(function(c,u){return K.cloneElement(c,{viewBox:n||a,key:"label-".concat(u)})});if(!r)return o;var s=yF(e.label,n||a);return[s].concat(nF(o))};it.parseViewBox=vS;it.renderCallByParent=bF;function SF(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var TF=SF;const kF=_e(TF);function qa(t){"@babel/helpers - typeof";return qa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qa(t)}var wF=["valueAccessor"],CF=["data","dataKey","clockWise","id","textBreakAll"];function _F(t){return EF(t)||OF(t)||PF(t)||xF()}function xF(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PF(t,e){if(t){if(typeof t=="string")return ql(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ql(t,e)}}function OF(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function EF(t){if(Array.isArray(t))return ql(t)}function ql(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ms(){return Ms=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ms.apply(this,arguments)}function pg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function mg(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?pg(Object(n),!0).forEach(function(r){AF(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pg(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function AF(t,e,n){return e=IF(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IF(t){var e=RF(t,"string");return qa(e)=="symbol"?e:e+""}function RF(t,e){if(qa(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(qa(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gg(t,e){if(t==null)return{};var n=MF(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function MF(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var DF=function(e){return Array.isArray(e.value)?kF(e.value):e.value};function Pn(t){var e=t.valueAccessor,n=e===void 0?DF:e,r=gg(t,wF),i=r.data,a=r.dataKey,o=r.clockWise,s=r.id,c=r.textBreakAll,u=gg(r,CF);return!i||!i.length?null:O.createElement(Ce,{className:"recharts-label-list"},i.map(function(l,d){var f=ce(a)?n(l,d):ut(l&&l.payload,a),h=ce(s)?{}:{id:"".concat(s,"-").concat(d)};return O.createElement(it,Ms({},ie(l,!0),u,h,{parentViewBox:l.parentViewBox,value:f,textBreakAll:c,viewBox:it.parseViewBox(ce(o)?l:mg(mg({},l),{},{clockWise:o})),key:"label-".concat(d),index:d}))}))}Pn.displayName="LabelList";function NF(t,e){return t?t===!0?O.createElement(Pn,{key:"labelList-implicit",data:e}):O.isValidElement(t)||ne(t)?O.createElement(Pn,{key:"labelList-implicit",data:e,content:t}):Mi(t)?O.createElement(Pn,Ms({data:e},t,{key:"labelList-implicit"})):null:null}function LF(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var r=t.children,i=Nt(r,Pn).map(function(o,s){return K.cloneElement(o,{data:e,key:"labelList-".concat(s)})});if(!n)return i;var a=NF(t.label,e);return[a].concat(_F(i))}Pn.renderCallByParent=LF;function Va(t){"@babel/helpers - typeof";return Va=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Va(t)}function Vl(){return Vl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Vl.apply(this,arguments)}function vg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function yg(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?vg(Object(n),!0).forEach(function(r){jF(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vg(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function jF(t,e,n){return e=$F(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $F(t){var e=BF(t,"string");return Va(e)=="symbol"?e:e+""}function BF(t,e){if(Va(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Va(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var UF=function(e,n){var r=Gt(n-e),i=Math.min(Math.abs(n-e),359.999);return r*i},Oo=function(e){var n=e.cx,r=e.cy,i=e.radius,a=e.angle,o=e.sign,s=e.isExternal,c=e.cornerRadius,u=e.cornerIsExternal,l=c*(s?1:-1)+i,d=Math.asin(c/l)/Rs,f=u?a:a+o*d,h=tt(n,r,l,f),m=tt(n,r,i,f),p=u?a-o*d:a,v=tt(n,r,l*Math.cos(d*Rs),p);return{center:h,circleTangency:m,lineTangency:v,theta:d}},yS=function(e){var n=e.cx,r=e.cy,i=e.innerRadius,a=e.outerRadius,o=e.startAngle,s=e.endAngle,c=UF(o,s),u=o+c,l=tt(n,r,a,o),d=tt(n,r,a,u),f="M ".concat(l.x,",").concat(l.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(o>u),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(i>0){var h=tt(n,r,i,o),m=tt(n,r,i,u);f+="L ".concat(m.x,",").concat(m.y,`
            A `).concat(i,",").concat(i,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(o<=u),`,
            `).concat(h.x,",").concat(h.y," Z")}else f+="L ".concat(n,",").concat(r," Z");return f},FF=function(e){var n=e.cx,r=e.cy,i=e.innerRadius,a=e.outerRadius,o=e.cornerRadius,s=e.forceCornerRadius,c=e.cornerIsExternal,u=e.startAngle,l=e.endAngle,d=Gt(l-u),f=Oo({cx:n,cy:r,radius:a,angle:u,sign:d,cornerRadius:o,cornerIsExternal:c}),h=f.circleTangency,m=f.lineTangency,p=f.theta,v=Oo({cx:n,cy:r,radius:a,angle:l,sign:-d,cornerRadius:o,cornerIsExternal:c}),b=v.circleTangency,k=v.lineTangency,T=v.theta,S=c?Math.abs(u-l):Math.abs(u-l)-p-T;if(S<0)return s?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):yS({cx:n,cy:r,innerRadius:i,outerRadius:a,startAngle:u,endAngle:l});var g="M ".concat(m.x,",").concat(m.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(S>180),",").concat(+(d<0),",").concat(b.x,",").concat(b.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(k.x,",").concat(k.y,`
  `);if(i>0){var y=Oo({cx:n,cy:r,radius:i,angle:u,sign:d,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),w=y.circleTangency,C=y.lineTangency,_=y.theta,A=Oo({cx:n,cy:r,radius:i,angle:l,sign:-d,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),P=A.circleTangency,E=A.lineTangency,M=A.theta,N=c?Math.abs(u-l):Math.abs(u-l)-_-M;if(N<0&&o===0)return"".concat(g,"L").concat(n,",").concat(r,"Z");g+="L".concat(E.x,",").concat(E.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(P.x,",").concat(P.y,`
      A`).concat(i,",").concat(i,",0,").concat(+(N>180),",").concat(+(d>0),",").concat(w.x,",").concat(w.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(C.x,",").concat(C.y,"Z")}else g+="L".concat(n,",").concat(r,"Z");return g},qF={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},bS=function(e){var n=yg(yg({},qF),e),r=n.cx,i=n.cy,a=n.innerRadius,o=n.outerRadius,s=n.cornerRadius,c=n.forceCornerRadius,u=n.cornerIsExternal,l=n.startAngle,d=n.endAngle,f=n.className;if(o<a||l===d)return null;var h=he("recharts-sector",f),m=o-a,p=wr(s,m,0,!0),v;return p>0&&Math.abs(l-d)<360?v=FF({cx:r,cy:i,innerRadius:a,outerRadius:o,cornerRadius:Math.min(p,m/2),forceCornerRadius:c,cornerIsExternal:u,startAngle:l,endAngle:d}):v=yS({cx:r,cy:i,innerRadius:a,outerRadius:o,startAngle:l,endAngle:d}),O.createElement("path",Vl({},ie(n,!0),{className:h,d:v,role:"img"}))};function Wa(t){"@babel/helpers - typeof";return Wa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wa(t)}function Wl(){return Wl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Wl.apply(this,arguments)}function bg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Sg(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?bg(Object(n),!0).forEach(function(r){VF(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bg(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function VF(t,e,n){return e=WF(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WF(t){var e=zF(t,"string");return Wa(e)=="symbol"?e:e+""}function zF(t,e){if(Wa(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Wa(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Tg={curveBasisClosed:GO,curveBasisOpen:HO,curveBasis:zO,curveBumpX:IO,curveBumpY:RO,curveLinearClosed:KO,curveLinear:bc,curveMonotoneX:XO,curveMonotoneY:YO,curveNatural:JO,curveStep:QO,curveStepAfter:eE,curveStepBefore:ZO},Eo=function(e){return e.x===+e.x&&e.y===+e.y},ea=function(e){return e.x},ta=function(e){return e.y},GF=function(e,n){if(ne(e))return e;var r="curve".concat(vc(e));return(r==="curveMonotone"||r==="curveBump")&&n?Tg["".concat(r).concat(n==="vertical"?"Y":"X")]:Tg[r]||bc},HF=function(e){var n=e.type,r=n===void 0?"linear":n,i=e.points,a=i===void 0?[]:i,o=e.baseLine,s=e.layout,c=e.connectNulls,u=c===void 0?!1:c,l=GF(r,s),d=u?a.filter(function(p){return Eo(p)}):a,f;if(Array.isArray(o)){var h=u?o.filter(function(p){return Eo(p)}):o,m=d.map(function(p,v){return Sg(Sg({},p),{},{base:h[v]})});return s==="vertical"?f=bo().y(ta).x1(ea).x0(function(p){return p.base.x}):f=bo().x(ea).y1(ta).y0(function(p){return p.base.y}),f.defined(Eo).curve(l),f(m)}return s==="vertical"&&H(o)?f=bo().y(ta).x1(ea).x0(o):H(o)?f=bo().x(ea).y1(ta).y0(o):f=bb().x(ea).y(ta),f.defined(Eo).curve(l),f(d)},ni=function(e){var n=e.className,r=e.points,i=e.path,a=e.pathRef;if((!r||!r.length)&&!i)return null;var o=r&&r.length?HF(e):i;return K.createElement("path",Wl({},ie(e,!1),ts(e),{className:he("recharts-curve",n),d:o,ref:a}))},SS={exports:{}},KF="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",XF=KF,YF=XF;function TS(){}function kS(){}kS.resetWarningCache=TS;var JF=function(){function t(r,i,a,o,s,c){if(c!==YF){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:kS,resetWarningCache:TS};return n.PropTypes=n,n};SS.exports=JF();var QF=SS.exports;const zK=_e(QF);var ZF=Object.getOwnPropertyNames,e3=Object.getOwnPropertySymbols,t3=Object.prototype.hasOwnProperty;function kg(t,e){return function(r,i,a){return t(r,i,a)&&e(r,i,a)}}function Ao(t){return function(n,r,i){if(!n||!r||typeof n!="object"||typeof r!="object")return t(n,r,i);var a=i.cache,o=a.get(n),s=a.get(r);if(o&&s)return o===r&&s===n;a.set(n,r),a.set(r,n);var c=t(n,r,i);return a.delete(n),a.delete(r),c}}function n3(t){return t!=null?t[Symbol.toStringTag]:void 0}function wg(t){return ZF(t).concat(e3(t))}var r3=Object.hasOwn||function(t,e){return t3.call(t,e)};function Dr(t,e){return t===e||!t&&!e&&t!==t&&e!==e}var i3="__v",a3="__o",o3="_owner",Cg=Object.getOwnPropertyDescriptor,_g=Object.keys;function s3(t,e,n){var r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function c3(t,e){return Dr(t.getTime(),e.getTime())}function u3(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function l3(t,e){return t===e}function xg(t,e,n){var r=t.size;if(r!==e.size)return!1;if(!r)return!0;for(var i=new Array(r),a=t.entries(),o,s,c=0;(o=a.next())&&!o.done;){for(var u=e.entries(),l=!1,d=0;(s=u.next())&&!s.done;){if(i[d]){d++;continue}var f=o.value,h=s.value;if(n.equals(f[0],h[0],c,d,t,e,n)&&n.equals(f[1],h[1],f[0],h[0],t,e,n)){l=i[d]=!0;break}d++}if(!l)return!1;c++}return!0}var d3=Dr;function f3(t,e,n){var r=_g(t),i=r.length;if(_g(e).length!==i)return!1;for(;i-- >0;)if(!wS(t,e,n,r[i]))return!1;return!0}function na(t,e,n){var r=wg(t),i=r.length;if(wg(e).length!==i)return!1;for(var a,o,s;i-- >0;)if(a=r[i],!wS(t,e,n,a)||(o=Cg(t,a),s=Cg(e,a),(o||s)&&(!o||!s||o.configurable!==s.configurable||o.enumerable!==s.enumerable||o.writable!==s.writable)))return!1;return!0}function h3(t,e){return Dr(t.valueOf(),e.valueOf())}function p3(t,e){return t.source===e.source&&t.flags===e.flags}function Pg(t,e,n){var r=t.size;if(r!==e.size)return!1;if(!r)return!0;for(var i=new Array(r),a=t.values(),o,s;(o=a.next())&&!o.done;){for(var c=e.values(),u=!1,l=0;(s=c.next())&&!s.done;){if(!i[l]&&n.equals(o.value,s.value,o.value,s.value,t,e,n)){u=i[l]=!0;break}l++}if(!u)return!1}return!0}function m3(t,e){var n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function g3(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function wS(t,e,n,r){return(r===o3||r===a3||r===i3)&&(t.$$typeof||e.$$typeof)?!0:r3(e,r)&&n.equals(t[r],e[r],r,r,t,e,n)}var v3="[object Arguments]",y3="[object Boolean]",b3="[object Date]",S3="[object Error]",T3="[object Map]",k3="[object Number]",w3="[object Object]",C3="[object RegExp]",_3="[object Set]",x3="[object String]",P3="[object URL]",O3=Array.isArray,Og=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Eg=Object.assign,E3=Object.prototype.toString.call.bind(Object.prototype.toString);function A3(t){var e=t.areArraysEqual,n=t.areDatesEqual,r=t.areErrorsEqual,i=t.areFunctionsEqual,a=t.areMapsEqual,o=t.areNumbersEqual,s=t.areObjectsEqual,c=t.arePrimitiveWrappersEqual,u=t.areRegExpsEqual,l=t.areSetsEqual,d=t.areTypedArraysEqual,f=t.areUrlsEqual,h=t.unknownTagComparators;return function(p,v,b){if(p===v)return!0;if(p==null||v==null)return!1;var k=typeof p;if(k!==typeof v)return!1;if(k!=="object")return k==="number"?o(p,v,b):k==="function"?i(p,v,b):!1;var T=p.constructor;if(T!==v.constructor)return!1;if(T===Object)return s(p,v,b);if(O3(p))return e(p,v,b);if(Og!=null&&Og(p))return d(p,v,b);if(T===Date)return n(p,v,b);if(T===RegExp)return u(p,v,b);if(T===Map)return a(p,v,b);if(T===Set)return l(p,v,b);var S=E3(p);if(S===b3)return n(p,v,b);if(S===C3)return u(p,v,b);if(S===T3)return a(p,v,b);if(S===_3)return l(p,v,b);if(S===w3)return typeof p.then!="function"&&typeof v.then!="function"&&s(p,v,b);if(S===P3)return f(p,v,b);if(S===S3)return r(p,v,b);if(S===v3)return s(p,v,b);if(S===y3||S===k3||S===x3)return c(p,v,b);if(h){var g=h[S];if(!g){var y=n3(p);y&&(g=h[y])}if(g)return g(p,v,b)}return!1}}function I3(t){var e=t.circular,n=t.createCustomConfig,r=t.strict,i={areArraysEqual:r?na:s3,areDatesEqual:c3,areErrorsEqual:u3,areFunctionsEqual:l3,areMapsEqual:r?kg(xg,na):xg,areNumbersEqual:d3,areObjectsEqual:r?na:f3,arePrimitiveWrappersEqual:h3,areRegExpsEqual:p3,areSetsEqual:r?kg(Pg,na):Pg,areTypedArraysEqual:r?na:m3,areUrlsEqual:g3,unknownTagComparators:void 0};if(n&&(i=Eg({},i,n(i))),e){var a=Ao(i.areArraysEqual),o=Ao(i.areMapsEqual),s=Ao(i.areObjectsEqual),c=Ao(i.areSetsEqual);i=Eg({},i,{areArraysEqual:a,areMapsEqual:o,areObjectsEqual:s,areSetsEqual:c})}return i}function R3(t){return function(e,n,r,i,a,o,s){return t(e,n,s)}}function M3(t){var e=t.circular,n=t.comparator,r=t.createState,i=t.equals,a=t.strict;if(r)return function(c,u){var l=r(),d=l.cache,f=d===void 0?e?new WeakMap:void 0:d,h=l.meta;return n(c,u,{cache:f,equals:i,meta:h,strict:a})};if(e)return function(c,u){return n(c,u,{cache:new WeakMap,equals:i,meta:void 0,strict:a})};var o={cache:void 0,equals:i,meta:void 0,strict:a};return function(c,u){return n(c,u,o)}}var GK=rr();rr({strict:!0});rr({circular:!0});rr({circular:!0,strict:!0});rr({createInternalComparator:function(){return Dr}});rr({strict:!0,createInternalComparator:function(){return Dr}});rr({circular:!0,createInternalComparator:function(){return Dr}});rr({circular:!0,createInternalComparator:function(){return Dr},strict:!0});function rr(t){t===void 0&&(t={});var e=t.circular,n=e===void 0?!1:e,r=t.createInternalComparator,i=t.createState,a=t.strict,o=a===void 0?!1:a,s=I3(t),c=A3(s),u=r?r(c):R3(c);return M3({circular:n,comparator:c,createState:i,equals:u,strict:o})}function za(t){"@babel/helpers - typeof";return za=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},za(t)}function Ds(){return Ds=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ds.apply(this,arguments)}function D3(t,e){return $3(t)||j3(t,e)||L3(t,e)||N3()}function N3(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L3(t,e){if(t){if(typeof t=="string")return Ag(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ag(t,e)}}function Ag(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function j3(t,e){var n=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,a,o,s=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(l){u=!0,i=l}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function $3(t){if(Array.isArray(t))return t}function Ig(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Rg(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ig(Object(n),!0).forEach(function(r){B3(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ig(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function B3(t,e,n){return e=U3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U3(t){var e=F3(t,"string");return za(e)=="symbol"?e:e+""}function F3(t,e){if(za(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(za(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Mg=function(e,n,r,i,a){var o=Math.min(Math.abs(r)/2,Math.abs(i)/2),s=i>=0?1:-1,c=r>=0?1:-1,u=i>=0&&r>=0||i<0&&r<0?1:0,l;if(o>0&&a instanceof Array){for(var d=[0,0,0,0],f=0,h=4;f<h;f++)d[f]=a[f]>o?o:a[f];l="M".concat(e,",").concat(n+s*d[0]),d[0]>0&&(l+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(u,",").concat(e+c*d[0],",").concat(n)),l+="L ".concat(e+r-c*d[1],",").concat(n),d[1]>0&&(l+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(u,`,
        `).concat(e+r,",").concat(n+s*d[1])),l+="L ".concat(e+r,",").concat(n+i-s*d[2]),d[2]>0&&(l+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(u,`,
        `).concat(e+r-c*d[2],",").concat(n+i)),l+="L ".concat(e+c*d[3],",").concat(n+i),d[3]>0&&(l+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(u,`,
        `).concat(e,",").concat(n+i-s*d[3])),l+="Z"}else if(o>0&&a===+a&&a>0){var m=Math.min(o,a);l="M ".concat(e,",").concat(n+s*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(u,",").concat(e+c*m,",").concat(n,`
            L `).concat(e+r-c*m,",").concat(n,`
            A `).concat(m,",").concat(m,",0,0,").concat(u,",").concat(e+r,",").concat(n+s*m,`
            L `).concat(e+r,",").concat(n+i-s*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(u,",").concat(e+r-c*m,",").concat(n+i,`
            L `).concat(e+c*m,",").concat(n+i,`
            A `).concat(m,",").concat(m,",0,0,").concat(u,",").concat(e,",").concat(n+i-s*m," Z")}else l="M ".concat(e,",").concat(n," h ").concat(r," v ").concat(i," h ").concat(-r," Z");return l},q3=function(e,n){if(!e||!n)return!1;var r=e.x,i=e.y,a=n.x,o=n.y,s=n.width,c=n.height;if(Math.abs(s)>0&&Math.abs(c)>0){var u=Math.min(a,a+s),l=Math.max(a,a+s),d=Math.min(o,o+c),f=Math.max(o,o+c);return r>=u&&r<=l&&i>=d&&i<=f}return!1},V3={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},zf=function(e){var n=Rg(Rg({},V3),e),r=K.useRef(),i=K.useState(-1),a=D3(i,2),o=a[0],s=a[1];K.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var S=r.current.getTotalLength();S&&s(S)}catch(g){}},[]);var c=n.x,u=n.y,l=n.width,d=n.height,f=n.radius,h=n.className,m=n.animationEasing,p=n.animationDuration,v=n.animationBegin,b=n.isAnimationActive,k=n.isUpdateAnimationActive;if(c!==+c||u!==+u||l!==+l||d!==+d||l===0||d===0)return null;var T=he("recharts-rectangle",h);return k?O.createElement(Tr,{canBegin:o>0,from:{width:l,height:d,x:c,y:u},to:{width:l,height:d,x:c,y:u},duration:p,animationEasing:m,isActive:k},function(S){var g=S.width,y=S.height,w=S.x,C=S.y;return O.createElement(Tr,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:v,duration:p,isActive:b,easing:m},O.createElement("path",Ds({},ie(n,!0),{className:T,d:Mg(w,C,g,y,f),ref:r})))}):O.createElement("path",Ds({},ie(n,!0),{className:T,d:Mg(c,u,l,d,f)}))};function zl(){return zl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},zl.apply(this,arguments)}var Mc=function(e){var n=e.cx,r=e.cy,i=e.r,a=e.className,o=he("recharts-dot",a);return n===+n&&r===+r&&i===+i?K.createElement("circle",zl({},ie(e,!1),ts(e),{className:o,cx:n,cy:r,r:i})):null};function Ga(t){"@babel/helpers - typeof";return Ga=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ga(t)}var W3=["x","y","top","left","width","height","className"];function Gl(){return Gl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Gl.apply(this,arguments)}function Dg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function z3(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Dg(Object(n),!0).forEach(function(r){G3(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Dg(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function G3(t,e,n){return e=H3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H3(t){var e=K3(t,"string");return Ga(e)=="symbol"?e:e+""}function K3(t,e){if(Ga(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ga(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function X3(t,e){if(t==null)return{};var n=Y3(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Y3(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var J3=function(e,n,r,i,a,o){return"M".concat(e,",").concat(a,"v").concat(i,"M").concat(o,",").concat(n,"h").concat(r)},Q3=function(e){var n=e.x,r=n===void 0?0:n,i=e.y,a=i===void 0?0:i,o=e.top,s=o===void 0?0:o,c=e.left,u=c===void 0?0:c,l=e.width,d=l===void 0?0:l,f=e.height,h=f===void 0?0:f,m=e.className,p=X3(e,W3),v=z3({x:r,y:a,top:s,left:u,width:d,height:h},p);return!H(r)||!H(a)||!H(d)||!H(h)||!H(s)||!H(u)?null:O.createElement("path",Gl({},ie(v,!0),{className:he("recharts-cross",m),d:J3(r,a,d,h,s,u)}))},Z3=Vb,eq=Z3(Object.getPrototypeOf,Object),tq=eq,nq=Rn,rq=tq,iq=Mn,aq="[object Object]",oq=Function.prototype,sq=Object.prototype,CS=oq.toString,cq=sq.hasOwnProperty,uq=CS.call(Object);function lq(t){if(!iq(t)||nq(t)!=aq)return!1;var e=rq(t);if(e===null)return!0;var n=cq.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&CS.call(n)==uq}var dq=lq;const fq=_e(dq);var hq=Rn,pq=Mn,mq="[object Boolean]";function gq(t){return t===!0||t===!1||pq(t)&&hq(t)==mq}var vq=gq;const yq=_e(vq);function Ha(t){"@babel/helpers - typeof";return Ha=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ha(t)}function Ns(){return Ns=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ns.apply(this,arguments)}function bq(t,e){return wq(t)||kq(t,e)||Tq(t,e)||Sq()}function Sq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tq(t,e){if(t){if(typeof t=="string")return Ng(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ng(t,e)}}function Ng(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function kq(t,e){var n=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,a,o,s=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(l){u=!0,i=l}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function wq(t){if(Array.isArray(t))return t}function Lg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function jg(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Lg(Object(n),!0).forEach(function(r){Cq(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Lg(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Cq(t,e,n){return e=_q(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _q(t){var e=xq(t,"string");return Ha(e)=="symbol"?e:e+""}function xq(t,e){if(Ha(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ha(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $g=function(e,n,r,i,a){var o=r-i,s;return s="M ".concat(e,",").concat(n),s+="L ".concat(e+r,",").concat(n),s+="L ".concat(e+r-o/2,",").concat(n+a),s+="L ".concat(e+r-o/2-i,",").concat(n+a),s+="L ".concat(e,",").concat(n," Z"),s},Pq={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Oq=function(e){var n=jg(jg({},Pq),e),r=K.useRef(),i=K.useState(-1),a=bq(i,2),o=a[0],s=a[1];K.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var T=r.current.getTotalLength();T&&s(T)}catch(S){}},[]);var c=n.x,u=n.y,l=n.upperWidth,d=n.lowerWidth,f=n.height,h=n.className,m=n.animationEasing,p=n.animationDuration,v=n.animationBegin,b=n.isUpdateAnimationActive;if(c!==+c||u!==+u||l!==+l||d!==+d||f!==+f||l===0&&d===0||f===0)return null;var k=he("recharts-trapezoid",h);return b?O.createElement(Tr,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:f,x:c,y:u},to:{upperWidth:l,lowerWidth:d,height:f,x:c,y:u},duration:p,animationEasing:m,isActive:b},function(T){var S=T.upperWidth,g=T.lowerWidth,y=T.height,w=T.x,C=T.y;return O.createElement(Tr,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:v,duration:p,easing:m},O.createElement("path",Ns({},ie(n,!0),{className:k,d:$g(w,C,S,g,y),ref:r})))}):O.createElement("g",null,O.createElement("path",Ns({},ie(n,!0),{className:k,d:$g(c,u,l,d,f)})))},Eq=["option","shapeType","propTransformer","activeClassName","isActive"];function Ka(t){"@babel/helpers - typeof";return Ka=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ka(t)}function Aq(t,e){if(t==null)return{};var n=Iq(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Iq(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Bg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Ls(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Bg(Object(n),!0).forEach(function(r){Rq(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Bg(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Rq(t,e,n){return e=Mq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mq(t){var e=Dq(t,"string");return Ka(e)=="symbol"?e:e+""}function Dq(t,e){if(Ka(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ka(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nq(t,e){return Ls(Ls({},e),t)}function Lq(t,e){return t==="symbols"}function Ug(t){var e=t.shapeType,n=t.elementProps;switch(e){case"rectangle":return O.createElement(zf,n);case"trapezoid":return O.createElement(Oq,n);case"sector":return O.createElement(bS,n);case"symbols":if(Lq(e))return O.createElement(lf,n);break;default:return null}}function jq(t){return K.isValidElement(t)?t.props:t}function $q(t){var e=t.option,n=t.shapeType,r=t.propTransformer,i=r===void 0?Nq:r,a=t.activeClassName,o=a===void 0?"recharts-active-shape":a,s=t.isActive,c=Aq(t,Eq),u;if(K.isValidElement(e))u=K.cloneElement(e,Ls(Ls({},c),jq(e)));else if(ne(e))u=e(c);else if(fq(e)&&!yq(e)){var l=i(e,c);u=O.createElement(Ug,{shapeType:n,elementProps:l})}else{var d=c;u=O.createElement(Ug,{shapeType:n,elementProps:d})}return s?O.createElement(Ce,{className:o},u):u}function Dc(t,e){return e!=null&&"trapezoids"in t.props}function Nc(t,e){return e!=null&&"sectors"in t.props}function Xa(t,e){return e!=null&&"points"in t.props}function Bq(t,e){var n,r,i=t.x===(e==null||(n=e.labelViewBox)===null||n===void 0?void 0:n.x)||t.x===e.x,a=t.y===(e==null||(r=e.labelViewBox)===null||r===void 0?void 0:r.y)||t.y===e.y;return i&&a}function Uq(t,e){var n=t.endAngle===e.endAngle,r=t.startAngle===e.startAngle;return n&&r}function Fq(t,e){var n=t.x===e.x,r=t.y===e.y,i=t.z===e.z;return n&&r&&i}function qq(t,e){var n;return Dc(t,e)?n=Bq:Nc(t,e)?n=Uq:Xa(t,e)&&(n=Fq),n}function Vq(t,e){var n;return Dc(t,e)?n="trapezoids":Nc(t,e)?n="sectors":Xa(t,e)&&(n="points"),n}function Wq(t,e){if(Dc(t,e)){var n;return(n=e.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(Nc(t,e)){var r;return(r=e.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return Xa(t,e)?e.payload:{}}function zq(t){var e=t.activeTooltipItem,n=t.graphicalItem,r=t.itemData,i=Vq(n,e),a=Wq(n,e),o=r.filter(function(c,u){var l=gi(a,c),d=n.props[i].filter(function(m){var p=qq(n,e);return p(m,e)}),f=n.props[i].indexOf(d[d.length-1]),h=u===f;return l&&h}),s=r.indexOf(o[o.length-1]);return s}var Gq=Math.ceil,Hq=Math.max;function Kq(t,e,n,r){for(var i=-1,a=Hq(Gq((e-t)/(n||1)),0),o=Array(a);a--;)o[r?a:++i]=t,t+=n;return o}var Xq=Kq,Yq=c0,Fg=1/0,Jq=17976931348623157e292;function Qq(t){if(!t)return t===0?t:0;if(t=Yq(t),t===Fg||t===-Fg){var e=t<0?-1:1;return e*Jq}return t===t?t:0}var _S=Qq,Zq=Xq,eV=wc,Cu=_S;function tV(t){return function(e,n,r){return r&&typeof r!="number"&&eV(e,n,r)&&(n=r=void 0),e=Cu(e),n===void 0?(n=e,e=0):n=Cu(n),r=r===void 0?e<n?1:-1:Cu(r),Zq(e,n,r,t)}}var nV=tV,rV=nV,iV=rV(),aV=iV;const js=_e(aV);function Ya(t){"@babel/helpers - typeof";return Ya=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ya(t)}function qg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Vg(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?qg(Object(n),!0).forEach(function(r){xS(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qg(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function xS(t,e,n){return e=oV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oV(t){var e=sV(t,"string");return Ya(e)=="symbol"?e:e+""}function sV(t,e){if(Ya(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ya(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var cV=["Webkit","Moz","O","ms"],uV=function(e,n){if(!e)return null;var r=e.replace(/(\w)/,function(a){return a.toUpperCase()}),i=cV.reduce(function(a,o){return Vg(Vg({},a),{},xS({},o+r,n))},{});return i[e]=n,i};function yi(t){"@babel/helpers - typeof";return yi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yi(t)}function $s(){return $s=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},$s.apply(this,arguments)}function Wg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function _u(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Wg(Object(n),!0).forEach(function(r){St(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wg(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function lV(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,OS(r.key),r)}}function dV(t,e,n){return e&&zg(t.prototype,e),n&&zg(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function fV(t,e,n){return e=Bs(e),hV(t,PS()?Reflect.construct(e,n||[],Bs(t).constructor):e.apply(t,n))}function hV(t,e){if(e&&(yi(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pV(t)}function pV(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PS(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(PS=function(){return!!t})()}function Bs(t){return Bs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Bs(t)}function mV(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hl(t,e)}function Hl(t,e){return Hl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Hl(t,e)}function St(t,e,n){return e=OS(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OS(t){var e=gV(t,"string");return yi(e)=="symbol"?e:e+""}function gV(t,e){if(yi(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(yi(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vV=function(e){var n=e.data,r=e.startIndex,i=e.endIndex,a=e.x,o=e.width,s=e.travellerWidth;if(!n||!n.length)return{};var c=n.length,u=ma().domain(js(0,c)).range([a,a+o-s]),l=u.domain().map(function(d){return u(d)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(r),endX:u(i),scale:u,scaleValues:l}},Gg=function(e){return e.changedTouches&&!!e.changedTouches.length},bi=function(t){function e(n){var r;return lV(this,e),r=fV(this,e,[n]),St(r,"handleDrag",function(i){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(i):r.state.isSlideMoving&&r.handleSlideDrag(i)}),St(r,"handleTouchMove",function(i){i.changedTouches!=null&&i.changedTouches.length>0&&r.handleDrag(i.changedTouches[0])}),St(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var i=r.props,a=i.endIndex,o=i.onDragEnd,s=i.startIndex;o==null||o({endIndex:a,startIndex:s})}),r.detachDragEndListener()}),St(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),St(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),St(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),St(r,"handleSlideDragStart",function(i){var a=Gg(i)?i.changedTouches[0]:i;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:a.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return mV(e,t),dV(e,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(r){var i=r.startX,a=r.endX,o=this.state.scaleValues,s=this.props,c=s.gap,u=s.data,l=u.length-1,d=Math.min(i,a),f=Math.max(i,a),h=e.getIndexInRange(o,d),m=e.getIndexInRange(o,f);return{startIndex:h-h%c,endIndex:m===l?l:m-m%c}}},{key:"getTextOfTick",value:function(r){var i=this.props,a=i.data,o=i.tickFormatter,s=i.dataKey,c=ut(a[r],s,r);return ne(o)?o(c,r):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(r){var i=this.state,a=i.slideMoveStartX,o=i.startX,s=i.endX,c=this.props,u=c.x,l=c.width,d=c.travellerWidth,f=c.startIndex,h=c.endIndex,m=c.onChange,p=r.pageX-a;p>0?p=Math.min(p,u+l-d-s,u+l-d-o):p<0&&(p=Math.max(p,u-o,u-s));var v=this.getIndex({startX:o+p,endX:s+p});(v.startIndex!==f||v.endIndex!==h)&&m&&m(v),this.setState({startX:o+p,endX:s+p,slideMoveStartX:r.pageX})}},{key:"handleTravellerDragStart",value:function(r,i){var a=Gg(i)?i.changedTouches[0]:i;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:r,brushMoveStartX:a.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(r){var i=this.state,a=i.brushMoveStartX,o=i.movingTravellerId,s=i.endX,c=i.startX,u=this.state[o],l=this.props,d=l.x,f=l.width,h=l.travellerWidth,m=l.onChange,p=l.gap,v=l.data,b={startX:this.state.startX,endX:this.state.endX},k=r.pageX-a;k>0?k=Math.min(k,d+f-h-u):k<0&&(k=Math.max(k,d-u)),b[o]=u+k;var T=this.getIndex(b),S=T.startIndex,g=T.endIndex,y=function(){var C=v.length-1;return o==="startX"&&(s>c?S%p===0:g%p===0)||s<c&&g===C||o==="endX"&&(s>c?g%p===0:S%p===0)||s>c&&g===C};this.setState(St(St({},o,u+k),"brushMoveStartX",r.pageX),function(){m&&y()&&m(T)})}},{key:"handleTravellerMoveKeyboard",value:function(r,i){var a=this,o=this.state,s=o.scaleValues,c=o.startX,u=o.endX,l=this.state[i],d=s.indexOf(l);if(d!==-1){var f=d+r;if(!(f===-1||f>=s.length)){var h=s[f];i==="startX"&&h>=u||i==="endX"&&h<=c||this.setState(St({},i,h),function(){a.props.onChange(a.getIndex({startX:a.state.startX,endX:a.state.endX}))})}}}},{key:"renderBackground",value:function(){var r=this.props,i=r.x,a=r.y,o=r.width,s=r.height,c=r.fill,u=r.stroke;return O.createElement("rect",{stroke:u,fill:c,x:i,y:a,width:o,height:s})}},{key:"renderPanorama",value:function(){var r=this.props,i=r.x,a=r.y,o=r.width,s=r.height,c=r.data,u=r.children,l=r.padding,d=K.Children.only(u);return d?O.cloneElement(d,{x:i,y:a,width:o,height:s,margin:l,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(r,i){var a,o,s=this,c=this.props,u=c.y,l=c.travellerWidth,d=c.height,f=c.traveller,h=c.ariaLabel,m=c.data,p=c.startIndex,v=c.endIndex,b=Math.max(r,this.props.x),k=_u(_u({},ie(this.props,!1)),{},{x:b,y:u,width:l,height:d}),T=h||"Min value: ".concat((a=m[p])===null||a===void 0?void 0:a.name,", Max value: ").concat((o=m[v])===null||o===void 0?void 0:o.name);return O.createElement(Ce,{tabIndex:0,role:"slider","aria-label":T,"aria-valuenow":r,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[i],onTouchStart:this.travellerDragStartHandlers[i],onKeyDown:function(g){["ArrowLeft","ArrowRight"].includes(g.key)&&(g.preventDefault(),g.stopPropagation(),s.handleTravellerMoveKeyboard(g.key==="ArrowRight"?1:-1,i))},onFocus:function(){s.setState({isTravellerFocused:!0})},onBlur:function(){s.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},e.renderTraveller(f,k))}},{key:"renderSlide",value:function(r,i){var a=this.props,o=a.y,s=a.height,c=a.stroke,u=a.travellerWidth,l=Math.min(r,i)+u,d=Math.max(Math.abs(i-r)-u,0);return O.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:l,y:o,width:d,height:s})}},{key:"renderText",value:function(){var r=this.props,i=r.startIndex,a=r.endIndex,o=r.y,s=r.height,c=r.travellerWidth,u=r.stroke,l=this.state,d=l.startX,f=l.endX,h=5,m={pointerEvents:"none",fill:u};return O.createElement(Ce,{className:"recharts-brush-texts"},O.createElement(gs,$s({textAnchor:"end",verticalAnchor:"middle",x:Math.min(d,f)-h,y:o+s/2},m),this.getTextOfTick(i)),O.createElement(gs,$s({textAnchor:"start",verticalAnchor:"middle",x:Math.max(d,f)+c+h,y:o+s/2},m),this.getTextOfTick(a)))}},{key:"render",value:function(){var r=this.props,i=r.data,a=r.className,o=r.children,s=r.x,c=r.y,u=r.width,l=r.height,d=r.alwaysShowText,f=this.state,h=f.startX,m=f.endX,p=f.isTextActive,v=f.isSlideMoving,b=f.isTravellerMoving,k=f.isTravellerFocused;if(!i||!i.length||!H(s)||!H(c)||!H(u)||!H(l)||u<=0||l<=0)return null;var T=he("recharts-brush",a),S=O.Children.count(o)===1,g=uV("userSelect","none");return O.createElement(Ce,{className:T,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:g},this.renderBackground(),S&&this.renderPanorama(),this.renderSlide(h,m),this.renderTravellerLayer(h,"startX"),this.renderTravellerLayer(m,"endX"),(p||v||b||k||d)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(r){var i=r.x,a=r.y,o=r.width,s=r.height,c=r.stroke,u=Math.floor(a+s/2)-1;return O.createElement(O.Fragment,null,O.createElement("rect",{x:i,y:a,width:o,height:s,fill:c,stroke:"none"}),O.createElement("line",{x1:i+1,y1:u,x2:i+o-1,y2:u,fill:"none",stroke:"#fff"}),O.createElement("line",{x1:i+1,y1:u+2,x2:i+o-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(r,i){var a;return O.isValidElement(r)?a=O.cloneElement(r,i):ne(r)?a=r(i):a=e.renderDefaultTraveller(i),a}},{key:"getDerivedStateFromProps",value:function(r,i){var a=r.data,o=r.width,s=r.x,c=r.travellerWidth,u=r.updateId,l=r.startIndex,d=r.endIndex;if(a!==i.prevData||u!==i.prevUpdateId)return _u({prevData:a,prevTravellerWidth:c,prevUpdateId:u,prevX:s,prevWidth:o},a&&a.length?vV({data:a,width:o,x:s,travellerWidth:c,startIndex:l,endIndex:d}):{scale:null,scaleValues:null});if(i.scale&&(o!==i.prevWidth||s!==i.prevX||c!==i.prevTravellerWidth)){i.scale.range([s,s+o-c]);var f=i.scale.domain().map(function(h){return i.scale(h)});return{prevData:a,prevTravellerWidth:c,prevUpdateId:u,prevX:s,prevWidth:o,startX:i.scale(r.startIndex),endX:i.scale(r.endIndex),scaleValues:f}}return null}},{key:"getIndexInRange",value:function(r,i){for(var a=r.length,o=0,s=a-1;s-o>1;){var c=Math.floor((o+s)/2);r[c]>i?s=c:o=c}return i>=r[s]?s:o}}])}(K.PureComponent);St(bi,"displayName","Brush");St(bi,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var yV=vf;function bV(t,e){var n;return yV(t,function(r,i,a){return n=e(r,i,a),!n}),!!n}var SV=bV,TV=Nb,kV=er,wV=SV,CV=yt,_V=wc;function xV(t,e,n){var r=CV(t)?TV:wV;return n&&_V(t,e,n)&&(e=void 0),r(t,kV(e))}var PV=xV;const OV=_e(PV);var rn=function(e,n){var r=e.alwaysShow,i=e.ifOverflow;return r&&(i="extendDomain"),i===n},Hg=r0;function EV(t,e,n){e=="__proto__"&&Hg?Hg(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var AV=EV,IV=AV,RV=t0,MV=er;function DV(t,e){var n={};return e=MV(e),RV(t,function(r,i,a){IV(n,i,e(r,i,a))}),n}var NV=DV;const LV=_e(NV);function jV(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}var $V=jV,BV=vf;function UV(t,e){var n=!0;return BV(t,function(r,i,a){return n=!!e(r,i,a),n}),n}var FV=UV,qV=$V,VV=FV,WV=er,zV=yt,GV=wc;function HV(t,e,n){var r=zV(t)?qV:VV;return n&&GV(t,e,n)&&(e=void 0),r(t,WV(e))}var KV=HV;const ES=_e(KV);var XV=["x","y"];function Ja(t){"@babel/helpers - typeof";return Ja=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ja(t)}function Kl(){return Kl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Kl.apply(this,arguments)}function Kg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function ra(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Kg(Object(n),!0).forEach(function(r){YV(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Kg(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function YV(t,e,n){return e=JV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JV(t){var e=QV(t,"string");return Ja(e)=="symbol"?e:e+""}function QV(t,e){if(Ja(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ja(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ZV(t,e){if(t==null)return{};var n=eW(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function eW(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function tW(t,e){var n=t.x,r=t.y,i=ZV(t,XV),a="".concat(n),o=parseInt(a,10),s="".concat(r),c=parseInt(s,10),u="".concat(e.height||i.height),l=parseInt(u,10),d="".concat(e.width||i.width),f=parseInt(d,10);return ra(ra(ra(ra(ra({},e),i),o?{x:o}:{}),c?{y:c}:{}),{},{height:l,width:f,name:e.name,radius:e.radius})}function Xg(t){return O.createElement($q,Kl({shapeType:"rectangle",propTransformer:tW,activeClassName:"recharts-active-bar"},t))}var nW=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(r,i){if(typeof e=="number")return e;var a=H(r)||vP(r);return a?e(r,i):(a||_r(!1),n)}},rW=["value","background"],AS;function Si(t){"@babel/helpers - typeof";return Si=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Si(t)}function iW(t,e){if(t==null)return{};var n=aW(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function aW(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Us(){return Us=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Us.apply(this,arguments)}function Yg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function $e(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Yg(Object(n),!0).forEach(function(r){zn(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yg(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function oW(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,RS(r.key),r)}}function sW(t,e,n){return e&&Jg(t.prototype,e),n&&Jg(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function cW(t,e,n){return e=Fs(e),uW(t,IS()?Reflect.construct(e,n||[],Fs(t).constructor):e.apply(t,n))}function uW(t,e){if(e&&(Si(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lW(t)}function lW(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function IS(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(IS=function(){return!!t})()}function Fs(t){return Fs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Fs(t)}function dW(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xl(t,e)}function Xl(t,e){return Xl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Xl(t,e)}function zn(t,e,n){return e=RS(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RS(t){var e=fW(t,"string");return Si(e)=="symbol"?e:e+""}function fW(t,e){if(Si(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Si(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var zi=function(t){function e(){var n;oW(this,e);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=cW(this,e,[].concat(i)),zn(n,"state",{isAnimationFinished:!1}),zn(n,"id",$i("recharts-bar-")),zn(n,"handleAnimationEnd",function(){var o=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),o&&o()}),zn(n,"handleAnimationStart",function(){var o=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),o&&o()}),n}return dW(e,t),sW(e,[{key:"renderRectanglesStatically",value:function(r){var i=this,a=this.props,o=a.shape,s=a.dataKey,c=a.activeIndex,u=a.activeBar,l=ie(this.props,!1);return r&&r.map(function(d,f){var h=f===c,m=h?u:o,p=$e($e($e({},l),d),{},{isActive:h,option:m,index:f,dataKey:s,onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd});return O.createElement(Ce,Us({className:"recharts-bar-rectangle"},ns(i.props,d,f),{key:"rectangle-".concat(d==null?void 0:d.x,"-").concat(d==null?void 0:d.y,"-").concat(d==null?void 0:d.value,"-").concat(f)}),O.createElement(Xg,p))})}},{key:"renderRectanglesWithAnimation",value:function(){var r=this,i=this.props,a=i.data,o=i.layout,s=i.isAnimationActive,c=i.animationBegin,u=i.animationDuration,l=i.animationEasing,d=i.animationId,f=this.state.prevData;return O.createElement(Tr,{begin:c,duration:u,isActive:s,easing:l,from:{t:0},to:{t:1},key:"bar-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(h){var m=h.t,p=a.map(function(v,b){var k=f&&f[b];if(k){var T=et(k.x,v.x),S=et(k.y,v.y),g=et(k.width,v.width),y=et(k.height,v.height);return $e($e({},v),{},{x:T(m),y:S(m),width:g(m),height:y(m)})}if(o==="horizontal"){var w=et(0,v.height),C=w(m);return $e($e({},v),{},{y:v.y+v.height-C,height:C})}var _=et(0,v.width),A=_(m);return $e($e({},v),{},{width:A})});return O.createElement(Ce,null,r.renderRectanglesStatically(p))})}},{key:"renderRectangles",value:function(){var r=this.props,i=r.data,a=r.isAnimationActive,o=this.state.prevData;return a&&i&&i.length&&(!o||!gi(o,i))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(i)}},{key:"renderBackground",value:function(){var r=this,i=this.props,a=i.data,o=i.dataKey,s=i.activeIndex,c=ie(this.props.background,!1);return a.map(function(u,l){u.value;var d=u.background,f=iW(u,rW);if(!d)return null;var h=$e($e($e($e($e({},f),{},{fill:"#eee"},d),c),ns(r.props,u,l)),{},{onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd,dataKey:o,index:l,className:"recharts-bar-background-rectangle"});return O.createElement(Xg,Us({key:"background-bar-".concat(l),option:r.props.background,isActive:l===s},h))})}},{key:"renderErrorBar",value:function(r,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,o=a.data,s=a.xAxis,c=a.yAxis,u=a.layout,l=a.children,d=Nt(l,po);if(!d)return null;var f=u==="vertical"?o[0].height/2:o[0].width/2,h=function(v,b){var k=Array.isArray(v.value)?v.value[1]:v.value;return{x:v.x,y:v.y,value:k,errorVal:ut(v,b)}},m={clipPath:r?"url(#clipPath-".concat(i,")"):null};return O.createElement(Ce,m,d.map(function(p){return O.cloneElement(p,{key:"error-bar-".concat(i,"-").concat(p.props.dataKey),data:o,xAxis:s,yAxis:c,layout:u,offset:f,dataPointFormatter:h})}))}},{key:"render",value:function(){var r=this.props,i=r.hide,a=r.data,o=r.className,s=r.xAxis,c=r.yAxis,u=r.left,l=r.top,d=r.width,f=r.height,h=r.isAnimationActive,m=r.background,p=r.id;if(i||!a||!a.length)return null;var v=this.state.isAnimationFinished,b=he("recharts-bar",o),k=s&&s.allowDataOverflow,T=c&&c.allowDataOverflow,S=k||T,g=ce(p)?this.id:p;return O.createElement(Ce,{className:b},k||T?O.createElement("defs",null,O.createElement("clipPath",{id:"clipPath-".concat(g)},O.createElement("rect",{x:k?u:u-d/2,y:T?l:l-f/2,width:k?d:d*2,height:T?f:f*2}))):null,O.createElement(Ce,{className:"recharts-bar-rectangles",clipPath:S?"url(#clipPath-".concat(g,")"):null},m?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(S,g),(!h||v)&&Pn.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return r.animationId!==i.prevAnimationId?{prevAnimationId:r.animationId,curData:r.data,prevData:i.curData}:r.data!==i.curData?{curData:r.data}:null}}])}(K.PureComponent);AS=zi;zn(zi,"displayName","Bar");zn(zi,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!tn.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});zn(zi,"getComposedData",function(t){var e=t.props,n=t.item,r=t.barPosition,i=t.bandSize,a=t.xAxis,o=t.yAxis,s=t.xAxisTicks,c=t.yAxisTicks,u=t.stackedData,l=t.dataStartIndex,d=t.displayedData,f=t.offset,h=LU(r,n);if(!h)return null;var m=e.layout,p=n.type.defaultProps,v=p!==void 0?$e($e({},p),n.props):n.props,b=v.dataKey,k=v.children,T=v.minPointSize,S=m==="horizontal"?o:a,g=u?S.scale.domain():null,y=WU({numericAxis:S}),w=Nt(k,l0),C=d.map(function(_,A){var P,E,M,N,D,$;u?P=jU(u[l+A],g):(P=ut(_,b),Array.isArray(P)||(P=[y,P]));var F=nW(T,AS.defaultProps.minPointSize)(P[1],A);if(m==="horizontal"){var R,j=[o.scale(P[0]),o.scale(P[1])],q=j[0],J=j[1];E=og({axis:a,ticks:s,bandSize:i,offset:h.offset,entry:_,index:A}),M=(R=J!=null?J:q)!==null&&R!==void 0?R:void 0,N=h.size;var W=q-J;if(D=Number.isNaN(W)?0:W,$={x:E,y:o.y,width:N,height:o.height},Math.abs(F)>0&&Math.abs(D)<Math.abs(F)){var ee=Gt(D||F)*(Math.abs(F)-Math.abs(D));M-=ee,D+=ee}}else{var de=[a.scale(P[0]),a.scale(P[1])],Se=de[0],xe=de[1];if(E=Se,M=og({axis:o,ticks:c,bandSize:i,offset:h.offset,entry:_,index:A}),N=xe-Se,D=h.size,$={x:a.x,y:M,width:a.width,height:D},Math.abs(F)>0&&Math.abs(N)<Math.abs(F)){var _t=Gt(N||F)*(Math.abs(F)-Math.abs(N));N+=_t}}return $e($e($e({},_),{},{x:E,y:M,width:N,height:D,value:u?P:P[1],payload:_,background:$},w&&w[A]&&w[A].props),{},{tooltipPayload:[gS(n,_)],tooltipPosition:{x:E+N/2,y:M+D/2}})});return $e({data:C,layout:m},f)});function Qa(t){"@babel/helpers - typeof";return Qa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qa(t)}function hW(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,MS(r.key),r)}}function pW(t,e,n){return e&&Qg(t.prototype,e),n&&Qg(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Bt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Zg(Object(n),!0).forEach(function(r){Lc(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zg(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Lc(t,e,n){return e=MS(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MS(t){var e=mW(t,"string");return Qa(e)=="symbol"?e:e+""}function mW(t,e){if(Qa(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Qa(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Gf=function(e,n,r,i,a){var o=e.width,s=e.height,c=e.layout,u=e.children,l=Object.keys(n),d={left:r.left,leftMirror:r.left,right:o-r.right,rightMirror:o-r.right,top:r.top,topMirror:r.top,bottom:s-r.bottom,bottomMirror:s-r.bottom},f=!!Tt(u,zi);return l.reduce(function(h,m){var p=n[m],v=p.orientation,b=p.domain,k=p.padding,T=k===void 0?{}:k,S=p.mirror,g=p.reversed,y="".concat(v).concat(S?"Mirror":""),w,C,_,A,P;if(p.type==="number"&&(p.padding==="gap"||p.padding==="no-gap")){var E=b[1]-b[0],M=1/0,N=p.categoricalDomain.sort(SP);if(N.forEach(function(de,Se){Se>0&&(M=Math.min((de||0)-(N[Se-1]||0),M))}),Number.isFinite(M)){var D=M/E,$=p.layout==="vertical"?r.height:r.width;if(p.padding==="gap"&&(w=D*$/2),p.padding==="no-gap"){var F=wr(e.barCategoryGap,D*$),R=D*$/2;w=R-F-(R-F)/$*F}}}i==="xAxis"?C=[r.left+(T.left||0)+(w||0),r.left+r.width-(T.right||0)-(w||0)]:i==="yAxis"?C=c==="horizontal"?[r.top+r.height-(T.bottom||0),r.top+(T.top||0)]:[r.top+(T.top||0)+(w||0),r.top+r.height-(T.bottom||0)-(w||0)]:C=p.range,g&&(C=[C[1],C[0]]);var j=DU(p,a,f),q=j.scale,J=j.realScaleType;q.domain(b).range(C),NU(q);var W=VU(q,Bt(Bt({},p),{},{realScaleType:J}));i==="xAxis"?(P=v==="top"&&!S||v==="bottom"&&S,_=r.left,A=d[y]-P*p.height):i==="yAxis"&&(P=v==="left"&&!S||v==="right"&&S,_=d[y]-P*p.width,A=r.top);var ee=Bt(Bt(Bt({},p),W),{},{realScaleType:J,x:_,y:A,scale:q,width:i==="xAxis"?r.width:p.width,height:i==="yAxis"?r.height:p.height});return ee.bandSize=Is(ee,W),!p.hide&&i==="xAxis"?d[y]+=(P?-1:1)*ee.height:p.hide||(d[y]+=(P?-1:1)*ee.width),Bt(Bt({},h),{},Lc({},m,ee))},{})},DS=function(e,n){var r=e.x,i=e.y,a=n.x,o=n.y;return{x:Math.min(r,a),y:Math.min(i,o),width:Math.abs(a-r),height:Math.abs(o-i)}},gW=function(e){var n=e.x1,r=e.y1,i=e.x2,a=e.y2;return DS({x:n,y:r},{x:i,y:a})},NS=function(){function t(e){hW(this,t),this.scale=e}return pW(t,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=r.bandAware,a=r.position;if(n!==void 0){if(a)switch(a){case"start":return this.scale(n);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+o}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(n)+s}default:return this.scale(n)}if(i){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+c}return this.scale(n)}}},{key:"isInRange",value:function(n){var r=this.range(),i=r[0],a=r[r.length-1];return i<=a?n>=i&&n<=a:n>=a&&n<=i}}],[{key:"create",value:function(n){return new t(n)}}])}();Lc(NS,"EPS",1e-4);var Hf=function(e){var n=Object.keys(e).reduce(function(r,i){return Bt(Bt({},r),{},Lc({},i,NS.create(e[i])))},{});return Bt(Bt({},n),{},{apply:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=a.bandAware,s=a.position;return LV(i,function(c,u){return n[u].apply(c,{bandAware:o,position:s})})},isInRange:function(i){return ES(i,function(a,o){return n[o].isInRange(a)})}})};function vW(t){return(t%180+180)%180}var yW=function(e){var n=e.width,r=e.height,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=vW(i),o=a*Math.PI/180,s=Math.atan(r/n),c=o>s&&o<Math.PI-s?r/Math.sin(o):n/Math.cos(o);return Math.abs(c)},bW=er,SW=co,TW=Tc;function kW(t){return function(e,n,r){var i=Object(e);if(!SW(e)){var a=bW(n);e=TW(e),n=function(s){return a(i[s],s,i)}}var o=t(e,n,r);return o>-1?i[a?e[o]:o]:void 0}}var wW=kW,CW=_S;function _W(t){var e=CW(t),n=e%1;return e===e?n?e-n:e:0}var xW=_W,PW=Xb,OW=er,EW=xW,AW=Math.max;function IW(t,e,n){var r=t==null?0:t.length;if(!r)return-1;var i=n==null?0:EW(n);return i<0&&(i=AW(r+i,0)),PW(t,OW(e),i)}var RW=IW,MW=wW,DW=RW,NW=MW(DW),LW=NW;const jW=_e(LW);var $W=Cx(function(t){return{x:t.left,y:t.top,width:t.width,height:t.height}},function(t){return["l",t.left,"t",t.top,"w",t.width,"h",t.height].join("")}),Kf=K.createContext(void 0),Xf=K.createContext(void 0),LS=K.createContext(void 0),jS=K.createContext({}),$S=K.createContext(void 0),BS=K.createContext(0),US=K.createContext(0),ev=function(e){var n=e.state,r=n.xAxisMap,i=n.yAxisMap,a=n.offset,o=e.clipPathId,s=e.children,c=e.width,u=e.height,l=$W(a);return O.createElement(Kf.Provider,{value:r},O.createElement(Xf.Provider,{value:i},O.createElement(jS.Provider,{value:a},O.createElement(LS.Provider,{value:l},O.createElement($S.Provider,{value:o},O.createElement(BS.Provider,{value:u},O.createElement(US.Provider,{value:c},s)))))))},BW=function(){return K.useContext($S)},FS=function(e){var n=K.useContext(Kf);n==null&&_r(!1);var r=n[e];return r==null&&_r(!1),r},UW=function(){var e=K.useContext(Kf);return qn(e)},FW=function(){var e=K.useContext(Xf),n=jW(e,function(r){return ES(r.domain,Number.isFinite)});return n||qn(e)},qS=function(e){var n=K.useContext(Xf);n==null&&_r(!1);var r=n[e];return r==null&&_r(!1),r},qW=function(){var e=K.useContext(LS);return e},VW=function(){return K.useContext(jS)},Yf=function(){return K.useContext(US)},Jf=function(){return K.useContext(BS)};function Ti(t){"@babel/helpers - typeof";return Ti=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ti(t)}function WW(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,WS(r.key),r)}}function zW(t,e,n){return e&&tv(t.prototype,e),n&&tv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function GW(t,e,n){return e=qs(e),HW(t,VS()?Reflect.construct(e,n||[],qs(t).constructor):e.apply(t,n))}function HW(t,e){if(e&&(Ti(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KW(t)}function KW(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function VS(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(VS=function(){return!!t})()}function qs(t){return qs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},qs(t)}function XW(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yl(t,e)}function Yl(t,e){return Yl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Yl(t,e)}function nv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function rv(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?nv(Object(n),!0).forEach(function(r){Qf(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nv(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Qf(t,e,n){return e=WS(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WS(t){var e=YW(t,"string");return Ti(e)=="symbol"?e:e+""}function YW(t,e){if(Ti(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ti(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JW(t,e){return t4(t)||e4(t,e)||ZW(t,e)||QW()}function QW(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZW(t,e){if(t){if(typeof t=="string")return iv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iv(t,e)}}function iv(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function e4(t,e){var n=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,a,o,s=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(l){u=!0,i=l}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function t4(t){if(Array.isArray(t))return t}function Jl(){return Jl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Jl.apply(this,arguments)}var n4=function(e,n){var r;return O.isValidElement(e)?r=O.cloneElement(e,n):ne(e)?r=e(n):r=O.createElement("line",Jl({},n,{className:"recharts-reference-line-line"})),r},r4=function(e,n,r,i,a,o,s,c,u){var l=a.x,d=a.y,f=a.width,h=a.height;if(r){var m=u.y,p=e.y.apply(m,{position:o});if(rn(u,"discard")&&!e.y.isInRange(p))return null;var v=[{x:l+f,y:p},{x:l,y:p}];return c==="left"?v.reverse():v}if(n){var b=u.x,k=e.x.apply(b,{position:o});if(rn(u,"discard")&&!e.x.isInRange(k))return null;var T=[{x:k,y:d+h},{x:k,y:d}];return s==="top"?T.reverse():T}if(i){var S=u.segment,g=S.map(function(y){return e.apply(y,{position:o})});return rn(u,"discard")&&OV(g,function(y){return!e.isInRange(y)})?null:g}return null};function i4(t){var e=t.x,n=t.y,r=t.segment,i=t.xAxisId,a=t.yAxisId,o=t.shape,s=t.className,c=t.alwaysShow,u=BW(),l=FS(i),d=qS(a),f=qW();if(!u||!f)return null;_n(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var h=Hf({x:l.scale,y:d.scale}),m=Ke(e),p=Ke(n),v=r&&r.length===2,b=r4(h,m,p,v,f,t.position,l.orientation,d.orientation,t);if(!b)return null;var k=JW(b,2),T=k[0],S=T.x,g=T.y,y=k[1],w=y.x,C=y.y,_=rn(t,"hidden")?"url(#".concat(u,")"):void 0,A=rv(rv({clipPath:_},ie(t,!0)),{},{x1:S,y1:g,x2:w,y2:C});return O.createElement(Ce,{className:he("recharts-reference-line",s)},n4(o,A),it.renderCallByParent(t,gW({x1:S,y1:g,x2:w,y2:C})))}var Zf=function(t){function e(){return WW(this,e),GW(this,e,arguments)}return XW(e,t),zW(e,[{key:"render",value:function(){return O.createElement(i4,this.props)}}])}(O.Component);Qf(Zf,"displayName","ReferenceLine");Qf(Zf,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function Ql(){return Ql=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ql.apply(this,arguments)}function ki(t){"@babel/helpers - typeof";return ki=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ki(t)}function av(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function ov(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?av(Object(n),!0).forEach(function(r){jc(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):av(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function a4(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,GS(r.key),r)}}function o4(t,e,n){return e&&sv(t.prototype,e),n&&sv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function s4(t,e,n){return e=Vs(e),c4(t,zS()?Reflect.construct(e,n||[],Vs(t).constructor):e.apply(t,n))}function c4(t,e){if(e&&(ki(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u4(t)}function u4(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zS(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(zS=function(){return!!t})()}function Vs(t){return Vs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Vs(t)}function l4(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zl(t,e)}function Zl(t,e){return Zl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Zl(t,e)}function jc(t,e,n){return e=GS(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GS(t){var e=d4(t,"string");return ki(e)=="symbol"?e:e+""}function d4(t,e){if(ki(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(ki(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var f4=function(e){var n=e.x,r=e.y,i=e.xAxis,a=e.yAxis,o=Hf({x:i.scale,y:a.scale}),s=o.apply({x:n,y:r},{bandAware:!0});return rn(e,"discard")&&!o.isInRange(s)?null:s},$c=function(t){function e(){return a4(this,e),s4(this,e,arguments)}return l4(e,t),o4(e,[{key:"render",value:function(){var r=this.props,i=r.x,a=r.y,o=r.r,s=r.alwaysShow,c=r.clipPathId,u=Ke(i),l=Ke(a);if(_n(s===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!l)return null;var d=f4(this.props);if(!d)return null;var f=d.x,h=d.y,m=this.props,p=m.shape,v=m.className,b=rn(this.props,"hidden")?"url(#".concat(c,")"):void 0,k=ov(ov({clipPath:b},ie(this.props,!0)),{},{cx:f,cy:h});return O.createElement(Ce,{className:he("recharts-reference-dot",v)},e.renderDot(p,k),it.renderCallByParent(this.props,{x:f-o,y:h-o,width:2*o,height:2*o}))}}])}(O.Component);jc($c,"displayName","ReferenceDot");jc($c,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});jc($c,"renderDot",function(t,e){var n;return O.isValidElement(t)?n=O.cloneElement(t,e):ne(t)?n=t(e):n=O.createElement(Mc,Ql({},e,{cx:e.cx,cy:e.cy,className:"recharts-reference-dot-dot"})),n});function ed(){return ed=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ed.apply(this,arguments)}function wi(t){"@babel/helpers - typeof";return wi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wi(t)}function cv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function uv(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?cv(Object(n),!0).forEach(function(r){Bc(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cv(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function h4(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,KS(r.key),r)}}function p4(t,e,n){return e&&lv(t.prototype,e),n&&lv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function m4(t,e,n){return e=Ws(e),g4(t,HS()?Reflect.construct(e,n||[],Ws(t).constructor):e.apply(t,n))}function g4(t,e){if(e&&(wi(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return v4(t)}function v4(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function HS(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(HS=function(){return!!t})()}function Ws(t){return Ws=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Ws(t)}function y4(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&td(t,e)}function td(t,e){return td=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},td(t,e)}function Bc(t,e,n){return e=KS(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KS(t){var e=b4(t,"string");return wi(e)=="symbol"?e:e+""}function b4(t,e){if(wi(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(wi(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var S4=function(e,n,r,i,a){var o=a.x1,s=a.x2,c=a.y1,u=a.y2,l=a.xAxis,d=a.yAxis;if(!l||!d)return null;var f=Hf({x:l.scale,y:d.scale}),h={x:e?f.x.apply(o,{position:"start"}):f.x.rangeMin,y:r?f.y.apply(c,{position:"start"}):f.y.rangeMin},m={x:n?f.x.apply(s,{position:"end"}):f.x.rangeMax,y:i?f.y.apply(u,{position:"end"}):f.y.rangeMax};return rn(a,"discard")&&(!f.isInRange(h)||!f.isInRange(m))?null:DS(h,m)},Uc=function(t){function e(){return h4(this,e),m4(this,e,arguments)}return y4(e,t),p4(e,[{key:"render",value:function(){var r=this.props,i=r.x1,a=r.x2,o=r.y1,s=r.y2,c=r.className,u=r.alwaysShow,l=r.clipPathId;_n(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var d=Ke(i),f=Ke(a),h=Ke(o),m=Ke(s),p=this.props.shape;if(!d&&!f&&!h&&!m&&!p)return null;var v=S4(d,f,h,m,this.props);if(!v&&!p)return null;var b=rn(this.props,"hidden")?"url(#".concat(l,")"):void 0;return O.createElement(Ce,{className:he("recharts-reference-area",c)},e.renderRect(p,uv(uv({clipPath:b},ie(this.props,!0)),v)),it.renderCallByParent(this.props,v))}}])}(O.Component);Bc(Uc,"displayName","ReferenceArea");Bc(Uc,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});Bc(Uc,"renderRect",function(t,e){var n;return O.isValidElement(t)?n=O.cloneElement(t,e):ne(t)?n=t(e):n=O.createElement(zf,ed({},e,{className:"recharts-reference-area-rect"})),n});function XS(t,e,n){if(e<1)return[];if(e===1&&n===void 0)return t;for(var r=[],i=0;i<t.length;i+=e)if(n===void 0||n(t[i])===!0)r.push(t[i]);else return;return r}function T4(t,e,n){var r={width:t.width+e.width,height:t.height+e.height};return yW(r,n)}function k4(t,e,n){var r=n==="width",i=t.x,a=t.y,o=t.width,s=t.height;return e===1?{start:r?i:a,end:r?i+o:a+s}:{start:r?i+o:a+s,end:r?i:a}}function zs(t,e,n,r,i){if(t*e<t*r||t*e>t*i)return!1;var a=n();return t*(e-t*a/2-r)>=0&&t*(e+t*a/2-i)<=0}function w4(t,e){return XS(t,e+1)}function C4(t,e,n,r,i){for(var a=(r||[]).slice(),o=e.start,s=e.end,c=0,u=1,l=o,d=function(){var m=r==null?void 0:r[c];if(m===void 0)return{v:XS(r,u)};var p=c,v,b=function(){return v===void 0&&(v=n(m,p)),v},k=m.coordinate,T=c===0||zs(t,k,b,l,s);T||(c=0,l=o,u+=1),T&&(l=k+t*(b()/2+i),c+=u)},f;u<=a.length;)if(f=d(),f)return f.v;return[]}function Za(t){"@babel/helpers - typeof";return Za=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Za(t)}function dv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function rt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?dv(Object(n),!0).forEach(function(r){_4(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dv(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function _4(t,e,n){return e=x4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x4(t){var e=P4(t,"string");return Za(e)=="symbol"?e:e+""}function P4(t,e){if(Za(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Za(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function O4(t,e,n,r,i){for(var a=(r||[]).slice(),o=a.length,s=e.start,c=e.end,u=function(f){var h=a[f],m,p=function(){return m===void 0&&(m=n(h,f)),m};if(f===o-1){var v=t*(h.coordinate+t*p()/2-c);a[f]=h=rt(rt({},h),{},{tickCoord:v>0?h.coordinate-v*t:h.coordinate})}else a[f]=h=rt(rt({},h),{},{tickCoord:h.coordinate});var b=zs(t,h.tickCoord,p,s,c);b&&(c=h.tickCoord-t*(p()/2+i),a[f]=rt(rt({},h),{},{isShow:!0}))},l=o-1;l>=0;l--)u(l);return a}function E4(t,e,n,r,i,a){var o=(r||[]).slice(),s=o.length,c=e.start,u=e.end;if(a){var l=r[s-1],d=n(l,s-1),f=t*(l.coordinate+t*d/2-u);o[s-1]=l=rt(rt({},l),{},{tickCoord:f>0?l.coordinate-f*t:l.coordinate});var h=zs(t,l.tickCoord,function(){return d},c,u);h&&(u=l.tickCoord-t*(d/2+i),o[s-1]=rt(rt({},l),{},{isShow:!0}))}for(var m=a?s-1:s,p=function(k){var T=o[k],S,g=function(){return S===void 0&&(S=n(T,k)),S};if(k===0){var y=t*(T.coordinate-t*g()/2-c);o[k]=T=rt(rt({},T),{},{tickCoord:y<0?T.coordinate-y*t:T.coordinate})}else o[k]=T=rt(rt({},T),{},{tickCoord:T.coordinate});var w=zs(t,T.tickCoord,g,c,u);w&&(c=T.tickCoord+t*(g()/2+i),o[k]=rt(rt({},T),{},{isShow:!0}))},v=0;v<m;v++)p(v);return o}function eh(t,e,n){var r=t.tick,i=t.ticks,a=t.viewBox,o=t.minTickGap,s=t.orientation,c=t.interval,u=t.tickFormatter,l=t.unit,d=t.angle;if(!i||!i.length||!r)return[];if(H(c)||tn.isSsr)return w4(i,typeof c=="number"&&H(c)?c:0);var f=[],h=s==="top"||s==="bottom"?"width":"height",m=l&&h==="width"?pa(l,{fontSize:e,letterSpacing:n}):{width:0,height:0},p=function(T,S){var g=ne(u)?u(T.value,S):T.value;return h==="width"?T4(pa(g,{fontSize:e,letterSpacing:n}),m,d):pa(g,{fontSize:e,letterSpacing:n})[h]},v=i.length>=2?Gt(i[1].coordinate-i[0].coordinate):1,b=k4(a,v,h);return c==="equidistantPreserveStart"?C4(v,b,p,i,o):(c==="preserveStart"||c==="preserveStartEnd"?f=E4(v,b,p,i,o,c==="preserveStartEnd"):f=O4(v,b,p,i,o),f.filter(function(k){return k.isShow}))}var A4=["viewBox"],I4=["viewBox"],R4=["ticks"];function Ci(t){"@babel/helpers - typeof";return Ci=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ci(t)}function Hr(){return Hr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Hr.apply(this,arguments)}function fv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function We(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?fv(Object(n),!0).forEach(function(r){th(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fv(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function xu(t,e){if(t==null)return{};var n=M4(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function M4(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function D4(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,JS(r.key),r)}}function N4(t,e,n){return e&&hv(t.prototype,e),n&&hv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function L4(t,e,n){return e=Gs(e),j4(t,YS()?Reflect.construct(e,n||[],Gs(t).constructor):e.apply(t,n))}function j4(t,e){if(e&&(Ci(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $4(t)}function $4(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function YS(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(YS=function(){return!!t})()}function Gs(t){return Gs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Gs(t)}function B4(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nd(t,e)}function nd(t,e){return nd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},nd(t,e)}function th(t,e,n){return e=JS(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JS(t){var e=U4(t,"string");return Ci(e)=="symbol"?e:e+""}function U4(t,e){if(Ci(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ci(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Gi=function(t){function e(n){var r;return D4(this,e),r=L4(this,e,[n]),r.state={fontSize:"",letterSpacing:""},r}return B4(e,t),N4(e,[{key:"shouldComponentUpdate",value:function(r,i){var a=r.viewBox,o=xu(r,A4),s=this.props,c=s.viewBox,u=xu(s,I4);return!Qr(a,c)||!Qr(o,u)||!Qr(i,this.state)}},{key:"componentDidMount",value:function(){var r=this.layerReference;if(r){var i=r.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];i&&this.setState({fontSize:window.getComputedStyle(i).fontSize,letterSpacing:window.getComputedStyle(i).letterSpacing})}}},{key:"getTickLineCoord",value:function(r){var i=this.props,a=i.x,o=i.y,s=i.width,c=i.height,u=i.orientation,l=i.tickSize,d=i.mirror,f=i.tickMargin,h,m,p,v,b,k,T=d?-1:1,S=r.tickSize||l,g=H(r.tickCoord)?r.tickCoord:r.coordinate;switch(u){case"top":h=m=r.coordinate,v=o+ +!d*c,p=v-T*S,k=p-T*f,b=g;break;case"left":p=v=r.coordinate,m=a+ +!d*s,h=m-T*S,b=h-T*f,k=g;break;case"right":p=v=r.coordinate,m=a+ +d*s,h=m+T*S,b=h+T*f,k=g;break;default:h=m=r.coordinate,v=o+ +d*c,p=v+T*S,k=p+T*f,b=g;break}return{line:{x1:h,y1:p,x2:m,y2:v},tick:{x:b,y:k}}}},{key:"getTickTextAnchor",value:function(){var r=this.props,i=r.orientation,a=r.mirror,o;switch(i){case"left":o=a?"start":"end";break;case"right":o=a?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var r=this.props,i=r.orientation,a=r.mirror,o="end";switch(i){case"left":case"right":o="middle";break;case"top":o=a?"start":"end";break;default:o=a?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var r=this.props,i=r.x,a=r.y,o=r.width,s=r.height,c=r.orientation,u=r.mirror,l=r.axisLine,d=We(We(We({},ie(this.props,!1)),ie(l,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var f=+(c==="top"&&!u||c==="bottom"&&u);d=We(We({},d),{},{x1:i,y1:a+f*s,x2:i+o,y2:a+f*s})}else{var h=+(c==="left"&&!u||c==="right"&&u);d=We(We({},d),{},{x1:i+h*o,y1:a,x2:i+h*o,y2:a+s})}return O.createElement("line",Hr({},d,{className:he("recharts-cartesian-axis-line",Dt(l,"className"))}))}},{key:"renderTicks",value:function(r,i,a){var o=this,s=this.props,c=s.tickLine,u=s.stroke,l=s.tick,d=s.tickFormatter,f=s.unit,h=eh(We(We({},this.props),{},{ticks:r}),i,a),m=this.getTickTextAnchor(),p=this.getTickVerticalAnchor(),v=ie(this.props,!1),b=ie(l,!1),k=We(We({},v),{},{fill:"none"},ie(c,!1)),T=h.map(function(S,g){var y=o.getTickLineCoord(S),w=y.line,C=y.tick,_=We(We(We(We({textAnchor:m,verticalAnchor:p},v),{},{stroke:"none",fill:u},b),C),{},{index:g,payload:S,visibleTicksCount:h.length,tickFormatter:d});return O.createElement(Ce,Hr({className:"recharts-cartesian-axis-tick",key:"tick-".concat(S.value,"-").concat(S.coordinate,"-").concat(S.tickCoord)},ns(o.props,S,g)),c&&O.createElement("line",Hr({},k,w,{className:he("recharts-cartesian-axis-tick-line",Dt(c,"className"))})),l&&e.renderTickItem(l,_,"".concat(ne(d)?d(S.value,g):S.value).concat(f||"")))});return O.createElement("g",{className:"recharts-cartesian-axis-ticks"},T)}},{key:"render",value:function(){var r=this,i=this.props,a=i.axisLine,o=i.width,s=i.height,c=i.ticksGenerator,u=i.className,l=i.hide;if(l)return null;var d=this.props,f=d.ticks,h=xu(d,R4),m=f;return ne(c)&&(m=f&&f.length>0?c(this.props):c(h)),o<=0||s<=0||!m||!m.length?null:O.createElement(Ce,{className:he("recharts-cartesian-axis",u),ref:function(v){r.layerReference=v}},a&&this.renderAxisLine(),this.renderTicks(m,this.state.fontSize,this.state.letterSpacing),it.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(r,i,a){var o,s=he(i.className,"recharts-cartesian-axis-tick-value");return O.isValidElement(r)?o=O.cloneElement(r,We(We({},i),{},{className:s})):ne(r)?o=r(We(We({},i),{},{className:s})):o=O.createElement(gs,Hr({},i,{className:"recharts-cartesian-axis-tick-value"}),a),o}}])}(K.Component);th(Gi,"displayName","CartesianAxis");th(Gi,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var F4=["x1","y1","x2","y2","key"],q4=["offset"];function xr(t){"@babel/helpers - typeof";return xr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xr(t)}function pv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function at(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?pv(Object(n),!0).forEach(function(r){V4(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pv(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function V4(t,e,n){return e=W4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W4(t){var e=z4(t,"string");return xr(e)=="symbol"?e:e+""}function z4(t,e){if(xr(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(xr(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gr(){return gr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},gr.apply(this,arguments)}function mv(t,e){if(t==null)return{};var n=G4(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function G4(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var H4=function(e){var n=e.fill;if(!n||n==="none")return null;var r=e.fillOpacity,i=e.x,a=e.y,o=e.width,s=e.height,c=e.ry;return O.createElement("rect",{x:i,y:a,ry:c,width:o,height:s,stroke:"none",fill:n,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function QS(t,e){var n;if(O.isValidElement(t))n=O.cloneElement(t,e);else if(ne(t))n=t(e);else{var r=e.x1,i=e.y1,a=e.x2,o=e.y2,s=e.key,c=mv(e,F4),u=ie(c,!1);u.offset;var l=mv(u,q4);n=O.createElement("line",gr({},l,{x1:r,y1:i,x2:a,y2:o,fill:"none",key:s}))}return n}function K4(t){var e=t.x,n=t.width,r=t.horizontal,i=r===void 0?!0:r,a=t.horizontalPoints;if(!i||!a||!a.length)return null;var o=a.map(function(s,c){var u=at(at({},t),{},{x1:e,y1:s,x2:e+n,y2:s,key:"line-".concat(c),index:c});return QS(i,u)});return O.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function X4(t){var e=t.y,n=t.height,r=t.vertical,i=r===void 0?!0:r,a=t.verticalPoints;if(!i||!a||!a.length)return null;var o=a.map(function(s,c){var u=at(at({},t),{},{x1:s,y1:e,x2:s,y2:e+n,key:"line-".concat(c),index:c});return QS(i,u)});return O.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function Y4(t){var e=t.horizontalFill,n=t.fillOpacity,r=t.x,i=t.y,a=t.width,o=t.height,s=t.horizontalPoints,c=t.horizontal,u=c===void 0?!0:c;if(!u||!e||!e.length)return null;var l=s.map(function(f){return Math.round(f+i-i)}).sort(function(f,h){return f-h});i!==l[0]&&l.unshift(0);var d=l.map(function(f,h){var m=!l[h+1],p=m?i+o-f:l[h+1]-f;if(p<=0)return null;var v=h%e.length;return O.createElement("rect",{key:"react-".concat(h),y:f,x:r,height:p,width:a,stroke:"none",fill:e[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return O.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function J4(t){var e=t.vertical,n=e===void 0?!0:e,r=t.verticalFill,i=t.fillOpacity,a=t.x,o=t.y,s=t.width,c=t.height,u=t.verticalPoints;if(!n||!r||!r.length)return null;var l=u.map(function(f){return Math.round(f+a-a)}).sort(function(f,h){return f-h});a!==l[0]&&l.unshift(0);var d=l.map(function(f,h){var m=!l[h+1],p=m?a+s-f:l[h+1]-f;if(p<=0)return null;var v=h%r.length;return O.createElement("rect",{key:"react-".concat(h),x:f,y:o,width:p,height:c,stroke:"none",fill:r[v],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return O.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var Q4=function(e,n){var r=e.xAxis,i=e.width,a=e.height,o=e.offset;return pS(eh(at(at(at({},Gi.defaultProps),r),{},{ticks:wn(r,!0),viewBox:{x:0,y:0,width:i,height:a}})),o.left,o.left+o.width,n)},Z4=function(e,n){var r=e.yAxis,i=e.width,a=e.height,o=e.offset;return pS(eh(at(at(at({},Gi.defaultProps),r),{},{ticks:wn(r,!0),viewBox:{x:0,y:0,width:i,height:a}})),o.top,o.top+o.height,n)},Ur={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function e8(t){var e,n,r,i,a,o,s=Yf(),c=Jf(),u=VW(),l=at(at({},t),{},{stroke:(e=t.stroke)!==null&&e!==void 0?e:Ur.stroke,fill:(n=t.fill)!==null&&n!==void 0?n:Ur.fill,horizontal:(r=t.horizontal)!==null&&r!==void 0?r:Ur.horizontal,horizontalFill:(i=t.horizontalFill)!==null&&i!==void 0?i:Ur.horizontalFill,vertical:(a=t.vertical)!==null&&a!==void 0?a:Ur.vertical,verticalFill:(o=t.verticalFill)!==null&&o!==void 0?o:Ur.verticalFill,x:H(t.x)?t.x:u.left,y:H(t.y)?t.y:u.top,width:H(t.width)?t.width:u.width,height:H(t.height)?t.height:u.height}),d=l.x,f=l.y,h=l.width,m=l.height,p=l.syncWithTicks,v=l.horizontalValues,b=l.verticalValues,k=UW(),T=FW();if(!H(h)||h<=0||!H(m)||m<=0||!H(d)||d!==+d||!H(f)||f!==+f)return null;var S=l.verticalCoordinatesGenerator||Q4,g=l.horizontalCoordinatesGenerator||Z4,y=l.horizontalPoints,w=l.verticalPoints;if((!y||!y.length)&&ne(g)){var C=v&&v.length,_=g({yAxis:T?at(at({},T),{},{ticks:C?v:T.ticks}):void 0,width:s,height:c,offset:u},C?!0:p);_n(Array.isArray(_),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(xr(_),"]")),Array.isArray(_)&&(y=_)}if((!w||!w.length)&&ne(S)){var A=b&&b.length,P=S({xAxis:k?at(at({},k),{},{ticks:A?b:k.ticks}):void 0,width:s,height:c,offset:u},A?!0:p);_n(Array.isArray(P),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(xr(P),"]")),Array.isArray(P)&&(w=P)}return O.createElement("g",{className:"recharts-cartesian-grid"},O.createElement(H4,{fill:l.fill,fillOpacity:l.fillOpacity,x:l.x,y:l.y,width:l.width,height:l.height,ry:l.ry}),O.createElement(K4,gr({},l,{offset:u,horizontalPoints:y,xAxis:k,yAxis:T})),O.createElement(X4,gr({},l,{offset:u,verticalPoints:w,xAxis:k,yAxis:T})),O.createElement(Y4,gr({},l,{horizontalPoints:y})),O.createElement(J4,gr({},l,{verticalPoints:w})))}e8.displayName="CartesianGrid";var t8=["type","layout","connectNulls","ref"],n8=["key"];function _i(t){"@babel/helpers - typeof";return _i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_i(t)}function gv(t,e){if(t==null)return{};var n=r8(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function r8(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function va(){return va=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},va.apply(this,arguments)}function vv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function bt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?vv(Object(n),!0).forEach(function(r){Ut(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vv(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Fr(t){return s8(t)||o8(t)||a8(t)||i8()}function i8(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a8(t,e){if(t){if(typeof t=="string")return rd(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rd(t,e)}}function o8(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function s8(t){if(Array.isArray(t))return rd(t)}function rd(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c8(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,eT(r.key),r)}}function u8(t,e,n){return e&&yv(t.prototype,e),n&&yv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function l8(t,e,n){return e=Hs(e),d8(t,ZS()?Reflect.construct(e,n||[],Hs(t).constructor):e.apply(t,n))}function d8(t,e){if(e&&(_i(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return f8(t)}function f8(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ZS(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ZS=function(){return!!t})()}function Hs(t){return Hs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Hs(t)}function h8(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&id(t,e)}function id(t,e){return id=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},id(t,e)}function Ut(t,e,n){return e=eT(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eT(t){var e=p8(t,"string");return _i(e)=="symbol"?e:e+""}function p8(t,e){if(_i(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(_i(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Fc=function(t){function e(){var n;c8(this,e);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=l8(this,e,[].concat(i)),Ut(n,"state",{isAnimationFinished:!0,totalLength:0}),Ut(n,"generateSimpleStrokeDasharray",function(o,s){return"".concat(s,"px ").concat(o-s,"px")}),Ut(n,"getStrokeDasharray",function(o,s,c){var u=c.reduce(function(b,k){return b+k});if(!u)return n.generateSimpleStrokeDasharray(s,o);for(var l=Math.floor(o/u),d=o%u,f=s-o,h=[],m=0,p=0;m<c.length;p+=c[m],++m)if(p+c[m]>d){h=[].concat(Fr(c.slice(0,m)),[d-p]);break}var v=h.length%2===0?[0,f]:[f];return[].concat(Fr(e.repeat(c,l)),Fr(h),v).map(function(b){return"".concat(b,"px")}).join(", ")}),Ut(n,"id",$i("recharts-line-")),Ut(n,"pathRef",function(o){n.mainCurve=o}),Ut(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),Ut(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return h8(e,t),u8(e,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch(i){return 0}}},{key:"renderErrorBar",value:function(r,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,o=a.points,s=a.xAxis,c=a.yAxis,u=a.layout,l=a.children,d=Nt(l,po);if(!d)return null;var f=function(p,v){return{x:p.x,y:p.y,value:p.value,errorVal:ut(p.payload,v)}},h={clipPath:r?"url(#clipPath-".concat(i,")"):null};return O.createElement(Ce,h,d.map(function(m){return O.cloneElement(m,{key:"bar-".concat(m.props.dataKey),data:o,xAxis:s,yAxis:c,layout:u,dataPointFormatter:f})}))}},{key:"renderDots",value:function(r,i,a){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var s=this.props,c=s.dot,u=s.points,l=s.dataKey,d=ie(this.props,!1),f=ie(c,!0),h=u.map(function(p,v){var b=bt(bt(bt({key:"dot-".concat(v),r:3},d),f),{},{index:v,cx:p.x,cy:p.y,value:p.value,dataKey:l,payload:p.payload,points:u});return e.renderDotItem(c,b)}),m={clipPath:r?"url(#clipPath-".concat(i?"":"dots-").concat(a,")"):null};return O.createElement(Ce,va({className:"recharts-line-dots",key:"dots"},m),h)}},{key:"renderCurveStatically",value:function(r,i,a,o){var s=this.props,c=s.type,u=s.layout,l=s.connectNulls;s.ref;var d=gv(s,t8),f=bt(bt(bt({},ie(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(a,")"):null,points:r},o),{},{type:c,layout:u,connectNulls:l});return O.createElement(ni,va({},f,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,i){var a=this,o=this.props,s=o.points,c=o.strokeDasharray,u=o.isAnimationActive,l=o.animationBegin,d=o.animationDuration,f=o.animationEasing,h=o.animationId,m=o.animateNewValues,p=o.width,v=o.height,b=this.state,k=b.prevPoints,T=b.totalLength;return O.createElement(Tr,{begin:l,duration:d,isActive:u,easing:f,from:{t:0},to:{t:1},key:"line-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(S){var g=S.t;if(k){var y=k.length/s.length,w=s.map(function(E,M){var N=Math.floor(M*y);if(k[N]){var D=k[N],$=et(D.x,E.x),F=et(D.y,E.y);return bt(bt({},E),{},{x:$(g),y:F(g)})}if(m){var R=et(p*2,E.x),j=et(v/2,E.y);return bt(bt({},E),{},{x:R(g),y:j(g)})}return bt(bt({},E),{},{x:E.x,y:E.y})});return a.renderCurveStatically(w,r,i)}var C=et(0,T),_=C(g),A;if(c){var P="".concat(c).split(/[,\s]+/gim).map(function(E){return parseFloat(E)});A=a.getStrokeDasharray(_,T,P)}else A=a.generateSimpleStrokeDasharray(T,_);return a.renderCurveStatically(s,r,i,{strokeDasharray:A})})}},{key:"renderCurve",value:function(r,i){var a=this.props,o=a.points,s=a.isAnimationActive,c=this.state,u=c.prevPoints,l=c.totalLength;return s&&o&&o.length&&(!u&&l>0||!gi(u,o))?this.renderCurveWithAnimation(r,i):this.renderCurveStatically(o,r,i)}},{key:"render",value:function(){var r,i=this.props,a=i.hide,o=i.dot,s=i.points,c=i.className,u=i.xAxis,l=i.yAxis,d=i.top,f=i.left,h=i.width,m=i.height,p=i.isAnimationActive,v=i.id;if(a||!s||!s.length)return null;var b=this.state.isAnimationFinished,k=s.length===1,T=he("recharts-line",c),S=u&&u.allowDataOverflow,g=l&&l.allowDataOverflow,y=S||g,w=ce(v)?this.id:v,C=(r=ie(o,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},_=C.r,A=_===void 0?3:_,P=C.strokeWidth,E=P===void 0?2:P,M=ob(o)?o:{},N=M.clipDot,D=N===void 0?!0:N,$=A*2+E;return O.createElement(Ce,{className:T},S||g?O.createElement("defs",null,O.createElement("clipPath",{id:"clipPath-".concat(w)},O.createElement("rect",{x:S?f:f-h/2,y:g?d:d-m/2,width:S?h:h*2,height:g?m:m*2})),!D&&O.createElement("clipPath",{id:"clipPath-dots-".concat(w)},O.createElement("rect",{x:f-$/2,y:d-$/2,width:h+$,height:m+$}))):null,!k&&this.renderCurve(y,w),this.renderErrorBar(y,w),(k||o)&&this.renderDots(y,D,w),(!p||b)&&Pn.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return r.animationId!==i.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:i.curPoints}:r.points!==i.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,i){for(var a=r.length%2!==0?[].concat(Fr(r),[0]):r,o=[],s=0;s<i;++s)o=[].concat(Fr(o),Fr(a));return o}},{key:"renderDotItem",value:function(r,i){var a;if(O.isValidElement(r))a=O.cloneElement(r,i);else if(ne(r))a=r(i);else{var o=i.key,s=gv(i,n8),c=he("recharts-line-dot",typeof r!="boolean"?r.className:"");a=O.createElement(Mc,va({key:o},s,{className:c}))}return a}}])}(K.PureComponent);Ut(Fc,"displayName","Line");Ut(Fc,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!tn.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Ut(Fc,"getComposedData",function(t){var e=t.props,n=t.xAxis,r=t.yAxis,i=t.xAxisTicks,a=t.yAxisTicks,o=t.dataKey,s=t.bandSize,c=t.displayedData,u=t.offset,l=e.layout,d=c.map(function(f,h){var m=ut(f,o);return l==="horizontal"?{x:As({axis:n,ticks:i,bandSize:s,entry:f,index:h}),y:ce(m)?null:r.scale(m),value:m,payload:f}:{x:ce(m)?null:n.scale(m),y:As({axis:r,ticks:a,bandSize:s,entry:f,index:h}),value:m,payload:f}});return bt({points:d,layout:l},u)});var m8=["layout","type","stroke","connectNulls","isRange","ref"],g8=["key"],tT;function xi(t){"@babel/helpers - typeof";return xi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xi(t)}function nT(t,e){if(t==null)return{};var n=v8(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function v8(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function vr(){return vr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},vr.apply(this,arguments)}function bv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Bn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?bv(Object(n),!0).forEach(function(r){en(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bv(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function y8(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,iT(r.key),r)}}function b8(t,e,n){return e&&Sv(t.prototype,e),n&&Sv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function S8(t,e,n){return e=Ks(e),T8(t,rT()?Reflect.construct(e,n||[],Ks(t).constructor):e.apply(t,n))}function T8(t,e){if(e&&(xi(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return k8(t)}function k8(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rT(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(rT=function(){return!!t})()}function Ks(t){return Ks=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Ks(t)}function w8(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ad(t,e)}function ad(t,e){return ad=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},ad(t,e)}function en(t,e,n){return e=iT(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iT(t){var e=C8(t,"string");return xi(e)=="symbol"?e:e+""}function C8(t,e){if(xi(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(xi(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Nr=function(t){function e(){var n;y8(this,e);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=S8(this,e,[].concat(i)),en(n,"state",{isAnimationFinished:!0}),en(n,"id",$i("recharts-area-")),en(n,"handleAnimationEnd",function(){var o=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),ne(o)&&o()}),en(n,"handleAnimationStart",function(){var o=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),ne(o)&&o()}),n}return w8(e,t),b8(e,[{key:"renderDots",value:function(r,i,a){var o=this.props.isAnimationActive,s=this.state.isAnimationFinished;if(o&&!s)return null;var c=this.props,u=c.dot,l=c.points,d=c.dataKey,f=ie(this.props,!1),h=ie(u,!0),m=l.map(function(v,b){var k=Bn(Bn(Bn({key:"dot-".concat(b),r:3},f),h),{},{index:b,cx:v.x,cy:v.y,dataKey:d,value:v.value,payload:v.payload,points:l});return e.renderDotItem(u,k)}),p={clipPath:r?"url(#clipPath-".concat(i?"":"dots-").concat(a,")"):null};return O.createElement(Ce,vr({className:"recharts-area-dots"},p),m)}},{key:"renderHorizontalRect",value:function(r){var i=this.props,a=i.baseLine,o=i.points,s=i.strokeWidth,c=o[0].x,u=o[o.length-1].x,l=r*Math.abs(c-u),d=Wn(o.map(function(f){return f.y||0}));return H(a)&&typeof a=="number"?d=Math.max(a,d):a&&Array.isArray(a)&&a.length&&(d=Math.max(Wn(a.map(function(f){return f.y||0})),d)),H(d)?O.createElement("rect",{x:c<u?c:c-l,y:0,width:l,height:Math.floor(d+(s?parseInt("".concat(s),10):1))}):null}},{key:"renderVerticalRect",value:function(r){var i=this.props,a=i.baseLine,o=i.points,s=i.strokeWidth,c=o[0].y,u=o[o.length-1].y,l=r*Math.abs(c-u),d=Wn(o.map(function(f){return f.x||0}));return H(a)&&typeof a=="number"?d=Math.max(a,d):a&&Array.isArray(a)&&a.length&&(d=Math.max(Wn(a.map(function(f){return f.x||0})),d)),H(d)?O.createElement("rect",{x:0,y:c<u?c:c-l,width:d+(s?parseInt("".concat(s),10):1),height:Math.floor(l)}):null}},{key:"renderClipRect",value:function(r){var i=this.props.layout;return i==="vertical"?this.renderVerticalRect(r):this.renderHorizontalRect(r)}},{key:"renderAreaStatically",value:function(r,i,a,o){var s=this.props,c=s.layout,u=s.type,l=s.stroke,d=s.connectNulls,f=s.isRange;s.ref;var h=nT(s,m8);return O.createElement(Ce,{clipPath:a?"url(#clipPath-".concat(o,")"):null},O.createElement(ni,vr({},ie(h,!0),{points:r,connectNulls:d,type:u,baseLine:i,layout:c,stroke:"none",className:"recharts-area-area"})),l!=="none"&&O.createElement(ni,vr({},ie(this.props,!1),{className:"recharts-area-curve",layout:c,type:u,connectNulls:d,fill:"none",points:r})),l!=="none"&&f&&O.createElement(ni,vr({},ie(this.props,!1),{className:"recharts-area-curve",layout:c,type:u,connectNulls:d,fill:"none",points:i})))}},{key:"renderAreaWithAnimation",value:function(r,i){var a=this,o=this.props,s=o.points,c=o.baseLine,u=o.isAnimationActive,l=o.animationBegin,d=o.animationDuration,f=o.animationEasing,h=o.animationId,m=this.state,p=m.prevPoints,v=m.prevBaseLine;return O.createElement(Tr,{begin:l,duration:d,isActive:u,easing:f,from:{t:0},to:{t:1},key:"area-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(b){var k=b.t;if(p){var T=p.length/s.length,S=s.map(function(C,_){var A=Math.floor(_*T);if(p[A]){var P=p[A],E=et(P.x,C.x),M=et(P.y,C.y);return Bn(Bn({},C),{},{x:E(k),y:M(k)})}return C}),g;if(H(c)&&typeof c=="number"){var y=et(v,c);g=y(k)}else if(ce(c)||ji(c)){var w=et(v,0);g=w(k)}else g=c.map(function(C,_){var A=Math.floor(_*T);if(v[A]){var P=v[A],E=et(P.x,C.x),M=et(P.y,C.y);return Bn(Bn({},C),{},{x:E(k),y:M(k)})}return C});return a.renderAreaStatically(S,g,r,i)}return O.createElement(Ce,null,O.createElement("defs",null,O.createElement("clipPath",{id:"animationClipPath-".concat(i)},a.renderClipRect(k))),O.createElement(Ce,{clipPath:"url(#animationClipPath-".concat(i,")")},a.renderAreaStatically(s,c,r,i)))})}},{key:"renderArea",value:function(r,i){var a=this.props,o=a.points,s=a.baseLine,c=a.isAnimationActive,u=this.state,l=u.prevPoints,d=u.prevBaseLine,f=u.totalLength;return c&&o&&o.length&&(!l&&f>0||!gi(l,o)||!gi(d,s))?this.renderAreaWithAnimation(r,i):this.renderAreaStatically(o,s,r,i)}},{key:"render",value:function(){var r,i=this.props,a=i.hide,o=i.dot,s=i.points,c=i.className,u=i.top,l=i.left,d=i.xAxis,f=i.yAxis,h=i.width,m=i.height,p=i.isAnimationActive,v=i.id;if(a||!s||!s.length)return null;var b=this.state.isAnimationFinished,k=s.length===1,T=he("recharts-area",c),S=d&&d.allowDataOverflow,g=f&&f.allowDataOverflow,y=S||g,w=ce(v)?this.id:v,C=(r=ie(o,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},_=C.r,A=_===void 0?3:_,P=C.strokeWidth,E=P===void 0?2:P,M=ob(o)?o:{},N=M.clipDot,D=N===void 0?!0:N,$=A*2+E;return O.createElement(Ce,{className:T},S||g?O.createElement("defs",null,O.createElement("clipPath",{id:"clipPath-".concat(w)},O.createElement("rect",{x:S?l:l-h/2,y:g?u:u-m/2,width:S?h:h*2,height:g?m:m*2})),!D&&O.createElement("clipPath",{id:"clipPath-dots-".concat(w)},O.createElement("rect",{x:l-$/2,y:u-$/2,width:h+$,height:m+$}))):null,k?null:this.renderArea(y,w),(o||k)&&this.renderDots(y,D,w),(!p||b)&&Pn.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return r.animationId!==i.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,curBaseLine:r.baseLine,prevPoints:i.curPoints,prevBaseLine:i.curBaseLine}:r.points!==i.curPoints||r.baseLine!==i.curBaseLine?{curPoints:r.points,curBaseLine:r.baseLine}:null}}])}(K.PureComponent);tT=Nr;en(Nr,"displayName","Area");en(Nr,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!tn.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});en(Nr,"getBaseValue",function(t,e,n,r){var i=t.layout,a=t.baseValue,o=e.props.baseValue,s=o!=null?o:a;if(H(s)&&typeof s=="number")return s;var c=i==="horizontal"?r:n,u=c.scale.domain();if(c.type==="number"){var l=Math.max(u[0],u[1]),d=Math.min(u[0],u[1]);return s==="dataMin"?d:s==="dataMax"||l<0?l:Math.max(Math.min(u[0],u[1]),0)}return s==="dataMin"?u[0]:s==="dataMax"?u[1]:u[0]});en(Nr,"getComposedData",function(t){var e=t.props,n=t.item,r=t.xAxis,i=t.yAxis,a=t.xAxisTicks,o=t.yAxisTicks,s=t.bandSize,c=t.dataKey,u=t.stackedData,l=t.dataStartIndex,d=t.displayedData,f=t.offset,h=e.layout,m=u&&u.length,p=tT.getBaseValue(e,n,r,i),v=h==="horizontal",b=!1,k=d.map(function(S,g){var y;m?y=u[l+g]:(y=ut(S,c),Array.isArray(y)?b=!0:y=[p,y]);var w=y[1]==null||m&&ut(S,c)==null;return v?{x:As({axis:r,ticks:a,bandSize:s,entry:S,index:g}),y:w?null:i.scale(y[1]),value:y,payload:S}:{x:w?null:r.scale(y[1]),y:As({axis:i,ticks:o,bandSize:s,entry:S,index:g}),value:y,payload:S}}),T;return m||b?T=k.map(function(S){var g=Array.isArray(S.value)?S.value[0]:null;return v?{x:S.x,y:g!=null&&S.y!=null?i.scale(g):null}:{x:g!=null?r.scale(g):null,y:S.y}}):T=v?i.scale(p):r.scale(p),Bn({points:k,baseLine:T,layout:h,isRange:b},f)});en(Nr,"renderDotItem",function(t,e){var n;if(O.isValidElement(t))n=O.cloneElement(t,e);else if(ne(t))n=t(e);else{var r=he("recharts-area-dot",typeof t!="boolean"?t.className:""),i=e.key,a=nT(e,g8);n=O.createElement(Mc,vr({},a,{key:i,className:r}))}return n});function Pi(t){"@babel/helpers - typeof";return Pi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pi(t)}function _8(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,sT(r.key),r)}}function x8(t,e,n){return e&&Tv(t.prototype,e),n&&Tv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function P8(t,e,n){return e=Xs(e),O8(t,aT()?Reflect.construct(e,n||[],Xs(t).constructor):e.apply(t,n))}function O8(t,e){if(e&&(Pi(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E8(t)}function E8(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function aT(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(aT=function(){return!!t})()}function Xs(t){return Xs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Xs(t)}function A8(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&od(t,e)}function od(t,e){return od=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},od(t,e)}function oT(t,e,n){return e=sT(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sT(t){var e=I8(t,"string");return Pi(e)=="symbol"?e:e+""}function I8(t,e){if(Pi(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Pi(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sd(){return sd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},sd.apply(this,arguments)}function R8(t){var e=t.xAxisId,n=Yf(),r=Jf(),i=FS(e);return i==null?null:K.createElement(Gi,sd({},i,{className:he("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return wn(o,!0)}}))}var mo=function(t){function e(){return _8(this,e),P8(this,e,arguments)}return A8(e,t),x8(e,[{key:"render",value:function(){return K.createElement(R8,this.props)}}])}(K.Component);oT(mo,"displayName","XAxis");oT(mo,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Oi(t){"@babel/helpers - typeof";return Oi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oi(t)}function M8(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lT(r.key),r)}}function D8(t,e,n){return e&&kv(t.prototype,e),n&&kv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function N8(t,e,n){return e=Ys(e),L8(t,cT()?Reflect.construct(e,n||[],Ys(t).constructor):e.apply(t,n))}function L8(t,e){if(e&&(Oi(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return j8(t)}function j8(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cT(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(cT=function(){return!!t})()}function Ys(t){return Ys=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Ys(t)}function $8(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cd(t,e)}function cd(t,e){return cd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},cd(t,e)}function uT(t,e,n){return e=lT(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lT(t){var e=B8(t,"string");return Oi(e)=="symbol"?e:e+""}function B8(t,e){if(Oi(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Oi(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ud(){return ud=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ud.apply(this,arguments)}var U8=function(e){var n=e.yAxisId,r=Yf(),i=Jf(),a=qS(n);return a==null?null:K.createElement(Gi,ud({},a,{className:he("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:i},ticksGenerator:function(s){return wn(s,!0)}}))},go=function(t){function e(){return M8(this,e),N8(this,e,arguments)}return $8(e,t),D8(e,[{key:"render",value:function(){return K.createElement(U8,this.props)}}])}(K.Component);uT(go,"displayName","YAxis");uT(go,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function wv(t){return W8(t)||V8(t)||q8(t)||F8()}function F8(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function q8(t,e){if(t){if(typeof t=="string")return ld(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ld(t,e)}}function V8(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function W8(t){if(Array.isArray(t))return ld(t)}function ld(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var dd=function(e,n,r,i,a){var o=Nt(e,Zf),s=Nt(e,$c),c=[].concat(wv(o),wv(s)),u=Nt(e,Uc),l="".concat(i,"Id"),d=i[0],f=n;if(c.length&&(f=c.reduce(function(p,v){if(v.props[l]===r&&rn(v.props,"extendDomain")&&H(v.props[d])){var b=v.props[d];return[Math.min(p[0],b),Math.max(p[1],b)]}return p},f)),u.length){var h="".concat(d,"1"),m="".concat(d,"2");f=u.reduce(function(p,v){if(v.props[l]===r&&rn(v.props,"extendDomain")&&H(v.props[h])&&H(v.props[m])){var b=v.props[h],k=v.props[m];return[Math.min(p[0],b,k),Math.max(p[1],b,k)]}return p},f)}return a&&a.length&&(f=a.reduce(function(p,v){return H(v)?[Math.min(p[0],v),Math.max(p[1],v)]:p},f)),f},dT={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(c,u,l){this.fn=c,this.context=u,this.once=l||!1}function a(c,u,l,d,f){if(typeof l!="function")throw new TypeError("The listener must be a function");var h=new i(l,d||c,f),m=n?n+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],h]:c._events[m].push(h):(c._events[m]=h,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new r:delete c._events[u]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var u=[],l,d;if(this._eventsCount===0)return u;for(d in l=this._events)e.call(l,d)&&u.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(l)):u},s.prototype.listeners=function(u){var l=n?n+u:u,d=this._events[l];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,m=new Array(h);f<h;f++)m[f]=d[f].fn;return m},s.prototype.listenerCount=function(u){var l=n?n+u:u,d=this._events[l];return d?d.fn?1:d.length:0},s.prototype.emit=function(u,l,d,f,h,m){var p=n?n+u:u;if(!this._events[p])return!1;var v=this._events[p],b=arguments.length,k,T;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),b){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,l),!0;case 3:return v.fn.call(v.context,l,d),!0;case 4:return v.fn.call(v.context,l,d,f),!0;case 5:return v.fn.call(v.context,l,d,f,h),!0;case 6:return v.fn.call(v.context,l,d,f,h,m),!0}for(T=1,k=new Array(b-1);T<b;T++)k[T-1]=arguments[T];v.fn.apply(v.context,k)}else{var S=v.length,g;for(T=0;T<S;T++)switch(v[T].once&&this.removeListener(u,v[T].fn,void 0,!0),b){case 1:v[T].fn.call(v[T].context);break;case 2:v[T].fn.call(v[T].context,l);break;case 3:v[T].fn.call(v[T].context,l,d);break;case 4:v[T].fn.call(v[T].context,l,d,f);break;default:if(!k)for(g=1,k=new Array(b-1);g<b;g++)k[g-1]=arguments[g];v[T].fn.apply(v[T].context,k)}}return!0},s.prototype.on=function(u,l,d){return a(this,u,l,d,!1)},s.prototype.once=function(u,l,d){return a(this,u,l,d,!0)},s.prototype.removeListener=function(u,l,d,f){var h=n?n+u:u;if(!this._events[h])return this;if(!l)return o(this,h),this;var m=this._events[h];if(m.fn)m.fn===l&&(!f||m.once)&&(!d||m.context===d)&&o(this,h);else{for(var p=0,v=[],b=m.length;p<b;p++)(m[p].fn!==l||f&&!m[p].once||d&&m[p].context!==d)&&v.push(m[p]);v.length?this._events[h]=v.length===1?v[0]:v:o(this,h)}return this},s.prototype.removeAllListeners=function(u){var l;return u?(l=n?n+u:u,this._events[l]&&o(this,l)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s})(dT);var z8=dT.exports;const G8=_e(z8);var Pu=new G8,Ou="recharts.syncMouseEvents";function eo(t){"@babel/helpers - typeof";return eo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eo(t)}function H8(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,fT(r.key),r)}}function K8(t,e,n){return e&&Cv(t.prototype,e),n&&Cv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Eu(t,e,n){return e=fT(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fT(t){var e=X8(t,"string");return eo(e)=="symbol"?e:e+""}function X8(t,e){if(eo(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(eo(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Y8=function(){function t(){H8(this,t),Eu(this,"activeIndex",0),Eu(this,"coordinateList",[]),Eu(this,"layout","horizontal")}return K8(t,[{key:"setDetails",value:function(n){var r,i=n.coordinateList,a=i===void 0?null:i,o=n.container,s=o===void 0?null:o,c=n.layout,u=c===void 0?null:c,l=n.offset,d=l===void 0?null:l,f=n.mouseHandlerCallback,h=f===void 0?null:f;this.coordinateList=(r=a!=null?a:this.coordinateList)!==null&&r!==void 0?r:[],this.container=s!=null?s:this.container,this.layout=u!=null?u:this.layout,this.offset=d!=null?d:this.offset,this.mouseHandlerCallback=h!=null?h:this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,r;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var i=this.container.getBoundingClientRect(),a=i.x,o=i.y,s=i.height,c=this.coordinateList[this.activeIndex].coordinate,u=((n=window)===null||n===void 0?void 0:n.scrollX)||0,l=((r=window)===null||r===void 0?void 0:r.scrollY)||0,d=a+c+u,f=o+this.offset.top+s/2+l;this.mouseHandlerCallback({pageX:d,pageY:f})}}}])}();function J8(t,e,n){if(n==="number"&&e===!0&&Array.isArray(t)){var r=t==null?void 0:t[0],i=t==null?void 0:t[1];if(r&&i&&H(r)&&H(i))return!0}return!1}function Q8(t,e,n,r){var i=r/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-i:n.left+.5,y:t==="horizontal"?n.top+.5:e.y-i,width:t==="horizontal"?r:n.width-1,height:t==="horizontal"?n.height-1:r}}function hT(t){var e=t.cx,n=t.cy,r=t.radius,i=t.startAngle,a=t.endAngle,o=tt(e,n,r,i),s=tt(e,n,r,a);return{points:[o,s],cx:e,cy:n,radius:r,startAngle:i,endAngle:a}}function Z8(t,e,n){var r,i,a,o;if(t==="horizontal")r=e.x,a=r,i=n.top,o=n.top+n.height;else if(t==="vertical")i=e.y,o=i,r=n.left,a=n.left+n.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var s=e.cx,c=e.cy,u=e.innerRadius,l=e.outerRadius,d=e.angle,f=tt(s,c,u,d),h=tt(s,c,l,d);r=f.x,i=f.y,a=h.x,o=h.y}else return hT(e);return[{x:r,y:i},{x:a,y:o}]}function to(t){"@babel/helpers - typeof";return to=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},to(t)}function _v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Io(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?_v(Object(n),!0).forEach(function(r){e6(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_v(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function e6(t,e,n){return e=t6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t6(t){var e=n6(t,"string");return to(e)=="symbol"?e:e+""}function n6(t,e){if(to(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(to(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function r6(t){var e,n,r=t.element,i=t.tooltipEventType,a=t.isActive,o=t.activeCoordinate,s=t.activePayload,c=t.offset,u=t.activeTooltipIndex,l=t.tooltipAxisBandSize,d=t.layout,f=t.chartName,h=(e=r.props.cursor)!==null&&e!==void 0?e:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!h||!a||!o||f!=="ScatterChart"&&i!=="axis")return null;var m,p=ni;if(f==="ScatterChart")m=o,p=Q3;else if(f==="BarChart")m=Q8(d,o,c,l),p=zf;else if(d==="radial"){var v=hT(o),b=v.cx,k=v.cy,T=v.radius,S=v.startAngle,g=v.endAngle;m={cx:b,cy:k,startAngle:S,endAngle:g,innerRadius:T,outerRadius:T},p=bS}else m={points:Z8(d,o,c)},p=ni;var y=Io(Io(Io(Io({stroke:"#ccc",pointerEvents:"none"},c),m),ie(h,!1)),{},{payload:s,payloadIndex:u,className:he("recharts-tooltip-cursor",h.className)});return K.isValidElement(h)?K.cloneElement(h,y):K.createElement(p,y)}var i6=["item"],a6=["children","className","width","height","style","compact","title","desc"];function Ei(t){"@babel/helpers - typeof";return Ei=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ei(t)}function Kr(){return Kr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Kr.apply(this,arguments)}function xv(t,e){return c6(t)||s6(t,e)||mT(t,e)||o6()}function o6(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s6(t,e){var n=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,a,o,s=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(l){u=!0,i=l}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function c6(t){if(Array.isArray(t))return t}function Pv(t,e){if(t==null)return{};var n=u6(t,e),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)r=a[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function u6(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function l6(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ov(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,gT(r.key),r)}}function d6(t,e,n){return e&&Ov(t.prototype,e),n&&Ov(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function f6(t,e,n){return e=Js(e),h6(t,pT()?Reflect.construct(e,n||[],Js(t).constructor):e.apply(t,n))}function h6(t,e){if(e&&(Ei(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return p6(t)}function p6(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pT(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(pT=function(){return!!t})()}function Js(t){return Js=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Js(t)}function m6(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fd(t,e)}function fd(t,e){return fd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},fd(t,e)}function Ai(t){return y6(t)||v6(t)||mT(t)||g6()}function g6(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mT(t,e){if(t){if(typeof t=="string")return hd(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hd(t,e)}}function v6(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function y6(t){if(Array.isArray(t))return hd(t)}function hd(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ev(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ev(Object(n),!0).forEach(function(r){te(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ev(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function te(t,e,n){return e=gT(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gT(t){var e=b6(t,"string");return Ei(e)=="symbol"?e:e+""}function b6(t,e){if(Ei(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ei(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var S6={xAxis:["bottom","top"],yAxis:["left","right"]},T6={width:"100%",height:"100%"},vT={x:0,y:0};function Ro(t){return t}var k6=function(e,n){return n==="horizontal"?e.x:n==="vertical"?e.y:n==="centric"?e.angle:e.radius},w6=function(e,n,r,i){var a=n.find(function(l){return l&&l.index===r});if(a){if(e==="horizontal")return{x:a.coordinate,y:i.y};if(e==="vertical")return{x:i.x,y:a.coordinate};if(e==="centric"){var o=a.coordinate,s=i.radius;return L(L(L({},i),tt(i.cx,i.cy,s,o)),{},{angle:o,radius:s})}var c=a.coordinate,u=i.angle;return L(L(L({},i),tt(i.cx,i.cy,c,u)),{},{angle:u,radius:c})}return vT},qc=function(e,n){var r=n.graphicalItems,i=n.dataStartIndex,a=n.dataEndIndex,o=(r!=null?r:[]).reduce(function(s,c){var u=c.props.data;return u&&u.length?[].concat(Ai(s),Ai(u)):s},[]);return o.length>0?o:e&&e.length&&H(i)&&H(a)?e.slice(i,a+1):[]};function yT(t){return t==="number"?[0,"auto"]:void 0}var pd=function(e,n,r,i){var a=e.graphicalItems,o=e.tooltipAxis,s=qc(n,e);return r<0||!a||!a.length||r>=s.length?null:a.reduce(function(c,u){var l,d=(l=u.props.data)!==null&&l!==void 0?l:n;d&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=r&&(d=d.slice(e.dataStartIndex,e.dataEndIndex+1));var f;if(o.dataKey&&!o.allowDuplicatedCategory){var h=d===void 0?s:d;f=es(h,o.dataKey,i)}else f=d&&d[r]||s[r];return f?[].concat(Ai(c),[gS(u,f)]):c},[])},Av=function(e,n,r,i){var a=i||{x:e.chartX,y:e.chartY},o=k6(a,r),s=e.orderedTooltipTicks,c=e.tooltipAxis,u=e.tooltipTicks,l=OU(o,s,u,c);if(l>=0&&u){var d=u[l]&&u[l].value,f=pd(e,n,l,d),h=w6(r,s,l,a);return{activeTooltipIndex:l,activeLabel:d,activePayload:f,activeCoordinate:h}}return null},C6=function(e,n){var r=n.axes,i=n.graphicalItems,a=n.axisType,o=n.axisIdKey,s=n.stackGroups,c=n.dataStartIndex,u=n.dataEndIndex,l=e.layout,d=e.children,f=e.stackOffset,h=hS(l,a);return r.reduce(function(m,p){var v,b=p.type.defaultProps!==void 0?L(L({},p.type.defaultProps),p.props):p.props,k=b.type,T=b.dataKey,S=b.allowDataOverflow,g=b.allowDuplicatedCategory,y=b.scale,w=b.ticks,C=b.includeHidden,_=b[o];if(m[_])return m;var A=qc(e.data,{graphicalItems:i.filter(function(W){var ee,de=o in W.props?W.props[o]:(ee=W.type.defaultProps)===null||ee===void 0?void 0:ee[o];return de===_}),dataStartIndex:c,dataEndIndex:u}),P=A.length,E,M,N;J8(b.domain,S,k)&&(E=Ul(b.domain,null,S),h&&(k==="number"||y!=="auto")&&(N=ga(A,T,"category")));var D=yT(k);if(!E||E.length===0){var $,F=($=b.domain)!==null&&$!==void 0?$:D;if(T){if(E=ga(A,T,k),k==="category"&&h){var R=bP(E);g&&R?(M=E,E=js(0,P)):g||(E=ug(F,E,p).reduce(function(W,ee){return W.indexOf(ee)>=0?W:[].concat(Ai(W),[ee])},[]))}else if(k==="category")g?E=E.filter(function(W){return W!==""&&!ce(W)}):E=ug(F,E,p).reduce(function(W,ee){return W.indexOf(ee)>=0||ee===""||ce(ee)?W:[].concat(Ai(W),[ee])},[]);else if(k==="number"){var j=MU(A,i.filter(function(W){var ee,de,Se=o in W.props?W.props[o]:(ee=W.type.defaultProps)===null||ee===void 0?void 0:ee[o],xe="hide"in W.props?W.props.hide:(de=W.type.defaultProps)===null||de===void 0?void 0:de.hide;return Se===_&&(C||!xe)}),T,a,l);j&&(E=j)}h&&(k==="number"||y!=="auto")&&(N=ga(A,T,"category"))}else h?E=js(0,P):s&&s[_]&&s[_].hasStack&&k==="number"?E=f==="expand"?[0,1]:mS(s[_].stackGroups,c,u):E=fS(A,i.filter(function(W){var ee=o in W.props?W.props[o]:W.type.defaultProps[o],de="hide"in W.props?W.props.hide:W.type.defaultProps.hide;return ee===_&&(C||!de)}),k,l,!0);if(k==="number")E=dd(d,E,_,a,w),F&&(E=Ul(F,E,S));else if(k==="category"&&F){var q=F,J=E.every(function(W){return q.indexOf(W)>=0});J&&(E=q)}}return L(L({},m),{},te({},_,L(L({},b),{},{axisType:a,domain:E,categoricalDomain:N,duplicateDomain:M,originalDomain:(v=b.domain)!==null&&v!==void 0?v:D,isCategorical:h,layout:l})))},{})},_6=function(e,n){var r=n.graphicalItems,i=n.Axis,a=n.axisType,o=n.axisIdKey,s=n.stackGroups,c=n.dataStartIndex,u=n.dataEndIndex,l=e.layout,d=e.children,f=qc(e.data,{graphicalItems:r,dataStartIndex:c,dataEndIndex:u}),h=f.length,m=hS(l,a),p=-1;return r.reduce(function(v,b){var k=b.type.defaultProps!==void 0?L(L({},b.type.defaultProps),b.props):b.props,T=k[o],S=yT("number");if(!v[T]){p++;var g;return m?g=js(0,h):s&&s[T]&&s[T].hasStack?(g=mS(s[T].stackGroups,c,u),g=dd(d,g,T,a)):(g=Ul(S,fS(f,r.filter(function(y){var w,C,_=o in y.props?y.props[o]:(w=y.type.defaultProps)===null||w===void 0?void 0:w[o],A="hide"in y.props?y.props.hide:(C=y.type.defaultProps)===null||C===void 0?void 0:C.hide;return _===T&&!A}),"number",l),i.defaultProps.allowDataOverflow),g=dd(d,g,T,a)),L(L({},v),{},te({},T,L(L({axisType:a},i.defaultProps),{},{hide:!0,orientation:Dt(S6,"".concat(a,".").concat(p%2),null),domain:g,originalDomain:S,isCategorical:m,layout:l})))}return v},{})},x6=function(e,n){var r=n.axisType,i=r===void 0?"xAxis":r,a=n.AxisComp,o=n.graphicalItems,s=n.stackGroups,c=n.dataStartIndex,u=n.dataEndIndex,l=e.children,d="".concat(i,"Id"),f=Nt(l,a),h={};return f&&f.length?h=C6(e,{axes:f,graphicalItems:o,axisType:i,axisIdKey:d,stackGroups:s,dataStartIndex:c,dataEndIndex:u}):o&&o.length&&(h=_6(e,{Axis:a,graphicalItems:o,axisType:i,axisIdKey:d,stackGroups:s,dataStartIndex:c,dataEndIndex:u})),h},P6=function(e){var n=qn(e),r=wn(n,!1,!0);return{tooltipTicks:r,orderedTooltipTicks:yf(r,function(i){return i.coordinate}),tooltipAxis:n,tooltipAxisBandSize:Is(n,r)}},Iv=function(e){var n=e.children,r=e.defaultShowTooltip,i=Tt(n,bi),a=0,o=0;return e.data&&e.data.length!==0&&(o=e.data.length-1),i&&i.props&&(i.props.startIndex>=0&&(a=i.props.startIndex),i.props.endIndex>=0&&(o=i.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:a,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!r}},O6=function(e){return!e||!e.length?!1:e.some(function(n){var r=Cn(n&&n.type);return r&&r.indexOf("Bar")>=0})},Rv=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},E6=function(e,n){var r=e.props,i=e.graphicalItems,a=e.xAxisMap,o=a===void 0?{}:a,s=e.yAxisMap,c=s===void 0?{}:s,u=r.width,l=r.height,d=r.children,f=r.margin||{},h=Tt(d,bi),m=Tt(d,Zr),p=Object.keys(c).reduce(function(g,y){var w=c[y],C=w.orientation;return!w.mirror&&!w.hide?L(L({},g),{},te({},C,g[C]+w.width)):g},{left:f.left||0,right:f.right||0}),v=Object.keys(o).reduce(function(g,y){var w=o[y],C=w.orientation;return!w.mirror&&!w.hide?L(L({},g),{},te({},C,Dt(g,"".concat(C))+w.height)):g},{top:f.top||0,bottom:f.bottom||0}),b=L(L({},v),p),k=b.bottom;h&&(b.bottom+=h.props.height||bi.defaultProps.height),m&&n&&(b=IU(b,i,r,n));var T=u-b.left-b.right,S=l-b.top-b.bottom;return L(L({brushBottom:k},b),{},{width:Math.max(T,0),height:Math.max(S,0)})},A6=function(e,n){if(n==="xAxis")return e[n].width;if(n==="yAxis")return e[n].height},nh=function(e){var n=e.chartName,r=e.GraphicalChild,i=e.defaultTooltipEventType,a=i===void 0?"axis":i,o=e.validateTooltipEventTypes,s=o===void 0?["axis"]:o,c=e.axisComponents,u=e.legendContent,l=e.formatAxisMap,d=e.defaultProps,f=function(b,k){var T=k.graphicalItems,S=k.stackGroups,g=k.offset,y=k.updateId,w=k.dataStartIndex,C=k.dataEndIndex,_=b.barSize,A=b.layout,P=b.barGap,E=b.barCategoryGap,M=b.maxBarSize,N=Rv(A),D=N.numericAxisName,$=N.cateAxisName,F=O6(T),R=[];return T.forEach(function(j,q){var J=qc(b.data,{graphicalItems:[j],dataStartIndex:w,dataEndIndex:C}),W=j.type.defaultProps!==void 0?L(L({},j.type.defaultProps),j.props):j.props,ee=W.dataKey,de=W.maxBarSize,Se=W["".concat(D,"Id")],xe=W["".concat($,"Id")],_t={},dt=c.reduce(function(or,sr){var eu=k["".concat(sr.axisType,"Map")],Rh=W["".concat(sr.axisType,"Id")];eu&&eu[Rh]||sr.axisType==="zAxis"||_r(!1);var Mh=eu[Rh];return L(L({},or),{},te(te({},sr.axisType,Mh),"".concat(sr.axisType,"Ticks"),wn(Mh)))},_t),Q=dt[$],re=dt["".concat($,"Ticks")],oe=S&&S[Se]&&S[Se].hasStack&&zU(j,S[Se].stackGroups),V=Cn(j.type).indexOf("Bar")>=0,Re=Is(Q,re),me=[],qe=F&&EU({barSize:_,stackGroups:S,totalSize:A6(dt,$)});if(V){var Ve,ft,Ln=ce(de)?M:de,jr=(Ve=(ft=Is(Q,re,!0))!==null&&ft!==void 0?ft:Ln)!==null&&Ve!==void 0?Ve:0;me=AU({barGap:P,barCategoryGap:E,bandSize:jr!==Re?jr:Re,sizeList:qe[xe],maxBarSize:Ln}),jr!==Re&&(me=me.map(function(or){return L(L({},or),{},{position:L(L({},or.position),{},{offset:or.position.offset-jr/2})})}))}var vo=j&&j.type&&j.type.getComposedData;vo&&R.push({props:L(L({},vo(L(L({},dt),{},{displayedData:J,props:b,dataKey:ee,item:j,bandSize:Re,barPosition:me,offset:g,stackedData:oe,layout:A,dataStartIndex:w,dataEndIndex:C}))),{},te(te(te({key:j.key||"item-".concat(q)},D,dt[D]),$,dt[$]),"animationId",y)),childIndex:IP(j,b.children),item:j})}),R},h=function(b,k){var T=b.props,S=b.dataStartIndex,g=b.dataEndIndex,y=b.updateId;if(!Zh({props:T}))return null;var w=T.children,C=T.layout,_=T.stackOffset,A=T.data,P=T.reverseStackOrder,E=Rv(C),M=E.numericAxisName,N=E.cateAxisName,D=Nt(w,r),$=qU(A,D,"".concat(M,"Id"),"".concat(N,"Id"),_,P),F=c.reduce(function(W,ee){var de="".concat(ee.axisType,"Map");return L(L({},W),{},te({},de,x6(T,L(L({},ee),{},{graphicalItems:D,stackGroups:ee.axisType===M&&$,dataStartIndex:S,dataEndIndex:g}))))},{}),R=E6(L(L({},F),{},{props:T,graphicalItems:D}),k==null?void 0:k.legendBBox);Object.keys(F).forEach(function(W){F[W]=l(T,F[W],R,W.replace("Map",""),n)});var j=F["".concat(N,"Map")],q=P6(j),J=f(T,L(L({},F),{},{dataStartIndex:S,dataEndIndex:g,updateId:y,graphicalItems:D,stackGroups:$,offset:R}));return L(L({formattedGraphicalItems:J,graphicalItems:D,offset:R,stackGroups:$},q),F)},m=function(v){function b(k){var T,S,g;return l6(this,b),g=f6(this,b,[k]),te(g,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),te(g,"accessibilityManager",new Y8),te(g,"handleLegendBBoxUpdate",function(y){if(y){var w=g.state,C=w.dataStartIndex,_=w.dataEndIndex,A=w.updateId;g.setState(L({legendBBox:y},h({props:g.props,dataStartIndex:C,dataEndIndex:_,updateId:A},L(L({},g.state),{},{legendBBox:y}))))}}),te(g,"handleReceiveSyncEvent",function(y,w,C){if(g.props.syncId===y){if(C===g.eventEmitterSymbol&&typeof g.props.syncMethod!="function")return;g.applySyncEvent(w)}}),te(g,"handleBrushChange",function(y){var w=y.startIndex,C=y.endIndex;if(w!==g.state.dataStartIndex||C!==g.state.dataEndIndex){var _=g.state.updateId;g.setState(function(){return L({dataStartIndex:w,dataEndIndex:C},h({props:g.props,dataStartIndex:w,dataEndIndex:C,updateId:_},g.state))}),g.triggerSyncEvent({dataStartIndex:w,dataEndIndex:C})}}),te(g,"handleMouseEnter",function(y){var w=g.getMouseInfo(y);if(w){var C=L(L({},w),{},{isTooltipActive:!0});g.setState(C),g.triggerSyncEvent(C);var _=g.props.onMouseEnter;ne(_)&&_(C,y)}}),te(g,"triggeredAfterMouseMove",function(y){var w=g.getMouseInfo(y),C=w?L(L({},w),{},{isTooltipActive:!0}):{isTooltipActive:!1};g.setState(C),g.triggerSyncEvent(C);var _=g.props.onMouseMove;ne(_)&&_(C,y)}),te(g,"handleItemMouseEnter",function(y){g.setState(function(){return{isTooltipActive:!0,activeItem:y,activePayload:y.tooltipPayload,activeCoordinate:y.tooltipPosition||{x:y.cx,y:y.cy}}})}),te(g,"handleItemMouseLeave",function(){g.setState(function(){return{isTooltipActive:!1}})}),te(g,"handleMouseMove",function(y){y.persist(),g.throttleTriggeredAfterMouseMove(y)}),te(g,"handleMouseLeave",function(y){g.throttleTriggeredAfterMouseMove.cancel();var w={isTooltipActive:!1};g.setState(w),g.triggerSyncEvent(w);var C=g.props.onMouseLeave;ne(C)&&C(w,y)}),te(g,"handleOuterEvent",function(y){var w=AP(y),C=Dt(g.props,"".concat(w));if(w&&ne(C)){var _,A;/.*touch.*/i.test(w)?A=g.getMouseInfo(y.changedTouches[0]):A=g.getMouseInfo(y),C((_=A)!==null&&_!==void 0?_:{},y)}}),te(g,"handleClick",function(y){var w=g.getMouseInfo(y);if(w){var C=L(L({},w),{},{isTooltipActive:!0});g.setState(C),g.triggerSyncEvent(C);var _=g.props.onClick;ne(_)&&_(C,y)}}),te(g,"handleMouseDown",function(y){var w=g.props.onMouseDown;if(ne(w)){var C=g.getMouseInfo(y);w(C,y)}}),te(g,"handleMouseUp",function(y){var w=g.props.onMouseUp;if(ne(w)){var C=g.getMouseInfo(y);w(C,y)}}),te(g,"handleTouchMove",function(y){y.changedTouches!=null&&y.changedTouches.length>0&&g.throttleTriggeredAfterMouseMove(y.changedTouches[0])}),te(g,"handleTouchStart",function(y){y.changedTouches!=null&&y.changedTouches.length>0&&g.handleMouseDown(y.changedTouches[0])}),te(g,"handleTouchEnd",function(y){y.changedTouches!=null&&y.changedTouches.length>0&&g.handleMouseUp(y.changedTouches[0])}),te(g,"handleDoubleClick",function(y){var w=g.props.onDoubleClick;if(ne(w)){var C=g.getMouseInfo(y);w(C,y)}}),te(g,"handleContextMenu",function(y){var w=g.props.onContextMenu;if(ne(w)){var C=g.getMouseInfo(y);w(C,y)}}),te(g,"triggerSyncEvent",function(y){g.props.syncId!==void 0&&Pu.emit(Ou,g.props.syncId,y,g.eventEmitterSymbol)}),te(g,"applySyncEvent",function(y){var w=g.props,C=w.layout,_=w.syncMethod,A=g.state.updateId,P=y.dataStartIndex,E=y.dataEndIndex;if(y.dataStartIndex!==void 0||y.dataEndIndex!==void 0)g.setState(L({dataStartIndex:P,dataEndIndex:E},h({props:g.props,dataStartIndex:P,dataEndIndex:E,updateId:A},g.state)));else if(y.activeTooltipIndex!==void 0){var M=y.chartX,N=y.chartY,D=y.activeTooltipIndex,$=g.state,F=$.offset,R=$.tooltipTicks;if(!F)return;if(typeof _=="function")D=_(R,y);else if(_==="value"){D=-1;for(var j=0;j<R.length;j++)if(R[j].value===y.activeLabel){D=j;break}}var q=L(L({},F),{},{x:F.left,y:F.top}),J=Math.min(M,q.x+q.width),W=Math.min(N,q.y+q.height),ee=R[D]&&R[D].value,de=pd(g.state,g.props.data,D),Se=R[D]?{x:C==="horizontal"?R[D].coordinate:J,y:C==="horizontal"?W:R[D].coordinate}:vT;g.setState(L(L({},y),{},{activeLabel:ee,activeCoordinate:Se,activePayload:de,activeTooltipIndex:D}))}else g.setState(y)}),te(g,"renderCursor",function(y){var w,C=g.state,_=C.isTooltipActive,A=C.activeCoordinate,P=C.activePayload,E=C.offset,M=C.activeTooltipIndex,N=C.tooltipAxisBandSize,D=g.getTooltipEventType(),$=(w=y.props.active)!==null&&w!==void 0?w:_,F=g.props.layout,R=y.key||"_recharts-cursor";return O.createElement(r6,{key:R,activeCoordinate:A,activePayload:P,activeTooltipIndex:M,chartName:n,element:y,isActive:$,layout:F,offset:E,tooltipAxisBandSize:N,tooltipEventType:D})}),te(g,"renderPolarAxis",function(y,w,C){var _=Dt(y,"type.axisType"),A=Dt(g.state,"".concat(_,"Map")),P=y.type.defaultProps,E=P!==void 0?L(L({},P),y.props):y.props,M=A&&A[E["".concat(_,"Id")]];return K.cloneElement(y,L(L({},M),{},{className:he(_,M.className),key:y.key||"".concat(w,"-").concat(C),ticks:wn(M,!0)}))}),te(g,"renderPolarGrid",function(y){var w=y.props,C=w.radialLines,_=w.polarAngles,A=w.polarRadius,P=g.state,E=P.radiusAxisMap,M=P.angleAxisMap,N=qn(E),D=qn(M),$=D.cx,F=D.cy,R=D.innerRadius,j=D.outerRadius;return K.cloneElement(y,{polarAngles:Array.isArray(_)?_:wn(D,!0).map(function(q){return q.coordinate}),polarRadius:Array.isArray(A)?A:wn(N,!0).map(function(q){return q.coordinate}),cx:$,cy:F,innerRadius:R,outerRadius:j,key:y.key||"polar-grid",radialLines:C})}),te(g,"renderLegend",function(){var y=g.state.formattedGraphicalItems,w=g.props,C=w.children,_=w.width,A=w.height,P=g.props.margin||{},E=_-(P.left||0)-(P.right||0),M=lS({children:C,formattedGraphicalItems:y,legendWidth:E,legendContent:u});if(!M)return null;var N=M.item,D=Pv(M,i6);return K.cloneElement(N,L(L({},D),{},{chartWidth:_,chartHeight:A,margin:P,onBBoxUpdate:g.handleLegendBBoxUpdate}))}),te(g,"renderTooltip",function(){var y,w=g.props,C=w.children,_=w.accessibilityLayer,A=Tt(C,mn);if(!A)return null;var P=g.state,E=P.isTooltipActive,M=P.activeCoordinate,N=P.activePayload,D=P.activeLabel,$=P.offset,F=(y=A.props.active)!==null&&y!==void 0?y:E;return K.cloneElement(A,{viewBox:L(L({},$),{},{x:$.left,y:$.top}),active:F,label:D,payload:F?N:[],coordinate:M,accessibilityLayer:_})}),te(g,"renderBrush",function(y){var w=g.props,C=w.margin,_=w.data,A=g.state,P=A.offset,E=A.dataStartIndex,M=A.dataEndIndex,N=A.updateId;return K.cloneElement(y,{key:y.key||"_recharts-brush",onChange:Po(g.handleBrushChange,y.props.onChange),data:_,x:H(y.props.x)?y.props.x:P.left,y:H(y.props.y)?y.props.y:P.top+P.height+P.brushBottom-(C.bottom||0),width:H(y.props.width)?y.props.width:P.width,startIndex:E,endIndex:M,updateId:"brush-".concat(N)})}),te(g,"renderReferenceElement",function(y,w,C){if(!y)return null;var _=g,A=_.clipPathId,P=g.state,E=P.xAxisMap,M=P.yAxisMap,N=P.offset,D=y.type.defaultProps||{},$=y.props,F=$.xAxisId,R=F===void 0?D.xAxisId:F,j=$.yAxisId,q=j===void 0?D.yAxisId:j;return K.cloneElement(y,{key:y.key||"".concat(w,"-").concat(C),xAxis:E[R],yAxis:M[q],viewBox:{x:N.left,y:N.top,width:N.width,height:N.height},clipPathId:A})}),te(g,"renderActivePoints",function(y){var w=y.item,C=y.activePoint,_=y.basePoint,A=y.childIndex,P=y.isRange,E=[],M=w.props.key,N=w.item.type.defaultProps!==void 0?L(L({},w.item.type.defaultProps),w.item.props):w.item.props,D=N.activeDot,$=N.dataKey,F=L(L({index:A,dataKey:$,cx:C.x,cy:C.y,r:4,fill:Wf(w.item),strokeWidth:2,stroke:"#fff",payload:C.payload,value:C.value},ie(D,!1)),ts(D));return E.push(b.renderActiveDot(D,F,"".concat(M,"-activePoint-").concat(A))),_?E.push(b.renderActiveDot(D,L(L({},F),{},{cx:_.x,cy:_.y}),"".concat(M,"-basePoint-").concat(A))):P&&E.push(null),E}),te(g,"renderGraphicChild",function(y,w,C){var _=g.filterFormatItem(y,w,C);if(!_)return null;var A=g.getTooltipEventType(),P=g.state,E=P.isTooltipActive,M=P.tooltipAxis,N=P.activeTooltipIndex,D=P.activeLabel,$=g.props.children,F=Tt($,mn),R=_.props,j=R.points,q=R.isRange,J=R.baseLine,W=_.item.type.defaultProps!==void 0?L(L({},_.item.type.defaultProps),_.item.props):_.item.props,ee=W.activeDot,de=W.hide,Se=W.activeBar,xe=W.activeShape,_t=!!(!de&&E&&F&&(ee||Se||xe)),dt={};A!=="axis"&&F&&F.props.trigger==="click"?dt={onClick:Po(g.handleItemMouseEnter,y.props.onClick)}:A!=="axis"&&(dt={onMouseLeave:Po(g.handleItemMouseLeave,y.props.onMouseLeave),onMouseEnter:Po(g.handleItemMouseEnter,y.props.onMouseEnter)});var Q=K.cloneElement(y,L(L({},_.props),dt));function re(sr){return typeof M.dataKey=="function"?M.dataKey(sr.payload):null}if(_t)if(N>=0){var oe,V;if(M.dataKey&&!M.allowDuplicatedCategory){var Re=typeof M.dataKey=="function"?re:"payload.".concat(M.dataKey.toString());oe=es(j,Re,D),V=q&&J&&es(J,Re,D)}else oe=j==null?void 0:j[N],V=q&&J&&J[N];if(xe||Se){var me=y.props.activeIndex!==void 0?y.props.activeIndex:N;return[K.cloneElement(y,L(L(L({},_.props),dt),{},{activeIndex:me})),null,null]}if(!ce(oe))return[Q].concat(Ai(g.renderActivePoints({item:_,activePoint:oe,basePoint:V,childIndex:N,isRange:q})))}else{var qe,Ve=(qe=g.getItemByXY(g.state.activeCoordinate))!==null&&qe!==void 0?qe:{graphicalItem:Q},ft=Ve.graphicalItem,Ln=ft.item,jr=Ln===void 0?y:Ln,vo=ft.childIndex,or=L(L(L({},_.props),dt),{},{activeIndex:vo});return[K.cloneElement(jr,or),null,null]}return q?[Q,null,null]:[Q,null]}),te(g,"renderCustomized",function(y,w,C){return K.cloneElement(y,L(L({key:"recharts-customized-".concat(C)},g.props),g.state))}),te(g,"renderMap",{CartesianGrid:{handler:Ro,once:!0},ReferenceArea:{handler:g.renderReferenceElement},ReferenceLine:{handler:Ro},ReferenceDot:{handler:g.renderReferenceElement},XAxis:{handler:Ro},YAxis:{handler:Ro},Brush:{handler:g.renderBrush,once:!0},Bar:{handler:g.renderGraphicChild},Line:{handler:g.renderGraphicChild},Area:{handler:g.renderGraphicChild},Radar:{handler:g.renderGraphicChild},RadialBar:{handler:g.renderGraphicChild},Scatter:{handler:g.renderGraphicChild},Pie:{handler:g.renderGraphicChild},Funnel:{handler:g.renderGraphicChild},Tooltip:{handler:g.renderCursor,once:!0},PolarGrid:{handler:g.renderPolarGrid,once:!0},PolarAngleAxis:{handler:g.renderPolarAxis},PolarRadiusAxis:{handler:g.renderPolarAxis},Customized:{handler:g.renderCustomized}}),g.clipPathId="".concat((T=k.id)!==null&&T!==void 0?T:$i("recharts"),"-clip"),g.throttleTriggeredAfterMouseMove=u0(g.triggeredAfterMouseMove,(S=k.throttleDelay)!==null&&S!==void 0?S:1e3/60),g.state={},g}return m6(b,v),d6(b,[{key:"componentDidMount",value:function(){var T,S;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(T=this.props.margin.left)!==null&&T!==void 0?T:0,top:(S=this.props.margin.top)!==null&&S!==void 0?S:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var T=this.props,S=T.children,g=T.data,y=T.height,w=T.layout,C=Tt(S,mn);if(C){var _=C.props.defaultIndex;if(!(typeof _!="number"||_<0||_>this.state.tooltipTicks.length-1)){var A=this.state.tooltipTicks[_]&&this.state.tooltipTicks[_].value,P=pd(this.state,g,_,A),E=this.state.tooltipTicks[_].coordinate,M=(this.state.offset.top+y)/2,N=w==="horizontal",D=N?{x:E,y:M}:{y:E,x:M},$=this.state.formattedGraphicalItems.find(function(R){var j=R.item;return j.type.name==="Scatter"});$&&(D=L(L({},D),$.props.points[_].tooltipPosition),P=$.props.points[_].tooltipPayload);var F={activeTooltipIndex:_,isTooltipActive:!0,activeLabel:A,activePayload:P,activeCoordinate:D};this.setState(F),this.renderCursor(C),this.accessibilityManager.setIndex(_)}}}},{key:"getSnapshotBeforeUpdate",value:function(T,S){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==S.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==T.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==T.margin){var g,y;this.accessibilityManager.setDetails({offset:{left:(g=this.props.margin.left)!==null&&g!==void 0?g:0,top:(y=this.props.margin.top)!==null&&y!==void 0?y:0}})}return null}},{key:"componentDidUpdate",value:function(T){tl([Tt(T.children,mn)],[Tt(this.props.children,mn)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var T=Tt(this.props.children,mn);if(T&&typeof T.props.shared=="boolean"){var S=T.props.shared?"axis":"item";return s.indexOf(S)>=0?S:a}return a}},{key:"getMouseInfo",value:function(T){if(!this.container)return null;var S=this.container,g=S.getBoundingClientRect(),y=ej(g),w={chartX:Math.round(T.pageX-y.left),chartY:Math.round(T.pageY-y.top)},C=g.width/S.offsetWidth||1,_=this.inRange(w.chartX,w.chartY,C);if(!_)return null;var A=this.state,P=A.xAxisMap,E=A.yAxisMap,M=this.getTooltipEventType(),N=Av(this.state,this.props.data,this.props.layout,_);if(M!=="axis"&&P&&E){var D=qn(P).scale,$=qn(E).scale,F=D&&D.invert?D.invert(w.chartX):null,R=$&&$.invert?$.invert(w.chartY):null;return L(L({},w),{},{xValue:F,yValue:R},N)}return N?L(L({},w),N):null}},{key:"inRange",value:function(T,S){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,y=this.props.layout,w=T/g,C=S/g;if(y==="horizontal"||y==="vertical"){var _=this.state.offset,A=w>=_.left&&w<=_.left+_.width&&C>=_.top&&C<=_.top+_.height;return A?{x:w,y:C}:null}var P=this.state,E=P.angleAxisMap,M=P.radiusAxisMap;if(E&&M){var N=qn(E);return fg({x:w,y:C},N)}return null}},{key:"parseEventsOfWrapper",value:function(){var T=this.props.children,S=this.getTooltipEventType(),g=Tt(T,mn),y={};g&&S==="axis"&&(g.props.trigger==="click"?y={onClick:this.handleClick}:y={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var w=ts(this.props,this.handleOuterEvent);return L(L({},w),y)}},{key:"addListener",value:function(){Pu.on(Ou,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){Pu.removeListener(Ou,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(T,S,g){for(var y=this.state.formattedGraphicalItems,w=0,C=y.length;w<C;w++){var _=y[w];if(_.item===T||_.props.key===T.key||S===Cn(_.item.type)&&g===_.childIndex)return _}return null}},{key:"renderClipPath",value:function(){var T=this.clipPathId,S=this.state.offset,g=S.left,y=S.top,w=S.height,C=S.width;return O.createElement("defs",null,O.createElement("clipPath",{id:T},O.createElement("rect",{x:g,y,height:w,width:C})))}},{key:"getXScales",value:function(){var T=this.state.xAxisMap;return T?Object.entries(T).reduce(function(S,g){var y=xv(g,2),w=y[0],C=y[1];return L(L({},S),{},te({},w,C.scale))},{}):null}},{key:"getYScales",value:function(){var T=this.state.yAxisMap;return T?Object.entries(T).reduce(function(S,g){var y=xv(g,2),w=y[0],C=y[1];return L(L({},S),{},te({},w,C.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(T){var S;return(S=this.state.xAxisMap)===null||S===void 0||(S=S[T])===null||S===void 0?void 0:S.scale}},{key:"getYScaleByAxisId",value:function(T){var S;return(S=this.state.yAxisMap)===null||S===void 0||(S=S[T])===null||S===void 0?void 0:S.scale}},{key:"getItemByXY",value:function(T){var S=this.state,g=S.formattedGraphicalItems,y=S.activeItem;if(g&&g.length)for(var w=0,C=g.length;w<C;w++){var _=g[w],A=_.props,P=_.item,E=P.type.defaultProps!==void 0?L(L({},P.type.defaultProps),P.props):P.props,M=Cn(P.type);if(M==="Bar"){var N=(A.data||[]).find(function(R){return q3(T,R)});if(N)return{graphicalItem:_,payload:N}}else if(M==="RadialBar"){var D=(A.data||[]).find(function(R){return fg(T,R)});if(D)return{graphicalItem:_,payload:D}}else if(Dc(_,y)||Nc(_,y)||Xa(_,y)){var $=zq({graphicalItem:_,activeTooltipItem:y,itemData:E.data}),F=E.activeIndex===void 0?$:E.activeIndex;return{graphicalItem:L(L({},_),{},{childIndex:F}),payload:Xa(_,y)?E.data[$]:_.props.data[$]}}}return null}},{key:"render",value:function(){var T=this;if(!Zh(this))return null;var S=this.props,g=S.children,y=S.className,w=S.width,C=S.height,_=S.style,A=S.compact,P=S.title,E=S.desc,M=Pv(S,a6),N=ie(M,!1);if(A)return O.createElement(ev,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},O.createElement(rl,Kr({},N,{width:w,height:C,title:P,desc:E}),this.renderClipPath(),tp(g,this.renderMap)));if(this.props.accessibilityLayer){var D,$;N.tabIndex=(D=this.props.tabIndex)!==null&&D!==void 0?D:0,N.role=($=this.props.role)!==null&&$!==void 0?$:"application",N.onKeyDown=function(R){T.accessibilityManager.keyboardEvent(R)},N.onFocus=function(){T.accessibilityManager.focus()}}var F=this.parseEventsOfWrapper();return O.createElement(ev,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},O.createElement("div",Kr({className:he("recharts-wrapper",y),style:L({position:"relative",cursor:"default",width:w,height:C},_)},F,{ref:function(j){T.container=j}}),O.createElement(rl,Kr({},N,{width:w,height:C,title:P,desc:E,style:T6}),this.renderClipPath(),tp(g,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(K.Component);te(m,"displayName",n),te(m,"defaultProps",L({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},d)),te(m,"getDerivedStateFromProps",function(v,b){var k=v.dataKey,T=v.data,S=v.children,g=v.width,y=v.height,w=v.layout,C=v.stackOffset,_=v.margin,A=b.dataStartIndex,P=b.dataEndIndex;if(b.updateId===void 0){var E=Iv(v);return L(L(L({},E),{},{updateId:0},h(L(L({props:v},E),{},{updateId:0}),b)),{},{prevDataKey:k,prevData:T,prevWidth:g,prevHeight:y,prevLayout:w,prevStackOffset:C,prevMargin:_,prevChildren:S})}if(k!==b.prevDataKey||T!==b.prevData||g!==b.prevWidth||y!==b.prevHeight||w!==b.prevLayout||C!==b.prevStackOffset||!Qr(_,b.prevMargin)){var M=Iv(v),N={chartX:b.chartX,chartY:b.chartY,isTooltipActive:b.isTooltipActive},D=L(L({},Av(b,T,w)),{},{updateId:b.updateId+1}),$=L(L(L({},M),N),D);return L(L(L({},$),h(L({props:v},$),b)),{},{prevDataKey:k,prevData:T,prevWidth:g,prevHeight:y,prevLayout:w,prevStackOffset:C,prevMargin:_,prevChildren:S})}if(!tl(S,b.prevChildren)){var F,R,j,q,J=Tt(S,bi),W=J&&(F=(R=J.props)===null||R===void 0?void 0:R.startIndex)!==null&&F!==void 0?F:A,ee=J&&(j=(q=J.props)===null||q===void 0?void 0:q.endIndex)!==null&&j!==void 0?j:P,de=W!==A||ee!==P,Se=!ce(T),xe=Se&&!de?b.updateId:b.updateId+1;return L(L({updateId:xe},h(L(L({props:v},b),{},{updateId:xe,dataStartIndex:W,dataEndIndex:ee}),b)),{},{prevChildren:S,dataStartIndex:W,dataEndIndex:ee})}return null}),te(m,"renderActiveDot",function(v,b,k){var T;return K.isValidElement(v)?T=K.cloneElement(v,b):ne(v)?T=v(b):T=O.createElement(Mc,b),O.createElement(Ce,{className:"recharts-active-dot",key:k},T)});var p=K.forwardRef(function(b,k){return O.createElement(m,Kr({},b,{ref:k}))});return p.displayName=m.displayName,p},HK=nh({chartName:"LineChart",GraphicalChild:Fc,axisComponents:[{axisType:"xAxis",AxisComp:mo},{axisType:"yAxis",AxisComp:go}],formatAxisMap:Gf}),KK=nh({chartName:"BarChart",GraphicalChild:zi,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:mo},{axisType:"yAxis",AxisComp:go}],formatAxisMap:Gf}),XK=nh({chartName:"AreaChart",GraphicalChild:Nr,axisComponents:[{axisType:"xAxis",AxisComp:mo},{axisType:"yAxis",AxisComp:go}],formatAxisMap:Gf});const cn=Object.create(null);cn.open="0";cn.close="1";cn.ping="2";cn.pong="3";cn.message="4";cn.upgrade="5";cn.noop="6";const $o=Object.create(null);Object.keys(cn).forEach(t=>{$o[cn[t]]=t});const md={type:"error",data:"parser error"},bT=typeof Blob=="function"||typeof Blob!="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",ST=typeof ArrayBuffer=="function",TT=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,rh=({type:t,data:e},n,r)=>bT&&e instanceof Blob?n?r(e):Mv(e,r):ST&&(e instanceof ArrayBuffer||TT(e))?n?r(e):Mv(new Blob([e]),r):r(cn[t]+(e||"")),Mv=(t,e)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];e("b"+(r||""))},n.readAsDataURL(t)};function Dv(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let Au;function I6(t,e){if(bT&&t.data instanceof Blob)return t.data.arrayBuffer().then(Dv).then(e);if(ST&&(t.data instanceof ArrayBuffer||TT(t.data)))return e(Dv(t.data));rh(t,!1,n=>{Au||(Au=new TextEncoder),e(Au.encode(n))})}const Nv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",da=typeof Uint8Array=="undefined"?[]:new Uint8Array(256);for(let t=0;t<Nv.length;t++)da[Nv.charCodeAt(t)]=t;const R6=t=>{let e=t.length*.75,n=t.length,r,i=0,a,o,s,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const u=new ArrayBuffer(e),l=new Uint8Array(u);for(r=0;r<n;r+=4)a=da[t.charCodeAt(r)],o=da[t.charCodeAt(r+1)],s=da[t.charCodeAt(r+2)],c=da[t.charCodeAt(r+3)],l[i++]=a<<2|o>>4,l[i++]=(o&15)<<4|s>>2,l[i++]=(s&3)<<6|c&63;return u},M6=typeof ArrayBuffer=="function",ih=(t,e)=>{if(typeof t!="string")return{type:"message",data:kT(t,e)};const n=t.charAt(0);return n==="b"?{type:"message",data:D6(t.substring(1),e)}:$o[n]?t.length>1?{type:$o[n],data:t.substring(1)}:{type:$o[n]}:md},D6=(t,e)=>{if(M6){const n=R6(t);return kT(n,e)}else return{base64:!0,data:t}},kT=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},wT=String.fromCharCode(30),N6=(t,e)=>{const n=t.length,r=new Array(n);let i=0;t.forEach((a,o)=>{rh(a,!1,s=>{r[o]=s,++i===n&&e(r.join(wT))})})},L6=(t,e)=>{const n=t.split(wT),r=[];for(let i=0;i<n.length;i++){const a=ih(n[i],e);if(r.push(a),a.type==="error")break}return r};function j6(){return new TransformStream({transform(t,e){I6(t,n=>{const r=n.length;let i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);const a=new DataView(i.buffer);a.setUint8(0,126),a.setUint16(1,r)}else{i=new Uint8Array(9);const a=new DataView(i.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(r))}t.data&&typeof t.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(n)})}})}let Iu;function Mo(t){return t.reduce((e,n)=>e+n.length,0)}function Do(t,e){if(t[0].length===e)return t.shift();const n=new Uint8Array(e);let r=0;for(let i=0;i<e;i++)n[i]=t[0][r++],r===t[0].length&&(t.shift(),r=0);return t.length&&r<t[0].length&&(t[0]=t[0].slice(r)),n}function $6(t,e){Iu||(Iu=new TextDecoder);const n=[];let r=0,i=-1,a=!1;return new TransformStream({transform(o,s){for(n.push(o);;){if(r===0){if(Mo(n)<1)break;const c=Do(n,1);a=(c[0]&128)===128,i=c[0]&127,i<126?r=3:i===126?r=1:r=2}else if(r===1){if(Mo(n)<2)break;const c=Do(n,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),r=3}else if(r===2){if(Mo(n)<8)break;const c=Do(n,8),u=new DataView(c.buffer,c.byteOffset,c.length),l=u.getUint32(0);if(l>Math.pow(2,53-32)-1){s.enqueue(md);break}i=l*Math.pow(2,32)+u.getUint32(4),r=3}else{if(Mo(n)<i)break;const c=Do(n,i);s.enqueue(ih(a?c:Iu.decode(c),e)),r=0}if(i===0||i>t){s.enqueue(md);break}}}})}const CT=4;function Ue(t){if(t)return B6(t)}function B6(t){for(var e in Ue.prototype)t[e]=Ue.prototype[e];return t}Ue.prototype.on=Ue.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};Ue.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this};Ue.prototype.off=Ue.prototype.removeListener=Ue.prototype.removeAllListeners=Ue.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===e||r.fn===e){n.splice(i,1);break}return n.length===0&&delete this._callbacks["$"+t],this};Ue.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,e)}return this};Ue.prototype.emitReserved=Ue.prototype.emit;Ue.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};Ue.prototype.hasListeners=function(t){return!!this.listeners(t).length};const Vc=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,n)=>n(e,0))(),It=(()=>typeof self!="undefined"?self:typeof window!="undefined"?window:Function("return this")())(),U6="arraybuffer";function _T(t,...e){return e.reduce((n,r)=>(t.hasOwnProperty(r)&&(n[r]=t[r]),n),{})}const F6=It.setTimeout,q6=It.clearTimeout;function Wc(t,e){e.useNativeTimers?(t.setTimeoutFn=F6.bind(It),t.clearTimeoutFn=q6.bind(It)):(t.setTimeoutFn=It.setTimeout.bind(It),t.clearTimeoutFn=It.clearTimeout.bind(It))}const V6=1.33;function W6(t){return typeof t=="string"?z6(t):Math.ceil((t.byteLength||t.size)*V6)}function z6(t){let e=0,n=0;for(let r=0,i=t.length;r<i;r++)e=t.charCodeAt(r),e<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(r++,n+=4);return n}function xT(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function G6(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}function H6(t){let e={},n=t.split("&");for(let r=0,i=n.length;r<i;r++){let a=n[r].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}class K6 extends Error{constructor(e,n,r){super(e),this.description=n,this.context=r,this.type="TransportError"}}class ah extends Ue{constructor(e){super(),this.writable=!1,Wc(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,n,r){return super.emitReserved("error",new K6(e,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const n=ih(e,this.socket.binaryType);this.onPacket(n)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,n={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const n=G6(e);return n.length?"?"+n:""}}class X6 extends ah{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const n=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};L6(e,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,N6(e,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=xT()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(e,n)}}let PT=!1;try{PT=typeof XMLHttpRequest!="undefined"&&"withCredentials"in new XMLHttpRequest}catch(t){}const Y6=PT;function J6(){}class Q6 extends X6{constructor(e){if(super(e),typeof location!="undefined"){const n=location.protocol==="https:";let r=location.port;r||(r=n?"443":"80"),this.xd=typeof location!="undefined"&&e.hostname!==location.hostname||r!==e.port}}doWrite(e,n){const r=this.request({method:"POST",data:e});r.on("success",n),r.on("error",(i,a)=>{this.onError("xhr post error",i,a)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=e}}class an extends Ue{constructor(e,n,r){super(),this.createRequest=e,Wc(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var e;const n=_T(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this._opts.extraHeaders[i])}}catch(i){}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(i){}try{r.setRequestHeader("Accept","*/*")}catch(i){}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var i;r.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document!="undefined"&&(this._index=an.requestsCount++,an.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr=="undefined"||this._xhr===null)){if(this._xhr.onreadystatechange=J6,e)try{this._xhr.abort()}catch(n){}typeof document!="undefined"&&delete an.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}an.requestsCount=0;an.requests={};if(typeof document!="undefined"){if(typeof attachEvent=="function")attachEvent("onunload",Lv);else if(typeof addEventListener=="function"){const t="onpagehide"in It?"pagehide":"unload";addEventListener(t,Lv,!1)}}function Lv(){for(let t in an.requests)an.requests.hasOwnProperty(t)&&an.requests[t].abort()}const Z6=function(){const t=OT({xdomain:!1});return t&&t.responseType!==null}();class ez extends Q6{constructor(e){super(e);const n=e&&e.forceBase64;this.supportsBinary=Z6&&!n}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new an(OT,this.uri(),e)}}function OT(t){const e=t.xdomain;try{if(typeof XMLHttpRequest!="undefined"&&(!e||Y6))return new XMLHttpRequest}catch(n){}if(!e)try{return new It[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(n){}}const ET=typeof navigator!="undefined"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class tz extends ah{get name(){return"websocket"}doOpen(){const e=this.uri(),n=this.opts.protocols,r=ET?{}:_T(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,n,r)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const r=e[n],i=n===e.length-1;rh(r,this.supportsBinary,a=>{try{this.doWrite(r,a)}catch(o){}i&&Vc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws!="undefined"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=xT()),this.supportsBinary||(n.b64=1),this.createUri(e,n)}}const Ru=It.WebSocket||It.MozWebSocket;class nz extends tz{createSocket(e,n,r){return ET?new Ru(e,n,r):n?new Ru(e,n):new Ru(e)}doWrite(e,n){this.ws.send(n)}}class rz extends ah{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const n=$6(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(n).getReader(),i=j6();i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();const a=()=>{r.read().then(({done:s,value:c})=>{s||(this.onPacket(c),a())}).catch(s=>{})};a();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const r=e[n],i=n===e.length-1;this._writer.write(r).then(()=>{i&&Vc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const iz={websocket:nz,webtransport:rz,polling:ez},az=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,oz=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function gd(t){if(t.length>8e3)throw"URI too long";const e=t,n=t.indexOf("["),r=t.indexOf("]");n!=-1&&r!=-1&&(t=t.substring(0,n)+t.substring(n,r).replace(/:/g,";")+t.substring(r,t.length));let i=az.exec(t||""),a={},o=14;for(;o--;)a[oz[o]]=i[o]||"";return n!=-1&&r!=-1&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=sz(a,a.path),a.queryKey=cz(a,a.query),a}function sz(t,e){const n=/\/{2,9}/g,r=e.replace(n,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function cz(t,e){const n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,i,a){i&&(n[i]=a)}),n}const vd=typeof addEventListener=="function"&&typeof removeEventListener=="function",Bo=[];vd&&addEventListener("offline",()=>{Bo.forEach(t=>t())},!1);class Kn extends Ue{constructor(e,n){if(super(),this.binaryType=U6,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(n=e,e=null),e){const r=gd(e);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=gd(n.host).host);Wc(this,n),this.secure=n.secure!=null?n.secure:typeof location!="undefined"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location!="undefined"?location.hostname:"localhost"),this.port=n.port||(typeof location!="undefined"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{const i=r.prototype.name;this.transports.push(i),this._transportsByName[i]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=H6(this.opts.query)),vd&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Bo.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const n=Object.assign({},this.opts.query);n.EIO=CT,n.transport=e,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Kn.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(e);n.open(),this.setTransport(n)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",Kn.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=e.data,this._onError(n);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const i=this.writeBuffer[r].data;if(i&&(n+=W6(i)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Vc(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,n,r){return this._sendPacket("message",e,n,r),this}send(e,n,r){return this._sendPacket("message",e,n,r),this}_sendPacket(e,n,r,i){if(typeof n=="function"&&(i=n,n=void 0),typeof r=="function"&&(i=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const a={type:e,data:n,options:r};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),e()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(Kn.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),vd&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=Bo.indexOf(this._offlineEventListener);r!==-1&&Bo.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,n),this.writeBuffer=[],this._prevBufferLen=0}}}Kn.protocol=CT;class uz extends Kn{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let n=this.createTransport(e),r=!1;Kn.priorWebsocketSuccess=!1;const i=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",d=>{if(!r)if(d.type==="pong"&&d.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;Kn.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(l(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const f=new Error("probe error");f.transport=n.name,this.emitReserved("upgradeError",f)}}))};function a(){r||(r=!0,l(),n.close(),n=null)}const o=d=>{const f=new Error("probe error: "+d);f.transport=n.name,a(),this.emitReserved("upgradeError",f)};function s(){o("transport closed")}function c(){o("socket closed")}function u(d){n&&d.name!==n.name&&a()}const l=()=>{n.removeListener("open",i),n.removeListener("error",o),n.removeListener("close",s),this.off("close",c),this.off("upgrading",u)};n.once("open",i),n.once("error",o),n.once("close",s),this.once("close",c),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const n=[];for(let r=0;r<e.length;r++)~this.transports.indexOf(e[r])&&n.push(e[r]);return n}}let lz=class extends uz{constructor(e,n={}){const r=typeof e=="object"?e:n;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(i=>iz[i]).filter(i=>!!i)),super(e,r)}};function dz(t,e="",n){let r=t;n=n||typeof location!="undefined"&&location,t==null&&(t=n.protocol+"//"+n.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=n.protocol+t:t=n.host+t),/^(https?|wss?):\/\//.test(t)||(typeof n!="undefined"?t=n.protocol+"//"+t:t="https://"+t),r=gd(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const a=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port+e,r.href=r.protocol+"://"+a+(n&&n.port===r.port?"":":"+r.port),r}const fz=typeof ArrayBuffer=="function",hz=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,AT=Object.prototype.toString,pz=typeof Blob=="function"||typeof Blob!="undefined"&&AT.call(Blob)==="[object BlobConstructor]",mz=typeof File=="function"||typeof File!="undefined"&&AT.call(File)==="[object FileConstructor]";function oh(t){return fz&&(t instanceof ArrayBuffer||hz(t))||pz&&t instanceof Blob||mz&&t instanceof File}function Uo(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let n=0,r=t.length;n<r;n++)if(Uo(t[n]))return!0;return!1}if(oh(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Uo(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&Uo(t[n]))return!0;return!1}function gz(t){const e=[],n=t.data,r=t;return r.data=yd(n,e),r.attachments=e.length,{packet:r,buffers:e}}function yd(t,e){if(!t)return t;if(oh(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}else if(Array.isArray(t)){const n=new Array(t.length);for(let r=0;r<t.length;r++)n[r]=yd(t[r],e);return n}else if(typeof t=="object"&&!(t instanceof Date)){const n={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=yd(t[r],e));return n}return t}function vz(t,e){return t.data=bd(t.data,e),delete t.attachments,t}function bd(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=bd(t[n],e);else if(typeof t=="object")for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=bd(t[n],e));return t}const yz=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],bz=5;var fe;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(fe||(fe={}));class Sz{constructor(e){this.replacer=e}encode(e){return(e.type===fe.EVENT||e.type===fe.ACK)&&Uo(e)?this.encodeAsBinary({type:e.type===fe.EVENT?fe.BINARY_EVENT:fe.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let n=""+e.type;return(e.type===fe.BINARY_EVENT||e.type===fe.BINARY_ACK)&&(n+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(n+=e.nsp+","),e.id!=null&&(n+=e.id),e.data!=null&&(n+=JSON.stringify(e.data,this.replacer)),n}encodeAsBinary(e){const n=gz(e),r=this.encodeAsString(n.packet),i=n.buffers;return i.unshift(r),i}}function jv(t){return Object.prototype.toString.call(t)==="[object Object]"}class sh extends Ue{constructor(e){super(),this.reviver=e}add(e){let n;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(e);const r=n.type===fe.BINARY_EVENT;r||n.type===fe.BINARY_ACK?(n.type=r?fe.EVENT:fe.ACK,this.reconstructor=new Tz(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(oh(e)||e.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(e),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let n=0;const r={type:Number(e.charAt(0))};if(fe[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===fe.BINARY_EVENT||r.type===fe.BINARY_ACK){const a=n+1;for(;e.charAt(++n)!=="-"&&n!=e.length;);const o=e.substring(a,n);if(o!=Number(o)||e.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(o)}if(e.charAt(n+1)==="/"){const a=n+1;for(;++n&&!(e.charAt(n)===","||n===e.length););r.nsp=e.substring(a,n)}else r.nsp="/";const i=e.charAt(n+1);if(i!==""&&Number(i)==i){const a=n+1;for(;++n;){const o=e.charAt(n);if(o==null||Number(o)!=o){--n;break}if(n===e.length)break}r.id=Number(e.substring(a,n+1))}if(e.charAt(++n)){const a=this.tryParse(e.substr(n));if(sh.isPayloadValid(r.type,a))r.data=a;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(n){return!1}}static isPayloadValid(e,n){switch(e){case fe.CONNECT:return jv(n);case fe.DISCONNECT:return n===void 0;case fe.CONNECT_ERROR:return typeof n=="string"||jv(n);case fe.EVENT:case fe.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&yz.indexOf(n[0])===-1);case fe.ACK:case fe.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Tz{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const n=vz(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const kz=Object.freeze(Object.defineProperty({__proto__:null,Decoder:sh,Encoder:Sz,get PacketType(){return fe},protocol:bz},Symbol.toStringTag,{value:"Module"}));function Ft(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const wz=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class IT extends Ue{constructor(e,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Ft(e,"open",this.onopen.bind(this)),Ft(e,"packet",this.onpacket.bind(this)),Ft(e,"error",this.onerror.bind(this)),Ft(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...n){var r,i,a;if(wz.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(n.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const o={type:fe.EVENT,data:n};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const l=this.ids++,d=n.pop();this._registerAckCallback(l,d),o.id=l}const s=(i=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||i===void 0?void 0:i.writable,c=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!s||(c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,n){var r;const i=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(i===void 0){this.acks[e]=n;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let s=0;s<this.sendBuffer.length;s++)this.sendBuffer[s].id===e&&this.sendBuffer.splice(s,1);n.call(this,new Error("operation has timed out"))},i),o=(...s)=>{this.io.clearTimeoutFn(a),n.apply(this,s)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...n){return new Promise((r,i)=>{const a=(o,s)=>o?i(o):r(s);a.withError=!0,n.push(a),this.emit(e,...n)})}_addToQueue(e){let n;typeof e[e.length-1]=="function"&&(n=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...a)=>r!==this._queue[0]?void 0:(i!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(i)):(this._queue.shift(),n&&n(null,...a)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!e||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:fe.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(r=>String(r.id)===e)){const r=this.acks[e];delete this.acks[e],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case fe.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case fe.EVENT:case fe.BINARY_EVENT:this.onevent(e);break;case fe.ACK:case fe.BINARY_ACK:this.onack(e);break;case fe.DISCONNECT:this.ondisconnect();break;case fe.CONNECT_ERROR:this.destroy();const r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){const n=e.data||[];e.id!=null&&n.push(this.ack(e.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const n=this;let r=!1;return function(...i){r||(r=!0,n.packet({type:fe.ACK,id:e,data:i}))}}onack(e){const n=this.acks[e.id];typeof n=="function"&&(delete this.acks[e.id],n.withError&&e.data.unshift(null),n.apply(this,e.data))}onconnect(e,n){this.id=e,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:fe.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(e===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(e===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,e.data)}}}function Hi(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Hi.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=Math.floor(e*10)&1?t+n:t-n}return Math.min(t,this.max)|0};Hi.prototype.reset=function(){this.attempts=0};Hi.prototype.setMin=function(t){this.ms=t};Hi.prototype.setMax=function(t){this.max=t};Hi.prototype.setJitter=function(t){this.jitter=t};class Sd extends Ue{constructor(e,n){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(n=e,e=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,Wc(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Hi({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=e;const i=n.parser||kz;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var n;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(n=this.backoff)===null||n===void 0||n.setMin(e),this)}randomizationFactor(e){var n;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(n=this.backoff)===null||n===void 0||n.setJitter(e),this)}reconnectionDelayMax(e){var n;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(n=this.backoff)===null||n===void 0||n.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new lz(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const i=Ft(n,"open",function(){r.onopen(),e&&e()}),a=s=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",s),e?e(s):this.maybeReconnectOnOpen()},o=Ft(n,"error",a);if(this._timeout!==!1){const s=this._timeout,c=this.setTimeoutFn(()=>{i(),a(new Error("timeout")),n.close()},s);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(i),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Ft(e,"ping",this.onping.bind(this)),Ft(e,"data",this.ondata.bind(this)),Ft(e,"error",this.onerror.bind(this)),Ft(e,"close",this.onclose.bind(this)),Ft(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(n){this.onclose("parse error",n)}}ondecoded(e){Vc(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,n){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new IT(this,e,n),this.nsps[e]=r),r}_destroy(e){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(e){const n=this.encoder.encode(e);for(let r=0;r<n.length;r++)this.engine.write(n[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,n){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const ia={};function Mu(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const n=dz(t,e.path||"/socket.io"),r=n.source,i=n.id,a=n.path,o=ia[i]&&a in ia[i].nsps,s=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let c;return s?c=new Sd(r,e):(ia[i]||(ia[i]=new Sd(r,e)),c=ia[i]),n.query&&!e.query&&(e.query=n.queryKey),c.socket(n.path,e)}Object.assign(Mu,{Manager:Sd,Socket:IT,io:Mu,connect:Mu});function Cz(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}var _z=Object.defineProperty,xz=(t,e,n)=>e in t?_z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$v=(t,e,n)=>xz(t,typeof e!="symbol"?e+"":e,n);class gt{constructor(){$v(this,"_locking"),$v(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),r}}function Ne(t,e){if(!t)throw new Error(e)}const Pz=34028234663852886e22,Oz=-34028234663852886e22,Ez=4294967295,Az=2147483647,Iz=-2147483648;function Fo(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>Az||t<Iz)throw new Error("invalid int 32: "+t)}function Td(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>Ez||t<0)throw new Error("invalid uint 32: "+t)}function RT(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>Pz||t<Oz))throw new Error("invalid float 32: "+t)}const MT=Symbol("@bufbuild/protobuf/enum-type");function Rz(t){const e=t[MT];return Ne(e,"missing enum type on enum object"),e}function DT(t,e,n,r){t[MT]=NT(e,n.map(i=>({no:i.no,name:i.name,localName:t[i.no]})))}function NT(t,e,n){const r=Object.create(null),i=Object.create(null),a=[];for(const o of e){const s=LT(o);a.push(s),r[o.name]=s,i[o.no]=s}return{typeName:t,values:a,findName(o){return r[o]},findNumber(o){return i[o]}}}function Mz(t,e,n){const r={};for(const i of e){const a=LT(i);r[a.localName]=a.no,r[a.no]=a.localName}return DT(r,t,e),r}function LT(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class ch{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const r=this.getType(),i=r.runtime.bin,a=i.makeReadOptions(n);return i.readMessage(this,a.readerFactory(e),e.byteLength,a),this}fromJson(e,n){const r=this.getType(),i=r.runtime.json,a=i.makeReadOptions(n);return i.readMessage(r,e,a,this),this}fromJsonString(e,n){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,n)}toBinary(e){const n=this.getType(),r=n.runtime.bin,i=r.makeWriteOptions(e),a=i.writerFactory();return r.writeMessage(this,a,i),a.finish()}toJson(e){const n=this.getType(),r=n.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var n;const r=this.toJson(e);return JSON.stringify(r,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function Dz(t,e,n,r){var i;const a=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),o={[a]:function(s){t.util.initFields(this),t.util.initPartial(s,this)}}[a];return Object.setPrototypeOf(o.prototype,new ch),Object.assign(o,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(s,c){return new o().fromBinary(s,c)},fromJson(s,c){return new o().fromJson(s,c)},fromJsonString(s,c){return new o().fromJsonString(s,c)},equals(s,c){return t.util.equals(o,s,c)}}),o}function Nz(){let t=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function Du(t,e,n){for(let a=0;a<28;a=a+7){const o=t>>>a,s=!(!(o>>>7)&&e==0),c=(s?o|128:o)&255;if(n.push(c),!s)return}const r=t>>>28&15|(e&7)<<4,i=!!(e>>3);if(n.push((i?r|128:r)&255),!!i){for(let a=3;a<31;a=a+7){const o=e>>>a,s=!!(o>>>7),c=(s?o|128:o)&255;if(n.push(c),!s)return}n.push(e>>>31&1)}}const qo=4294967296;function Bv(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let r=0,i=0;function a(o,s){const c=Number(t.slice(o,s));i*=n,r=r*n+c,r>=qo&&(i=i+(r/qo|0),r=r%qo)}return a(-24,-18),a(-18,-12),a(-12,-6),a(-6),e?$T(r,i):uh(r,i)}function Lz(t,e){let n=uh(t,e);const r=n.hi&2147483648;r&&(n=$T(n.lo,n.hi));const i=jT(n.lo,n.hi);return r?"-"+i:i}function jT(t,e){if({lo:t,hi:e}=jz(t,e),e<=2097151)return String(qo*e+t);const n=t&16777215,r=(t>>>24|e<<8)&16777215,i=e>>16&65535;let a=n+r*6777216+i*6710656,o=r+i*8147497,s=i*2;const c=1e7;return a>=c&&(o+=Math.floor(a/c),a%=c),o>=c&&(s+=Math.floor(o/c),o%=c),s.toString()+Uv(o)+Uv(a)}function jz(t,e){return{lo:t>>>0,hi:e>>>0}}function uh(t,e){return{lo:t|0,hi:e|0}}function $T(t,e){return e=~e,t?t=~t+1:e+=1,uh(t,e)}const Uv=t=>{const e=String(t);return"0000000".slice(e.length)+e};function Fv(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function $z(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function Bz(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof{}!="object"||{}.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),a=BigInt("9223372036854775807"),o=BigInt("0"),s=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(c){const u=typeof c=="bigint"?c:BigInt(c);if(u>a||u<i)throw new Error("int64 invalid: ".concat(c));return u},uParse(c){const u=typeof c=="bigint"?c:BigInt(c);if(u>s||u<o)throw new Error("uint64 invalid: ".concat(c));return u},enc(c){return t.setBigInt64(0,this.parse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(c){return t.setBigInt64(0,this.uParse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(c,u){return t.setInt32(0,c,!0),t.setInt32(4,u,!0),t.getBigInt64(0,!0)},uDec(c,u){return t.setInt32(0,c,!0),t.setInt32(4,u,!0),t.getBigUint64(0,!0)}}}const n=i=>Ne(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>Ne(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),n(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),n(i),Bv(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),Bv(i)},dec(i,a){return Lz(i,a)},uDec(i,a){return jT(i,a)}}}const Ae=Bz();var U;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(U||(U={}));var Qn;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(Qn||(Qn={}));function jn(t,e,n){if(e===n)return!0;if(t==U.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}switch(t){case U.UINT64:case U.FIXED64:case U.INT64:case U.SFIXED64:case U.SINT64:return e==n}return!1}function Ii(t,e){switch(t){case U.BOOL:return!1;case U.UINT64:case U.FIXED64:case U.INT64:case U.SFIXED64:case U.SINT64:return e==0?Ae.zero:"0";case U.DOUBLE:case U.FLOAT:return 0;case U.BYTES:return new Uint8Array(0);case U.STRING:return"";default:return 0}}function BT(t,e){switch(t){case U.BOOL:return e===!1;case U.STRING:return e==="";case U.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var je;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(je||(je={}));class Uz{constructor(e){this.stack=[],this.textEncoder=e!=null?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let n=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Td(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Fo(e),Fv(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){RT(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){Td(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Fo(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Fo(e),e=(e<<1^e>>31)>>>0,Fv(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=Ae.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=Ae.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}int64(e){let n=Ae.enc(e);return Du(n.lo,n.hi,this.buf),this}sint64(e){let n=Ae.enc(e),r=n.hi>>31,i=n.lo<<1^r,a=(n.hi<<1|n.lo>>>31)^r;return Du(i,a,this.buf),this}uint64(e){let n=Ae.uEnc(e);return Du(n.lo,n.hi,this.buf),this}}class Fz{constructor(e,n){this.varint64=Nz,this.uint32=$z,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n!=null?n:new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e,n){let r=this.pos;switch(e){case je.Varint:for(;this.buf[this.pos++]&128;);break;case je.Bit64:this.pos+=4;case je.Bit32:this.pos+=4;break;case je.LengthDelimited:let i=this.uint32();this.pos+=i;break;case je.StartGroup:for(;;){const[a,o]=this.tag();if(o===je.EndGroup){if(n!==void 0&&a!==n)throw new Error("invalid end group tag");break}this.skip(o,a)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return Ae.dec(...this.varint64())}uint64(){return Ae.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,Ae.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Ae.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Ae.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function qz(t,e,n,r){let i;return{typeName:e,extendee:n,get field(){if(!i){const a=typeof r=="function"?r():r;a.name=e.split(".").pop(),a.jsonName="[".concat(e,"]"),i=t.util.newFieldList([a]).list()[0]}return i},runtime:t}}function UT(t){const e=t.field.localName,n=Object.create(null);return n[e]=Vz(t),[n,()=>n[e]]}function Vz(t){const e=t.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return Ii(e.T,e.L);case"message":const n=e.T,r=new n;return n.fieldWrapper?n.fieldWrapper.unwrapField(r):r;case"map":throw"map fields are not allowed to be extensions"}}function Wz(t,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let n=t.length-1;n>=0;--n)if(t[n].no==e.no)return[t[n]];return[]}return t.filter(n=>n.no===e.no)}let vn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),zc=[];for(let t=0;t<vn.length;t++)zc[vn[t].charCodeAt(0)]=t;zc["-".charCodeAt(0)]=vn.indexOf("+");zc["_".charCodeAt(0)]=vn.indexOf("/");const FT={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),r=0,i=0,a,o=0;for(let s=0;s<t.length;s++){if(a=zc[t.charCodeAt(s)],a===void 0)switch(t[s]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:o=a,i=1;break;case 1:n[r++]=o<<2|(a&48)>>4,o=a,i=2;break;case 2:n[r++]=(o&15)<<4|(a&60)>>2,o=a,i=3;break;case 3:n[r++]=(o&3)<<6|a,i=0;break}}if(i==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(t){let e="",n=0,r,i=0;for(let a=0;a<t.length;a++)switch(r=t[a],n){case 0:e+=vn[r>>2],i=(r&3)<<4,n=1;break;case 1:e+=vn[i|r>>4],i=(r&15)<<2,n=2;break;case 2:e+=vn[i|r>>6],e+=vn[r&63],n=0;break}return n&&(e+=vn[i],e+="=",n==1&&(e+="=")),e}};function zz(t,e,n){VT(e,t);const r=e.runtime.bin.makeReadOptions(n),i=Wz(t.getType().runtime.bin.listUnknownFields(t),e.field),[a,o]=UT(e);for(const s of i)e.runtime.bin.readField(a,r.readerFactory(s.data),e.field,s.wireType,r);return o()}function Gz(t,e,n,r){VT(e,t);const i=e.runtime.bin.makeReadOptions(r),a=e.runtime.bin.makeWriteOptions(r);if(qT(t,e)){const u=t.getType().runtime.bin.listUnknownFields(t).filter(l=>l.no!=e.field.no);t.getType().runtime.bin.discardUnknownFields(t);for(const l of u)t.getType().runtime.bin.onUnknownField(t,l.no,l.wireType,l.data)}const o=a.writerFactory();let s=e.field;!s.opt&&!s.repeated&&(s.kind=="enum"||s.kind=="scalar")&&(s=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(s,n,o,a);const c=i.readerFactory(o.finish());for(;c.pos<c.len;){const[u,l]=c.tag(),d=c.skip(l,u);t.getType().runtime.bin.onUnknownField(t,u,l,d)}}function qT(t,e){const n=t.getType();return e.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(t).find(r=>r.no==e.field.no)}function VT(t,e){Ne(t.extendee.typeName==e.getType().typeName,"extension ".concat(t.typeName," can only be applied to message ").concat(t.extendee.typeName))}function WT(t,e){const n=t.localName;if(t.repeated)return e[n].length>0;if(t.oneof)return e[t.oneof.localName].case===n;switch(t.kind){case"enum":case"scalar":return t.opt||t.req?e[n]!==void 0:t.kind=="enum"?e[n]!==t.T.values[0].no:!BT(t.T,e[n]);case"message":return e[n]!==void 0;case"map":return Object.keys(e[n]).length>0}}function qv(t,e){const n=t.localName,r=!t.opt&&!t.req;if(t.repeated)e[n]=[];else if(t.oneof)e[t.oneof.localName]={case:void 0};else switch(t.kind){case"map":e[n]={};break;case"enum":e[n]=r?t.T.values[0].no:void 0;break;case"scalar":e[n]=r?Ii(t.T,t.L):void 0;break;case"message":e[n]=void 0;break}}function yn(t,e){if(t===null||typeof t!="object"||!Object.getOwnPropertyNames(ch.prototype).every(r=>r in t&&typeof t[r]=="function"))return!1;const n=t.getType();return n===null||typeof n!="function"||!("typeName"in n)||typeof n.typeName!="string"?!1:e===void 0?!0:n.typeName==e.typeName}function zT(t,e){return yn(e)||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}U.DOUBLE,U.FLOAT,U.INT64,U.UINT64,U.INT32,U.UINT32,U.BOOL,U.STRING,U.BYTES;const Vv={ignoreUnknownFields:!1},Wv={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function Hz(t){return t?Object.assign(Object.assign({},Vv),t):Vv}function Kz(t){return t?Object.assign(Object.assign({},Wv),t):Wv}const Qs=Symbol(),Vo=Symbol();function Xz(){return{makeReadOptions:Hz,makeWriteOptions:Kz,readMessage(t,e,n,r){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(t.typeName," from JSON: ").concat(Jt(e)));r=r!=null?r:new t;const i=new Map,a=n.typeRegistry;for(const[o,s]of Object.entries(e)){const c=t.fields.findJsonName(o);if(c){if(c.oneof){if(s===null&&c.kind=="scalar")continue;const u=i.get(c.oneof);if(u!==void 0)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: multiple keys for oneof "').concat(c.oneof.name,'" present: "').concat(u,'", "').concat(o,'"'));i.set(c.oneof,o)}zv(r,s,c,n,t)}else{let u=!1;if(a!=null&&a.findExtension&&o.startsWith("[")&&o.endsWith("]")){const l=a.findExtension(o.substring(1,o.length-1));if(l&&l.extendee.typeName==t.typeName){u=!0;const[d,f]=UT(l);zv(d,s,l.field,n,l),Gz(r,l,f(),n)}}if(!u&&!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: key "').concat(o,'" is unknown'))}}return r},writeMessage(t,e){const n=t.getType(),r={};let i;try{for(i of n.fields.byNumber()){if(!WT(i,t)){if(i.req)throw"required field not set";if(!e.emitDefaultValues||!Jz(i))continue}const o=i.oneof?t[i.oneof.localName].value:t[i.localName],s=Gv(i,o,e);s!==void 0&&(r[e.useProtoFieldName?i.name:i.jsonName]=s)}const a=e.typeRegistry;if(a!=null&&a.findExtensionFor)for(const o of n.runtime.bin.listUnknownFields(t)){const s=a.findExtensionFor(n.typeName,o.no);if(s&&qT(t,s)){const c=zz(t,s,e),u=Gv(s.field,c,e);u!==void 0&&(r[s.field.jsonName]=u)}}}catch(a){const o=i?"cannot encode field ".concat(n.typeName,".").concat(i.name," to JSON"):"cannot encode message ".concat(n.typeName," to JSON"),s=a instanceof Error?a.message:String(a);throw new Error(o+(s.length>0?": ".concat(s):""))}return r},readScalar(t,e,n){return ya(t,e,n!=null?n:Qn.BIGINT,!0)},writeScalar(t,e,n){if(e!==void 0&&(n||BT(t,e)))return Wo(t,e)},debug:Jt}}function Jt(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function zv(t,e,n,r,i){let a=n.localName;if(n.repeated){if(Ne(n.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Jt(e)));const o=t[a];for(const s of e){if(s===null)throw new Error("cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Jt(s)));switch(n.kind){case"message":o.push(n.T.fromJson(s,r));break;case"enum":const c=Nu(n.T,s,r.ignoreUnknownFields,!0);c!==Vo&&o.push(c);break;case"scalar":try{o.push(ya(n.T,s,n.L,!0))}catch(u){let l="cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Jt(s));throw u instanceof Error&&u.message.length>0&&(l+=": ".concat(u.message)),new Error(l)}break}}}else if(n.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Jt(e)));const o=t[a];for(const[s,c]of Object.entries(e)){if(c===null)throw new Error("cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: map value null"));let u;try{u=Yz(n.K,s)}catch(l){let d="cannot decode map key for field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Jt(e));throw l instanceof Error&&l.message.length>0&&(d+=": ".concat(l.message)),new Error(d)}switch(n.V.kind){case"message":o[u]=n.V.T.fromJson(c,r);break;case"enum":const l=Nu(n.V.T,c,r.ignoreUnknownFields,!0);l!==Vo&&(o[u]=l);break;case"scalar":try{o[u]=ya(n.V.T,c,Qn.BIGINT,!0)}catch(d){let f="cannot decode map value for field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Jt(e));throw d instanceof Error&&d.message.length>0&&(f+=": ".concat(d.message)),new Error(f)}break}}}else switch(n.oneof&&(t=t[n.oneof.localName]={case:a},a="value"),n.kind){case"message":const o=n.T;if(e===null&&o.typeName!="google.protobuf.Value")return;let s=t[a];yn(s)?s.fromJson(e,r):(t[a]=s=o.fromJson(e,r),o.fieldWrapper&&!n.oneof&&(t[a]=o.fieldWrapper.unwrapField(s)));break;case"enum":const c=Nu(n.T,e,r.ignoreUnknownFields,!1);switch(c){case Qs:qv(n,t);break;case Vo:break;default:t[a]=c;break}break;case"scalar":try{const u=ya(n.T,e,n.L,!1);switch(u){case Qs:qv(n,t);break;default:t[a]=u;break}}catch(u){let l="cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Jt(e));throw u instanceof Error&&u.message.length>0&&(l+=": ".concat(u.message)),new Error(l)}break}}function Yz(t,e){if(t===U.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return ya(t,e,Qn.BIGINT,!0).toString()}function ya(t,e,n,r){if(e===null)return r?Ii(t,n):Qs;switch(t){case U.DOUBLE:case U.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const i=Number(e);if(Number.isNaN(i)||!Number.isFinite(i))break;return t==U.FLOAT&&RT(i),i;case U.INT32:case U.FIXED32:case U.SFIXED32:case U.SINT32:case U.UINT32:let a;if(typeof e=="number"?a=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(a=Number(e)),a===void 0)break;return t==U.UINT32||t==U.FIXED32?Td(a):Fo(a),a;case U.INT64:case U.SFIXED64:case U.SINT64:if(typeof e!="number"&&typeof e!="string")break;const o=Ae.parse(e);return n?o.toString():o;case U.FIXED64:case U.UINT64:if(typeof e!="number"&&typeof e!="string")break;const s=Ae.uParse(e);return n?s.toString():s;case U.BOOL:if(typeof e!="boolean")break;return e;case U.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch(c){throw new Error("invalid UTF8")}return e;case U.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return FT.dec(e)}throw new Error}function Nu(t,e,n,r){if(e===null)return t.typeName=="google.protobuf.NullValue"?0:r?t.values[0].no:Qs;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const i=t.findName(e);if(i!==void 0)return i.no;if(n)return Vo;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(Jt(e)))}function Jz(t){return t.repeated||t.kind=="map"?!0:!(t.oneof||t.kind=="message"||t.opt||t.req)}function Gv(t,e,n){if(t.kind=="map"){Ne(typeof e=="object"&&e!=null);const r={},i=Object.entries(e);switch(t.V.kind){case"scalar":for(const[o,s]of i)r[o.toString()]=Wo(t.V.T,s);break;case"message":for(const[o,s]of i)r[o.toString()]=s.toJson(n);break;case"enum":const a=t.V.T;for(const[o,s]of i)r[o.toString()]=Lu(a,s,n.enumAsInteger);break}return n.emitDefaultValues||i.length>0?r:void 0}if(t.repeated){Ne(Array.isArray(e));const r=[];switch(t.kind){case"scalar":for(let i=0;i<e.length;i++)r.push(Wo(t.T,e[i]));break;case"enum":for(let i=0;i<e.length;i++)r.push(Lu(t.T,e[i],n.enumAsInteger));break;case"message":for(let i=0;i<e.length;i++)r.push(e[i].toJson(n));break}return n.emitDefaultValues||r.length>0?r:void 0}switch(t.kind){case"scalar":return Wo(t.T,e);case"enum":return Lu(t.T,e,n.enumAsInteger);case"message":return zT(t.T,e).toJson(n)}}function Lu(t,e,n){var r;if(Ne(typeof e=="number"),t.typeName=="google.protobuf.NullValue")return null;if(n)return e;const i=t.findNumber(e);return(r=i==null?void 0:i.name)!==null&&r!==void 0?r:e}function Wo(t,e){switch(t){case U.INT32:case U.SFIXED32:case U.SINT32:case U.FIXED32:case U.UINT32:return Ne(typeof e=="number"),e;case U.FLOAT:case U.DOUBLE:return Ne(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case U.STRING:return Ne(typeof e=="string"),e;case U.BOOL:return Ne(typeof e=="boolean"),e;case U.UINT64:case U.FIXED64:case U.INT64:case U.SFIXED64:case U.SINT64:return Ne(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case U.BYTES:return Ne(e instanceof Uint8Array),FT.enc(e)}}const qr=Symbol("@bufbuild/protobuf/unknown-fields"),Hv={readUnknownFields:!0,readerFactory:t=>new Fz(t)},Kv={writeUnknownFields:!0,writerFactory:()=>new Uz};function Qz(t){return t?Object.assign(Object.assign({},Hv),t):Hv}function Zz(t){return t?Object.assign(Object.assign({},Kv),t):Kv}function e5(){return{makeReadOptions:Qz,makeWriteOptions:Zz,listUnknownFields(t){var e;return(e=t[qr])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[qr]},writeUnknownFields(t,e){const r=t[qr];if(r)for(const i of r)e.tag(i.no,i.wireType).raw(i.data)},onUnknownField(t,e,n,r){const i=t;Array.isArray(i[qr])||(i[qr]=[]),i[qr].push({no:e,wireType:n,data:r})},readMessage(t,e,n,r,i){const a=t.getType(),o=i?e.len:e.pos+n;let s,c;for(;e.pos<o&&([s,c]=e.tag(),!(i===!0&&c==je.EndGroup));){const u=a.fields.find(s);if(!u){const l=e.skip(c,s);r.readUnknownFields&&this.onUnknownField(t,s,c,l);continue}Xv(t,e,u,c,r)}if(i&&(c!=je.EndGroup||s!==n))throw new Error("invalid end group tag")},readField:Xv,writeMessage(t,e,n){const r=t.getType();for(const i of r.fields.byNumber()){if(!WT(i,t)){if(i.req)throw new Error("cannot encode field ".concat(r.typeName,".").concat(i.name," to binary: required field not set"));continue}const a=i.oneof?t[i.oneof.localName].value:t[i.localName];Yv(i,a,e,n)}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e},writeField(t,e,n,r){e!==void 0&&Yv(t,e,n,r)}}}function Xv(t,e,n,r,i){let{repeated:a,localName:o}=n;switch(n.oneof&&(t=t[n.oneof.localName],t.case!=o&&delete t.value,t.case=o,o="value"),n.kind){case"scalar":case"enum":const s=n.kind=="enum"?U.INT32:n.T;let c=Zs;if(n.kind=="scalar"&&n.L>0&&(c=n5),a){let f=t[o];if(r==je.LengthDelimited&&s!=U.STRING&&s!=U.BYTES){let m=e.uint32()+e.pos;for(;e.pos<m;)f.push(c(e,s))}else f.push(c(e,s))}else t[o]=c(e,s);break;case"message":const u=n.T;a?t[o].push(zo(e,new u,i,n)):yn(t[o])?zo(e,t[o],i,n):(t[o]=zo(e,new u,i,n),u.fieldWrapper&&!n.oneof&&!n.repeated&&(t[o]=u.fieldWrapper.unwrapField(t[o])));break;case"map":let[l,d]=t5(n,e,i);t[o][l]=d;break}}function zo(t,e,n,r){const i=e.getType().runtime.bin,a=r==null?void 0:r.delimited;return i.readMessage(e,t,a?r.no:t.uint32(),n,a),e}function t5(t,e,n){const r=e.uint32(),i=e.pos+r;let a,o;for(;e.pos<i;){const[s]=e.tag();switch(s){case 1:a=Zs(e,t.K);break;case 2:switch(t.V.kind){case"scalar":o=Zs(e,t.V.T);break;case"enum":o=e.int32();break;case"message":o=zo(e,new t.V.T,n,void 0);break}break}}if(a===void 0&&(a=Ii(t.K,Qn.BIGINT)),typeof a!="string"&&typeof a!="number"&&(a=a.toString()),o===void 0)switch(t.V.kind){case"scalar":o=Ii(t.V.T,Qn.BIGINT);break;case"enum":o=t.V.T.values[0].no;break;case"message":o=new t.V.T;break}return[a,o]}function n5(t,e){const n=Zs(t,e);return typeof n=="bigint"?n.toString():n}function Zs(t,e){switch(e){case U.STRING:return t.string();case U.BOOL:return t.bool();case U.DOUBLE:return t.double();case U.FLOAT:return t.float();case U.INT32:return t.int32();case U.INT64:return t.int64();case U.UINT64:return t.uint64();case U.FIXED64:return t.fixed64();case U.BYTES:return t.bytes();case U.FIXED32:return t.fixed32();case U.SFIXED32:return t.sfixed32();case U.SFIXED64:return t.sfixed64();case U.SINT64:return t.sint64();case U.UINT32:return t.uint32();case U.SINT32:return t.sint32()}}function Yv(t,e,n,r){Ne(e!==void 0);const i=t.repeated;switch(t.kind){case"scalar":case"enum":let a=t.kind=="enum"?U.INT32:t.T;if(i)if(Ne(Array.isArray(e)),t.packed)i5(n,a,t.no,e);else for(const o of e)ba(n,a,t.no,o);else ba(n,a,t.no,e);break;case"message":if(i){Ne(Array.isArray(e));for(const o of e)Jv(n,r,t,o)}else Jv(n,r,t,e);break;case"map":Ne(typeof e=="object"&&e!=null);for(const[o,s]of Object.entries(e))r5(n,r,t,o,s);break}}function r5(t,e,n,r,i){t.tag(n.no,je.LengthDelimited),t.fork();let a=r;switch(n.K){case U.INT32:case U.FIXED32:case U.UINT32:case U.SFIXED32:case U.SINT32:a=Number.parseInt(r);break;case U.BOOL:Ne(r=="true"||r=="false"),a=r=="true";break}switch(ba(t,n.K,1,a),n.V.kind){case"scalar":ba(t,n.V.T,2,i);break;case"enum":ba(t,U.INT32,2,i);break;case"message":Ne(i!==void 0),t.tag(2,je.LengthDelimited).bytes(i.toBinary(e));break}t.join()}function Jv(t,e,n,r){const i=zT(n.T,r);n.delimited?t.tag(n.no,je.StartGroup).raw(i.toBinary(e)).tag(n.no,je.EndGroup):t.tag(n.no,je.LengthDelimited).bytes(i.toBinary(e))}function ba(t,e,n,r){Ne(r!==void 0);let[i,a]=GT(e);t.tag(n,i)[a](r)}function i5(t,e,n,r){if(!r.length)return;t.tag(n,je.LengthDelimited).fork();let[,i]=GT(e);for(let a=0;a<r.length;a++)t[i](r[a]);t.join()}function GT(t){let e=je.Varint;switch(t){case U.BYTES:case U.STRING:e=je.LengthDelimited;break;case U.DOUBLE:case U.FIXED64:case U.SFIXED64:e=je.Bit64;break;case U.FIXED32:case U.SFIXED32:case U.FLOAT:e=je.Bit32;break}const n=U[t].toLowerCase();return[e,n]}function a5(){return{setEnumType:DT,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const r of n.fields.byMember()){const i=r.localName,a=e,o=t;if(o[i]!=null)switch(r.kind){case"oneof":const s=o[i].case;if(s===void 0)continue;const c=r.findField(s);let u=o[i].value;c&&c.kind=="message"&&!yn(u,c.T)?u=new c.T(u):c&&c.kind==="scalar"&&c.T===U.BYTES&&(u=aa(u)),a[i]={case:s,value:u};break;case"scalar":case"enum":let l=o[i];r.T===U.BYTES&&(l=r.repeated?l.map(aa):aa(l)),a[i]=l;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===U.BYTES)for(const[h,m]of Object.entries(o[i]))a[i][h]=aa(m);else Object.assign(a[i],o[i]);break;case"message":const f=r.V.T;for(const h of Object.keys(o[i])){let m=o[i][h];f.fieldWrapper||(m=new f(m)),a[i][h]=m}break}break;case"message":const d=r.T;if(r.repeated)a[i]=o[i].map(f=>yn(f,d)?f:new d(f));else{const f=o[i];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?a[i]=aa(f):a[i]=f:a[i]=yn(f,d)?f:new d(f)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(r=>{const i=e[r.localName],a=n[r.localName];if(r.repeated){if(i.length!==a.length)return!1;switch(r.kind){case"message":return i.every((o,s)=>r.T.equals(o,a[s]));case"scalar":return i.every((o,s)=>jn(r.T,o,a[s]));case"enum":return i.every((o,s)=>jn(U.INT32,o,a[s]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":let o=i,s=a;return r.T.fieldWrapper&&(o!==void 0&&!yn(o)&&(o=r.T.fieldWrapper.wrapField(o)),s!==void 0&&!yn(s)&&(s=r.T.fieldWrapper.wrapField(s))),r.T.equals(o,s);case"enum":return jn(U.INT32,i,a);case"scalar":return jn(r.T,i,a);case"oneof":if(i.case!==a.case)return!1;const c=r.findField(i.case);if(c===void 0)return!0;switch(c.kind){case"message":return c.T.equals(i.value,a.value);case"enum":return jn(U.INT32,i.value,a.value);case"scalar":return jn(c.T,i.value,a.value)}throw new Error("oneof cannot contain ".concat(c.kind));case"map":const u=Object.keys(i).concat(Object.keys(a));switch(r.V.kind){case"message":const l=r.V.T;return u.every(f=>l.equals(i[f],a[f]));case"enum":return u.every(f=>jn(U.INT32,i[f],a[f]));case"scalar":const d=r.V.T;return u.every(f=>jn(d,i[f],a[f]))}break}})},clone(t){const e=t.getType(),n=new e,r=n;for(const i of e.fields.byMember()){const a=t[i.localName];let o;if(i.repeated)o=a.map(No);else if(i.kind=="map"){o=r[i.localName];for(const[s,c]of Object.entries(a))o[s]=No(c)}else i.kind=="oneof"?o=i.findField(a.case)?{case:a.case,value:No(a.value)}:{case:void 0}:o=No(a);r[i.localName]=o}for(const i of e.runtime.bin.listUnknownFields(t))e.runtime.bin.onUnknownField(r,i.no,i.wireType,i.data);return n}}}function No(t){if(t===void 0)return t;if(yn(t))return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function aa(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function o5(t,e,n){return{syntax:t,json:Xz(),bin:e5(),util:Object.assign(Object.assign({},a5()),{newFieldList:e,initFields:n}),makeMessageType(r,i,a){return Dz(this,r,i,a)},makeEnum:Mz,makeEnumType:NT,getEnumType:Rz,makeExtension(r,i,a){return qz(this,r,i,a)}}}class s5{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,e.push(n)):e.push(r)}return this.members}}function HT(t,e){const n=KT(t);return e?n:h5(f5(n))}function c5(t){return HT(t,!1)}const u5=KT;function KT(t){let e=!1;const n=[];for(let r=0;r<t.length;r++){let i=t.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),n.push(i);break}}return n.join("")}const l5=new Set(["constructor","toString","toJSON","valueOf"]),d5=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),XT=t=>"".concat(t,"$"),f5=t=>d5.has(t)?XT(t):t,h5=t=>l5.has(t)?XT(t):t;class p5{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=c5(e)}addField(e){Ne(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}function m5(t,e){var n,r,i,a,o,s;const c=[];let u;for(const l of typeof t=="function"?t():t){const d=l;if(d.localName=HT(l.name,l.oneof!==void 0),d.jsonName=(n=l.jsonName)!==null&&n!==void 0?n:u5(l.name),d.repeated=(r=l.repeated)!==null&&r!==void 0?r:!1,l.kind=="scalar"&&(d.L=(i=l.L)!==null&&i!==void 0?i:Qn.BIGINT),d.delimited=(a=l.delimited)!==null&&a!==void 0?a:!1,d.req=(o=l.req)!==null&&o!==void 0?o:!1,d.opt=(s=l.opt)!==null&&s!==void 0?s:!1,l.packed===void 0&&(d.packed=l.kind=="enum"||l.kind=="scalar"&&l.T!=U.BYTES&&l.T!=U.STRING),l.oneof!==void 0){const f=typeof l.oneof=="string"?l.oneof:l.oneof.name;(!u||u.name!=f)&&(u=new p5(f)),d.oneof=u,u.addField(d)}c.push(d)}return c}const I=o5("proto3",t=>new s5(t,e=>m5(e)),t=>{for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,r=t;if(e.repeated){r[n]=[];continue}switch(e.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=Ii(e.T,e.L);break}}});class ht extends ch{constructor(e){super(),this.seconds=Ae.zero,this.nanos=0,I.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(I.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Ae.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return ht.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new ht({seconds:Ae.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new ht().fromBinary(e,n)}static fromJson(e,n){return new ht().fromJson(e,n)}static fromJsonString(e,n){return new ht().fromJsonString(e,n)}static equals(e,n){return I.util.equals(ht,e,n)}}ht.runtime=I;ht.typeName="google.protobuf.Timestamp";ht.fields=I.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const g5=I.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:ht},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:v5,repeated:!0},{no:5,name:"events",kind:"message",T:b5,repeated:!0}]),v5=I.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:y5,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),y5=I.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:ht},{no:3,name:"value",kind:"scalar",T:2}]),b5=I.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:ht},{no:7,name:"normalized_end_timestamp",kind:"message",T:ht,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),YT=I.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),Wt=I.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),Be=I.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),lh=I.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),fa=I.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),no=I.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),Ht=I.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),Vr=I.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),S5=I.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),Je=I.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),Gc=I.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:ec,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:ck}]),ec=I.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),T5=I.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:I.getEnumType(Be),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),Pr=I.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:I.getEnumType(ri)},{no:4,name:"tracks",kind:"message",T:Xr,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:T5},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:I.getEnumType(ro)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:I.getEnumType(Ht)},{no:18,name:"kind_details",kind:"enum",T:I.getEnumType(k5),repeated:!0}]),ri=I.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),ro=I.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"}]),k5=I.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),He=I.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),w5=I.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Xn,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:I.getEnumType(JT)},{no:6,name:"sdp_cid",kind:"scalar",T:9}]),Xr=I.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:I.getEnumType(Wt)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:I.getEnumType(Be)},{no:10,name:"layers",kind:"message",T:Xn,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:w5,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:I.getEnumType(He)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:ck},{no:19,name:"audio_features",kind:"enum",T:I.getEnumType(Je),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:I.getEnumType(YT)}]),Xn=I.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:I.getEnumType(lh)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}]),JT=I.makeEnum("livekit.VideoLayer.Mode",[{no:0,name:"MODE_UNUSED"},{no:1,name:"ONE_SPATIAL_LAYER_PER_STREAM"},{no:2,name:"MULTIPLE_SPATIAL_LAYERS_PER_STREAM"},{no:3,name:"ONE_SPATIAL_LAYER_PER_STREAM_INCOMPLETE_RTCP_SR"}]),st=I.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:I.getEnumType(se)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:dh,oneof:"value"},{no:3,name:"speaker",kind:"message",T:C5,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:tk,oneof:"value"},{no:7,name:"transcription",kind:"message",T:_5,oneof:"value"},{no:8,name:"metrics",kind:"message",T:g5,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:tc,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:fh,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:hh,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:ph,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:nc,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:rc,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:ic,oneof:"value"},{no:18,name:"encrypted_packet",kind:"message",T:QT,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),se=I.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),QT=I.makeMessageType("livekit.EncryptedPacket",()=>[{no:1,name:"encryption_type",kind:"enum",T:I.getEnumType(He)},{no:2,name:"iv",kind:"scalar",T:12},{no:3,name:"key_index",kind:"scalar",T:13},{no:4,name:"encrypted_value",kind:"scalar",T:12}]),ZT=I.makeMessageType("livekit.EncryptedPacketPayload",()=>[{no:1,name:"user",kind:"message",T:dh,oneof:"value"},{no:3,name:"chat_message",kind:"message",T:tc,oneof:"value"},{no:4,name:"rpc_request",kind:"message",T:fh,oneof:"value"},{no:5,name:"rpc_ack",kind:"message",T:hh,oneof:"value"},{no:6,name:"rpc_response",kind:"message",T:ph,oneof:"value"},{no:7,name:"stream_header",kind:"message",T:nc,oneof:"value"},{no:8,name:"stream_chunk",kind:"message",T:rc,oneof:"value"},{no:9,name:"stream_trailer",kind:"message",T:ic,oneof:"value"}]),C5=I.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:ek,repeated:!0}]),ek=I.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),dh=I.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),tk=I.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),_5=I.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:x5,repeated:!0}]),x5=I.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),tc=I.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),fh=I.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),hh=I.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),ph=I.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:nk,oneof:"value"}]),nk=I.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),rk=I.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),ik=I.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:I.getEnumType(ak)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),ak=I.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),P5=I.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:I.getEnumType(ok)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),ok=I.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),sk=I.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:Qv},{no:2,name:"screen",kind:"message",T:Qv},{no:3,name:"resume_connection",kind:"enum",T:I.getEnumType(no)},{no:4,name:"disabled_codecs",kind:"message",T:O5},{no:5,name:"force_relay",kind:"enum",T:I.getEnumType(no)}]),Qv=I.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:I.getEnumType(no)}]),O5=I.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:ec,repeated:!0},{no:2,name:"publish",kind:"message",T:ec,repeated:!0}]),ck=I.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),kd=I.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),uk=I.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:I.getEnumType(kd)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),lk=I.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),nc=I.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:I.getEnumType(He)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:uk,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:lk,oneof:"content_header"}],{localName:"DataStream_Header"}),rc=I.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),ic=I.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),E5=I.makeMessageType("livekit.SubscribedAudioCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"enabled",kind:"scalar",T:8}]),zt=I.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),wd=I.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),A5=I.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),I5=I.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:Or,oneof:"message"},{no:2,name:"answer",kind:"message",T:Or,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Hc,oneof:"message"},{no:4,name:"add_track",kind:"message",T:ac,oneof:"message"},{no:5,name:"mute",kind:"message",T:Kc,oneof:"message"},{no:6,name:"subscription",kind:"message",T:Xc,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:dk,oneof:"message"},{no:8,name:"leave",kind:"message",T:Yc,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:hk,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:gk,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:vk,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Yt,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:vh,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:Sk,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:gh,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:fk,oneof:"message"}]),Zv=I.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:R5,oneof:"message"},{no:2,name:"answer",kind:"message",T:Or,oneof:"message"},{no:3,name:"offer",kind:"message",T:Or,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Hc,oneof:"message"},{no:5,name:"update",kind:"message",T:N5,oneof:"message"},{no:6,name:"track_published",kind:"message",T:mh,oneof:"message"},{no:8,name:"leave",kind:"message",T:Yc,oneof:"message"},{no:9,name:"mute",kind:"message",T:Kc,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:L5,oneof:"message"},{no:11,name:"room_update",kind:"message",T:j5,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:B5,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:F5,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:V5,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:z5,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:D5,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:M5,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:H5,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:Y5,oneof:"message"},{no:22,name:"request_response",kind:"message",T:J5,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:Q5,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:G5,oneof:"message"},{no:25,name:"media_sections_requirement",kind:"message",T:Z5,oneof:"message"},{no:26,name:"subscribed_audio_codec_update",kind:"message",T:W5,oneof:"message"}]),Cd=I.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Xn,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:I.getEnumType(JT)}]),ac=I.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:I.getEnumType(Wt)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:I.getEnumType(Be)},{no:9,name:"layers",kind:"message",T:Xn,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Cd,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:I.getEnumType(He)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:I.getEnumType(YT)},{no:17,name:"audio_features",kind:"enum",T:I.getEnumType(Je),repeated:!0}]),Hc=I.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:I.getEnumType(zt)},{no:3,name:"final",kind:"scalar",T:8}]),Kc=I.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),R5=I.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:Gc},{no:2,name:"participant",kind:"message",T:Pr},{no:3,name:"other_participants",kind:"message",T:Pr,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:pk,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:sk},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:ik},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:ec,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),M5=I.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:pk,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:sk},{no:3,name:"server_info",kind:"message",T:ik},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),mh=I.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Xr}]),D5=I.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Or=I.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13}]),N5=I.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:Pr,repeated:!0}]),Xc=I.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:rk,repeated:!0}]),dk=I.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:I.getEnumType(lh)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),gh=I.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:I.getEnumType(Je),repeated:!0}]),fk=I.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),Yc=I.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:I.getEnumType(Ht)},{no:3,name:"action",kind:"enum",T:I.getEnumType(ii)},{no:4,name:"regions",kind:"message",T:K5}]),ii=I.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),hk=I.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:Xn,repeated:!0}]),vh=I.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),pk=I.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),L5=I.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:ek,repeated:!0}]),j5=I.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:Gc}]),$5=I.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:I.getEnumType(fa)},{no:3,name:"score",kind:"scalar",T:2}]),B5=I.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:$5,repeated:!0}]),U5=I.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:I.getEnumType(wd)}]),F5=I.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:U5,repeated:!0}]),yh=I.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:I.getEnumType(lh)},{no:2,name:"enabled",kind:"scalar",T:8}]),q5=I.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:yh,repeated:!0}]),V5=I.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:yh,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:q5,repeated:!0}]),W5=I.makeMessageType("livekit.SubscribedAudioCodecUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_audio_codecs",kind:"message",T:E5,repeated:!0}]),mk=I.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),gk=I.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:mk,repeated:!0}]),z5=I.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),G5=I.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:Gc},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:Pr},{no:4,name:"other_participants",kind:"message",T:Pr,repeated:!0}]),vk=I.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:Or},{no:2,name:"subscription",kind:"message",T:Xc},{no:3,name:"publish_tracks",kind:"message",T:mh,repeated:!0},{no:4,name:"data_channels",kind:"message",T:bk,repeated:!0},{no:5,name:"offer",kind:"message",T:Or},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:yk,repeated:!0}]),yk=I.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),bk=I.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:I.getEnumType(zt)}]),Yt=I.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:I.getEnumType(A5),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),Sk=I.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),H5=I.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),K5=I.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:X5,repeated:!0}]),X5=I.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),Y5=I.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:I.getEnumType(S5)}]),J5=I.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:I.getEnumType(bh)},{no:3,name:"message",kind:"scalar",T:9},{no:4,name:"trickle",kind:"message",T:Hc,oneof:"request"},{no:5,name:"add_track",kind:"message",T:ac,oneof:"request"},{no:6,name:"mute",kind:"message",T:Kc,oneof:"request"},{no:7,name:"update_metadata",kind:"message",T:vh,oneof:"request"},{no:8,name:"update_audio_track",kind:"message",T:gh,oneof:"request"},{no:9,name:"update_video_track",kind:"message",T:fk,oneof:"request"}]),bh=I.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"},{no:4,name:"QUEUED"},{no:5,name:"UNSUPPORTED_TYPE"},{no:6,name:"UNCLASSIFIED_ERROR"}]),Q5=I.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Z5=I.makeMessageType("livekit.MediaSectionsRequirement",()=>[{no:1,name:"num_audios",kind:"scalar",T:13},{no:2,name:"num_videos",kind:"scalar",T:13}]);function eG(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Go={exports:{}},tG=Go.exports,ey;function nG(){return ey||(ey=1,function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(tG,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],a={},o=null;function s(p,v){var b=p[v];if(typeof b.bind=="function")return b.bind(p);try{return Function.prototype.bind.call(b,p)}catch(k){return function(){return Function.prototype.apply.apply(b,[p,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function u(p){return p==="debug"&&(p="log"),typeof console===n?!1:p==="trace"&&r?c:console[p]!==void 0?s(console,p):console.log!==void 0?s(console,"log"):e}function l(){for(var p=this.getLevel(),v=0;v<i.length;v++){var b=i[v];this[b]=v<p?e:this.methodFactory(b,p,this.name)}if(this.log=this.debug,typeof console===n&&p<this.levels.SILENT)return"No console available for logging"}function d(p){return function(){typeof console!==n&&(l.call(this),this[p].apply(this,arguments))}}function f(p,v,b){return u(p)||d.apply(this,arguments)}function h(p,v){var b=this,k,T,S,g="loglevel";typeof p=="string"?g+=":"+p:typeof p=="symbol"&&(g=void 0);function y(P){var E=(i[P]||"silent").toUpperCase();if(!(typeof window===n||!g)){try{window.localStorage[g]=E;return}catch(M){}try{window.document.cookie=encodeURIComponent(g)+"="+E+";"}catch(M){}}}function w(){var P;if(!(typeof window===n||!g)){try{P=window.localStorage[g]}catch(D){}if(typeof P===n)try{var E=window.document.cookie,M=encodeURIComponent(g),N=E.indexOf(M+"=");N!==-1&&(P=/^([^;]+)/.exec(E.slice(N+M.length+1))[1])}catch(D){}return b.levels[P]===void 0&&(P=void 0),P}}function C(){if(!(typeof window===n||!g)){try{window.localStorage.removeItem(g)}catch(P){}try{window.document.cookie=encodeURIComponent(g)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(P){}}}function _(P){var E=P;if(typeof E=="string"&&b.levels[E.toUpperCase()]!==void 0&&(E=b.levels[E.toUpperCase()]),typeof E=="number"&&E>=0&&E<=b.levels.SILENT)return E;throw new TypeError("log.setLevel() called with invalid level: "+P)}b.name=p,b.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},b.methodFactory=v||f,b.getLevel=function(){return S!=null?S:T!=null?T:k},b.setLevel=function(P,E){return S=_(P),E!==!1&&y(S),l.call(b)},b.setDefaultLevel=function(P){T=_(P),w()||b.setLevel(P,!1)},b.resetLevel=function(){S=null,C(),l.call(b)},b.enableAll=function(P){b.setLevel(b.levels.TRACE,P)},b.disableAll=function(P){b.setLevel(b.levels.SILENT,P)},b.rebuild=function(){if(o!==b&&(k=_(o.getLevel())),l.call(b),o===b)for(var P in a)a[P].rebuild()},k=_(o?o.getLevel():"WARN");var A=w();A!=null&&(S=_(A)),l.call(b)}o=new h,o.getLogger=function(v){if(typeof v!="symbol"&&typeof v!="string"||v==="")throw new TypeError("You must supply a name when creating a logger.");var b=a[v];return b||(b=a[v]=new h(v,o.methodFactory)),b};var m=typeof window!==n?window.log:void 0;return o.noConflict=function(){return typeof window!==n&&window.log===o&&(window.log=m),o},o.getLoggers=function(){return a},o.default=o,o})}(Go)),Go.exports}var Jc=nG(),_d;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(_d||(_d={}));var Kt;(function(t){t.Default="livekit",t.Room="livekit-room",t.TokenSource="livekit-token-source",t.Participant="livekit-participant",t.Track="livekit-track",t.Publication="livekit-track-publication",t.Engine="livekit-engine",t.Signal="livekit-signal",t.PCManager="livekit-pc-manager",t.PCTransport="livekit-pc-transport",t.E2EE="lk-e2ee"})(Kt||(Kt={}));let ae=Jc.getLogger("livekit");Object.values(Kt).map(t=>Jc.getLogger(t));ae.setDefaultLevel(_d.info);function In(t){const e=Jc.getLogger(t);return e.setDefaultLevel(ae.getLevel()),e}const rG=Jc.getLogger("lk-e2ee"),oa=7e3,iG=[0,300,2*2*300,3*3*300,4*4*300,oa,oa,oa,oa,oa];class aG{constructor(e){this._retryDelays=e!==void 0?[...e]:iG}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function oG(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function x(t,e,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(l){try{u(r.next(l))}catch(d){o(d)}}function c(l){try{u(r.throw(l))}catch(d){o(d)}}function u(l){l.done?a(l.value):i(l.value).then(s,c)}u((r=r.apply(t,e||[])).next())})}function ty(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function bn(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof ty=="function"?ty(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(a){n[a]=t[a]&&function(o){return new Promise(function(s,c){o=t[a](o),i(s,c,o.done,o.value)})}}function i(a,o,s,c){Promise.resolve(c).then(function(u){a({value:u,done:s})},o)}}var Lo={exports:{}},ny;function sG(){if(ny)return Lo.exports;ny=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(g,y,w){return Function.prototype.apply.call(g,y,w)},n;t&&typeof t.ownKeys=="function"?n=t.ownKeys:Object.getOwnPropertySymbols?n=function(g){return Object.getOwnPropertyNames(g).concat(Object.getOwnPropertySymbols(g))}:n=function(g){return Object.getOwnPropertyNames(g)};function r(S){console&&console.warn&&console.warn(S)}var i=Number.isNaN||function(g){return g!==g};function a(){a.init.call(this)}Lo.exports=a,Lo.exports.once=b,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var o=10;function s(S){if(typeof S!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof S)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(S){if(typeof S!="number"||S<0||i(S))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+S+".");o=S}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(g){if(typeof g!="number"||g<0||i(g))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+g+".");return this._maxListeners=g,this};function c(S){return S._maxListeners===void 0?a.defaultMaxListeners:S._maxListeners}a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(g){for(var y=[],w=1;w<arguments.length;w++)y.push(arguments[w]);var C=g==="error",_=this._events;if(_!==void 0)C=C&&_.error===void 0;else if(!C)return!1;if(C){var A;if(y.length>0&&(A=y[0]),A instanceof Error)throw A;var P=new Error("Unhandled error."+(A?" ("+A.message+")":""));throw P.context=A,P}var E=_[g];if(E===void 0)return!1;if(typeof E=="function")e(E,this,y);else for(var M=E.length,N=m(E,M),w=0;w<M;++w)e(N[w],this,y);return!0};function u(S,g,y,w){var C,_,A;if(s(y),_=S._events,_===void 0?(_=S._events=Object.create(null),S._eventsCount=0):(_.newListener!==void 0&&(S.emit("newListener",g,y.listener?y.listener:y),_=S._events),A=_[g]),A===void 0)A=_[g]=y,++S._eventsCount;else if(typeof A=="function"?A=_[g]=w?[y,A]:[A,y]:w?A.unshift(y):A.push(y),C=c(S),C>0&&A.length>C&&!A.warned){A.warned=!0;var P=new Error("Possible EventEmitter memory leak detected. "+A.length+" "+String(g)+" listeners added. Use emitter.setMaxListeners() to increase limit");P.name="MaxListenersExceededWarning",P.emitter=S,P.type=g,P.count=A.length,r(P)}return S}a.prototype.addListener=function(g,y){return u(this,g,y,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(g,y){return u(this,g,y,!0)};function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(S,g,y){var w={fired:!1,wrapFn:void 0,target:S,type:g,listener:y},C=l.bind(w);return C.listener=y,w.wrapFn=C,C}a.prototype.once=function(g,y){return s(y),this.on(g,d(this,g,y)),this},a.prototype.prependOnceListener=function(g,y){return s(y),this.prependListener(g,d(this,g,y)),this},a.prototype.removeListener=function(g,y){var w,C,_,A,P;if(s(y),C=this._events,C===void 0)return this;if(w=C[g],w===void 0)return this;if(w===y||w.listener===y)--this._eventsCount===0?this._events=Object.create(null):(delete C[g],C.removeListener&&this.emit("removeListener",g,w.listener||y));else if(typeof w!="function"){for(_=-1,A=w.length-1;A>=0;A--)if(w[A]===y||w[A].listener===y){P=w[A].listener,_=A;break}if(_<0)return this;_===0?w.shift():p(w,_),w.length===1&&(C[g]=w[0]),C.removeListener!==void 0&&this.emit("removeListener",g,P||y)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(g){var y,w,C;if(w=this._events,w===void 0)return this;if(w.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):w[g]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete w[g]),this;if(arguments.length===0){var _=Object.keys(w),A;for(C=0;C<_.length;++C)A=_[C],A!=="removeListener"&&this.removeAllListeners(A);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(y=w[g],typeof y=="function")this.removeListener(g,y);else if(y!==void 0)for(C=y.length-1;C>=0;C--)this.removeListener(g,y[C]);return this};function f(S,g,y){var w=S._events;if(w===void 0)return[];var C=w[g];return C===void 0?[]:typeof C=="function"?y?[C.listener||C]:[C]:y?v(C):m(C,C.length)}a.prototype.listeners=function(g){return f(this,g,!0)},a.prototype.rawListeners=function(g){return f(this,g,!1)},a.listenerCount=function(S,g){return typeof S.listenerCount=="function"?S.listenerCount(g):h.call(S,g)},a.prototype.listenerCount=h;function h(S){var g=this._events;if(g!==void 0){var y=g[S];if(typeof y=="function")return 1;if(y!==void 0)return y.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function m(S,g){for(var y=new Array(g),w=0;w<g;++w)y[w]=S[w];return y}function p(S,g){for(;g+1<S.length;g++)S[g]=S[g+1];S.pop()}function v(S){for(var g=new Array(S.length),y=0;y<g.length;++y)g[y]=S[y].listener||S[y];return g}function b(S,g){return new Promise(function(y,w){function C(A){S.removeListener(g,_),w(A)}function _(){typeof S.removeListener=="function"&&S.removeListener("error",C),y([].slice.call(arguments))}T(S,g,_,{once:!0}),g!=="error"&&k(S,C,{once:!0})})}function k(S,g,y){typeof S.on=="function"&&T(S,"error",g,y)}function T(S,g,y,w){if(typeof S.on=="function")w.once?S.once(g,y):S.on(g,y);else if(typeof S.addEventListener=="function")S.addEventListener(g,function C(_){w.once&&S.removeEventListener(g,C),y(_)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof S)}return Lo.exports}var fn=sG();let Tk=!0,kk=!0;function ha(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseFloat(r[n],10)}function Lr(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(o,s){if(o!==e)return i.apply(this,arguments);const c=u=>{const l=n(u);l&&(s.handleEvent?s.handleEvent(l):s(l))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(s,c),i.apply(this,[o,c])};const a=r.removeEventListener;r.removeEventListener=function(o,s){if(o!==e||!this._eventMap||!this._eventMap[e])return a.apply(this,arguments);if(!this._eventMap[e].has(s))return a.apply(this,arguments);const c=this._eventMap[e].get(s);return this._eventMap[e].delete(s),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,a.apply(this,[o,c])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(o){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),o&&this.addEventListener(e,this["_on"+e]=o)},enumerable:!0,configurable:!0})}function cG(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(Tk=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function uG(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(kk=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function wk(){if(typeof window=="object"){if(Tk)return;typeof console!="undefined"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Sh(t,e){kk&&console.warn(t+" is deprecated, please use "+e+" instead.")}function lG(t){const e={browser:null,version:null};if(typeof t=="undefined"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.userAgentData&&n.userAgentData.brands){const r=n.userAgentData.brands.find(i=>i.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(n.mozGetUserMedia)e.browser="firefox",e.version=parseInt(ha(n.userAgent,/Firefox\/(\d+)\./,1));else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(ha(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(ha(n.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype,e._safariVersion=ha(n.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function ry(t){return Object.prototype.toString.call(t)==="[object Object]"}function Ck(t){return ry(t)?Object.keys(t).reduce(function(e,n){const r=ry(t[n]),i=r?Ck(t[n]):t[n],a=r&&!Object.keys(i).length;return i===void 0||a?e:Object.assign(e,{[n]:i})},{}):t}function xd(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?xd(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(i=>{xd(t,t.get(i),n)})}))}function iy(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const a=[];return t.forEach(o=>{o.type==="track"&&o.trackIdentifier===e.id&&a.push(o)}),a.forEach(o=>{t.forEach(s=>{s.type===r&&s.trackId===o.id&&xd(t,s,i)})}),i}const ay=wk;function _k(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(s){if(typeof s!="object"||s.mandatory||s.optional)return s;const c={};return Object.keys(s).forEach(u=>{if(u==="require"||u==="advanced"||u==="mediaSource")return;const l=typeof s[u]=="object"?s[u]:{ideal:s[u]};l.exact!==void 0&&typeof l.exact=="number"&&(l.min=l.max=l.exact);const d=function(f,h){return f?f+h.charAt(0).toUpperCase()+h.slice(1):h==="deviceId"?"sourceId":h};if(l.ideal!==void 0){c.optional=c.optional||[];let f={};typeof l.ideal=="number"?(f[d("min",u)]=l.ideal,c.optional.push(f),f={},f[d("max",u)]=l.ideal,c.optional.push(f)):(f[d("",u)]=l.ideal,c.optional.push(f))}l.exact!==void 0&&typeof l.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[d("",u)]=l.exact):["min","max"].forEach(f=>{l[f]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[d(f,u)]=l[f])})}),s.advanced&&(c.optional=(c.optional||[]).concat(s.advanced)),c},i=function(s,c){if(e.version>=61)return c(s);if(s=JSON.parse(JSON.stringify(s)),s&&typeof s.audio=="object"){const u=function(l,d,f){d in l&&!(f in l)&&(l[f]=l[d],delete l[d])};s=JSON.parse(JSON.stringify(s)),u(s.audio,"autoGainControl","googAutoGainControl"),u(s.audio,"noiseSuppression","googNoiseSuppression"),s.audio=r(s.audio)}if(s&&typeof s.video=="object"){let u=s.video.facingMode;u=u&&(typeof u=="object"?u:{ideal:u});const l=e.version<66;if(u&&(u.exact==="user"||u.exact==="environment"||u.ideal==="user"||u.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!l)){delete s.video.facingMode;let d;if(u.exact==="environment"||u.ideal==="environment"?d=["back","rear"]:(u.exact==="user"||u.ideal==="user")&&(d=["front"]),d)return n.mediaDevices.enumerateDevices().then(f=>{f=f.filter(m=>m.kind==="videoinput");let h=f.find(m=>d.some(p=>m.label.toLowerCase().includes(p)));return!h&&f.length&&d.includes("back")&&(h=f[f.length-1]),h&&(s.video.deviceId=u.exact?{exact:h.deviceId}:{ideal:h.deviceId}),s.video=r(s.video),ay("chrome: "+JSON.stringify(s)),c(s)})}s.video=r(s.video)}return ay("chrome: "+JSON.stringify(s)),c(s)},a=function(s){return e.version>=64?s:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[s.name]||s.name,message:s.message,constraint:s.constraint||s.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(s,c,u){i(s,l=>{n.webkitGetUserMedia(l,c,d=>{u&&u(a(d))})})};if(n.getUserMedia=o.bind(n),n.mediaDevices.getUserMedia){const s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(c){return i(c,u=>s(u).then(l=>{if(u.audio&&!l.getAudioTracks().length||u.video&&!l.getVideoTracks().length)throw l.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return l},l=>Promise.reject(a(l))))}}}function xk(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function Pk(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let a;t.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(s=>s.track&&s.track.id===i.track.id):a={track:i.track};const o=new Event("track");o.track=i.track,o.receiver=a,o.transceiver={receiver:a},o.streams=[r.stream],this.dispatchEvent(o)}),r.stream.getTracks().forEach(i=>{let a;t.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(s=>s.track&&s.track.id===i.id):a={track:i};const o=new Event("track");o.track=i,o.receiver=a,o.transceiver={receiver:a},o.streams=[r.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Lr(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Ok(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(i,a){return{track:a,get dtmf(){return this._dtmf===void 0&&(a.kind==="audio"?this._dtmf=i.createDTMFSender(a):this._dtmf=null),this._dtmf},_pc:i}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(s,c){let u=i.apply(this,arguments);return u||(u=e(this,s),this._senders.push(u)),u};const a=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(s){a.apply(this,arguments);const c=this._senders.indexOf(s);c!==-1&&this._senders.splice(c,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(a){this._senders=this._senders||[],n.apply(this,[a]),a.getTracks().forEach(o=>{this._senders.push(e(this,o))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(a){this._senders=this._senders||[],r.apply(this,[a]),a.getTracks().forEach(o=>{const s=this._senders.find(c=>c.track===o);s&&this._senders.splice(this._senders.indexOf(s),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Ek(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const a=n.apply(this,[]);return a.forEach(o=>o._pc=this),a});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const a=r.apply(this,arguments);return a._pc=this,a}),t.RTCRtpSender.prototype.getStats=function(){const a=this;return this._pc.getStats().then(o=>iy(o,a.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=n.apply(this,[]);return i.forEach(a=>a._pc=this),i}),Lr(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(a=>iy(a,i.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const r=arguments[0];let i,a,o;return this.getSenders().forEach(s=>{s.track===r&&(i?o=!0:i=s)}),this.getReceivers().forEach(s=>(s.track===r&&(a?o=!0:a=s),s.track===r)),o||i&&a?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():a?a.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function Ak(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(o=>this._shimmedLocalStreams[o][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(o,s){if(!s)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const c=e.apply(this,arguments);return this._shimmedLocalStreams[s.id]?this._shimmedLocalStreams[s.id].indexOf(c)===-1&&this._shimmedLocalStreams[s.id].push(c):this._shimmedLocalStreams[s.id]=[s,c],c};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._shimmedLocalStreams=this._shimmedLocalStreams||{},o.getTracks().forEach(u=>{if(this.getSenders().find(d=>d.track===u))throw new DOMException("Track already exists.","InvalidAccessError")});const s=this.getSenders();n.apply(this,arguments);const c=this.getSenders().filter(u=>s.indexOf(u)===-1);this._shimmedLocalStreams[o.id]=[o].concat(c)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[o.id],r.apply(this,arguments)};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},o&&Object.keys(this._shimmedLocalStreams).forEach(s=>{const c=this._shimmedLocalStreams[s].indexOf(o);c!==-1&&this._shimmedLocalStreams[s].splice(c,1),this._shimmedLocalStreams[s].length===1&&delete this._shimmedLocalStreams[s]}),i.apply(this,arguments)}}function Ik(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return Ak(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const l=n.apply(this);return this._reverseStreams=this._reverseStreams||{},l.map(d=>this._reverseStreams[d.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(l){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},l.getTracks().forEach(d=>{if(this.getSenders().find(h=>h.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[l.id]){const d=new t.MediaStream(l.getTracks());this._streams[l.id]=d,this._reverseStreams[d.id]=l,l=d}r.apply(this,[l])};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(l){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[l.id]||l]),delete this._reverseStreams[this._streams[l.id]?this._streams[l.id].id:l.id],delete this._streams[l.id]},t.RTCPeerConnection.prototype.addTrack=function(l,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(p=>p===l))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(p=>p.track===l))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const m=this._streams[d.id];if(m)m.addTrack(l),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const p=new t.MediaStream([l]);this._streams[d.id]=p,this._reverseStreams[p.id]=d,this.addStream(p)}return this.getSenders().find(p=>p.track===l)};function a(u,l){let d=l.sdp;return Object.keys(u._reverseStreams||[]).forEach(f=>{const h=u._reverseStreams[f],m=u._streams[h.id];d=d.replace(new RegExp(m.id,"g"),h.id)}),new RTCSessionDescription({type:l.type,sdp:d})}function o(u,l){let d=l.sdp;return Object.keys(u._reverseStreams||[]).forEach(f=>{const h=u._reverseStreams[f],m=u._streams[h.id];d=d.replace(new RegExp(h.id,"g"),m.id)}),new RTCSessionDescription({type:l.type,sdp:d})}["createOffer","createAnswer"].forEach(function(u){const l=t.RTCPeerConnection.prototype[u],d={[u](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?l.apply(this,[m=>{const p=a(this,m);f[0].apply(null,[p])},m=>{f[1]&&f[1].apply(null,m)},arguments[2]]):l.apply(this,arguments).then(m=>a(this,m))}};t.RTCPeerConnection.prototype[u]=d[u]});const s=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?s.apply(this,arguments):(arguments[0]=o(this,arguments[0]),s.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const u=c.get.apply(this);return u.type===""?u:a(this,u)}}),t.RTCPeerConnection.prototype.removeTrack=function(l){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!l._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(l._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(h=>{this._streams[h].getTracks().find(p=>l.track===p)&&(f=this._streams[h])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(l.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Pd(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],i={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=i[n]})}function Rk(t,e){Lr(t,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var oy=Object.freeze({__proto__:null,fixNegotiationNeeded:Rk,shimAddTrackRemoveTrack:Ik,shimAddTrackRemoveTrackWithNative:Ak,shimGetSendersWithDtmf:Ok,shimGetUserMedia:_k,shimMediaStream:xk,shimOnTrack:Pk,shimPeerConnection:Pd,shimSenderReceiverGetStats:Ek});function Mk(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(i,a,o){Sh("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(i).then(a,o)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const i=function(o,s,c){s in o&&!(c in o)&&(o[c]=o[s],delete o[s])},a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(o){return typeof o=="object"&&typeof o.audio=="object"&&(o=JSON.parse(JSON.stringify(o)),i(o.audio,"autoGainControl","mozAutoGainControl"),i(o.audio,"noiseSuppression","mozNoiseSuppression")),a(o)},r&&r.prototype.getSettings){const o=r.prototype.getSettings;r.prototype.getSettings=function(){const s=o.apply(this,arguments);return i(s,"mozAutoGainControl","autoGainControl"),i(s,"mozNoiseSuppression","noiseSuppression"),s}}if(r&&r.prototype.applyConstraints){const o=r.prototype.applyConstraints;r.prototype.applyConstraints=function(s){return this.kind==="audio"&&typeof s=="object"&&(s=JSON.parse(JSON.stringify(s)),i(s,"autoGainControl","mozAutoGainControl"),i(s,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[s])}}}}function dG(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(r)})}function Dk(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Od(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const a=t.RTCPeerConnection.prototype[i],o={[i](){return arguments[0]=new(i==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),a.apply(this,arguments)}};t.RTCPeerConnection.prototype[i]=o[i]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[a,o,s]=arguments;return r.apply(this,[a||null]).then(c=>{if(e.version<53&&!o)try{c.forEach(u=>{u.type=n[u.type]||u.type})}catch(u){if(u.name!=="TypeError")throw u;c.forEach((l,d)=>{c.set(d,Object.assign({},l,{type:n[l.type]||l.type}))})}return c}).then(o,s)}}function Nk(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(a=>a._pc=this),i});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Lk(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),Lr(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function jk(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){Sh("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function $k(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function Bk(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(o=>{if("rid"in o&&!/^[a-z0-9]{0,16}$/i.test(o.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in o&&!(parseFloat(o.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in o&&!(parseFloat(o.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const a=e.apply(this,arguments);if(i){const{sender:o}=a,s=o.getParameters();(!("encodings"in s)||s.encodings.length===1&&Object.keys(s.encodings[0]).length===0)&&(s.encodings=r,o.sendEncodings=r,this.setParametersPromises.push(o.setParameters(s).then(()=>{delete o.sendEncodings}).catch(()=>{delete o.sendEncodings})))}return a})}function Uk(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function Fk(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function qk(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var sy=Object.freeze({__proto__:null,shimAddTransceiver:Bk,shimCreateAnswer:qk,shimCreateOffer:Fk,shimGetDisplayMedia:dG,shimGetParameters:Uk,shimGetUserMedia:Mk,shimOnTrack:Dk,shimPeerConnection:Od,shimRTCDataChannel:$k,shimReceiverGetStats:Lk,shimRemoveStream:jk,shimSenderGetStats:Nk});function Vk(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},t.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];return a&&a.forEach(s=>{this._localStreams?this._localStreams.includes(s)||this._localStreams.push(s):this._localStreams=[s]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const i=n.getTracks();this.getSenders().forEach(a=>{i.includes(a.track)&&this.removeTrack(a)})})}}function Wk(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const a=new Event("addstream");a.stream=i,this.dispatchEvent(a)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(a=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(a)>=0)return;r._remoteStreams.push(a);const o=new Event("addstream");o.stream=a,r.dispatchEvent(o)})}),e.apply(r,arguments)}}}function zk(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,a=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(u,l){const d=arguments.length>=2?arguments[2]:arguments[0],f=n.apply(this,[d]);return l?(f.then(u,l),Promise.resolve()):f},e.createAnswer=function(u,l){const d=arguments.length>=2?arguments[2]:arguments[0],f=r.apply(this,[d]);return l?(f.then(u,l),Promise.resolve()):f};let s=function(c,u,l){const d=i.apply(this,[c]);return l?(d.then(u,l),Promise.resolve()):d};e.setLocalDescription=s,s=function(c,u,l){const d=a.apply(this,[c]);return l?(d.then(u,l),Promise.resolve()):d},e.setRemoteDescription=s,s=function(c,u,l){const d=o.apply(this,[c]);return l?(d.then(u,l),Promise.resolve()):d},e.addIceCandidate=s}function Gk(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=i=>r(Hk(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=function(r,i,a){e.mediaDevices.getUserMedia(r).then(i,a)}.bind(e))}function Hk(t){return t&&t.video!==void 0?Object.assign({},t,{video:Ck(t.video)}):t}function Kk(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const a=[];for(let o=0;o<r.iceServers.length;o++){let s=r.iceServers[o];s.urls===void 0&&s.url?(Sh("RTCIceServer.url","RTCIceServer.urls"),s=JSON.parse(JSON.stringify(s)),s.urls=s.url,delete s.url,a.push(s)):a.push(r.iceServers[o])}r.iceServers=a}return new e(r,i)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function Xk(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Yk(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio!="undefined"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(o=>o.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo!="undefined"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const a=this.getTransceivers().find(o=>o.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):r.offerToReceiveVideo===!0&&!a&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function Jk(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var cy=Object.freeze({__proto__:null,shimAudioContext:Jk,shimCallbacksAPI:zk,shimConstraints:Hk,shimCreateOfferLegacy:Yk,shimGetUserMedia:Gk,shimLocalStreamsAPI:Vk,shimRTCIceServerUrls:Kk,shimRemoteStreamsAPI:Wk,shimTrackEventTransceiver:Xk}),ju={exports:{}},uy;function fG(){return uy||(uy=1,function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((i,a)=>(a>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let a=8;a<r.length;a+=2)switch(r[a]){case"raddr":i.relatedAddress=r[a+1];break;case"rport":i.relatedPort=parseInt(r[a+1],10);break;case"tcptype":i.tcpType=r[a+1];break;case"ufrag":i.ufrag=r[a+1],i.usernameFragment=r[a+1];break;default:i[r[a]]===void 0&&(i[r[a]]=r[a+1]);break}return i},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const i=n.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const a=n.type;return r.push("typ"),r.push(a),a!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const i=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let i;const a=n.substring(n.indexOf(" ")+1).split(";");for(let o=0;o<a.length;o++)i=a[o].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(n){let r="",i=n.payloadType;if(n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const a=[];Object.keys(n.parameters).forEach(o=>{n.parameters[o]!==void 0?a.push(o+"="+n.parameters[o]):a.push(o)}),r+="a=fmtp:"+i+" "+a.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",i=n.payloadType;return n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(a=>{r+="a=rtcp-fb:"+i+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),i={ssrc:parseInt(n.substring(7,r),10)},a=n.indexOf(":",r);return a>-1?(i.attribute=n.substring(r+1,a),i.value=n.substring(a+1)):i.attribute=n.substring(r+1),i},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let i="a=setup:"+r+`\r
`;return n.fingerprints.forEach(a=>{i+="a=fingerprint:"+a.algorithm+" "+a.value+`\r
`}),i},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const i=e.matchPrefix(n+r,"a=ice-ufrag:")[0],a=e.matchPrefix(n+r,"a=ice-pwd:")[0];return i&&a?{usernameFragment:i.substring(12),password:a.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},a=e.splitLines(n)[0].split(" ");r.profile=a[2];for(let s=3;s<a.length;s++){const c=a[s],u=e.matchPrefix(n,"a=rtpmap:"+c+" ")[0];if(u){const l=e.parseRtpMap(u),d=e.matchPrefix(n,"a=fmtp:"+c+" ");switch(l.parameters=d.length?e.parseFmtp(d[0]):{},l.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+c+" ").map(e.parseRtcpFb),r.codecs.push(l),l.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(l.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(s=>{r.headerExtensions.push(e.parseExtmap(s))});const o=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(s=>{o.forEach(c=>{s.rtcpFeedback.find(l=>l.type===c.type&&l.parameter===c.parameter)||s.rtcpFeedback.push(c)})}),r},e.writeRtpDescription=function(n,r){let i="";i+="m="+n+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(o=>o.preferredPayloadType!==void 0?o.preferredPayloadType:o.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(o=>{i+=e.writeRtpMap(o),i+=e.writeFmtp(o),i+=e.writeRtcpFb(o)});let a=0;return r.codecs.forEach(o=>{o.maxptime>a&&(a=o.maxptime)}),a>0&&(i+="a=maxptime:"+a+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(o=>{i+=e.writeExtmap(o)}),i},e.parseRtpEncodingParameters=function(n){const r=[],i=e.parseRtpParameters(n),a=i.fecMechanisms.indexOf("RED")!==-1,o=i.fecMechanisms.indexOf("ULPFEC")!==-1,s=e.matchPrefix(n,"a=ssrc:").map(f=>e.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),c=s.length>0&&s[0].ssrc;let u;const l=e.matchPrefix(n,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(m=>parseInt(m,10)));l.length>0&&l[0].length>1&&l[0][0]===c&&(u=l[0][1]),i.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let h={ssrc:c,codecPayloadType:parseInt(f.parameters.apt,10)};c&&u&&(h.rtx={ssrc:u}),r.push(h),a&&(h=JSON.parse(JSON.stringify(h)),h.fec={ssrc:c,mechanism:o?"red+ulpfec":"red"},r.push(h))}}),r.length===0&&c&&r.push({ssrc:c});let d=e.matchPrefix(n,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(f=>{f.maxBitrate=d})),r},e.parseRtcpParameters=function(n){const r={},i=e.matchPrefix(n,"a=ssrc:").map(s=>e.parseSsrcMedia(s)).filter(s=>s.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const a=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=a.length>0,r.compound=a.length===0;const o=e.matchPrefix(n,"a=rtcp-mux");return r.mux=o.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const i=e.matchPrefix(n,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const a=e.matchPrefix(n,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="msid");if(a.length>0)return r=a[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),i=e.matchPrefix(n,"a=max-message-size:");let a;i.length>0&&(a=parseInt(i[0].substring(19),10)),isNaN(a)&&(a=65536);const o=e.matchPrefix(n,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:r.fmt,maxMessageSize:a};const s=e.matchPrefix(n,"a=sctpmap:");if(s.length>0){const c=s[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:a}}},e.writeSctpDescription=function(n,r){let i=[];return n.protocol!=="DTLS/SCTP"?i=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,i){let a;const o=r!==void 0?r:2;return n?a=n:a=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+a+" "+o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const i=e.splitLines(n);for(let a=0;a<i.length;a++)switch(i[a]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[a].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const i=e.splitLines(n)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(n){const i=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},t.exports=e}(ju)),ju.exports}var Qk=fG(),ai=eG(Qk),hG=Cz({__proto__:null,default:ai},[Qk]);function Ho(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),a=ai.parseCandidate(r.candidate);for(const o in a)o in i||Object.defineProperty(i,o,{value:a[o]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},t.RTCIceCandidate.prototype=e.prototype,Lr(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function Ed(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||Lr(t,"icecandidate",e=>{if(e.candidate){const n=ai.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Ko(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp=="undefined"?null:this._sctp}});const n=function(s){if(!s||!s.sdp)return!1;const c=ai.splitSections(s.sdp);return c.shift(),c.some(u=>{const l=ai.parseMLine(u);return l&&l.kind==="application"&&l.protocol.indexOf("SCTP")!==-1})},r=function(s){const c=s.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const u=parseInt(c[1],10);return u!==u?-1:u},i=function(s){let c=65536;return e.browser==="firefox"&&(e.version<57?s===-1?c=16384:c=2147483637:e.version<60?c=e.version===57?65535:65536:c=2147483637),c},a=function(s,c){let u=65536;e.browser==="firefox"&&e.version===57&&(u=65535);const l=ai.matchPrefix(s.sdp,"a=max-message-size:");return l.length>0?u=parseInt(l[0].substring(19),10):e.browser==="firefox"&&c!==-1&&(u=2147483637),u},o=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:c}=this.getConfiguration();c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp=="undefined"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const c=r(arguments[0]),u=i(c),l=a(arguments[0],c);let d;u===0&&l===0?d=Number.POSITIVE_INFINITY:u===0||l===0?d=Math.max(u,l):d=Math.min(u,l);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return d}}),this._sctp=f}return o.apply(this,arguments)}}function Xo(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,i){const a=r.send;r.send=function(){const s=arguments[0],c=s.length||s.size||s.byteLength;if(r.readyState==="open"&&i.sctp&&c>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return a.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const i=n.apply(this,arguments);return e(i,this),i},Lr(t,"datachannel",r=>(e(r.channel,r.target),r))}function Ad(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const a=i.target;if(a._lastConnectionState!==a.connectionState){a._lastConnectionState=a.connectionState;const o=new Event("connectionstatechange",i);a.dispatchEvent(o)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function Id(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const a=i.sdp.split(`
`).filter(o=>o.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&i instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:i.type,sdp:a}):i.sdp=a}return n.apply(this,arguments)}}function Yo(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Jo(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return n.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?n.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(o=>n.apply(this,[o]))})}var pG=Object.freeze({__proto__:null,removeExtmapAllowMixed:Id,shimAddIceCandidateNullOrEmpty:Yo,shimConnectionState:Ad,shimMaxMessageSize:Ko,shimParameterlessSetLocalDescription:Jo,shimRTCIceCandidate:Ho,shimRTCIceCandidateRelayProtocol:Ed,shimSendThrowTypeError:Xo});function mG(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=wk,r=lG(t),i={browserDetails:r,commonShim:pG,extractVersion:ha,disableLog:cG,disableWarnings:uG,sdp:hG};switch(r.browser){case"chrome":if(!oy||!Pd||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=oy,Yo(t,r),Jo(t),_k(t,r),xk(t),Pd(t,r),Pk(t),Ik(t,r),Ok(t),Ek(t),Rk(t,r),Ho(t),Ed(t),Ad(t),Ko(t,r),Xo(t),Id(t,r);break;case"firefox":if(!sy||!Od||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=sy,Yo(t,r),Jo(t),Mk(t,r),Od(t,r),Dk(t),jk(t),Nk(t),Lk(t),$k(t),Bk(t),Uk(t),Fk(t),qk(t),Ho(t),Ad(t),Ko(t,r),Xo(t);break;case"safari":if(!cy||!e.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=cy,Yo(t,r),Jo(t),Kk(t),Yk(t),zk(t),Vk(t),Wk(t),Xk(t),Gk(t),Jk(t),Ho(t),Ed(t),Ko(t,r),Xo(t),Id(t,r);break;default:n("Unsupported browser!");break}return i}mG({window:typeof window=="undefined"?void 0:window});const gG=10,sa="lk_e2ee",vG="LKFrameEncryptionKey",yG={sharedKey:!1,ratchetSalt:vG,ratchetWindowSize:8,failureTolerance:gG,keyringSize:16};var Yn;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(Yn||(Yn={}));var ly;(function(t){t.KeyRatcheted="keyRatcheted"})(ly||(ly={}));var Gn;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(Gn||(Gn={}));var dy;(function(t){t.Error="cryptorError"})(dy||(dy={}));function bG(){return SG()||Rd()}function Rd(){return typeof window.RTCRtpScriptTransform!="undefined"}function SG(){return typeof window.RTCRtpSender!="undefined"&&typeof window.RTCRtpSender.prototype.createEncodedStreams!="undefined"}function TG(t){var e,n,r,i,a;if(((e=t.value)===null||e===void 0?void 0:e.case)!=="sipDtmf"&&((n=t.value)===null||n===void 0?void 0:n.case)!=="metrics"&&((r=t.value)===null||r===void 0?void 0:r.case)!=="speaker"&&((i=t.value)===null||i===void 0?void 0:i.case)!=="transcription"&&((a=t.value)===null||a===void 0?void 0:a.case)!=="encryptedPacket")return new ZT({value:t.value})}class JK extends fn.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r,i)=>{ae.debug("key ratcheted event received",{ratchetResult:n,participantId:r,keyIndex:i})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},yG),e),this.on(Yn.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,r){const i={key:e,participantIdentity:n,keyIndex:r};if(!this.options.sharedKey&&!n)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(n!=null?n:"shared","-").concat(r!=null?r:0),i),this.emit(Yn.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(Yn.RatchetRequest,e,n)}}class Nn extends Error{constructor(e,n){super(n||"an error has occured"),this.name="LiveKitError",this.code=e}}var pe;(function(t){t[t.NotAllowed=0]="NotAllowed",t[t.ServerUnreachable=1]="ServerUnreachable",t[t.InternalError=2]="InternalError",t[t.Cancelled=3]="Cancelled",t[t.LeaveRequest=4]="LeaveRequest",t[t.Timeout=5]="Timeout"})(pe||(pe={}));class Te extends Nn{constructor(e,n,r,i){super(1,e),this.name="ConnectionError",this.status=r,this.reason=n,this.context=i,this.reasonName=pe[n]}}class Th extends Nn{constructor(e){super(21,e!=null?e:"device is unsupported"),this.name="DeviceUnsupportedError"}}class Sn extends Nn{constructor(e){super(20,e!=null?e:"track is invalid"),this.name="TrackInvalidError"}}class kG extends Nn{constructor(e){super(10,e!=null?e:"unsupported server"),this.name="UnsupportedServer"}}class Ge extends Nn{constructor(e){super(12,e!=null?e:"unexpected connection state"),this.name="UnexpectedConnectionState"}}class Md extends Nn{constructor(e){super(13,e!=null?e:"unable to negotiate"),this.name="NegotiationError"}}class fy extends Nn{constructor(e,n){super(15,e),this.name="PublishTrackError",this.status=n}}class hy extends Nn{constructor(e,n){super(15,e),this.reason=n,this.reasonName=typeof n=="string"?n:bh[n]}}var ot;(function(t){t[t.AlreadyOpened=0]="AlreadyOpened",t[t.AbnormalEnd=1]="AbnormalEnd",t[t.DecodeFailed=2]="DecodeFailed",t[t.LengthExceeded=3]="LengthExceeded",t[t.Incomplete=4]="Incomplete",t[t.HandlerAlreadyRegistered=7]="HandlerAlreadyRegistered",t[t.EncryptionTypeMismatch=8]="EncryptionTypeMismatch"})(ot||(ot={}));class At extends Nn{constructor(e,n){super(16,e),this.name="DataStreamError",this.reason=n,this.reasonName=ot[n]}}var oc;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(oc||(oc={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(oc||(oc={}));var py;(function(t){t[t.InvalidKey=0]="InvalidKey",t[t.MissingKey=1]="MissingKey",t[t.InternalError=2]="InternalError"})(py||(py={}));var z;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.SignalReconnecting="signalReconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.Moved="moved",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.ParticipantAttributesChanged="participantAttributesChanged",t.ParticipantActive="participantActive",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.SipDTMFReceived="sipDTMFReceived",t.TranscriptionReceived="transcriptionReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged",t.ChatMessage="chatMessage",t.LocalTrackSubscribed="localTrackSubscribed",t.MetricsReceived="metricsReceived"})(z||(z={}));var Y;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalTrackCpuConstrained="localTrackCpuConstrained",t.LocalSenderCreated="localSenderCreated",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.SipDTMFReceived="sipDTMFReceived",t.TranscriptionReceived="transcriptionReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.TrackCpuConstrained="trackCpuConstrained",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded",t.AttributesChanged="attributesChanged",t.LocalTrackSubscribed="localTrackSubscribed",t.ChatMessage="chatMessage",t.Active="active"})(Y||(Y={}));var X;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalTrackSubscribed="localTrackSubscribed",t.Offline="offline",t.SignalRequestResponse="signalRequestResponse",t.SignalConnected="signalConnected",t.RoomMoved="roomMoved"})(X||(X={}));var G;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.CpuConstrained="cpuConstrained",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed",t.TrackProcessorUpdate="trackProcessorUpdate",t.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",t.TranscriptionReceived="transcriptionReceived",t.TimeSyncUpdate="timeSyncUpdate",t.PreConnectBufferFlushed="preConnectBufferFlushed"})(G||(G={}));function wG(t){return typeof t=="undefined"?t:typeof structuredClone=="function"?typeof t=="object"&&t!==null?structuredClone(Object.assign({},t)):structuredClone(t):JSON.parse(JSON.stringify(t))}const CG=/version\/(\d+(\.?_?\d+)+)/i;let $u;function Ct(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof t=="undefined"&&typeof navigator=="undefined")return;const n=(t!=null?t:navigator.userAgent).toLowerCase();if($u===void 0||e){const r=_G.find(i=>{let{test:a}=i;return a.test(n)});$u=r==null?void 0:r.describe(n)}return $u}const _G=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:Qo(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:Bu(t)}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:Qo(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0,osVersion:Bu(t)}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:Qo(CG,t),os:t.includes("mobile/")?"iOS":"macOS",osVersion:Bu(t)}}}];function Qo(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(t);return r&&r.length>=n&&r[n]||""}function Bu(t){return t.includes("mac os")?Qo(/\(.+?(\d+_\d+(:?_\d+)?)/,t,1).replace(/_/g,"."):void 0}var xG="2.15.8";const PG=xG,OG=16;class nt{}nt.setTimeout=function(){return setTimeout(...arguments)};nt.setInterval=function(){return setInterval(...arguments)};nt.clearTimeout=function(){return clearTimeout(...arguments)};nt.clearInterval=function(){return clearInterval(...arguments)};const EG=5e3,ca=[];var wt;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH"})(wt||(wt={}));class B extends fn.EventEmitter{get streamState(){return this._streamState}setStreamState(e){this._streamState=e}constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this._streamState=B.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=ae,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),EG):this.handleAppVisibilityChanged()},this.log=In((i=r.loggerName)!==null&&i!==void 0?i:Kt.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=B.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),ue(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===B.Kind.Video&&(n="video"),this.attachedElements.length===0&&this.kind===B.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(ca.forEach(a=>{a.parentElement===null&&!e&&(e=a)}),e&&ca.splice(ca.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),Yr(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(a=>a.kind==="audio");return e.play().then(()=>{this.emit(i?G.AudioPlaybackStarted:G.VideoPlaybackStarted)}).catch(a=>{a.name==="NotAllowedError"?this.emit(i?G.AudioPlaybackFailed:G.VideoPlaybackFailed,a):a.name==="AbortError"?ae.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):ae.warn("could not playback ".concat(i?"audio":"video"),a),i&&e&&r.some(o=>o.kind==="video")&&a.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(G.ElementAttached,e),e}detach(e){try{if(e){oi(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(G.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(r=>{oi(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(G.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=In(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),ca.forEach(r=>{r.parentElement||(n=!1)}),n&&ca.push(e)}}handleAppVisibilityChanged(){return x(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===B.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){mt()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){mt()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Yr(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let r;t.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(t)||(r.forEach(i=>{n.removeTrack(i)}),n.addTrack(t)),(!Ar()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(Ar()||Er())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function oi(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(u){u.Audio="audio",u.Video="video",u.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(u){u.Camera="camera",u.Microphone="microphone",u.ScreenShare="screen_share",u.ScreenShareAudio="screen_share_audio",u.Unknown="unknown"})(n=t.Source||(t.Source={}));let r;(function(u){u.Active="active",u.Paused="paused",u.Unknown="unknown"})(r=t.StreamState||(t.StreamState={}));function i(u){switch(u){case e.Audio:return Wt.AUDIO;case e.Video:return Wt.VIDEO;default:return Wt.DATA}}t.kindToProto=i;function a(u){switch(u){case Wt.AUDIO:return e.Audio;case Wt.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=a;function o(u){switch(u){case n.Camera:return Be.CAMERA;case n.Microphone:return Be.MICROPHONE;case n.ScreenShare:return Be.SCREEN_SHARE;case n.ScreenShareAudio:return Be.SCREEN_SHARE_AUDIO;default:return Be.UNKNOWN}}t.sourceToProto=o;function s(u){switch(u){case Be.CAMERA:return n.Camera;case Be.MICROPHONE:return n.Microphone;case Be.SCREEN_SHARE:return n.ScreenShare;case Be.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=s;function c(u){switch(u){case wd.ACTIVE:return r.Active;case wd.PAUSED:return r.Paused;default:return r.Unknown}}t.streamStateFromProto=c})(B||(B={}));class be{constructor(e,n,r,i,a){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(n!==void 0&&r!==void 0)this.width=e,this.height=n,this.aspectRatio=e/n,this.encoding={maxBitrate:r,maxFramerate:i,priority:a};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const AG=["vp8","h264"],IG=["vp8","h264","vp9","av1","h265"];function RG(t){return!!AG.find(e=>e===t)}const MG=RG;var my;(function(t){t[t.PREFER_REGRESSION=0]="PREFER_REGRESSION",t[t.SIMULCAST=1]="SIMULCAST",t[t.REGRESSION=2]="REGRESSION"})(my||(my={}));var Dd;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:24e3},t.music={maxBitrate:48e3},t.musicStereo={maxBitrate:64e3},t.musicHighQuality={maxBitrate:96e3},t.musicHighQualityStereo={maxBitrate:128e3}})(Dd||(Dd={}));const io={h90:new be(160,90,9e4,20),h180:new be(320,180,16e4,20),h216:new be(384,216,18e4,20),h360:new be(640,360,45e4,20),h540:new be(960,540,8e5,25),h720:new be(1280,720,17e5,30),h1080:new be(1920,1080,3e6,30),h1440:new be(2560,1440,5e6,30),h2160:new be(3840,2160,8e6,30)},Nd={h120:new be(160,120,7e4,20),h180:new be(240,180,125e3,20),h240:new be(320,240,14e4,20),h360:new be(480,360,33e4,20),h480:new be(640,480,5e5,20),h540:new be(720,540,6e5,25),h720:new be(960,720,13e5,30),h1080:new be(1440,1080,23e5,30),h1440:new be(1920,1440,38e5,30)},kh={h360fps3:new be(640,360,2e5,3,"medium"),h360fps15:new be(640,360,4e5,15,"medium"),h720fps5:new be(1280,720,8e5,5,"medium"),h720fps15:new be(1280,720,15e5,15,"medium"),h720fps30:new be(1280,720,2e6,30,"medium"),h1080fps15:new be(1920,1080,25e5,15,"medium"),h1080fps30:new be(1920,1080,5e6,30,"medium"),original:new be(0,0,7e6,30,"medium")},DG="|",gy="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function NG(t){const e=t.split(DG);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function vt(t){return x(this,void 0,void 0,function*(){return new Promise(e=>nt.setTimeout(e,t))})}function Ld(){return"addTransceiver"in RTCPeerConnection.prototype}function jd(){return"addTrack"in RTCPeerConnection.prototype}function LG(){if(!("getCapabilities"in RTCRtpSender)||Ar()||Er())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType.toLowerCase()==="video/av1"){e=!0;break}}return e}function jG(){if(!("getCapabilities"in RTCRtpSender)||Er())return!1;if(Ar()){const n=Ct();if(n!=null&&n.version&&ln(n.version,"16")<0||(n==null?void 0:n.os)==="iOS"&&(n!=null&&n.osVersion)&&ln(n.osVersion,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType.toLowerCase()==="video/vp9"){e=!0;break}}return e}function Qt(t){return t==="av1"||t==="vp9"}function $d(t){return!document||ao()?!1:(t||(t=document.createElement("audio")),"setSinkId"in t)}function $G(){return typeof RTCPeerConnection=="undefined"?!1:Ld()||jd()}function Er(){var t;return((t=Ct())===null||t===void 0?void 0:t.name)==="Firefox"}function Ar(){var t;return((t=Ct())===null||t===void 0?void 0:t.name)==="Safari"}function ao(){const t=Ct();return(t==null?void 0:t.name)==="Safari"||(t==null?void 0:t.os)==="iOS"}function BG(){const t=Ct();return(t==null?void 0:t.name)==="Safari"&&t.version.startsWith("17.")||(t==null?void 0:t.os)==="iOS"&&!!(t!=null&&t.osVersion)&&ln(t.osVersion,"17")>=0}function UG(t){return t||(t=Ct()),(t==null?void 0:t.name)==="Safari"&&ln(t.version,"18.3")>0||(t==null?void 0:t.os)==="iOS"&&!!(t!=null&&t.osVersion)&&ln(t.osVersion,"18.3")>0}function Zk(){var t,e;return mt()?(e=(t=navigator.userAgentData)===null||t===void 0?void 0:t.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function FG(){const t=Ct(),e="17.2";if(t)return t.name!=="Safari"&&t.os!=="iOS"||t.os==="iOS"&&t.osVersion&&ln(t.osVersion,e)>=0?!0:t.name==="Safari"&&ln(t.version,e)>=0}function mt(){return typeof document!="undefined"}function un(){return navigator.product=="ReactNative"}function Bd(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function ew(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function tw(){if(!un())return;let t=ew();if(t)return t.platform}function vy(){if(mt())return window.devicePixelRatio;if(un()){let t=ew();if(t)return t.devicePixelRatio}return 1}function ln(t,e){const n=t.split("."),r=e.split("."),i=Math.min(n.length,r.length);for(let a=0;a<i;++a){const o=parseInt(n[a],10),s=parseInt(r[a],10);if(o>s)return 1;if(o<s)return-1;if(a===i-1&&o===s)return 0}return t===""&&e!==""?-1:e===""?1:n.length==r.length?0:n.length<r.length?-1:1}function qG(t){for(const e of t)e.target.handleResize(e)}function VG(t){for(const e of t)e.target.handleVisibilityChanged(e)}let Uu=null;const yy=()=>(Uu||(Uu=new ResizeObserver(qG)),Uu);let Fu=null;const by=()=>(Fu||(Fu=new IntersectionObserver(VG,{root:null,rootMargin:"0px"})),Fu);function WG(){var t;const e=new P5({sdk:ok.JS,protocol:OG,version:PG});return un()&&(e.os=(t=tw())!==null&&t!==void 0?t:""),e}function Sy(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=t,i.height=e;const a=i.getContext("2d");a==null||a.fillRect(0,0,i.width,i.height),r&&a&&(a.beginPath(),a.arc(t/2,e/2,50,0,Math.PI*2,!0),a.closePath(),a.fillStyle="grey",a.fill());const o=i.captureStream(),[s]=o.getTracks();if(!s)throw Error("Could not get empty media stream video track");return s.enabled=n,s}let ua;function qu(){if(!ua){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const r=t.createMediaStreamDestination();if(e.connect(n),n.connect(r),e.start(),[ua]=r.stream.getAudioTracks(),!ua)throw Error("Could not get empty media stream audio track");ua.enabled=!1}return ua.clone()}class Mt{get isResolved(){return this._isResolved}constructor(e,n){this._isResolved=!1,this.onFinally=n,this.promise=new Promise((r,i)=>x(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;this._isResolved=!0,(r=this.onFinally)===null||r===void 0||r.call(this)})}}function zG(t){return IG.includes(t)}function Jn(t){if(typeof t=="string"||typeof t=="number")return t;if(Array.isArray(t))return t[0];if(t.exact!==void 0)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal!==void 0)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function GG(t){return t.startsWith("http")?t.replace(/^(http)/,"ws"):t}function Ud(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}function HG(t,e){return t.segments.map(n=>{let{id:r,text:i,language:a,startTime:o,endTime:s,final:c}=n;var u;const l=(u=e.get(r))!==null&&u!==void 0?u:Date.now(),d=Date.now();return c?e.delete(r):e.set(r,l),{id:r,text:i,startTime:Number.parseInt(o.toString()),endTime:Number.parseInt(s.toString()),final:c,language:a,firstReceivedTime:l,lastReceivedTime:d}})}function KG(t){const{id:e,timestamp:n,message:r,editTimestamp:i}=t;return{id:e,timestamp:Number.parseInt(n.toString()),editTimestamp:i?Number.parseInt(i.toString()):void 0,message:r}}function Ty(t){switch(t.reason){case pe.LeaveRequest:return t.context;case pe.Cancelled:return Ht.CLIENT_INITIATED;case pe.NotAllowed:return Ht.USER_REJECTED;case pe.ServerUnreachable:return Ht.JOIN_FAILURE;default:return Ht.UNKNOWN_REASON}}function Zo(t){return t!==void 0?Number(t):void 0}function fr(t){return t!==void 0?BigInt(t):void 0}function Sr(t){return!!t&&!(t instanceof MediaStreamTrack)&&t.isLocal}function on(t){return!!t&&t.kind==B.Kind.Audio}function ir(t){return!!t&&t.kind==B.Kind.Video}function $n(t){return Sr(t)&&ir(t)}function pn(t){return Sr(t)&&on(t)}function Fd(t){return!!t&&!t.isLocal}function XG(t){return!!t&&!t.isLocal}function Vu(t){return Fd(t)&&ir(t)}function YG(t){return t.isLocal}function JG(t,e){const n=[];let r=new TextEncoder().encode(t);for(;r.length>e;){let i=e;for(;i>0;){const a=r[i];if(a!==void 0&&(a&192)!==128)break;i--}n.push(r.slice(0,i)),r=r.slice(i)}return r.length>0&&n.push(r),n}function nw(t,e,n){var r,i,a,o;const{optionsWithoutProcessor:s,audioProcessor:c,videoProcessor:u}=aw(t!=null?t:{}),l=e==null?void 0:e.processor,d=n==null?void 0:n.processor,f=s!=null?s:{};return f.audio===!0&&(f.audio={}),f.video===!0&&(f.video={}),f.audio&&(qd(f.audio,e),(r=(a=f.audio).deviceId)!==null&&r!==void 0||(a.deviceId={ideal:"default"}),(c||l)&&(f.audio.processor=c!=null?c:l)),f.video&&(qd(f.video,n),(i=(o=f.video).deviceId)!==null&&i!==void 0||(o.deviceId={ideal:"default"}),(u||d)&&(f.video.processor=u!=null?u:d)),f}function qd(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function wh(t){var e,n,r,i;const a={};if(t.video)if(typeof t.video=="object"){const o={},s=o,c=t.video;Object.keys(c).forEach(u=>{switch(u){case"resolution":qd(s,c.resolution);break;default:s[u]=c[u]}}),a.video=o,(e=(r=a.video).deviceId)!==null&&e!==void 0||(r.deviceId={ideal:"default"})}else a.video=t.video?{deviceId:{ideal:"default"}}:!1;else a.video=!1;return t.audio?typeof t.audio=="object"?(a.audio=t.audio,(n=(i=a.audio).deviceId)!==null&&n!==void 0||(i.deviceId={ideal:"default"})):a.audio={deviceId:{ideal:"default"}}:a.audio=!1,a}function rw(t){return x(this,arguments,void 0,function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return function*(){const r=iw();if(r){const i=r.createAnalyser();i.fftSize=2048;const a=i.frequencyBinCount,o=new Uint8Array(a);r.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(i),yield vt(n),i.getByteTimeDomainData(o);const c=o.some(u=>u!==128&&u!==0);return r.close(),!c}return!1}()})}function iw(){var t;const e=typeof window!="undefined"&&(window.AudioContext||window.webkitAudioContext);if(e){const n=new e({latencyHint:"interactive"});if(n.state==="suspended"&&typeof window!="undefined"&&(!((t=window.document)===null||t===void 0)&&t.body)){const r=()=>x(this,void 0,void 0,function*(){var i;try{n.state==="suspended"&&(yield n.resume())}catch(a){console.warn("Error trying to auto-resume audio context",a)}finally{(i=window.document.body)===null||i===void 0||i.removeEventListener("click",r)}});n.addEventListener("statechange",()=>{var i;n.state==="closed"&&((i=window.document.body)===null||i===void 0||i.removeEventListener("click",r))}),window.document.body.addEventListener("click",r)}return n}}function QG(t){return t==="audioinput"?B.Source.Microphone:t==="videoinput"?B.Source.Camera:B.Source.Unknown}function Vd(t){return t===B.Source.Microphone?"audioinput":t===B.Source.Camera?"videoinput":void 0}function ZG(t){var e,n;let r=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&t.resolution.width>0&&t.resolution.height>0&&(r=typeof r=="boolean"?{}:r,Ar()?r=Object.assign(Object.assign({},r),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:r,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio,preferCurrentTab:t.preferCurrentTab}}function Sa(t){return t.split("/")[1].toLowerCase()}function eH(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new mh({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}function ue(t){return"mediaStreamTrack"in t?{trackID:t.sid,source:t.source,muted:t.isMuted,enabled:t.mediaStreamTrack.enabled,kind:t.kind,streamID:t.mediaStreamID,streamTrackID:t.mediaStreamTrack.id}:{trackID:t.trackSid,enabled:t.isEnabled,muted:t.isMuted,trackInfo:Object.assign({mimeType:t.mimeType,name:t.trackName,encrypted:t.isEncrypted,kind:t.kind,source:t.source},t.track?ue(t.track):{})}}function tH(){return typeof RTCRtpReceiver!="undefined"&&"getSynchronizationSources"in RTCRtpReceiver}function nH(t,e){var n;t===void 0&&(t={}),e===void 0&&(e={});const r=[...Object.keys(e),...Object.keys(t)],i={};for(const a of r)t[a]!==e[a]&&(i[a]=(n=e[a])!==null&&n!==void 0?n:"");return i}function aw(t){const e=Object.assign({},t);let n,r;return typeof e.audio=="object"&&e.audio.processor&&(n=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(r=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:n,videoProcessor:r,optionsWithoutProcessor:wG(e)}}function rH(t){switch(t){case Be.CAMERA:return B.Source.Camera;case Be.MICROPHONE:return B.Source.Microphone;case Be.SCREEN_SHARE:return B.Source.ScreenShare;case Be.SCREEN_SHARE_AUDIO:return B.Source.ScreenShareAudio;default:return B.Source.Unknown}}function ky(t,e){return t.width*t.height<e.width*e.height}function iH(t,e){var n;return(n=t.layers)===null||n===void 0?void 0:n.find(r=>r.quality===e)}class aH extends fn.EventEmitter{constructor(e,n){super(),this.decryptDataRequests=new Map,this.encryptDataRequests=new Map,this.onWorkerMessage=r=>{var i,a;const{kind:o,data:s}=r.data;switch(o){case"error":ae.error(s.error.message),this.emit(Gn.EncryptionError,s.error);break;case"initAck":s.enabled&&this.keyProvider.getKeys().forEach(l=>{this.postKey(l)});break;case"enable":if(s.enabled&&this.keyProvider.getKeys().forEach(l=>{this.postKey(l)}),this.encryptionEnabled!==s.enabled&&s.participantIdentity===((i=this.room)===null||i===void 0?void 0:i.localParticipant.identity))this.emit(Gn.ParticipantEncryptionStatusChanged,s.enabled,this.room.localParticipant),this.encryptionEnabled=s.enabled;else if(s.participantIdentity){const l=(a=this.room)===null||a===void 0?void 0:a.getParticipantByIdentity(s.participantIdentity);if(!l)throw TypeError("couldn't set encryption status, participant not found".concat(s.participantIdentity));this.emit(Gn.ParticipantEncryptionStatusChanged,s.enabled,l)}break;case"ratchetKey":this.keyProvider.emit(Yn.KeyRatcheted,s.ratchetResult,s.participantIdentity,s.keyIndex);break;case"decryptDataResponse":const c=this.decryptDataRequests.get(s.uuid);c!=null&&c.resolve&&c.resolve(s);break;case"encryptDataResponse":const u=this.encryptDataRequests.get(s.uuid);u!=null&&u.resolve&&u.resolve(s);break}},this.onWorkerError=r=>{ae.error("e2ee worker encountered an error:",{error:r.error}),this.emit(Gn.EncryptionError,r.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1,this.dataChannelEncryptionEnabled=n}get isEnabled(){return this.encryptionEnabled}get isDataChannelEncryptionEnabled(){return this.isEnabled&&this.dataChannelEncryptionEnabled}setup(e){if(!bG())throw new Th("tried to setup end-to-end encryption on an unsupported browser");if(ae.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:rG.getLevel()}};this.worker&&(ae.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){ae.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?ae.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(X.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(z.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==He.NONE,i.identity)),e.on(z.ConnectionStateChanged,r=>{r===ve.Connected&&e.remoteParticipants.forEach(i=>{i.trackPublications.forEach(a=>{this.setParticipantCryptorEnabled(a.trackInfo.encryption!==He.NONE,i.identity)})})}).on(z.TrackUnsubscribed,(r,i,a)=>{var o;const s={kind:"removeTransform",data:{participantIdentity:a.identity,trackId:r.mediaStreamID}};(o=this.worker)===null||o===void 0||o.postMessage(s)}).on(z.TrackSubscribed,(r,i,a)=>{this.setupE2EEReceiver(r,a.identity,i.trackInfo)}).on(z.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");n.getKeys().forEach(r=>{this.postKey(r)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(Y.LocalSenderCreated,(r,i)=>x(this,void 0,void 0,function*(){this.setupE2EESender(i,r)})),e.localParticipant.on(Y.LocalTrackPublished,r=>{if(!ir(r.track)||!ao())return;const i={kind:"updateCodec",data:{trackId:r.track.mediaStreamID,codec:Sa(r.trackInfo.codecs[0].mimeType),participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(i)}),n.on(Yn.SetKey,r=>this.postKey(r)).on(Yn.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}encryptData(e){return x(this,void 0,void 0,function*(){if(!this.worker)throw Error("could not encrypt data, worker is missing");const n=crypto.randomUUID(),r={kind:"encryptDataRequest",data:{uuid:n,payload:e,participantIdentity:this.room.localParticipant.identity}},i=new Mt;return i.onFinally=()=>{this.encryptDataRequests.delete(n)},this.encryptDataRequests.set(n,i),this.worker.postMessage(r),i.promise})}handleEncryptedData(e,n,r,i){if(!this.worker)throw Error("could not handle encrypted data, worker is missing");const a=crypto.randomUUID(),o={kind:"decryptDataRequest",data:{uuid:a,payload:e,iv:n,participantIdentity:r,keyIndex:i}},s=new Mt;return s.onFinally=()=>{this.decryptDataRequests.delete(a)},this.decryptDataRequests.set(a,s),this.worker.postMessage(o),s.promise}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(r)}postKey(e){let{key:n,participantIdentity:r,keyIndex:i}=e;var a;if(!this.worker)throw Error("could not set key, worker is missing");const o={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((a=this.room)===null||a===void 0?void 0:a.localParticipant.identity),key:n,keyIndex:i}};this.worker.postMessage(o)}postEnable(e,n){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?Sa(r.mimeType):void 0)}}setupE2EESender(e,n){if(!Sr(e)||!n){n||ae.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,r,i){return x(this,void 0,void 0,function*(){if(this.worker){if(Rd()){const a={kind:"decode",participantIdentity:r,trackId:n,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,a)}else{if(sa in e&&i){const c={kind:"updateCodec",data:{trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(c);return}let a=e.writableStream,o=e.readableStream;if(!a||!o){const c=e.createEncodedStreams();e.writableStream=c.writable,a=c.writable,e.readableStream=c.readable,o=c.readable}const s={kind:"decode",data:{readableStream:o,writableStream:a,trackId:n,codec:i,participantIdentity:r,isReuse:sa in e}};this.worker.postMessage(s,[o,a])}e[sa]=!0}})}handleSender(e,n,r){var i;if(!(sa in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Rd()){ae.info("initialize script transform");const a={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,a)}else{ae.info("initialize encoded streams");const a=e.createEncodedStreams(),o={kind:"encode",data:{readableStream:a.readable,writableStream:a.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(o,[a.readable,a.writable])}e[sa]=!0}}}const Wu="default";class Qe{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new Qe),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return x(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var a;if(((a=Qe.userMediaPromiseMap)===null||a===void 0?void 0:a.size)>0){ae.debug("awaiting getUserMedia promise");try{n?yield Qe.userMediaPromiseMap.get(n):yield Promise.all(Qe.userMediaPromiseMap.values())}catch(s){ae.warn("error waiting for media permissons")}}let o=yield navigator.mediaDevices.enumerateDevices();if(i&&!(Ar()&&r.hasDeviceInUse(n))&&(o.filter(c=>c.kind===n).length===0||o.some(c=>{const u=c.label==="",l=n?c.kind===n:!0;return u&&l}))){const c={video:n!=="audioinput"&&n!=="audiooutput",audio:n!=="videoinput"&&{deviceId:{ideal:"default"}}},u=yield navigator.mediaDevices.getUserMedia(c);o=yield navigator.mediaDevices.enumerateDevices(),u.getTracks().forEach(l=>{l.stop()})}return r._previousDevices=o,n&&(o=o.filter(s=>s.kind===n)),o}()})}normalizeDeviceId(e,n,r){return x(this,void 0,void 0,function*(){if(n!==Wu)return n;const i=yield this.getDevices(e),a=i.find(s=>s.deviceId===Wu);if(!a){ae.warn("could not reliably determine default device");return}const o=i.find(s=>s.deviceId!==Wu&&s.groupId===(r!=null?r:a.groupId));if(!o){ae.warn("could not reliably determine default device");return}return o==null?void 0:o.deviceId})}hasDeviceInUse(e){return e?Qe.userMediaPromiseMap.has(e):Qe.userMediaPromiseMap.size>0}}Qe.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];Qe.userMediaPromiseMap=new Map;var Ta;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(Ta||(Ta={}));class oH{constructor(){this.pendingTasks=new Map,this.taskMutex=new gt,this.nextTaskIndex=0}run(e){return x(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Ta.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=Ta.RUNNING,yield e()}finally{n.status=Ta.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return x(this,void 0,void 0,function*(){return this.run(()=>x(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}function sH(t,e){const n=new URL(GG(t));return e.forEach((r,i)=>{n.searchParams.set(i,r)}),ow(n,"rtc")}function cH(t){const e=new URL(Ud(t));return ow(e,"validate")}function uH(t){return t.endsWith("/")?t:"".concat(t,"/")}function ow(t,e){return t.pathname="".concat(uH(t.pathname)).concat(e),t.toString()}const lH=["syncState","trickle","offer","answer","simulate","leave"];function dH(t){const e=lH.indexOf(t.case)>=0;return ae.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var Pe;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(Pe||(Pe={}));class Ch{get currentState(){return this.state}get isDisconnected(){return this.state===Pe.DISCONNECTING||this.state===Pe.DISCONNECTED}get isEstablishingConnection(){return this.state===Pe.CONNECTING||this.state===Pe.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=Pe.DISCONNECTED,this.log=ae,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=In((r=n.loggerName)!==null&&r!==void 0?r:Kt.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=e,this.requestQueue=new oH,this.queuedRequests=[],this.closingLock=new gt,this.connectionLock=new gt,this.state=Pe.DISCONNECTED}get logContext(){var e,n;return(n=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:{}}join(e,n,r,i){return x(this,void 0,void 0,function*(){return this.state=Pe.CONNECTING,this.options=r,yield this.connect(e,n,r,i)})}reconnect(e,n,r,i){return x(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=Pe.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(e,n,r,i){this.connectOptions=r;const a=WG(),o=fH(n,a,r),s=sH(e,o),c=cH(s);return new Promise((u,l)=>x(this,void 0,void 0,function*(){const d=yield this.connectionLock.lock();try{const f=()=>x(this,void 0,void 0,function*(){this.close(),clearTimeout(h),l(new Te("room connection has been cancelled (signal)",pe.Cancelled))}),h=setTimeout(()=>{this.close(),l(new Te("room connection has timed out (signal)",pe.ServerUnreachable))},r.websocketTimeout);i!=null&&i.aborted&&f(),i==null||i.addEventListener("abort",f);const m=new URL(s);m.searchParams.has("access_token")&&m.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(m),Object.assign({reconnect:r.reconnect,reconnectReason:r.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(s),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(h)},this.ws.onerror=p=>x(this,void 0,void 0,function*(){if(this.state!==Pe.CONNECTED){this.state=Pe.DISCONNECTED,clearTimeout(h);try{const v=yield fetch(c);if(v.status.toFixed(0).startsWith("4")){const b=yield v.text();l(new Te(b,pe.NotAllowed,v.status))}else l(new Te("Encountered unknown websocket error during connection: ".concat(p.toString()),pe.InternalError,v.status))}catch(v){l(new Te(v instanceof Error?v.message:"server was not reachable",pe.ServerUnreachable))}return}this.handleWSError(p)}),this.ws.onmessage=p=>x(this,void 0,void 0,function*(){var v,b,k;let T;if(typeof p.data=="string"){const S=JSON.parse(p.data);T=Zv.fromJson(S,{ignoreUnknownFields:!0})}else if(p.data instanceof ArrayBuffer)T=Zv.fromBinary(new Uint8Array(p.data));else{this.log.error("could not decode websocket message: ".concat(typeof p.data),this.logContext);return}if(this.state!==Pe.CONNECTED){let S=!1;if(((v=T.message)===null||v===void 0?void 0:v.case)==="join"?(this.state=Pe.CONNECTED,i==null||i.removeEventListener("abort",f),this.pingTimeoutDuration=T.message.value.pingTimeout,this.pingIntervalDuration=T.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),u(T.message.value)):this.state===Pe.RECONNECTING&&T.message.case!=="leave"?(this.state=Pe.CONNECTED,i==null||i.removeEventListener("abort",f),this.startPingInterval(),((b=T.message)===null||b===void 0?void 0:b.case)==="reconnect"?u(T.message.value):(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),u(void 0),S=!0)):this.isEstablishingConnection&&T.message.case==="leave"?l(new Te("Received leave request while trying to (re)connect",pe.LeaveRequest,void 0,T.message.value.reason)):r.reconnect||l(new Te("did not receive join response, got ".concat((k=T.message)===null||k===void 0?void 0:k.case," instead"),pe.InternalError)),!S)return}this.signalLatency&&(yield vt(this.signalLatency)),this.handleSignalResponse(T)}),this.ws.onclose=p=>{this.isEstablishingConnection&&l(new Te("Websocket got closed during a (re)connection attempt",pe.InternalError)),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:p.reason,code:p.code,wasClean:p.wasClean,state:this.state})),this.handleOnClose(p.reason)}}finally{d()}}))}close(){return x(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const r=yield e.closingLock.lock();try{if(e.clearPingInterval(),n&&(e.state=Pe.DISCONNECTING),e.ws){e.ws.onmessage=null,e.ws.onopen=null,e.ws.onclose=null;const i=new Promise(a=>{e.ws?e.ws.onclose=()=>{a()}:a()});e.ws.readyState<e.ws.CLOSING&&(e.ws.close(),yield Promise.race([i,vt(250)])),e.ws=void 0}}finally{n&&(e.state=Pe.DISCONNECTED),r()}}()})}sendOffer(e,n){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:sc(e,n)})}sendAnswer(e,n){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:sc(e,n)})}sendIceCandidate(e,n){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Hc({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new Kc({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return x(this,arguments,void 0,function(r,i){var a=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){const s=a.getNextRequestId();return yield a.sendRequest({case:"updateMetadata",value:new vh({requestId:s,metadata:r,name:i,attributes:o})}),s}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new hk({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new gk({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Ae.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new Sk({timestamp:Ae.parse(Date.now()),rtt:Ae.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,n){return this.sendRequest({case:"updateAudioTrack",value:new gh({trackSid:e,features:n})})}sendLeave(){return this.sendRequest({case:"leave",value:new Yc({reason:Ht.CLIENT_INITIATED,action:ii.DISCONNECT})})}sendRequest(e){return x(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(!i&&!dH(n)&&r.state===Pe.RECONNECTING){r.queuedRequests.push(()=>x(r,void 0,void 0,function*(){yield this.sendRequest(n,!0)}));return}if(i||(yield r.requestQueue.flush()),r.signalLatency&&(yield vt(r.signalLatency)),r.isDisconnected){r.log.debug("skipping signal request (type: ".concat(n.case,") - SignalClient disconnected"));return}if(!r.ws||r.ws.readyState!==r.ws.OPEN){r.log.error("cannot send signal request before connected, type: ".concat(n==null?void 0:n.case),r.logContext);return}const o=new I5({message:n});try{r.useJSON?r.ws.send(o.toJsonString()):r.ws.send(o.toBinary())}catch(s){r.log.error("error sending signal message",Object.assign(Object.assign({},r.logContext),{error:s}))}}()})}handleSignalResponse(e){var n,r;const i=e.message;if(i==null){this.log.debug("received unsupported message",this.logContext);return}let a=!1;if(i.case==="answer"){const o=wy(i.value);this.onAnswer&&this.onAnswer(o,i.value.id)}else if(i.case==="offer"){const o=wy(i.value);this.onOffer&&this.onOffer(o,i.value.id)}else if(i.case==="trickle"){const o=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(o,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=i.value.participants)!==null&&n!==void 0?n:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),a=!0):i.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(i.value):i.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(i.value.trackSid):i.case==="roomMoved"?(this.onTokenRefresh&&this.onTokenRefresh(i.value.token),this.onRoomMoved&&this.onRoomMoved(i.value)):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));a||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return x(this,void 0,void 0,function*(){if(this.state===Pe.DISCONNECTED)return;const n=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),n&&n(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=nt.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&nt.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=nt.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&nt.clearInterval(this.pingInterval)}}function wy(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function sc(t,e){return new Or({sdp:t.sdp,type:t.type,id:e})}function fH(t,e,n){var r;const i=new URLSearchParams;return i.set("access_token",t),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid)),i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk",un()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),n.adaptiveStream&&i.set("adaptive_stream","1"),n.reconnectReason&&i.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),i}class Cy{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0&&this.buffer[0].sequence<=e;)this.pop()}alignBufferedAmount(e){for(;this.buffer.length>0;){const n=this.buffer[0];if(this._totalSize-n.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class hH{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,n){const r=Date.now();r-this._lastCleanup>this.ttl/2&&this.cleanup();const i=r+this.ttl;return this._map.set(e,{value:n,expiresAt:i}),this}get(e){const n=this._map.get(e);if(n){if(n.expiresAt<Date.now()){this._map.delete(e);return}return n.value}}has(e){const n=this._map.get(e);return n?n.expiresAt<Date.now()?(this._map.delete(e),!1):!0:!1}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[n,r]of this._map.entries())r.expiresAt<e&&this._map.delete(n);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[n,r]of this._map.entries())r.expiresAt>=Date.now()&&e(r.value,n,this.asValueMap())}map(e){this.cleanup();const n=[],r=this.asValueMap();for(const[i,a]of r.entries())n.push(e(a,i,r));return n}asValueMap(){const e=new Map;for(const[n,r]of this._map.entries())r.expiresAt>=Date.now()&&e.set(n,r.value);return e}}var $t={},zu={},Gu={exports:{}},_y;function _h(){if(_y)return Gu.exports;_y=1;var t=Gu.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var n="candidate:%s %d %s %d %s %d typ %s";return n+=e.raddr!=null?" raddr %s rport %d":"%v%v",n+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(n+=" generation %d"),n+=e["network-id"]!=null?" network-id %d":"%v",n+=e["network-cost"]!=null?" network-cost %d":"%v",n}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var n="ssrc:%d";return e.attribute!=null&&(n+=" %s",e.value!=null&&(n+=":%s")),n}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var n="mediaclk:";return n+=e.id!=null?"id=%s %s":"%v%s",n+=e.mediaClockValue!=null?"=%s":"",n+=e.rateNumerator!=null?" rate=%s":"",n+=e.rateDenominator!=null?"/%s":"",n}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(t).forEach(function(e){var n=t[e];n.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})}),Gu.exports}var xy;function pH(){return xy||(xy=1,function(t){var e=function(s){return String(Number(s))===s?Number(s):s},n=function(s,c,u,l){if(l&&!u)c[l]=e(s[1]);else for(var d=0;d<u.length;d+=1)s[d+1]!=null&&(c[u[d]]=e(s[d+1]))},r=function(s,c,u){var l=s.name&&s.names;s.push&&!c[s.push]?c[s.push]=[]:l&&!c[s.name]&&(c[s.name]={});var d=s.push?{}:l?c[s.name]:c;n(u.match(s.reg),d,s.names,s.name),s.push&&c[s.push].push(d)},i=_h(),a=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(s){var c={},u=[],l=c;return s.split(/(\r\n|\r|\n)/).filter(a).forEach(function(d){var f=d[0],h=d.slice(2);f==="m"&&(u.push({rtp:[],fmtp:[]}),l=u[u.length-1]);for(var m=0;m<(i[f]||[]).length;m+=1){var p=i[f][m];if(p.reg.test(h))return r(p,l,h)}}),c.media=u,c};var o=function(s,c){var u=c.split(/=(.+)/,2);return u.length===2?s[u[0]]=e(u[1]):u.length===1&&c.length>1&&(s[u[0]]=void 0),s};t.parseParams=function(s){return s.split(/;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(s){return s.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(s){for(var c=[],u=s.split(" ").map(e),l=0;l<u.length;l+=3)c.push({component:u[l],ip:u[l+1],port:u[l+2]});return c},t.parseImageAttributes=function(s){return s.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(o,{})})},t.parseSimulcastStreamList=function(s){return s.split(";").map(function(c){return c.split(",").map(function(u){var l,d=!1;return u[0]!=="~"?l=e(u):(l=e(u.substring(1,u.length)),d=!0),{scid:l,paused:d}})})}}(zu)),zu}var Hu,Py;function mH(){if(Py)return Hu;Py=1;var t=_h(),e=/%[sdv%]/g,n=function(o){var s=1,c=arguments,u=c.length;return o.replace(e,function(l){if(s>=u)return l;var d=c[s];switch(s+=1,l){case"%%":return"%";case"%s":return String(d);case"%d":return Number(d);case"%v":return""}})},r=function(o,s,c){var u=s.format instanceof Function?s.format(s.push?c:c[s.name]):s.format,l=[o+"="+u];if(s.names)for(var d=0;d<s.names.length;d+=1){var f=s.names[d];s.name?l.push(c[s.name][f]):l.push(c[s.names[d]])}else l.push(c[s.name]);return n.apply(null,l)},i=["v","o","s","i","u","e","p","c","b","t","r","z","a"],a=["i","c","b","a"];return Hu=function(o,s){s=s||{},o.version==null&&(o.version=0),o.name==null&&(o.name=" "),o.media.forEach(function(d){d.payloads==null&&(d.payloads="")});var c=s.outerOrder||i,u=s.innerOrder||a,l=[];return c.forEach(function(d){t[d].forEach(function(f){f.name in o&&o[f.name]!=null?l.push(r(d,f,o)):f.push in o&&o[f.push]!=null&&o[f.push].forEach(function(h){l.push(r(d,f,h))})})}),o.media.forEach(function(d){l.push(r("m",t.m[0],d)),u.forEach(function(f){t[f].forEach(function(h){h.name in d&&d[h.name]!=null?l.push(r(f,h,d)):h.push in d&&d[h.push]!=null&&d[h.push].forEach(function(m){l.push(r(f,h,m))})})})}),l.join(`\r
`)+`\r
`},Hu}var Oy;function gH(){if(Oy)return $t;Oy=1;var t=pH(),e=mH(),n=_h();return $t.grammar=n,$t.write=e,$t.parse=t.parse,$t.parseParams=t.parseParams,$t.parseFmtpConfig=t.parseFmtpConfig,$t.parsePayloads=t.parsePayloads,$t.parseRemoteCandidates=t.parseRemoteCandidates,$t.parseImageAttributes=t.parseImageAttributes,$t.parseSimulcastStreamList=t.parseSimulcastStreamList,$t}var Un=gH();function xh(t,e,n){var r,i,a;e===void 0&&(e=50),n===void 0&&(n={});var o=(r=n.isImmediate)!=null&&r,s=(i=n.callback)!=null&&i,c=n.maxWait,u=Date.now(),l=[];function d(){if(c!==void 0){var h=Date.now()-u;if(h+e>=c)return c-h}return e}var f=function(){var h=[].slice.call(arguments),m=this;return new Promise(function(p,v){var b=o&&a===void 0;if(a!==void 0&&clearTimeout(a),a=setTimeout(function(){if(a=void 0,u=Date.now(),!o){var T=t.apply(m,h);s&&s(T),l.forEach(function(S){return(0,S.resolve)(T)}),l=[]}},d()),b){var k=t.apply(m,h);return s&&s(k),p(k)}l.push({resolve:p,reject:v})})};return f.cancel=function(h){a!==void 0&&clearTimeout(a),l.forEach(function(m){return(0,m.reject)(h)}),l=[]},f}const vH=.7,yH=20,si={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class Ey extends fn.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;super(),this.log=ae,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=xh(i=>x(this,void 0,void 0,function*(){this.emit(si.NegotiationStarted);try{yield this.createAndSendOffer()}catch(a){if(i)i(a);else throw a}}),yH),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=In((r=n.loggerName)!==null&&r!==void 0?r:Kt.PCTransport),this.loggerOptions=n,this.config=e,this._pc=this.createPC(),this.offerLock=new gt}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},e.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},e.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},e}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return x(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e,n){return x(this,void 0,void 0,function*(){var r;if(e.type==="answer"&&this.latestOfferId>0&&n>0&&n!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:n,latestOfferId:this.latestOfferId})),!1;let i;if(e.type==="offer"){let{stereoMids:a,nackMids:o}=bH(e);this.remoteStereoMids=a,this.remoteNackMids=o}else if(e.type==="answer"){const a=Un.parse((r=e.sdp)!==null&&r!==void 0?r:"");a.media.forEach(o=>{const s=Ph(o.mid);o.type==="audio"&&this.trackBitrates.some(c=>{if(!c.transceiver||s!=c.transceiver.mid)return!1;let u=0;if(o.rtp.some(d=>d.codec.toUpperCase()===c.codec.toUpperCase()?(u=d.payload,!0):!1),u===0)return!0;let l=!1;for(const d of o.fmtp)if(d.payload===u){d.config=d.config.split(";").filter(f=>!f.includes("maxaveragebitrate")).join(";"),c.maxbr>0&&(d.config+=";maxaveragebitrate=".concat(c.maxbr*1e3)),l=!0;break}return l||c.maxbr>0&&o.fmtp.push({payload:u,config:"maxaveragebitrate=".concat(c.maxbr*1e3)}),!0})}),i=Un.write(a)}return yield this.setMungedSDP(e,i,!0),this.pendingCandidates.forEach(a=>{this.pc.addIceCandidate(a)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(si.NegotiationComplete),e.sdp&&Un.parse(e.sdp).media.forEach(o=>{o.type==="video"&&this.emit(si.RTPVideoPayloadTypes,o.rtp)})),!0})}createAndSendOffer(e){return x(this,void 0,void 0,function*(){var n;const r=yield this.offerLock.lock();try{if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const s=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&s)yield this._pc.setRemoteDescription(s);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const i=this.latestOfferId+1;this.latestOfferId=i;const a=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:a.sdp},this.logContext));const o=Un.parse((n=a.sdp)!==null&&n!==void 0?n:"");if(o.media.forEach(s=>{Iy(s),s.type==="audio"?Ay(s,[],[]):s.type==="video"&&this.trackBitrates.some(c=>{if(!s.msid||!c.cid||!s.msid.includes(c.cid))return!1;let u=0;if(s.rtp.some(d=>d.codec.toUpperCase()===c.codec.toUpperCase()?(u=d.payload,!0):!1),u===0||(Qt(c.codec)&&!Ar()&&this.ensureVideoDDExtensionForSVC(s,o),c.codec!=="av1"))return!0;const l=Math.round(c.maxbr*vH);for(const d of s.fmtp)if(d.payload===u){d.config.includes("x-google-start-bitrate")||(d.config+=";x-google-start-bitrate=".concat(l));break}return!0})}),this.latestOfferId>i){this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:i}));return}yield this.setMungedSDP(a,Un.write(o)),this.onOffer(a,this.latestOfferId)}finally{r()}})}createAndSetAnswer(){return x(this,void 0,void 0,function*(){var e;const n=yield this.pc.createAnswer(),r=Un.parse((e=n.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{Iy(i),i.type==="audio"&&Ay(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,Un.write(r)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new Ge("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new Ge("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return x(this,void 0,void 0,function*(){var e;if(!this._pc)return;let n="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(s=>{switch(s.type){case"transport":n=s.selectedCandidatePairId;break;case"candidate-pair":n===""&&s.selected&&(n=s.id),r.set(s.id,s);break;case"remote-candidate":i.set(s.id,"".concat(s.address,":").concat(s.port));break}}),n==="")return;const o=(e=r.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(o!==void 0)return i.get(o)})}setMungedSDP(e,n,r){return x(this,void 0,void 0,function*(){if(n){const i=e.sdp;e.sdp=n;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(a){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:a,sdp:n})),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let a="unknown error";i instanceof Error?a=i.message:typeof i=="string"&&(a=i);const o={error:a,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(o.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:o})),new Md(a)}})}ensureVideoDDExtensionForSVC(e,n){var r,i;if(!((r=e.ext)===null||r===void 0?void 0:r.some(o=>o.uri===gy))){if(this.ddExtID===0){let o=0;n.media.forEach(s=>{var c;s.type==="video"&&((c=s.ext)===null||c===void 0||c.forEach(u=>{u.value>o&&(o=u.value)}))}),this.ddExtID=o+1}(i=e.ext)===null||i===void 0||i.push({value:this.ddExtID,uri:gy})}}}function Ay(t,e,n){const r=Ph(t.mid);let i=0;t.rtp.some(a=>a.codec==="opus"?(i=a.payload,!0):!1),i>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(r)&&!t.rtcpFb.some(a=>a.payload===i&&a.type==="nack")&&t.rtcpFb.push({payload:i,type:"nack"}),e.includes(r)&&t.fmtp.some(a=>a.payload===i?(a.config.includes("stereo=1")||(a.config+=";stereo=1"),!0):!1))}function bH(t){var e;const n=[],r=[],i=Un.parse((e=t.sdp)!==null&&e!==void 0?e:"");let a=0;return i.media.forEach(o=>{var s;const c=Ph(o.mid);o.type==="audio"&&(o.rtp.some(u=>u.codec==="opus"?(a=u.payload,!0):!1),!((s=o.rtcpFb)===null||s===void 0)&&s.some(u=>u.payload===a&&u.type==="nack")&&r.push(c),o.fmtp.some(u=>u.payload===a?(u.config.includes("sprop-stereo=1")&&n.push(c),!0):!1))}),{stereoMids:n,nackMids:r}}function Iy(t){if(t.connection){const e=t.connection.ip.indexOf(":")>=0;(t.connection.version===4&&e||t.connection.version===6&&!e)&&(t.connection.ip="0.0.0.0",t.connection.version=4)}}function Ph(t){return typeof t=="number"?t.toFixed(0):t}const Wd="vp8",SH={audioPreset:Dd.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:kh.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Wd,backupCodec:!0,preConnectBuffer:!1},sw={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},cw={deviceId:{ideal:"default"},resolution:io.h720.resolution},TH={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new aG,disconnectOnPageLeave:!0,webAudioMix:!1},Oh={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var Me;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(Me||(Me={}));class kH{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n,r){var i;this.peerConnectionTimeout=Oh.peerConnectionTimeout,this.log=ae,this.updateState=()=>{var a;const o=this.state,s=this.requiredTransports.map(c=>c.getConnectionState());s.every(c=>c==="connected")?this.state=Me.CONNECTED:s.some(c=>c==="failed")?this.state=Me.FAILED:s.some(c=>c==="connecting")?this.state=Me.CONNECTING:s.every(c=>c==="closed")?this.state=Me.CLOSED:s.some(c=>c==="closed")?this.state=Me.CLOSING:s.every(c=>c==="new")&&(this.state=Me.NEW),o!==this.state&&(this.log.debug("pc state change: from ".concat(Me[o]," to ").concat(Me[this.state]),this.logContext),(a=this.onStateChange)===null||a===void 0||a.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=In((i=r.loggerName)!==null&&i!==void 0?i:Kt.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n,this.publisher=new Ey(e,r),this.subscriber=new Ey(e,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=a=>{var o;(o=this.onIceCandidate)===null||o===void 0||o.call(this,a,zt.PUBLISHER)},this.subscriber.onIceCandidate=a=>{var o;(o=this.onIceCandidate)===null||o===void 0||o.call(this,a,zt.SUBSCRIBER)},this.subscriber.onDataChannel=a=>{var o;(o=this.onDataChannel)===null||o===void 0||o.call(this,a)},this.subscriber.onTrack=a=>{var o;(o=this.onTrack)===null||o===void 0||o.call(this,a)},this.publisher.onOffer=(a,o)=>{var s;(s=this.onPublisherOffer)===null||s===void 0||s.call(this,a,o)},this.state=Me.NEW,this.connectionLock=new gt,this.remoteOfferLock=new gt}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,n){return this.publisher.setRemoteDescription(e,n)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return x(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return x(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return x(this,void 0,void 0,function*(){n===zt.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e,n){return x(this,void 0,void 0,function*(){this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()}));const r=yield this.remoteOfferLock.lock();try{return(yield this.subscriber.setRemoteDescription(e,n))?yield this.subscriber.createAndSetAnswer():void 0}finally{r()}})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){return x(this,void 0,void 0,function*(){var r;const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(a=>this.ensureTransportConnected(a,e,n)))}finally{i()}})}negotiate(e){return x(this,void 0,void 0,function*(){return new Promise((n,r)=>x(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),a=()=>{clearTimeout(i),r("negotiation aborted")};e.signal.addEventListener("abort",a),this.publisher.once(si.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(si.NegotiationComplete,()=>{clearTimeout(i),n()})}),yield this.publisher.negotiate(o=>{clearTimeout(i),r(o)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===zt.PUBLISHER?this.publisher.getConnectedAddress():e===zt.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){return x(this,arguments,void 0,function(r,i){var a=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return function*(){if(r.getConnectionState()!=="connected")return new Promise((c,u)=>x(a,void 0,void 0,function*(){const l=()=>{this.log.warn("abort transport connection",this.logContext),nt.clearTimeout(d),u(new Te("room connection has been cancelled",pe.Cancelled))};i!=null&&i.signal.aborted&&l(),i==null||i.signal.addEventListener("abort",l);const d=nt.setTimeout(()=>{i==null||i.signal.removeEventListener("abort",l),u(new Te("could not establish pc connection",pe.InternalError))},o);for(;this.state!==Me.CONNECTED;)if(yield vt(50),i!=null&&i.signal.aborted){u(new Te("room connection has been cancelled",pe.Cancelled));return}nt.clearTimeout(d),i==null||i.signal.removeEventListener("abort",l),c()}))}()})}}class Le extends Error{constructor(e,n,r){super(n),this.code=e,this.message=Ry(n,Le.MAX_MESSAGE_BYTES),this.data=r?Ry(r,Le.MAX_DATA_BYTES):void 0}static fromProto(e){return new Le(e.code,e.message,e.data)}toProto(){return new nk({code:this.code,message:this.message,data:this.data})}static builtIn(e,n){return new Le(Le.ErrorCode[e],Le.ErrorMessage[e],n)}}Le.MAX_MESSAGE_BYTES=256;Le.MAX_DATA_BYTES=15360;Le.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};Le.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const uw=15360;function Eh(t){return new TextEncoder().encode(t).length}function Ry(t,e){if(Eh(t)<=e)return t;let n=0,r=t.length;const i=new TextEncoder;for(;n<r;){const a=Math.floor((n+r+1)/2);i.encode(t.slice(0,a)).length<=e?n=a:r=a-1}return t.slice(0,n)}const Ah=2e3;function Qc(t,e){if(!e)return 0;let n,r;return"bytesReceived"in t?(n=t.bytesReceived,r=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,r=e.bytesSent),n===void 0||r===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-r)*8*1e3/(t.timestamp-e.timestamp)}const Ih=typeof MediaRecorder!="undefined";class wH{constructor(){throw new Error("MediaRecorder is not available in this environment")}}const CH=Ih?MediaRecorder:wH;class _H extends CH{constructor(e,n){if(!Ih)throw new Error("MediaRecorder is not available in this environment");super(new MediaStream([e.mediaStreamTrack]),n);let r,i;const a=()=>i===void 0,o=()=>{this.removeEventListener("dataavailable",r),this.removeEventListener("stop",o),this.removeEventListener("error",s),i==null||i.close(),i=void 0},s=c=>{i==null||i.error(c),this.removeEventListener("dataavailable",r),this.removeEventListener("stop",o),this.removeEventListener("error",s),i=void 0};this.byteStream=new ReadableStream({start:c=>{i=c,r=u=>x(this,void 0,void 0,function*(){let l;if(u.data.arrayBuffer){const d=yield u.data.arrayBuffer();l=new Uint8Array(d)}else if(u.data.byteArray)l=u.data.byteArray;else throw new Error("no data available!");a()||c.enqueue(l)}),this.addEventListener("dataavailable",r)},cancel:()=>{o()}}),this.addEventListener("stop",o),this.addEventListener("error",s)}}function xH(){return Ih}const PH=1e3,OH=1e4;class lw extends B{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=arguments.length>4?arguments[4]:void 0;super(e,n,a),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=xh(()=>x(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>x(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(G.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new gt,this.pauseUpstreamLock=new gt,this.trackChangeLock=new gt,this.trackChangeLock.lock().then(o=>x(this,void 0,void 0,function*(){try{yield this.setMediaStreamTrack(e,!0)}finally{o()}})),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==B.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,n){return x(this,void 0,void 0,function*(){var r;if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(a=>{oi(this._mediaStreamTrack,a)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let i;if(this.processor&&e){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(Yr(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),i=this.processor.processedTrack}this.sender&&((r=this.sender.transport)===null||r===void 0?void 0:r.state)!=="closed"&&(yield this.sender.replaceTrack(i!=null?i:e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(a=>{Yr(i!=null?i:e,a)}))})}waitForDimensions(){return x(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:PH;return function*(){var r;if(e.kind===B.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((r=Ct())===null||r===void 0?void 0:r.os)==="iOS"&&(yield vt(10));const i=Date.now();for(;Date.now()-i<n;){const a=e.dimensions;if(a)return a;yield vt(50)}throw new Sn("unable to get track dimensions after timeout")}()})}setDeviceId(e){return x(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Jn(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),Jn(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return x(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){if(e.source===B.Source.ScreenShare)return;const{deviceId:r,groupId:i}=e._mediaStreamTrack.getSettings(),a=e.kind===B.Kind.Audio?"audioinput":"videoinput";return n?Qe.getInstance().normalizeDeviceId(a,r,i):r}()})}mute(){return x(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return x(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,n){return x(this,void 0,void 0,function*(){const r=yield this.trackChangeLock.lock();try{if(!this.sender)throw new Sn("unable to replace an unpublished track");let i,a;return typeof n=="boolean"?i=n:n!==void 0&&(i=n.userProvidedTrack,a=n.stopProcessor),this.providedByUser=i!=null?i:!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),a&&this.processor&&(yield this.internalStopProcessor()),this}finally{r()}})}restart(e){return x(this,void 0,void 0,function*(){this.manuallyStopped=!1;const n=yield this.trackChangeLock.lock();try{e||(e=this._constraints);const{deviceId:r,facingMode:i}=e,a=oG(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const o={audio:!1,video:!1};this.kind===B.Kind.Video?o.video=r||i?{deviceId:r,facingMode:i}:!0:o.audio=r?Object.assign({deviceId:r},a):!0,this.attachedElements.forEach(u=>{oi(this.mediaStreamTrack,u)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const c=(yield navigator.mediaDevices.getUserMedia(o)).getTracks()[0];return this.kind===B.Kind.Video&&(yield c.applyConstraints(a)),c.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(c),this._constraints=e,this.emit(G.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{n()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?G.Muted:G.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return x(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),Zk()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return x(this,void 0,void 0,function*(){var e;const n=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(G.UpstreamPaused,this);const r=Ct();if((r==null?void 0:r.name)==="Safari"&&ln(r.version,"12.0")<0)throw new Th("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{n()}})}resumeUpstream(){return x(this,void 0,void 0,function*(){var e;const n=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(G.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{n()}})}getRTCStatsReport(){return x(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return x(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var a;const o=yield r.trackChangeLock.lock();try{r.log.debug("setting up processor",r.logContext);const s=document.createElement(r.kind),c={kind:r.kind,track:r._mediaStreamTrack,element:s,audioContext:r.audioContext};if(yield n.init(c),r.log.debug("processor initialized",r.logContext),r.processor&&(yield r.internalStopProcessor()),r.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(Yr(r._mediaStreamTrack,s),s.muted=!0,s.play().catch(u=>{u instanceof DOMException&&u.name==="AbortError"?(r.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},r.logContext),{error:u})),setTimeout(()=>{s.play().catch(l=>{r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{err:l}))})},100)):r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{error:u}))}),r.processor=n,r.processorElement=s,r.processor.processedTrack){for(const u of r.attachedElements)u!==r.processorElement&&i&&(oi(r._mediaStreamTrack,u),Yr(r.processor.processedTrack,u));yield(a=r.sender)===null||a===void 0?void 0:a.replaceTrack(r.processor.processedTrack)}r.emit(G.TrackProcessorUpdate,r.processor)}finally{o()}}()})}getProcessor(){return this.processor}stopProcessor(){return x(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const r=yield e.trackChangeLock.lock();try{yield e.internalStopProcessor(n)}finally{r()}}()})}internalStopProcessor(){return x(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var r,i;e.processor&&(e.log.debug("stopping processor",e.logContext),(r=e.processor.processedTrack)===null||r===void 0||r.stop(),yield e.processor.destroy(),e.processor=void 0,n||((i=e.processorElement)===null||i===void 0||i.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(G.TrackProcessorUpdate))}()})}startPreConnectBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;if(!xH()){this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext);return}if(this.localTrackRecorder){this.log.warn("preconnect buffer already started");return}else{let n="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(n)||(n="video/mp4"),this.localTrackRecorder=new _H(this,{mimeType:n})}this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},OH)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.byteStream}getPreConnectBufferMimeType(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.mimeType}}class cc extends lw{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;super(e,B.Kind.Audio,n,r,a),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>x(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(s){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:s}));return}o&&this.prevStats&&(this._currentBitrate=Qc(o,this.prevStats)),this.prevStats=o}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(G.AudioTrackFeatureUpdate,this,Je.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(G.AudioTrackFeatureUpdate,this,Je.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=i,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return x(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===B.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return x(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Jn(this._constraints.deviceId);return this.source===B.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return x(this,void 0,void 0,function*(){let n;if(e){const r=wh({audio:e});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return x(this,void 0,void 0,function*(){const r=yield n.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){mt()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},Ah)))}setProcessor(e){return x(this,void 0,void 0,function*(){var n;const r=yield this.trackChangeLock.lock();try{if(!un()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.internalStopProcessor());const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(G.TrackProcessorUpdate,this.processor)}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return x(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return x(this,void 0,void 0,function*(){const e=yield rw(this);return e&&(this.isMuted||this.log.debug("silence detected on local audio track",this.logContext),this.emit(G.AudioSilenceDetected)),e})}}function EH(t,e,n){switch(t.kind){case"audio":return new cc(t,e,!1,void 0,n);case"video":return new uc(t,e,!1,n);default:throw new Sn("unsupported track type: ".concat(t.kind))}}const AH=Object.values(io),IH=Object.values(Nd),RH=Object.values(kh),MH=[io.h180,io.h360],DH=[Nd.h180,Nd.h360],NH=t=>[{scaleResolutionDownBy:2,fps:t.encoding.maxFramerate}].map(n=>{var r,i;return new be(Math.floor(t.width/n.scaleResolutionDownBy),Math.floor(t.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((r=t.encoding.maxFramerate)!==null&&r!==void 0?r:30)/((i=n.fps)!==null&&i!==void 0?i:30))))),n.fps,t.encoding.priority)}),zd=["q","h","f"];function Gd(t,e,n,r){var i,a;let o=r==null?void 0:r.videoEncoding;t&&(o=r==null?void 0:r.screenShareEncoding);const s=r==null?void 0:r.simulcast,c=r==null?void 0:r.scalabilityMode,u=r==null?void 0:r.videoCodec;if(!o&&!s&&!c||!e||!n)return[{}];o||(o=jH(t,e,n,u),ae.debug("using video encoding",o));const l=o.maxFramerate,d=new be(e,n,o.maxBitrate,o.maxFramerate,o.priority);if(c&&Qt(u)){const m=new dw(c),p=[];if(m.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));const v=Ct();if(ao()||un()||(v==null?void 0:v.name)==="Chrome"&&ln(v==null?void 0:v.version,"113")<0){const b=m.suffix=="h"?2:3,k=UG(v);for(let T=0;T<m.spatial;T+=1)p.push({rid:zd[2-T],maxBitrate:o.maxBitrate/Math.pow(b,T),maxFramerate:d.encoding.maxFramerate,scaleResolutionDownBy:k?Math.pow(2,T):void 0});p[0].scalabilityMode=c}else p.push({maxBitrate:o.maxBitrate,maxFramerate:d.encoding.maxFramerate,scalabilityMode:c});return d.encoding.priority&&(p[0].priority=d.encoding.priority,p[0].networkPriority=d.encoding.priority),ae.debug("using svc encoding",{encodings:p}),p}if(!s)return[o];let f=[];t?f=(i=Dy(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:My(t,d):f=(a=Dy(r==null?void 0:r.videoSimulcastLayers))!==null&&a!==void 0?a:My(t,d);let h;if(f.length>0){const m=f[0];f.length>1&&([,h]=f);const p=Math.max(e,n);if(p>=960&&h)return Ku(e,n,[m,h,d],l);if(p>=480)return Ku(e,n,[m,d],l)}return Ku(e,n,[d])}function LH(t,e,n){var r,i,a,o;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&ae.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const s=t.mediaStreamTrack.getSettings(),c=(r=s.width)!==null&&r!==void 0?r:(i=t.dimensions)===null||i===void 0?void 0:i.width,u=(a=s.height)!==null&&a!==void 0?a:(o=t.dimensions)===null||o===void 0?void 0:o.height;return t.source===B.Source.ScreenShare&&n.simulcast&&(n.simulcast=!1),Gd(t.source===B.Source.ScreenShare,c,u,n)}function jH(t,e,n,r){const i=$H(t,e,n);let{encoding:a}=i[0];const o=Math.max(e,n);for(let s=0;s<i.length;s+=1){const c=i[s];if(a=c.encoding,c.width>=o)break}if(r)switch(r){case"av1":case"h265":a=Object.assign({},a),a.maxBitrate=a.maxBitrate*.7;break;case"vp9":a=Object.assign({},a),a.maxBitrate=a.maxBitrate*.85;break}return a}function $H(t,e,n){if(t)return RH;const r=e>n?e/n:n/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?AH:IH}function My(t,e){if(t)return NH(e);const{width:n,height:r}=e,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?MH:DH}function Ku(t,e,n,r){const i=[];if(n.forEach((a,o)=>{if(o>=zd.length)return;const s=Math.min(t,e),u={rid:zd[o],scaleResolutionDownBy:Math.max(1,s/Math.min(a.width,a.height)),maxBitrate:a.encoding.maxBitrate},l=r&&a.encoding.maxFramerate?Math.min(r,a.encoding.maxFramerate):a.encoding.maxFramerate;l&&(u.maxFramerate=l);const d=Er()||o===0;a.encoding.priority&&d&&(u.priority=a.encoding.priority,u.networkPriority=a.encoding.priority),i.push(u)}),un()&&tw()==="ios"){let a;i.forEach(s=>{a?s.maxFramerate&&s.maxFramerate>a&&(a=s.maxFramerate):a=s.maxFramerate});let o=!0;i.forEach(s=>{var c;s.maxFramerate!=a&&(o&&(o=!1,ae.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),ae.info('Setting framerate of encoding "'.concat((c=s.rid)!==null&&c!==void 0?c:"",'" to ').concat(a)),s.maxFramerate=a)})}return i}function Dy(t){if(t)return t.sort((e,n)=>{const{encoding:r}=e,{encoding:i}=n;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class dw{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function BH(t){return t.source===B.Source.ScreenShare||t.constraints.height&&Jn(t.constraints.height)>=1080?"maintain-resolution":"balanced"}const UH=5e3;class uc extends lw{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,B.Kind.Video,n,r,i),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>x(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let a;try{a=yield this.getSenderStats()}catch(c){this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:c}));return}const o=new Map(a.map(c=>[c.rid,c])),s=a.some(c=>c.qualityLimitationReason==="cpu");if(s!==this.isCpuConstrained&&(this.isCpuConstrained=s,this.isCpuConstrained&&this.emit(G.CpuConstrained)),this.prevStats){let c=0;o.forEach((u,l)=>{var d;const f=(d=this.prevStats)===null||d===void 0?void 0:d.get(l);c+=Qc(u,f)}),this._currentBitrate=c}this.prevStats=o}),this.senderLock=new gt}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!mt())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},Ah))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return x(this,void 0,void 0,function*(){var n,r,i,a,o;yield e.pauseUpstream.call(this);try{for(var s=!0,c=bn(this.simulcastCodecs.values()),u;u=yield c.next(),n=u.done,!n;s=!0)a=u.value,s=!1,yield(o=a.sender)===null||o===void 0?void 0:o.replaceTrack(null)}catch(l){r={error:l}}finally{try{!s&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return x(this,void 0,void 0,function*(){var n,r,i,a,o;yield e.resumeUpstream.call(this);try{for(var s=!0,c=bn(this.simulcastCodecs.values()),u;u=yield c.next(),n=u.done,!n;s=!0){a=u.value,s=!1;const l=a;yield(o=l.sender)===null||o===void 0?void 0:o.replaceTrack(l.mediaStreamTrack)}}catch(l){r={error:l}}finally{try{!s&&!n&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return x(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===B.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return x(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.source===B.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){return x(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(i=>{var a;if(i.type==="outbound-rtp"){const o={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,framesPerSecond:i.framesPerSecond,framesSent:i.framesSent,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationDurations:i.qualityLimitationDurations,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges,rid:(a=i.rid)!==null&&a!==void 0?a:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,targetBitrate:i.targetBitrate,timestamp:i.timestamp},s=r.get(i.remoteId);s&&(o.jitter=s.jitter,o.packetsLost=s.packetsLost,o.roundTripTime=s.roundTripTime),n.push(o)}}),n.sort((i,a)=>{var o,s;return((o=a.frameWidth)!==null&&o!==void 0?o:0)-((s=i.frameWidth)!==null&&s!==void 0?s:0)}),n})}setPublishingQuality(e){const n=[];for(let r=wt.LOW;r<=wt.HIGH;r+=1)n.push(new yh({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(Qt(this.codec),n)}restartTrack(e){return x(this,void 0,void 0,function*(){var n,r,i,a,o;let s;if(e){const d=wh({video:e});typeof d.video!="boolean"&&(s=d.video)}yield this.restart(s),this.isCpuConstrained=!1;try{for(var c=!0,u=bn(this.simulcastCodecs.values()),l;l=yield u.next(),n=l.done,!n;c=!0){a=l.value,c=!1;const d=a;d.sender&&((o=d.sender.transport)===null||o===void 0?void 0:o.state)!=="closed"&&(d.mediaStreamTrack=this.mediaStreamTrack.clone(),yield d.sender.replaceTrack(d.mediaStreamTrack))}}catch(d){r={error:d}}finally{try{!c&&!n&&(i=u.return)&&(yield i.call(u))}finally{if(r)throw r.error}}})}setProcessor(e){const n=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return x(this,arguments,void 0,function(r){var i=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var o,s,c,u,l,d;if(yield n.setProcessor.call(i,r,a),!((l=i.processor)===null||l===void 0)&&l.processedTrack)try{for(var f=!0,h=bn(i.simulcastCodecs.values()),m;m=yield h.next(),o=m.done,!o;f=!0)u=m.value,f=!1,yield(d=u.sender)===null||d===void 0?void 0:d.replaceTrack(i.processor.processedTrack)}catch(p){s={error:p}}finally{try{!f&&!o&&(c=h.return)&&(yield c.call(h))}finally{if(s)throw s.error}}}()})}setDegradationPreference(e){return x(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const n=this.sender.getParameters();n.degradationPreference=e,this.sender.setParameters(n)}catch(n){this.log.warn("failed to set degradationPreference",Object.assign({error:n},this.logContext))}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,n){const r=this.simulcastCodecs.get(e);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},UH))}setPublishingCodecs(e){return x(this,void 0,void 0,function*(){var n,r,i,a,o,s,c;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(Qt(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const u=[];try{for(n=!0,r=bn(e);i=yield r.next(),a=i.done,!a;n=!0){c=i.value,n=!1;const l=c;if(!this.codec||this.codec===l.codec)yield this.setPublishingLayers(Qt(l.codec),l.qualities);else{const d=this.simulcastCodecs.get(l.codec);if(this.log.debug("try setPublishingCodec for ".concat(l.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:d})),!d||!d.sender){for(const f of l.qualities)if(f.enabled){u.push(l.codec);break}}else d.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(l.codec),this.logContext),yield Ny(d.sender,d.encodings,l.qualities,this.senderLock,Qt(l.codec),this.log,this.logContext))}}}catch(l){o={error:l}}finally{try{!n&&!a&&(s=r.return)&&(yield s.call(r))}finally{if(o)throw o.error}}return u})}setPublishingLayers(e,n){return x(this,void 0,void 0,function*(){if(this.optimizeForPerformance){this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:n}));return}this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:n})),!(!this.sender||!this.encodings)&&(yield Ny(this.sender,this.encodings,n,this.senderLock,e,this.log,this.logContext))})}prioritizePerformance(){return x(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const n=this.sender.getParameters();n.encodings=n.encodings.map((r,i)=>{var a;return Object.assign(Object.assign({},r),{active:i===0,scaleResolutionDownBy:Math.max(1,Math.ceil(((a=this.mediaStreamTrack.getSettings().height)!==null&&a!==void 0?a:360)/360)),scalabilityMode:i===0&&Qt(this.codec)?"L1T3":void 0,maxFramerate:i===0?15:0,maxBitrate:i===0?r.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:n.encodings})),this.encodings=n.encodings,yield this.sender.setParameters(n)}catch(n){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:n})),this.optimizeForPerformance=!1}finally{e()}})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return x(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),Zk()&&this.isInBackground&&this.source===B.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function Ny(t,e,n,r,i,a,o){return x(this,void 0,void 0,function*(){const s=yield r.lock();a.debug("setPublishingLayersForSender",Object.assign(Object.assign({},o),{sender:t,qualities:n,senderEncodings:e}));try{const c=t.getParameters(),{encodings:u}=c;if(!u)return;if(u.length!==e.length){a.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},o),{encodings:u,senderEncodings:e}));return}let l=!1;!1&&u[0].scalabilityMode||(i&&n.some(h=>h.enabled)&&n.forEach(h=>h.enabled=!0),u.forEach((f,h)=>{var m;let p=(m=f.rid)!==null&&m!==void 0?m:"";p===""&&(p="q");const v=fw(p),b=n.find(k=>k.quality===v);b&&f.active!==b.enabled&&(l=!0,f.active=b.enabled,a.debug("setting layer ".concat(b.quality," to ").concat(f.active?"enabled":"disabled"),o),Er()&&(b.enabled?(f.scaleResolutionDownBy=e[h].scaleResolutionDownBy,f.maxBitrate=e[h].maxBitrate,f.maxFrameRate=e[h].maxFrameRate):(f.scaleResolutionDownBy=4,f.maxBitrate=10,f.maxFrameRate=2)))})),l&&(c.encodings=u,a.debug("setting encodings",Object.assign(Object.assign({},o),{encodings:c.encodings})),yield t.setParameters(c))}finally{s()}})}function fw(t){switch(t){case"f":return wt.HIGH;case"h":return wt.MEDIUM;case"q":return wt.LOW;default:return wt.HIGH}}function Ly(t,e,n,r){if(!n)return[new Xn({quality:wt.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(r){const i=n[0].scalabilityMode,a=new dw(i),o=[],s=a.suffix=="h"?1.5:2,c=a.suffix=="h"?2:3;for(let u=0;u<a.spatial;u+=1)o.push(new Xn({quality:Math.min(wt.HIGH,a.spatial-1)-u,width:Math.ceil(t/Math.pow(s,u)),height:Math.ceil(e/Math.pow(s,u)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(c,u)):0,ssrc:0}));return o}return n.map(i=>{var a,o,s;const c=(a=i.scaleResolutionDownBy)!==null&&a!==void 0?a:1;let u=fw((o=i.rid)!==null&&o!==void 0?o:"");return new Xn({quality:u,width:Math.ceil(t/c),height:Math.ceil(e/c),bitrate:(s=i.maxBitrate)!==null&&s!==void 0?s:0,ssrc:0})})}const jy="_lossy",$y="_reliable",FH=2*1e3,Xu="leave-reconnect",qH=3e4;var Et;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(Et||(Et={}));class VH extends fn.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var n;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=Oh.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=Et.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=ae,this.reliableDataSequence=1,this.reliableMessageBuffer=new Cy,this.reliableReceivedState=new hH(qH),this.handleDataChannel=r=>x(this,[r],void 0,function(i){var a=this;let{channel:o}=i;return function*(){if(o){if(o.label===$y)a.reliableDCSub=o;else if(o.label===jy)a.lossyDCSub=o;else return;a.log.debug("on data channel ".concat(o.id,", ").concat(o.label),a.logContext),o.onmessage=a.handleDataMessage}}()}),this.handleDataMessage=r=>x(this,void 0,void 0,function*(){var i,a,o,s,c;const u=yield this.dataProcessLock.lock();try{let l;if(r.data instanceof ArrayBuffer)l=r.data;else if(r.data instanceof Blob)l=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const d=st.fromBinary(new Uint8Array(l));if(d.sequence>0&&d.participantSid!==""){const f=this.reliableReceivedState.get(d.participantSid);if(f&&d.sequence<=f)return;this.reliableReceivedState.set(d.participantSid,d.sequence)}if(((i=d.value)===null||i===void 0?void 0:i.case)==="speaker")this.emit(X.ActiveSpeakersUpdate,d.value.value.speakers);else if(((a=d.value)===null||a===void 0?void 0:a.case)==="encryptedPacket"){if(!this.e2eeManager){this.log.error("Received encrypted packet but E2EE not set up",this.logContext);return}const f=yield(o=this.e2eeManager)===null||o===void 0?void 0:o.handleEncryptedData(d.value.value.encryptedValue,d.value.value.iv,d.participantIdentity,d.value.value.keyIndex),h=ZT.fromBinary(f.payload),m=new st({value:h.value});((s=m.value)===null||s===void 0?void 0:s.case)==="user"&&By(m,m.value.value),this.emit(X.DataPacketReceived,m,d.value.value.encryptionType)}else((c=d.value)===null||c===void 0?void 0:c.case)==="user"&&By(d,d.value.value),this.emit(X.DataPacketReceived,d,He.NONE)}finally{u()}}),this.handleDataError=r=>{const a=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:o}=r.error;this.log.error("DataChannel error on ".concat(a,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:o}))}else this.log.error("Unknown DataChannel error on ".concat(a),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const a=r.currentTarget.maxRetransmits===0?se.LOSSY:se.RELIABLE;this.updateAndEmitDCBufferStatus(a)},this.handleDisconnect=(r,i)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const a=c=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(c,"ms. giving up"),this.logContext),this.emit(X.Disconnected),this.close()},o=Date.now()-this.reconnectStart;let s=this.getNextRetryDelay({elapsedMs:o,retryCount:this.reconnectAttempts});if(s===null){a(o);return}r===Xu&&(s=0),this.log.debug("reconnecting in ".concat(s,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=nt.setTimeout(()=>this.attemptReconnect(i).finally(()=>this.reconnectTimeout=void 0),s)},this.waitForRestarted=()=>new Promise((r,i)=>{this.pcState===Et.Connected&&r();const a=()=>{this.off(X.Disconnected,o),r()},o=()=>{this.off(X.Restarted,a),i()};this.once(X.Restarted,a),this.once(X.Disconnected,o)}),this.updateAndEmitDCBufferStatus=r=>{const i=this.isBufferStatusLow(r);typeof i!="undefined"&&i!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,i),this.emit(X.DCBufferStatusChanged,i,r))},this.isBufferStatusLow=r=>{const i=this.dataChannelForKind(r);if(i)return r===se.RELIABLE&&this.reliableMessageBuffer.alignBufferedAmount(i.bufferedAmount),i.bufferedAmount<=i.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===Pe.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(Vr.RR_SIGNAL_DISCONNECTED))},this.log=In((n=e.loggerName)!==null&&n!==void 0?n:Kt.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new Ch(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.closingLock=new gt,this.dataProcessLock=new gt,this.dcBufferStatus=new Map([[se.LOSSY,!0],[se.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(X.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(X.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(X.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(X.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(X.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(X.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(X.StreamStateChanged,r),this.client.onRequestResponse=r=>this.emit(X.SignalRequestResponse,r)}get logContext(){var e,n,r,i,a,o;return{room:(n=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||n===void 0?void 0:n.name,roomID:(i=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.sid,participant:(o=(a=this.latestJoinResponse)===null||a===void 0?void 0:a.participant)===null||o===void 0?void 0:o.identity,pID:this.participantSid}}join(e,n,r,i){return x(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const a=yield this.client.join(e,n,r,i);return this._isClosed=!1,this.latestJoinResponse=a,this.subscriberPrimary=a.subscriberPrimary,this.pcManager||(yield this.configure(a)),(!this.subscriberPrimary||a.fastPublish)&&this.negotiate().catch(o=>{ae.error(o,this.logContext)}),this.registerOnLineListener(),this.clientConfiguration=a.clientConfiguration,this.emit(X.SignalConnected,a),a}catch(a){if(a instanceof Te&&a.reason===pe.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,r,i);throw a}})}close(){return x(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(X.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return x(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new Cy,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupClient(){return x(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Sn("a track with the same ID has already been published");return new Promise((n,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new Te("publication of local track timed out, no response from server",pe.Timeout))},1e4);this.pendingTrackResolvers[e.cid]={resolve:a=>{clearTimeout(i),n(a)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return x(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return x(this,void 0,void 0,function*(){var n,r;if(this.pcManager&&this.pcManager.currentState!==Me.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const i=this.makeRTCConfiguration(e);this.pcManager=new kH(i,e.subscriberPrimary,this.loggerOptions),this.emit(X.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(a,o)=>{this.client.sendIceCandidate(a,o)},this.pcManager.onPublisherOffer=(a,o)=>{this.client.sendOffer(a,o)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(a,o,s)=>x(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(a),this.logContext),["closed","disconnected","failed"].includes(o)&&(this.publisherConnectionPromise=void 0),a===Me.CONNECTED){const l=this.pcState===Et.New;this.pcState=Et.Connected,l&&this.emit(X.Connected,e)}else a===Me.FAILED&&(this.pcState===Et.Connected||this.pcState===Et.Reconnecting)&&(this.pcState=Et.Disconnected,this.handleDisconnect("peerconnection failed",s==="failed"?Vr.RR_SUBSCRIBER_FAILED:Vr.RR_PUBLISHER_FAILED));const c=this.client.isDisconnected||this.client.currentState===Pe.RECONNECTING,u=[Me.FAILED,Me.CLOSING,Me.CLOSED].includes(a);c&&u&&!this._isClosed&&this.emit(X.Offline)}),this.pcManager.onTrack=a=>{this.emit(X.MediaTrackAdded,a.track,a.streams[0],a.receiver)},WH((r=e.serverInfo)===null||r===void 0?void 0:r.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(e,n)=>x(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e,n))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:n})),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=(e,n)=>x(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=n,!this.pcManager)return;const r=yield this.pcManager.createSubscriberAnswerFromOffer(e,n);r&&this.client.sendAnswer(r,n)}),this.client.onLocalTrackPublished=e=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(n=e.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(X.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(X.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(X.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(X.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var n;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(X.RoomMoved,e)},this.client.onClose=()=>{this.handleDisconnect("signal",Vr.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions(e.regions)),e.action){case ii.DISCONNECT:this.emit(X.Disconnected,e==null?void 0:e.reason),this.close();break;case ii.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(Xu);break;case ii.RESUME:this.handleDisconnect(Xu)}}}makeRTCConfiguration(e){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(a=>{const o={urls:a.urls};a.username&&(o.username=a.username),a.credential&&(o.credential=a.credential),i.push(o)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===no.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(jy,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel($y,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,n,r){return x(this,void 0,void 0,function*(){if(Ld())return yield this.createTransceiverRTCRtpSender(e,n,r);if(jd())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new Ge("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,r,i){return x(this,void 0,void 0,function*(){if(Ld())return this.createSimulcastTransceiverSender(e,n,r,i);if(jd())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new Ge("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,r){return x(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ge("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream),ir(e)&&(e.codec=n.videoCodec);const a={direction:"sendonly",streams:i};return r&&(a.sendEncodings=r),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,a)).sender})}createSimulcastTransceiverSender(e,n,r,i){return x(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ge("publisher is closed");const a={direction:"sendonly"};i&&(a.sendEncodings=i);const o=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,a);if(r.videoCodec)return e.setSimulcastTrackSender(r.videoCodec,o.sender),o.sender})}createRTCRtpSender(e){return x(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ge("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return x(this,void 0,void 0,function*(){var n,r,i;if(!this._isClosed){if(this.attemptingReconnect){ae.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===no.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:Me.NEW)===Me.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(a){this.reconnectAttempts+=1;let o=!0;a instanceof Ge?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:a})),o=!1):a instanceof Wr||(this.fullReconnectOnNext=!0),o?this.handleDisconnect("reconnect",Vr.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(X.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(e){return x(this,void 0,void 0,function*(){var n,r,i;try{if(!this.url||!this.token)throw new Ge("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(X.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let a;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new Wr;a=yield this.join(e!=null?e:this.url,this.token,this.signalOpts)}catch(o){throw o instanceof Te&&o.reason===pe.NotAllowed?new Ge("could not reconnect, token might be expired"):new Wr}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(X.SignalRestarted,a),yield this.waitForPCReconnected(),this.client.currentState!==Pe.CONNECTED)throw new Wr("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(X.Restarted)}catch(a){const o=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(o){yield this.restartConnection(o);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),a}})}resumeConnection(e){return x(this,void 0,void 0,function*(){var n;if(!this.url||!this.token)throw new Ge("could not reconnect, url or token not saved");if(!this.pcManager)throw new Ge("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(X.Resuming);let r;try{this.setupSignalClientCallbacks(),r=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(i){let a="";throw i instanceof Error&&(a=i.message,this.log.error(i.message,Object.assign(Object.assign({},this.logContext),{error:i}))),i instanceof Te&&i.reason===pe.NotAllowed?new Ge("could not reconnect, token might be expired"):i instanceof Te&&i.reason===pe.LeaveRequest?i:new Wr(a)}if(this.emit(X.SignalResumed),r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=r.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Pe.CONNECTED)throw new Wr("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),r!=null&&r.lastMessageSeq&&this.resendReliableMessagesForResume(r.lastMessageSeq),this.emit(X.Resumed)})}waitForPCInitialConnection(e,n){return x(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ge("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return x(this,void 0,void 0,function*(){this.pcState=Et.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield vt(FH),!this.pcManager)throw new Ge("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Et.Connected}catch(e){throw this.pcState=Et.Disconnected,new Te("could not establish PC connection, ".concat(e.message),pe.InternalError)}})}publishRpcResponse(e,n,r,i){return x(this,void 0,void 0,function*(){const a=new st({destinationIdentities:[e],kind:se.RELIABLE,value:{case:"rpcResponse",value:new ph({requestId:n,value:i?{case:"error",value:i.toProto()}:{case:"payload",value:r!=null?r:""}})}});yield this.sendDataPacket(a,se.RELIABLE)})}publishRpcAck(e,n){return x(this,void 0,void 0,function*(){const r=new st({destinationIdentities:[e],kind:se.RELIABLE,value:{case:"rpcAck",value:new hh({requestId:n})}});yield this.sendDataPacket(r,se.RELIABLE)})}sendDataPacket(e,n){return x(this,void 0,void 0,function*(){if(yield this.ensurePublisherConnected(n),this.e2eeManager&&this.e2eeManager.isDataChannelEncryptionEnabled){const a=TG(e);if(a){const o=yield this.e2eeManager.encryptData(a.toBinary());e.value={case:"encryptedPacket",value:new QT({encryptedValue:o.payload,iv:o.iv,keyIndex:o.keyIndex})}}}n===se.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const r=e.toBinary(),i=this.dataChannelForKind(n);if(i){if(n===se.RELIABLE&&this.reliableMessageBuffer.push({data:r,sequence:e.sequence}),this.attemptingReconnect)return;i.send(r)}this.updateAndEmitDCBufferStatus(n)})}resendReliableMessagesForResume(e){return x(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(se.RELIABLE);const n=this.dataChannelForKind(se.RELIABLE);n&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach(r=>{n.send(r.data)})),this.updateAndEmitDCBufferStatus(se.RELIABLE)})}waitForBufferStatusLow(e){return new Promise((n,r)=>x(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))n();else{const i=()=>r("Engine closed");for(this.once(X.Closing,i);!this.dcBufferStatus.get(e);)yield vt(10);this.off(X.Closing,i),n()}}))}ensureDataTransportConnected(e){return x(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return function*(){var a;if(!r.pcManager)throw new Ge("PC manager is closed");const o=i?r.pcManager.subscriber:r.pcManager.publisher,s=i?"Subscriber":"Publisher";if(!o)throw new Te("".concat(s," connection not set"),pe.InternalError);let c=!1;!i&&!r.dataChannelForKind(n,i)&&(r.createDataChannels(),c=!0),!c&&!i&&!r.pcManager.publisher.isICEConnected&&r.pcManager.publisher.getICEConnectionState()!=="checking"&&(c=!0),c&&r.negotiate().catch(d=>{ae.error(d,r.logContext)});const u=r.dataChannelForKind(n,i);if((u==null?void 0:u.readyState)==="open")return;const l=new Date().getTime()+r.peerConnectionTimeout;for(;new Date().getTime()<l;){if(o.isICEConnected&&((a=r.dataChannelForKind(n,i))===null||a===void 0?void 0:a.readyState)==="open")return;yield vt(50)}throw new Te("could not establish ".concat(s," connection, state: ").concat(o.getICEConnectionState()),pe.InternalError)}()})}ensurePublisherConnected(e){return x(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==Me.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return x(this,void 0,void 0,function*(){return new Promise((e,n)=>x(this,void 0,void 0,function*(){if(!this.pcManager){n(new Md("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const r=new AbortController,i=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(X.Closing,i),this.pcManager.publisher.once(si.RTPVideoPayloadTypes,a=>{const o=new Map;a.forEach(s=>{const c=s.codec.toLowerCase();zG(c)&&o.set(s.payload,c)}),this.emit(X.RTPVideoMapUpdate,o)});try{yield this.pcManager.negotiate(r),e()}catch(a){a instanceof Md&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",Vr.RR_UNKNOWN),n(a)}finally{this.off(X.Closing,i)}}))})}dataChannelForKind(e,n){if(n){if(e===se.LOSSY)return this.lossyDCSub;if(e===se.RELIABLE)return this.reliableDCSub}else{if(e===se.LOSSY)return this.lossyDC;if(e===se.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var r,i;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const a=this.pcManager.subscriber.getLocalDescription(),o=this.pcManager.subscriber.getRemoteDescription(),s=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,c=new Array,u=new Array;e.forEach(l=>{l.isDesired!==s&&c.push(l.trackSid),l.isEnabled||u.push(l.trackSid)}),this.client.sendSyncState(new vk({answer:a?sc({sdp:a.sdp,type:a.type}):void 0,offer:o?sc({sdp:o.sdp,type:o.type}):void 0,subscription:new Xc({trackSids:c,subscribe:!s,participantTracks:[]}),publishTracks:eH(n),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:u,datachannelReceiveStates:this.reliableReceivedState.map((l,d)=>new yk({publisherSid:d,lastSeq:l}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new bk({label:r.label,id:r.id,target:i}))};return n(this.dataChannelForKind(se.LOSSY),zt.PUBLISHER),n(this.dataChannelForKind(se.RELIABLE),zt.PUBLISHER),n(this.dataChannelForKind(se.LOSSY,!0),zt.SUBSCRIBER),n(this.dataChannelForKind(se.RELIABLE,!0),zt.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&nt.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){mt()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){mt()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class Wr extends Error{}function WH(t){return t!==void 0&&t>13}function By(t,e){const n=t.participantIdentity?t.participantIdentity:e.participantIdentity;t.participantIdentity=n,e.participantIdentity=n;const r=t.destinationIdentities.length!==0?t.destinationIdentities:e.destinationIdentities;t.destinationIdentities=r,e.destinationIdentities=r}class Hd{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return Bd(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return x(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(n.length>0){const r=n[0];return this.attemptedRegions.push(r),ae.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return x(this,void 0,void 0,function*(){const n=yield fetch("".concat(zH(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const r=yield n.json();return this.lastUpdateAt=Date.now(),r}else throw new Te("Could not fetch region settings: ".concat(n.statusText),n.status===401?pe.NotAllowed:pe.InternalError,n.status)})}setServerReportedRegions(e){this.regionSettings=e,this.lastUpdateAt=Date.now()}}function zH(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}class hw{get info(){return this._info}validateBytesReceived(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(typeof this.totalByteSize!="number"||this.totalByteSize===0)){if(e&&this.bytesReceived<this.totalByteSize)throw new At("Not enough chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, only received ").concat(this.bytesReceived," bytes"),ot.Incomplete);if(this.bytesReceived>this.totalByteSize)throw new At("Extra chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, received ").concat(this.bytesReceived," bytes"),ot.LengthExceeded)}}constructor(e,n,r,i){this.reader=n,this.totalByteSize=r,this._info=e,this.bytesReceived=0,this.outOfBandFailureRejectingFuture=i}}class GH extends hw{handleChunkReceived(e){var n;this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const r=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(n=this.onProgress)===null||n===void 0||n.call(this,r)}[Symbol.asyncIterator](){const e=this.reader.getReader();let n=new Mt,r=null,i=null;if(this.signal){const o=this.signal;i=()=>{var s;(s=n.reject)===null||s===void 0||s.call(n,o.reason)},o.addEventListener("abort",i),r=o}const a=()=>{e.releaseLock(),r&&i&&r.removeEventListener("abort",i),this.signal=void 0};return{next:()=>x(this,void 0,void 0,function*(){var o,s;try{const{done:c,value:u}=yield Promise.race([e.read(),n.promise,(s=(o=this.outOfBandFailureRejectingFuture)===null||o===void 0?void 0:o.promise)!==null&&s!==void 0?s:new Promise(()=>{})]);return c?(this.validateBytesReceived(!0),{done:!0,value:void 0}):(this.handleChunkReceived(u),{done:!1,value:u.content})}catch(c){throw a(),c}}),return(){return x(this,void 0,void 0,function*(){return a(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return x(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){var r,i,a,o;let s=new Set;const c=n.signal?e.withAbortSignal(n.signal):e;try{for(var u=!0,l=bn(c),d;d=yield l.next(),r=d.done,!r;u=!0){o=d.value,u=!1;const f=o;s.add(f)}}catch(f){i={error:f}}finally{try{!u&&!r&&(a=l.return)&&(yield a.call(l))}finally{if(i)throw i.error}}return Array.from(s)}()})}}class HH extends hw{constructor(e,n,r,i){super(e,n,r,i),this.receivedChunks=new Map}handleChunkReceived(e){var n;const r=Zo(e.chunkIndex),i=this.receivedChunks.get(r);if(i&&i.version>e.version)return;this.receivedChunks.set(r,e),this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const a=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(n=this.onProgress)===null||n===void 0||n.call(this,a)}[Symbol.asyncIterator](){const e=this.reader.getReader(),n=new TextDecoder("utf-8",{fatal:!0});let r=new Mt,i=null,a=null;if(this.signal){const s=this.signal;a=()=>{var c;(c=r.reject)===null||c===void 0||c.call(r,s.reason)},s.addEventListener("abort",a),i=s}const o=()=>{e.releaseLock(),i&&a&&i.removeEventListener("abort",a),this.signal=void 0};return{next:()=>x(this,void 0,void 0,function*(){var s,c;try{const{done:u,value:l}=yield Promise.race([e.read(),r.promise,(c=(s=this.outOfBandFailureRejectingFuture)===null||s===void 0?void 0:s.promise)!==null&&c!==void 0?c:new Promise(()=>{})]);if(u)return this.validateBytesReceived(!0),{done:!0,value:void 0};{this.handleChunkReceived(l);let d;try{d=n.decode(l.content)}catch(f){throw new At("Cannot decode datastream chunk ".concat(l.chunkIndex," as text: ").concat(f),ot.DecodeFailed)}return{done:!1,value:d}}}catch(u){throw o(),u}}),return(){return x(this,void 0,void 0,function*(){return o(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return x(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){var r,i,a,o;let s="";const c=n.signal?e.withAbortSignal(n.signal):e;try{for(var u=!0,l=bn(c),d;d=yield l.next(),r=d.done,!r;u=!0)o=d.value,u=!1,s+=o}catch(f){i={error:f}}finally{try{!u&&!r&&(a=l.return)&&(yield a.call(l))}finally{if(i)throw i.error}}return s}()})}}class KH{constructor(){this.log=ae,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map}registerTextStreamHandler(e,n){if(this.textStreamHandlers.has(e))throw new At('A text stream handler for topic "'.concat(e,'" has already been set.'),ot.HandlerAlreadyRegistered);this.textStreamHandlers.set(e,n)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,n){if(this.byteStreamHandlers.has(e))throw new At('A byte stream handler for topic "'.concat(e,'" has already been set.'),ot.HandlerAlreadyRegistered);this.byteStreamHandlers.set(e,n)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}clearHandlersAndControllers(){this.byteStreamControllers.clear(),this.textStreamControllers.clear(),this.byteStreamHandlers.clear(),this.textStreamHandlers.clear()}validateParticipantHasNoActiveDataStreams(e){var n,r,i,a;const o=Array.from(this.textStreamControllers.entries()).filter(c=>c[1].sendingParticipantIdentity===e),s=Array.from(this.byteStreamControllers.entries()).filter(c=>c[1].sendingParticipantIdentity===e);if(o.length>0||s.length>0){const c=new At("Participant ".concat(e," unexpectedly disconnected in the middle of sending data"),ot.AbnormalEnd);for(const[u,l]of s)(r=(n=l.outOfBandFailureRejectingFuture).reject)===null||r===void 0||r.call(n,c),this.byteStreamControllers.delete(u);for(const[u,l]of o)(a=(i=l.outOfBandFailureRejectingFuture).reject)===null||a===void 0||a.call(i,c),this.textStreamControllers.delete(u)}}handleDataStreamPacket(e,n){return x(this,void 0,void 0,function*(){switch(e.value.case){case"streamHeader":return this.handleStreamHeader(e.value.value,e.participantIdentity,n);case"streamChunk":return this.handleStreamChunk(e.value.value,n);case"streamTrailer":return this.handleStreamTrailer(e.value.value,n);default:throw new Error('DataPacket of value "'.concat(e.value.case,'" is not data stream related!'))}})}handleStreamHeader(e,n,r){return x(this,void 0,void 0,function*(){var i;if(e.contentHeader.case==="byteHeader"){const a=this.byteStreamHandlers.get(e.topic);if(!a){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let o;const s=new Mt;s.promise.catch(l=>{this.log.error(l)});const c={id:e.streamId,name:(i=e.contentHeader.value.name)!==null&&i!==void 0?i:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Zo(e.timestamp),attributes:e.attributes,encryptionType:r},u=new ReadableStream({start:l=>{if(o=l,this.textStreamControllers.has(e.streamId))throw new At("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),ot.AlreadyOpened);this.byteStreamControllers.set(e.streamId,{info:c,controller:o,startTime:Date.now(),sendingParticipantIdentity:n,outOfBandFailureRejectingFuture:s})}});a(new GH(c,u,Zo(e.totalLength),s),{identity:n})}else if(e.contentHeader.case==="textHeader"){const a=this.textStreamHandlers.get(e.topic);if(!a){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let o;const s=new Mt;s.promise.catch(l=>{this.log.error(l)});const c={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes,encryptionType:r},u=new ReadableStream({start:l=>{if(o=l,this.textStreamControllers.has(e.streamId))throw new At("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),ot.AlreadyOpened);this.textStreamControllers.set(e.streamId,{info:c,controller:o,startTime:Date.now(),sendingParticipantIdentity:n,outOfBandFailureRejectingFuture:s})}});a(new HH(c,u,Zo(e.totalLength),s),{identity:n})}})}handleStreamChunk(e,n){const r=this.byteStreamControllers.get(e.streamId);r&&(r.info.encryptionType!==n?(r.controller.error(new At("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(n,", got ").concat(r.info.encryptionType),ot.EncryptionTypeMismatch)),this.byteStreamControllers.delete(e.streamId)):e.content.length>0&&r.controller.enqueue(e));const i=this.textStreamControllers.get(e.streamId);i&&(i.info.encryptionType!==n?(i.controller.error(new At("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(n,", got ").concat(i.info.encryptionType),ot.EncryptionTypeMismatch)),this.textStreamControllers.delete(e.streamId)):e.content.length>0&&i.controller.enqueue(e))}handleStreamTrailer(e,n){const r=this.textStreamControllers.get(e.streamId);r&&(r.info.encryptionType!==n?r.controller.error(new At("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(n,", got ").concat(r.info.encryptionType),ot.EncryptionTypeMismatch)):(r.info.attributes=Object.assign(Object.assign({},r.info.attributes),e.attributes),r.controller.close(),this.textStreamControllers.delete(e.streamId)));const i=this.byteStreamControllers.get(e.streamId);i&&(i.info.encryptionType!==n?i.controller.error(new At("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(n,", got ").concat(i.info.encryptionType),ot.EncryptionTypeMismatch)):(i.info.attributes=Object.assign(Object.assign({},i.info.attributes),e.attributes),i.controller.close()),this.byteStreamControllers.delete(e.streamId))}}class pw{constructor(e,n,r){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=r,this.info=n}write(e){return this.defaultWriter.write(e)}close(){return x(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class XH extends pw{}class YH extends pw{}const Uy=15e3;class JH{constructor(e,n){this.engine=e,this.log=n}setupEngine(e){this.engine=e}sendText(e,n){return x(this,void 0,void 0,function*(){var r;const i=crypto.randomUUID(),o=new TextEncoder().encode(e).byteLength,s=(r=n==null?void 0:n.attachments)===null||r===void 0?void 0:r.map(()=>crypto.randomUUID()),c=new Array(s?s.length+1:1).fill(0),u=(d,f)=>{var h;c[f]=d;const m=c.reduce((p,v)=>p+v,0);(h=n==null?void 0:n.onProgress)===null||h===void 0||h.call(n,m)},l=yield this.streamText({streamId:i,totalSize:o,destinationIdentities:n==null?void 0:n.destinationIdentities,topic:n==null?void 0:n.topic,attachedStreamIds:s,attributes:n==null?void 0:n.attributes});return yield l.write(e),u(1,0),yield l.close(),n!=null&&n.attachments&&s&&(yield Promise.all(n.attachments.map((d,f)=>x(this,void 0,void 0,function*(){return this._sendFile(s[f],d,{topic:n.topic,mimeType:d.type,onProgress:h=>{u(h,f+1)}})})))),l.info})}streamText(e){return x(this,void 0,void 0,function*(){var n,r,i;const a=(n=e==null?void 0:e.streamId)!==null&&n!==void 0?n:crypto.randomUUID(),o={id:a,mimeType:"text/plain",timestamp:Date.now(),topic:(r=e==null?void 0:e.topic)!==null&&r!==void 0?r:"",size:e==null?void 0:e.totalSize,attributes:e==null?void 0:e.attributes,encryptionType:!((i=this.engine.e2eeManager)===null||i===void 0)&&i.isDataChannelEncryptionEnabled?He.GCM:He.NONE},s=new nc({streamId:a,mimeType:o.mimeType,topic:o.topic,timestamp:fr(o.timestamp),totalLength:fr(e==null?void 0:e.totalSize),attributes:o.attributes,contentHeader:{case:"textHeader",value:new uk({version:e==null?void 0:e.version,attachedStreamIds:e==null?void 0:e.attachedStreamIds,replyToStreamId:e==null?void 0:e.replyToStreamId,operationType:(e==null?void 0:e.type)==="update"?kd.UPDATE:kd.CREATE})}}),c=e==null?void 0:e.destinationIdentities,u=new st({destinationIdentities:c,value:{case:"streamHeader",value:s}});yield this.engine.sendDataPacket(u,se.RELIABLE);let l=0;const d=this.engine,f=new WritableStream({write(p){return x(this,void 0,void 0,function*(){for(const v of JG(p,Uy)){yield d.waitForBufferStatusLow(se.RELIABLE);const b=new rc({content:v,streamId:a,chunkIndex:fr(l)}),k=new st({destinationIdentities:c,value:{case:"streamChunk",value:b}});yield d.sendDataPacket(k,se.RELIABLE),l+=1}})},close(){return x(this,void 0,void 0,function*(){const p=new ic({streamId:a}),v=new st({destinationIdentities:c,value:{case:"streamTrailer",value:p}});yield d.sendDataPacket(v,se.RELIABLE)})},abort(p){console.log("Sink error:",p)}});let h=()=>x(this,void 0,void 0,function*(){yield m.close()});d.once(X.Closing,h);const m=new XH(f,o,()=>this.engine.off(X.Closing,h));return m})}sendFile(e,n){return x(this,void 0,void 0,function*(){const r=crypto.randomUUID();return yield this._sendFile(r,e,n),{id:r}})}_sendFile(e,n,r){return x(this,void 0,void 0,function*(){var i;const a=yield this.streamBytes({streamId:e,totalSize:n.size,name:n.name,mimeType:(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:n.type,topic:r==null?void 0:r.topic,destinationIdentities:r==null?void 0:r.destinationIdentities}),o=n.stream().getReader();for(;;){const{done:s,value:c}=yield o.read();if(s)break;yield a.write(c)}return yield a.close(),a.info})}streamBytes(e){return x(this,void 0,void 0,function*(){var n,r,i,a,o,s;const c=(n=e==null?void 0:e.streamId)!==null&&n!==void 0?n:crypto.randomUUID(),u=e==null?void 0:e.destinationIdentities,l={id:c,mimeType:(r=e==null?void 0:e.mimeType)!==null&&r!==void 0?r:"application/octet-stream",topic:(i=e==null?void 0:e.topic)!==null&&i!==void 0?i:"",timestamp:Date.now(),attributes:e==null?void 0:e.attributes,size:e==null?void 0:e.totalSize,name:(a=e==null?void 0:e.name)!==null&&a!==void 0?a:"unknown",encryptionType:!((o=this.engine.e2eeManager)===null||o===void 0)&&o.isDataChannelEncryptionEnabled?He.GCM:He.NONE},d=new nc({totalLength:fr((s=l.size)!==null&&s!==void 0?s:0),mimeType:l.mimeType,streamId:c,topic:l.topic,timestamp:fr(Date.now()),attributes:l.attributes,contentHeader:{case:"byteHeader",value:new lk({name:l.name})}}),f=new st({destinationIdentities:u,value:{case:"streamHeader",value:d}});yield this.engine.sendDataPacket(f,se.RELIABLE);let h=0;const m=new gt,p=this.engine,v=this.log,b=new WritableStream({write(T){return x(this,void 0,void 0,function*(){const S=yield m.lock();let g=0;try{for(;g<T.byteLength;){const y=T.slice(g,g+Uy);yield p.waitForBufferStatusLow(se.RELIABLE);const w=new st({destinationIdentities:u,value:{case:"streamChunk",value:new rc({content:y,streamId:c,chunkIndex:fr(h)})}});yield p.sendDataPacket(w,se.RELIABLE),h+=1,g+=y.byteLength}}finally{S()}})},close(){return x(this,void 0,void 0,function*(){const T=new ic({streamId:c}),S=new st({destinationIdentities:u,value:{case:"streamTrailer",value:T}});yield p.sendDataPacket(S,se.RELIABLE)})},abort(T){v.error("Sink error:",T)}});return new YH(b,l)})}}class mw extends B{constructor(e,n,r,i,a){super(e,r,a),this.sid=n,this.receiver=i}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?G.Muted:G.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(G.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return x(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),Ah)),tH()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var n;this.timeSyncHandle=requestAnimationFrame(()=>e());const r=(n=this.receiver)===null||n===void 0?void 0:n.getSynchronizationSources()[0];if(r){const{timestamp:i,rtpTimestamp:a}=r;a&&this.rtpTimestamp!==a&&(this.emit(G.TimeSyncUpdate,{timestamp:i,rtpTimestamp:a}),this.rtpTimestamp=a)}};e()}}class QH extends mw{constructor(e,n,r,i,a,o){super(e,n,B.Kind.Audio,r,o),this.monitorReceiver=()=>x(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const s=yield this.getReceiverStats();s&&this.prevStats&&this.receiver&&(this._currentBitrate=Qc(s,this.prevStats)),this.prevStats=s}),this.audioContext=i,this.webAudioPluginNodes=[],a&&(this.sinkId=a.deviceId)}setVolume(e){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):r.volume=e;un()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(un())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return x(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if($d(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&$d(e)&&e.setSinkId(this.sinkId).catch(r=>{this.log.error("Failed to set sink id on remote audio track",r,this.logContext)}),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(G.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(G.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return x(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",streamId:r.id,timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const Yu=100;class ZH extends mw{constructor(e,n,r,i,a){super(e,n,B.Kind.Video,r,a),this.elementInfos=[],this.monitorReceiver=()=>x(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const o=yield this.getReceiverStats();o&&this.prevStats&&this.receiver&&(this._currentBitrate=Qc(o,this.prevStats)),this.prevStats=o}),this.debouncedHandleResize=xh(()=>{this.updateDimensions()},Yu),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}setStreamState(e){super.setStreamState(e),console.log("setStreamState",e),e===B.StreamState.Active&&this.updateVisibility()}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?oi(this._mediaStreamTrack,n):Yr(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new eK(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(r=>r===e);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return x(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,r="",i=new Map;return e.forEach(a=>{a.type==="inbound-rtp"?(r=a.codecId,n={type:"video",streamId:a.id,framesDecoded:a.framesDecoded,framesDropped:a.framesDropped,framesReceived:a.framesReceived,packetsReceived:a.packetsReceived,packetsLost:a.packetsLost,frameWidth:a.frameWidth,frameHeight:a.frameHeight,pliCount:a.pliCount,firCount:a.firCount,nackCount:a.nackCount,jitter:a.jitter,timestamp:a.timestamp,bytesReceived:a.bytesReceived,decoderImplementation:a.decoderImplementation}):a.type==="codec"&&i.set(a.id,a)}),n&&r!==""&&i.get(r)&&(n.mimeType=i.get(r).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(r=>r.element===e);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return x(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(e){var n,r;const i=this.elementInfos.reduce((c,u)=>Math.max(c,u.visibilityChangedAt||0),0),a=!((r=(n=this.adaptiveStreamSettings)===null||n===void 0?void 0:n.pauseVideoInBackground)!==null&&r!==void 0)||r?this.isInBackground:!1,o=this.elementInfos.some(c=>c.pictureInPicture),s=this.elementInfos.some(c=>c.visible)&&!a||o;if(!(this.lastVisible===s&&!e)){if(!s&&Date.now()-i<Yu){nt.setTimeout(()=>{this.updateVisibility()},Yu);return}this.lastVisible=s,this.emit(G.VisibilityChanged,s,this)}}updateDimensions(){var e,n;let r=0,i=0;const a=this.getPixelDensity();for(const o of this.elementInfos){const s=o.width()*a,c=o.height()*a;s+c>r+i&&(r=s,i=c)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===i||(this.lastDimensions={width:r,height:i},this.emit(G.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?vy():n||(vy()>2?2:1)}}class eK{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=r=>{var i;const{target:a,isIntersecting:o}=r;a===this.element&&(this.isIntersecting=o,this.isPiP=la(this.element),this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r,i,a;(i=(r=window.documentPictureInPicture)===null||r===void 0?void 0:r.window)===null||i===void 0||i.addEventListener("pagehide",this.onLeavePiP),this.isPiP=la(this.element),(a=this.handleVisibilityChanged)===null||a===void 0||a.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=la(this.element),(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=n!=null?n:Kd(e),this.isPiP=mt()&&la(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,n,r;this.isIntersecting=Kd(this.element),this.isPiP=la(this.element),this.element.handleResize=()=>{var i;(i=this.handleResize)===null||i===void 0||i.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,by().observe(this.element),yy().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(r=(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window)===null||r===void 0||r.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,n,r,i,a;(e=by())===null||e===void 0||e.unobserve(this.element),(n=yy())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(r=window.documentPictureInPicture)===null||r===void 0||r.removeEventListener("enter",this.onEnterPiP),(a=(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window)===null||a===void 0||a.removeEventListener("pagehide",this.onLeavePiP)}}function la(t){var e,n;return document.pictureInPictureElement===t?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?Kd(t,(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window):!1}function Kd(t,e){const n=e||window;let r=t.offsetTop,i=t.offsetLeft;const a=t.offsetWidth,o=t.offsetHeight,{hidden:s}=t,{display:c}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,r+=t.offsetTop,i+=t.offsetLeft;return r<n.pageYOffset+n.innerHeight&&i<n.pageXOffset+n.innerWidth&&r+o>n.pageYOffset&&i+a>n.pageXOffset&&!s&&c!=="none"}class gn extends fn.EventEmitter{constructor(e,n,r,i){var a;super(),this.metadataMuted=!1,this.encryption=He.NONE,this.log=ae,this.handleMuted=()=>{this.emit(G.Muted)},this.handleUnmuted=()=>{this.emit(G.Unmuted)},this.log=In((a=i==null?void 0:i.loggerName)!==null&&a!==void 0?a:Kt.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=r,this.source=B.Source.Unknown}setTrack(e){this.track&&(this.track.off(G.Muted,this.handleMuted),this.track.off(G.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(G.Muted,this.handleMuted),e.on(G.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),ue(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==He.NONE}get audioTrack(){if(on(this.track))return this.track}get videoTrack(){if(ir(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=B.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===B.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(gn||(gn={}));class Xd extends gn{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(G.Ended)},this.handleCpuConstrained=()=>{this.track&&ir(this.track)&&this.emit(G.CpuConstrained,this.track)},this.updateInfo(n),this.setTrack(r)}setTrack(e){this.track&&(this.track.off(G.Ended,this.handleTrackEnded),this.track.off(G.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on(G.Ended,this.handleTrackEnded),e.on(G.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return x(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return x(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return x(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return x(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(on(this.track)){const n=this.track.getSourceTrackSettings(),r=new Set;return n.autoGainControl&&r.add(Je.TF_AUTO_GAIN_CONTROL),n.echoCancellation&&r.add(Je.TF_ECHO_CANCELLATION),n.noiseSuppression&&r.add(Je.TF_NOISE_SUPPRESSION),n.channelCount&&n.channelCount>1&&r.add(Je.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||r.add(Je.TF_NO_DTX),this.track.enhancedNoiseCancellation&&r.add(Je.TF_ENHANCED_NOISE_CANCELLATION),Array.from(r.values())}else return[]}}function Zc(t,e){return x(this,void 0,void 0,function*(){t!=null||(t={});let n=!1;const{audioProcessor:r,videoProcessor:i,optionsWithoutProcessor:a}=aw(t);let o=a.audio,s=a.video;if(r&&typeof a.audio=="object"&&(a.audio.processor=r),i&&typeof a.video=="object"&&(a.video.processor=i),t.audio&&typeof a.audio=="object"&&typeof a.audio.deviceId=="string"){const d=a.audio.deviceId;a.audio.deviceId={exact:d},n=!0,o=Object.assign(Object.assign({},a.audio),{deviceId:{ideal:d}})}if(a.video&&typeof a.video=="object"&&typeof a.video.deviceId=="string"){const d=a.video.deviceId;a.video.deviceId={exact:d},n=!0,s=Object.assign(Object.assign({},a.video),{deviceId:{ideal:d}})}(a.audio===!0||typeof a.audio=="object"&&!a.audio.deviceId)&&(a.audio={deviceId:"default"}),a.video===!0?a.video={deviceId:"default"}:typeof a.video=="object"&&!a.video.deviceId&&(a.video.deviceId="default");const c=nw(a,sw,cw),u=wh(c),l=navigator.mediaDevices.getUserMedia(u);a.audio&&(Qe.userMediaPromiseMap.set("audioinput",l),l.catch(()=>Qe.userMediaPromiseMap.delete("audioinput"))),a.video&&(Qe.userMediaPromiseMap.set("videoinput",l),l.catch(()=>Qe.userMediaPromiseMap.delete("videoinput")));try{const d=yield l;return yield Promise.all(d.getTracks().map(f=>x(this,void 0,void 0,function*(){const h=f.kind==="audio";let m=h?c.audio:c.video;(typeof m=="boolean"||!m)&&(m={});let p;const v=h?u.audio:u.video;typeof v!="boolean"&&(p=v);const b=f.getSettings().deviceId;p!=null&&p.deviceId&&Jn(p.deviceId)!==b?p.deviceId=b:p||(p={deviceId:b});const k=EH(f,p,e);return k.kind===B.Kind.Video?k.source=B.Source.Camera:k.kind===B.Kind.Audio&&(k.source=B.Source.Microphone),k.mediaStream=d,on(k)&&r?yield k.setProcessor(r):ir(k)&&i&&(yield k.setProcessor(i)),k})))}catch(d){if(!n)throw d;return Zc(Object.assign(Object.assign({},t),{audio:o,video:s}),e)}})}function tK(t){return x(this,void 0,void 0,function*(){return(yield Zc({audio:!1,video:t!=null?t:!0}))[0]})}function nK(t){return x(this,void 0,void 0,function*(){return(yield Zc({audio:t!=null?t:!0,video:!1}))[0]})}var Vn;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(Vn||(Vn={}));function rK(t){switch(t){case fa.EXCELLENT:return Vn.Excellent;case fa.GOOD:return Vn.Good;case fa.POOR:return Vn.Poor;case fa.LOST:return Vn.Lost;default:return Vn.Unknown}}class gw extends fn.EventEmitter{get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===ro.AGENT}get isActive(){var e;return((e=this.participantInfo)===null||e===void 0?void 0:e.state)===ri.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,n,r,i,a,o){let s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:ro.STANDARD;var c;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Vn.Unknown,this.log=ae,this.log=In((c=o==null?void 0:o.loggerName)!==null&&c!==void 0?c:Kt.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=r,this.metadata=i,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=s,this._attributes=a!=null?a:{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,n]of this.trackPublications)if(n.source===e)return n}getTrackPublicationByName(e){for(const[,n]of this.trackPublications)if(n.trackName===e)return n}waitUntilActive(){return this.isActive?Promise.resolve():this.activeFuture?this.activeFuture.promise:(this.activeFuture=new Mt,this.once(Y.Active,()=>{var e,n;(n=(e=this.activeFuture)===null||e===void 0?void 0:e.resolve)===null||n===void 0||n.call(e),this.activeFuture=void 0}),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrackPublication(B.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrackPublication(B.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(B.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){var n;return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===ri.ACTIVE&&((n=this.participantInfo)===null||n===void 0?void 0:n.state)!==ri.ACTIVE&&this.emit(Y.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,!0)}_setMetadata(e){const n=this.metadata!==e,r=this.metadata;this.metadata=e,n&&this.emit(Y.ParticipantMetadataChanged,r)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(Y.ParticipantNameChanged,e)}_setAttributes(e){const n=nH(this.attributes,e);this._attributes=e,Object.keys(n).length>0&&this.emit(Y.AttributesChanged,n)}setPermissions(e){var n,r,i,a,o,s;const c=this.permissions,u=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((a=this.permissions)===null||a===void 0?void 0:a.hidden)||e.recorder!==((o=this.permissions)===null||o===void 0?void 0:o.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((l,d)=>{var f;return l!==((f=this.permissions)===null||f===void 0?void 0:f.canPublishSources[d])})||e.canSubscribeMetrics!==((s=this.permissions)===null||s===void 0?void 0:s.canSubscribeMetrics);return this.permissions=e,u&&this.emit(Y.ParticipantPermissionsChanged,c),u}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(Y.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=rK(e),n!==this._connectionQuality&&this.emit(Y.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,n;this.activeFuture&&((n=(e=this.activeFuture).reject)===null||n===void 0||n.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(n=>on(n.track)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(G.Muted,()=>{this.emit(Y.TrackMuted,e)}),e.on(G.Unmuted,()=>{this.emit(Y.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case B.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case B.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function iK(t){var e,n,r;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new mk({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=t.allowAll)!==null&&r!==void 0?r:!1,trackSids:t.allowedTrackSids||[]})}class aK extends gw{constructor(e,n,r,i,a,o){super(e,n,void 0,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=He.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Mt)},this.handleReconnected=()=>{var s,c;(c=(s=this.reconnectFuture)===null||s===void 0?void 0:s.resolve)===null||c===void 0||c.call(s),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var s,c,u,l,d,f;this.reconnectFuture&&(this.reconnectFuture.promise.catch(h=>this.log.warn(h.message,this.logContext)),(c=(s=this.reconnectFuture)===null||s===void 0?void 0:s.reject)===null||c===void 0||c.call(s,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0),this.signalConnectedFuture&&((l=(u=this.signalConnectedFuture).reject)===null||l===void 0||l.call(u,"Got disconnected without signal connected"),this.signalConnectedFuture=void 0),(f=(d=this.activeAgentFuture)===null||d===void 0?void 0:d.reject)===null||f===void 0||f.call(d,"Got disconnected without active agent present"),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=s=>{var c,u;s.participant&&this.updateInfo(s.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new Mt),(u=(c=this.signalConnectedFuture).resolve)===null||u===void 0||u.call(c)},this.handleSignalRequestResponse=s=>{const{requestId:c,reason:u,message:l}=s,d=this.pendingSignalRequests.get(c);d&&(u!==bh.OK&&d.reject(new hy(l,u)),this.pendingSignalRequests.delete(c))},this.handleDataPacket=s=>{switch(s.value.case){case"rpcResponse":let c=s.value.value,u=null,l=null;c.value.case==="payload"?u=c.value.value:c.value.case==="error"&&(l=Le.fromProto(c.value.value)),this.handleIncomingRpcResponse(c.requestId,u,l);break;case"rpcAck":let d=s.value.value;this.handleIncomingRpcAck(d.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(s=>iK(s)))},this.onTrackUnmuted=s=>{this.onTrackMuted(s,s.isUpstreamPaused)},this.onTrackMuted=(s,c)=>{if(c===void 0&&(c=!0),!s.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),ue(s)));return}this.engine.updateMuteStatus(s.sid,c)},this.onTrackUpstreamPaused=s=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),ue(s))),this.onTrackMuted(s,!0)},this.onTrackUpstreamResumed=s=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),ue(s))),this.onTrackMuted(s,s.isMuted)},this.onTrackFeatureUpdate=s=>{const c=this.audioTrackPublications.get(s.sid);if(!c){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(s.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(c.trackSid,c.getTrackFeatures())},this.onTrackCpuConstrained=(s,c)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),ue(c))),this.emit(Y.LocalTrackCpuConstrained,s,c)},this.handleSubscribedQualityUpdate=s=>x(this,void 0,void 0,function*(){var c,u,l,d,f;if(!(!((f=this.roomOptions)===null||f===void 0)&&f.dynacast))return;const h=this.videoTrackPublications.get(s.trackSid);if(!h){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:s.trackSid}));return}if(!h.videoTrack)return;const m=yield h.videoTrack.setPublishingCodecs(s.subscribedCodecs);try{for(var p=!0,v=bn(m),b;b=yield v.next(),c=b.done,!c;p=!0){d=b.value,p=!1;const k=d;MG(k)&&(this.log.debug("publish ".concat(k," for ").concat(h.videoTrack.sid),Object.assign(Object.assign({},this.logContext),ue(h))),yield this.publishAdditionalCodecForTrack(h.videoTrack,k,h.options))}}catch(k){u={error:k}}finally{try{!p&&!c&&(l=v.return)&&(yield l.call(v))}finally{if(u)throw u.error}}}),this.handleLocalTrackUnpublished=s=>{const c=this.trackPublications.get(s.trackSid);if(!c){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:s.trackSid}));return}this.unpublishTrack(c.track)},this.handleTrackEnded=s=>x(this,void 0,void 0,function*(){if(s.source===B.Source.ScreenShare||s.source===B.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),ue(s))),this.unpublishTrack(s);else if(s.isUserProvided)yield s.mute();else if(pn(s)||$n(s))try{if(mt())try{const c=yield navigator==null?void 0:navigator.permissions.query({name:s.source===B.Source.Camera?"camera":"microphone"});if(c&&c.state==="denied")throw this.log.warn("user has revoked access to ".concat(s.source),Object.assign(Object.assign({},this.logContext),ue(s))),c.onchange=()=>{c.state!=="denied"&&(s.isMuted||s.restartTrack(),c.onchange=null)},new Error("GetUserMedia Permission denied")}catch(c){}s.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),ue(s))),pn(s)?yield s.restartTrack({deviceId:"default"}):yield s.restartTrack())}catch(c){this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),ue(s))),yield s.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=a,this.roomOutgoingDataStreamManager=o}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==He.NONE}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setupEngine(e){var n;this.engine=e,this.engine.on(X.RemoteMute,(r,i)=>{const a=this.trackPublications.get(r);!a||!a.track||(i?a.mute():a.unmute())}),!((n=this.signalConnectedFuture)===null||n===void 0)&&n.isResolved&&(this.signalConnectedFuture=void 0),this.engine.on(X.Connected,this.handleReconnected).on(X.SignalConnected,this.handleSignalConnected).on(X.SignalRestarted,this.handleReconnected).on(X.SignalResumed,this.handleReconnected).on(X.Restarting,this.handleReconnecting).on(X.Resuming,this.handleReconnecting).on(X.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(X.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(X.Closing,this.handleClosing).on(X.SignalRequestResponse,this.handleSignalRequestResponse).on(X.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return x(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return x(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return x(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return x(this,arguments,void 0,function(n){var r=this;let{metadata:i,name:a,attributes:o}=n;return function*(){return new Promise((s,c)=>x(r,void 0,void 0,function*(){var u,l;try{let d=!1;const f=yield this.engine.client.sendUpdateLocalMetadata((u=i!=null?i:this.metadata)!==null&&u!==void 0?u:"",(l=a!=null?a:this.name)!==null&&l!==void 0?l:"",o),h=performance.now();for(this.pendingSignalRequests.set(f,{resolve:s,reject:m=>{c(m),d=!0},values:{name:a,metadata:i,attributes:o}});performance.now()-h<5e3&&!d;){if((!a||this.name===a)&&(!i||this.metadata===i)&&(!o||Object.entries(o).every(m=>{let[p,v]=m;return this.attributes[p]===v||v===""&&!this.attributes[p]}))){this.pendingSignalRequests.delete(f),s();return}yield vt(50)}c(new hy("Request to update local metadata timed out","TimeoutError"))}catch(d){d instanceof Error&&c(d)}}))}()})}setCameraEnabled(e,n,r){return this.setTrackEnabled(B.Source.Camera,e,n,r)}setMicrophoneEnabled(e,n,r){return this.setTrackEnabled(B.Source.Microphone,e,n,r)}setScreenShareEnabled(e,n,r){return this.setTrackEnabled(B.Source.ScreenShare,e,n,r)}setE2EEEnabled(e){return x(this,void 0,void 0,function*(){this.encryptionType=e?He.GCM:He.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,r,i){return x(this,void 0,void 0,function*(){var a,o;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:n})),this.republishPromise&&(yield this.republishPromise);let s=this.getTrackPublication(e);if(n)if(s)yield s.unmute();else{let c;if(this.pendingPublishing.has(e)){const u=yield this.waitForPendingPublicationOfSource(e);return u||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield u==null?void 0:u.unmute(),u}this.pendingPublishing.add(e);try{switch(e){case B.Source.Camera:c=yield this.createTracks({video:(a=r)!==null&&a!==void 0?a:!0});break;case B.Source.Microphone:c=yield this.createTracks({audio:(o=r)!==null&&o!==void 0?o:!0});break;case B.Source.ScreenShare:c=yield this.createScreenTracks(Object.assign({},r));break;default:throw new Sn(e)}}catch(u){throw c==null||c.forEach(l=>{l.stop()}),u instanceof Error&&this.emit(Y.MediaDevicesError,u,Vd(e)),this.pendingPublishing.delete(e),u}for(const u of c){const l=Object.assign(Object.assign({},this.roomOptions.publishDefaults),r);e===B.Source.Microphone&&on(u)&&l.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),u.startPreConnectBuffer())}try{const u=[];for(const d of c)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),ue(d))),u.push(this.publishTrack(d,i));[s]=yield Promise.all(u)}catch(u){throw c==null||c.forEach(l=>{l.stop()}),u}finally{this.pendingPublishing.delete(e)}}else if(!(s!=null&&s.track)&&this.pendingPublishing.has(e)&&(s=yield this.waitForPendingPublicationOfSource(e),s||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),s&&s.track)if(e===B.Source.ScreenShare){s=yield this.unpublishTrack(s.track);const c=this.getTrackPublication(B.Source.ScreenShareAudio);c&&c.track&&this.unpublishTrack(c.track)}else yield s.mute();return s})}enableCameraAndMicrophone(){return x(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(B.Source.Camera)||this.pendingPublishing.has(B.Source.Microphone))){this.pendingPublishing.add(B.Source.Camera),this.pendingPublishing.add(B.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(B.Source.Camera),this.pendingPublishing.delete(B.Source.Microphone)}}})}createTracks(e){return x(this,void 0,void 0,function*(){var n,r;e!=null||(e={});const i=nw(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults);try{return(yield Zc(i,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map(s=>(on(s)&&(this.microphoneError=void 0,s.setAudioContext(this.audioContext),s.source=B.Source.Microphone,this.emit(Y.AudioStreamAcquired)),ir(s)&&(this.cameraError=void 0,s.source=B.Source.Camera),s))}catch(a){throw a instanceof Error&&(e.audio&&(this.microphoneError=a),e.video&&(this.cameraError=a)),a}})}createScreenTracks(e){return x(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new Th("getDisplayMedia not supported");e.resolution===void 0&&!BG()&&(e.resolution=kh.h1080fps30.resolution);const n=ZG(e),r=yield navigator.mediaDevices.getDisplayMedia(n),i=r.getVideoTracks();if(i.length===0)throw new Sn("no video track found");const a=new uc(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});a.source=B.Source.ScreenShare,e.contentHint&&(a.mediaStreamTrack.contentHint=e.contentHint);const o=[a];if(r.getAudioTracks().length>0){this.emit(Y.AudioStreamAcquired);const s=new cc(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});s.source=B.Source.ScreenShareAudio,o.push(s)}return o})}publishTrack(e,n){return x(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,n)})}publishOrRepublishTrack(e,n){return x(this,arguments,void 0,function(r,i){var a=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var s,c,u,l;pn(r)&&r.setAudioContext(a.audioContext),yield(s=a.reconnectFuture)===null||s===void 0?void 0:s.promise,a.republishPromise&&!o&&(yield a.republishPromise),Sr(r)&&a.pendingPublishPromises.has(r)&&(yield a.pendingPublishPromises.get(r));let d;if(r instanceof MediaStreamTrack)d=r.getConstraints();else{d=r.constraints;let b;switch(r.source){case B.Source.Microphone:b="audioinput";break;case B.Source.Camera:b="videoinput"}b&&a.activeDeviceMap.has(b)&&(d=Object.assign(Object.assign({},d),{deviceId:a.activeDeviceMap.get(b)}))}if(r instanceof MediaStreamTrack)switch(r.kind){case"audio":r=new cc(r,d,!0,a.audioContext,{loggerName:a.roomOptions.loggerName,loggerContextCb:()=>a.logContext});break;case"video":r=new uc(r,d,!0,{loggerName:a.roomOptions.loggerName,loggerContextCb:()=>a.logContext});break;default:throw new Sn("unsupported MediaStreamTrack kind ".concat(r.kind))}else r.updateLoggerOptions({loggerName:a.roomOptions.loggerName,loggerContextCb:()=>a.logContext});let f;if(a.trackPublications.forEach(b=>{b.track&&b.track===r&&(f=b)}),f)return a.log.warn("track has already been published, skipping",Object.assign(Object.assign({},a.logContext),ue(f))),f;const h=Object.assign(Object.assign({},a.roomOptions.publishDefaults),i),m="channelCount"in r.mediaStreamTrack.getSettings()&&r.mediaStreamTrack.getSettings().channelCount===2||r.mediaStreamTrack.getConstraints().channelCount===2,p=(c=h.forceStereo)!==null&&c!==void 0?c:m;p&&(h.dtx===void 0&&a.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},a.logContext),ue(r))),h.red===void 0&&a.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(u=h.dtx)!==null&&u!==void 0||(h.dtx=!1),(l=h.red)!==null&&l!==void 0||(h.red=!1)),!FG()&&a.roomOptions.e2ee&&(a.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},a.logContext)),h.simulcast=!1),h.source&&(r.source=h.source);const v=new Promise((b,k)=>x(a,void 0,void 0,function*(){try{if(this.engine.client.currentState!==Pe.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:ue(r)}));const T=setTimeout(()=>{k(new fy("publishing rejected as engine not connected within timeout",408))},15e3);yield this.waitUntilEngineConnected(),clearTimeout(T);const S=yield this.publish(r,h,p);b(S)}else try{const T=yield this.publish(r,h,p);b(T)}catch(T){k(T)}}catch(T){k(T)}}));a.pendingPublishPromises.set(r,v);try{return yield v}catch(b){throw b}finally{a.pendingPublishPromises.delete(r)}}()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new Mt),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),ue(e))),!1;const{canPublish:n,canPublishSources:r}=this.permissions;return n&&(r.length===0||r.map(i=>rH(i)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),ue(e))),!1)}publish(e,n,r){return x(this,void 0,void 0,function*(){var i,a,o,s,c,u,l,d,f,h;if(!this.hasPermissionsToPublish(e))throw new fy("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(_=>Sr(e)&&_.source===e.source)&&e.source!==B.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),ue(e))),n.stopMicTrackOnMute&&on(e)&&(e.stopOnMute=!0),e.source===B.Source.ScreenShare&&Er()&&(n.simulcast=!1),n.videoCodec==="av1"&&!LG()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!jG()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=Wd),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(_=>n.videoCodec===Sa(_.mime))||(n.videoCodec=Sa(this.enabledPublishVideoCodecs[0].mime)));const p=n.videoCodec;e.on(G.Muted,this.onTrackMuted),e.on(G.Unmuted,this.onTrackUnmuted),e.on(G.Ended,this.handleTrackEnded),e.on(G.UpstreamPaused,this.onTrackUpstreamPaused),e.on(G.UpstreamResumed,this.onTrackUpstreamResumed),e.on(G.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const v=[],b=!(!((i=n.dtx)!==null&&i!==void 0)||i),k=e.getSourceTrackSettings();k.autoGainControl&&v.push(Je.TF_AUTO_GAIN_CONTROL),k.echoCancellation&&v.push(Je.TF_ECHO_CANCELLATION),k.noiseSuppression&&v.push(Je.TF_NOISE_SUPPRESSION),k.channelCount&&k.channelCount>1&&v.push(Je.TF_STEREO),b&&v.push(Je.TF_NO_DTX),pn(e)&&e.hasPreConnectBuffer&&v.push(Je.TF_PRECONNECT_BUFFER);const T=new ac({cid:e.mediaStreamTrack.id,name:n.name,type:B.kindToProto(e.kind),muted:e.isMuted,source:B.sourceToProto(e.source),disableDtx:b,encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((a=n.red)!==null&&a!==void 0)||a),stream:n==null?void 0:n.stream,backupCodecPolicy:n==null?void 0:n.backupCodecPolicy,audioFeatures:v});let S;if(e.kind===B.Kind.Video){let _={width:0,height:0};try{_=yield e.waitForDimensions()}catch(A){const P=(s=(o=this.roomOptions.videoCaptureDefaults)===null||o===void 0?void 0:o.resolution)!==null&&s!==void 0?s:io.h720.resolution;_={width:P.width,height:P.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),ue(e)),{dims:_}))}T.width=_.width,T.height=_.height,$n(e)&&(Qt(p)&&(e.source===B.Source.ScreenShare&&(n.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),ue(e))))),n.scalabilityMode=(c=n.scalabilityMode)!==null&&c!==void 0?c:"L3T3_KEY"),T.simulcastCodecs=[new Cd({codec:p,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:Wd}),n.backupCodec&&p!==n.backupCodec.codec&&T.encryption===He.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),T.simulcastCodecs.push(new Cd({codec:n.backupCodec.codec,cid:""})))),S=Gd(e.source===B.Source.ScreenShare,T.width,T.height,n),T.layers=Ly(T.width,T.height,S,Qt(n.videoCodec))}else e.kind===B.Kind.Audio&&(S=[{maxBitrate:(u=n.audioPreset)===null||u===void 0?void 0:u.maxBitrate,priority:(d=(l=n.audioPreset)===null||l===void 0?void 0:l.priority)!==null&&d!==void 0?d:"high",networkPriority:(h=(f=n.audioPreset)===null||f===void 0?void 0:f.priority)!==null&&h!==void 0?h:"high"}]);if(!this.engine||this.engine.isClosed)throw new Ge("cannot publish track when not connected");const g=()=>x(this,void 0,void 0,function*(){var _,A,P;if(!this.engine.pcManager)throw new Ge("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,n,S),this.emit(Y.LocalSenderCreated,e.sender,e),$n(e)&&((_=n.degradationPreference)!==null&&_!==void 0||(n.degradationPreference=BH(e)),e.setDegradationPreference(n.degradationPreference)),S)if(Er()&&e.kind===B.Kind.Audio){let E;for(const M of this.engine.pcManager.publisher.getTransceivers())if(M.sender===e.sender){E=M;break}E&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:E,codec:"opus",maxbr:!((A=S[0])===null||A===void 0)&&A.maxBitrate?S[0].maxBitrate/1e3:0})}else e.codec&&Qt(e.codec)&&(!((P=S[0])===null||P===void 0)&&P.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:T.cid,codec:e.codec,maxbr:S[0].maxBitrate/1e3});yield this.engine.negotiate()});let y;const w=new Promise((_,A)=>x(this,void 0,void 0,function*(){var P;try{y=yield this.engine.addTrack(T),_(y)}catch(E){e.sender&&(!((P=this.engine.pcManager)===null||P===void 0)&&P.publisher)&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch(M=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),ue(e)),{error:M}))})),A(E)}}));if(this.enabledPublishVideoCodecs.length>0)y=(yield Promise.all([w,g()]))[0];else{y=yield w;let _;if(y.codecs.forEach(A=>{_===void 0&&(_=A.mimeType)}),_&&e.kind===B.Kind.Video){const A=Sa(_);A!==p&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),ue(e)),{codec:A})),n.videoCodec=A,S=Gd(e.source===B.Source.ScreenShare,T.width,T.height,n))}yield g()}const C=new Xd(e.kind,y,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(C.on(G.CpuConstrained,_=>this.onTrackCpuConstrained(_,C)),C.options=n,e.sid=y.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:S,trackInfo:y})),$n(e)?e.startMonitor(this.engine.client):pn(e)&&e.startMonitor(),this.addTrackPublication(C),this.emit(Y.LocalTrackPublished,C),pn(e)&&y.audioFeatures.includes(Je.TF_PRECONNECT_BUFFER)){const _=e.getPreConnectBuffer(),A=e.getPreConnectBufferMimeType();this.on(Y.LocalTrackSubscribed,P=>{if(P.trackSid===y.sid){if(!e.hasPreConnectBuffer){this.log.warn("subscribe event came to late, buffer already closed",this.logContext);return}this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),ue(e))),e.stopPreConnectBuffer()}}),_&&new Promise((E,M)=>x(this,void 0,void 0,function*(){var N,D,$,F,R,j;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),ue(e)));const ee=setTimeout(()=>{M(new Error("agent not active within 10 seconds"))},1e4),de=yield this.waitUntilActiveAgentPresent();clearTimeout(ee),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),ue(e)));const Se=yield this.streamBytes({name:"preconnect-buffer",mimeType:A,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[de.identity],attributes:{trackId:C.trackSid,sampleRate:String((R=k.sampleRate)!==null&&R!==void 0?R:"48000"),channels:String((j=k.channelCount)!==null&&j!==void 0?j:"1")}});try{for(var q=!0,J=bn(_),W;W=yield J.next(),N=W.done,!N;q=!0){F=W.value,q=!1;const xe=F;yield Se.write(xe)}}catch(xe){D={error:xe}}finally{try{!q&&!N&&($=J.return)&&(yield $.call(J))}finally{if(D)throw D.error}}yield Se.close(),E()}catch(ee){M(ee)}})).then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),ue(e)))}).catch(E=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),ue(e)),{error:E}))})}return C})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,r){return x(this,void 0,void 0,function*(){var i;if(this.encryptionType!==He.NONE)return;let a;if(this.trackPublications.forEach(h=>{h.track&&h.track===e&&(a=h)}),!a)throw new Sn("track is not published");if(!$n(e))throw new Sn("track is not a video track");const o=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),s=LH(e,n,o);if(!s){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),ue(e)));return}const c=e.addSimulcastTrack(n,s);if(!c)return;const u=new ac({cid:c.mediaStreamTrack.id,type:B.kindToProto(e.kind),muted:e.isMuted,source:B.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:o.videoCodec,cid:c.mediaStreamTrack.id}]});if(u.layers=Ly(u.width,u.height,s),!this.engine||this.engine.isClosed)throw new Ge("cannot publish track when not connected");const l=()=>x(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,c,o,s),yield this.engine.negotiate()}),f=(yield Promise.all([this.engine.addTrack(u),l()]))[0];this.log.debug("published ".concat(n," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:s,trackInfo:f}))})}unpublishTrack(e,n){return x(this,void 0,void 0,function*(){var r,i;if(Sr(e)){const u=this.pendingPublishPromises.get(e);u&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),ue(e))),yield u)}const a=this.getPublicationForTrack(e),o=a?ue(a):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),o)),!a||!a.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),o));return}e=a.track,e.off(G.Muted,this.onTrackMuted),e.off(G.Unmuted,this.onTrackUnmuted),e.off(G.Ended,this.handleTrackEnded),e.off(G.UpstreamPaused,this.onTrackUpstreamPaused),e.off(G.UpstreamResumed,this.onTrackUpstreamResumed),e.off(G.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),n===void 0&&(n=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),n?e.stop():e.stopMonitor();let s=!1;const c=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<Me.FAILED&&c)try{for(const u of this.engine.pcManager.publisher.getTransceivers())u.sender===c&&(u.direction="inactive",s=!0);if(this.engine.removeTrack(c)&&(s=!0),$n(e)){for(const[,u]of e.simulcastCodecs)u.sender&&(this.engine.removeTrack(u.sender)&&(s=!0),u.sender=void 0);e.simulcastCodecs.clear()}}catch(u){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),o),{error:u}))}switch(this.trackPublications.delete(a.trackSid),a.kind){case B.Kind.Audio:this.audioTrackPublications.delete(a.trackSid);break;case B.Kind.Video:this.videoTrackPublications.delete(a.trackSid);break}return this.emit(Y.LocalTrackUnpublished,a),a.setTrack(void 0),s&&(yield this.engine.negotiate()),a})}unpublishTracks(e){return x(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>!!r)})}republishAllTracks(e){return x(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){r.republishPromise&&(yield r.republishPromise),r.republishPromise=new Promise((a,o)=>x(r,void 0,void 0,function*(){try{const s=[];this.trackPublications.forEach(c=>{c.track&&(n&&(c.options=Object.assign(Object.assign({},c.options),n)),s.push(c))}),yield Promise.all(s.map(c=>x(this,void 0,void 0,function*(){const u=c.track;yield this.unpublishTrack(u,!1),i&&!u.isMuted&&u.source!==B.Source.ScreenShare&&u.source!==B.Source.ScreenShareAudio&&(pn(u)||$n(u))&&!u.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:c.trackSid})),yield u.restartTrack()),yield this.publishOrRepublishTrack(u,c.options,!0)}))),a()}catch(s){o(s)}finally{this.republishPromise=void 0}})),yield r.republishPromise}()})}publishData(e){return x(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const a=i.reliable?se.RELIABLE:se.LOSSY,o=i.destinationIdentities,s=i.topic;let c=new dh({participantIdentity:r.identity,payload:n,destinationIdentities:o,topic:s});const u=new st({kind:a,value:{case:"user",value:c}});yield r.engine.sendDataPacket(u,a)}()})}publishDtmf(e,n){return x(this,void 0,void 0,function*(){const r=new st({kind:se.RELIABLE,value:{case:"sipDtmf",value:new tk({code:e,digit:n})}});yield this.engine.sendDataPacket(r,se.RELIABLE)})}sendChatMessage(e,n){return x(this,void 0,void 0,function*(){const r={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:n==null?void 0:n.attachments},i=new st({value:{case:"chatMessage",value:new tc(Object.assign(Object.assign({},r),{timestamp:Ae.parse(r.timestamp)}))}});return yield this.engine.sendDataPacket(i,se.RELIABLE),this.emit(Y.ChatMessage,r),r})}editChatMessage(e,n){return x(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},n),{message:e,editTimestamp:Date.now()}),i=new st({value:{case:"chatMessage",value:new tc(Object.assign(Object.assign({},r),{timestamp:Ae.parse(r.timestamp),editTimestamp:Ae.parse(r.editTimestamp)}))}});return yield this.engine.sendDataPacket(i,se.RELIABLE),this.emit(Y.ChatMessage,r),r})}sendText(e,n){return x(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendText(e,n)})}streamText(e){return x(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamText(e)})}sendFile(e,n){return x(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendFile(e,n)})}streamBytes(e){return x(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamBytes(e)})}performRpc(e){return x(this,arguments,void 0,function(n){var r=this;let{destinationIdentity:i,method:a,payload:o,responseTimeout:s=1e4}=n;return function*(){return new Promise((u,l)=>x(r,void 0,void 0,function*(){var d,f,h,m;if(Eh(o)>uw){l(Le.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((f=(d=this.engine.latestJoinResponse)===null||d===void 0?void 0:d.serverInfo)===null||f===void 0)&&f.version&&ln((m=(h=this.engine.latestJoinResponse)===null||h===void 0?void 0:h.serverInfo)===null||m===void 0?void 0:m.version,"1.8.0")<0){l(Le.builtIn("UNSUPPORTED_SERVER"));return}const p=crypto.randomUUID();yield this.publishRpcRequest(i,p,a,o,s-2e3);const v=setTimeout(()=>{this.pendingAcks.delete(p),l(Le.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(p),clearTimeout(b)},2e3);this.pendingAcks.set(p,{resolve:()=>{clearTimeout(v)},participantIdentity:i});const b=setTimeout(()=>{this.pendingResponses.delete(p),l(Le.builtIn("RESPONSE_TIMEOUT"))},s);this.pendingResponses.set(p,{resolve:(k,T)=>{clearTimeout(b),this.pendingAcks.has(p)&&(console.warn("RPC response received before ack",p),this.pendingAcks.delete(p),clearTimeout(v)),T?l(T):u(k!=null?k:"")},participantIdentity:i})}))}()})}registerRpcMethod(e,n){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,n)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const n=this.pendingAcks.get(e);n?(n.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,n,r){const i=this.pendingResponses.get(e);i?(i.resolve(n,r),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,n,r,i,a){return x(this,void 0,void 0,function*(){const o=new st({destinationIdentities:[e],kind:se.RELIABLE,value:{case:"rpcRequest",value:new fh({id:n,method:r,payload:i,responseTimeoutMs:a,version:1})}});yield this.engine.sendDataPacket(o,se.RELIABLE)})}handleParticipantDisconnected(e){for(const[n,{participantIdentity:r}]of this.pendingAcks)r===e&&this.pendingAcks.delete(n);for(const[n,{participantIdentity:r,resolve:i}]of this.pendingResponses)r===e&&(i(null,Le.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(n))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(n=>n.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return super.updateInfo(e)?(e.tracks.forEach(n=>{var r,i;const a=this.trackPublications.get(n.sid);if(a){const o=a.isMuted||((i=(r=a.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);o!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),ue(a)),{mutedOnServer:o})),this.engine.client.sendMuteTrack(n.sid,o))}}),!0):!1}setActiveAgent(e){var n,r,i,a;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?(r=(n=this.activeAgentFuture)===null||n===void 0?void 0:n.resolve)===null||r===void 0||r.call(n,e):(a=(i=this.activeAgentFuture)===null||i===void 0?void 0:i.reject)===null||a===void 0||a.call(i,"Agent disconnected"),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new Mt),this.activeAgentFuture.promise)}getPublicationForTrack(e){let n;return this.trackPublications.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(pn(i)||$n(i))&&i.mediaStreamTrack===e&&(n=r):e===i&&(n=r))}),n}waitForPendingPublicationOfSource(e){return x(this,void 0,void 0,function*(){const r=Date.now();for(;Date.now()<r+1e4;){const i=Array.from(this.pendingPublishPromises.entries()).find(a=>{let[o]=a;return o.source===e});if(i)return i[1];yield vt(20)}})}}class oK extends gn{constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=a=>{this.setTrack(void 0),this.emit(G.Ended,a)},this.handleVisibilityChange=a=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(a),this.logContext),this.visible=a,this.emitTrackUpdate()},this.handleVideoDimensionsChange=a=>{this.log.debug("adaptivestream video dimensions ".concat(a.width,"x").concat(a.height),this.logContext),this.videoDimensionsAdaptiveStream=a,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new Xc({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new rk({participantSid:"",trackSids:[this.trackSid]})]});this.emit(G.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?gn.SubscriptionStatus.Unsubscribed:super.isSubscribed?gn.SubscriptionStatus.Subscribed:gn.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?gn.PermissionStatus.Allowed:gn.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return this.requestedDisabled!==void 0?!this.requestedDisabled:this.isAdaptiveStream?this.visible:!0}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.requestedDisabled===!e||(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.requestedMaxQuality===e||(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,r;this.isManualOperationAllowed()&&(((n=this.requestedVideoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((r=this.requestedVideoDimensions)===null||r===void 0?void 0:r.height)===e.height||(Vu(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&Vu(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return(e=this.requestedMaxQuality)!==null&&e!==void 0?e:wt.HIGH}setTrack(e){const n=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(G.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(G.VisibilityChanged,this.handleVisibilityChange),i.off(G.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(G.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(G.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(G.VisibilityChanged,this.handleVisibilityChange),e.on(G.Ended,this.handleEnded),this.emit(G.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(G.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?G.Muted:G.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(G.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(G.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return Vu(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new dk({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===B.Kind.Video){let n=this.requestedVideoDimensions;if(this.videoDimensionsAdaptiveStream!==void 0)if(n)ky(this.videoDimensionsAdaptiveStream,n)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),n=this.videoDimensionsAdaptiveStream);else if(this.requestedMaxQuality!==void 0&&this.trackInfo){const r=iH(this.trackInfo,this.requestedMaxQuality);r&&ky(this.videoDimensionsAdaptiveStream,r)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),n=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),n=this.videoDimensionsAdaptiveStream;n?(e.width=Math.ceil(n.width),e.height=Math.ceil(n.height)):this.requestedMaxQuality!==void 0?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:wt.HIGH})),e.quality=wt.HIGH)}this.emit(G.UpdateSettings,e)}}class lc extends gw{static fromParticipantInfo(e,n,r){return new lc(e,n.sid,n.identity,n.name,n.metadata,n.attributes,r,n.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,n,r,i,a,o,s){let c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:ro.STANDARD;super(n,r||"",i,a,o,s,c),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(G.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),ue(e)),{settings:n})),this.signalClient.sendUpdateTrackSettings(n)}),e.on(G.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(G.SubscriptionPermissionChanged,n=>{this.emit(Y.TrackSubscriptionPermissionChanged,e,n)}),e.on(G.SubscriptionStatusChanged,n=>{this.emit(Y.TrackSubscriptionStatusChanged,e,n)}),e.on(G.Subscribed,n=>{this.emit(Y.TrackSubscribed,n,e)}),e.on(G.Unsubscribed,n=>{this.emit(Y.TrackUnsubscribed,n,e)}),e.on(G.SubscriptionFailed,n=>{this.emit(Y.TrackSubscriptionFailed,e.trackSid,n)})}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:B.Source.Microphone;this.volumeMap.set(n,e);const r=this.getTrackPublication(n);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:B.Source.Microphone;const n=this.getTrackPublication(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,r,i,a,o){let s=this.getTrackPublicationBySid(n);if(s||n.startsWith("TR")||this.trackPublications.forEach(l=>{!s&&e.kind===l.kind.toString()&&(s=l)}),!s){if(o===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(Y.TrackSubscriptionFailed,n);return}o===void 0&&(o=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,r,i,a,o-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),ue(s))),this.emit(Y.TrackSubscriptionFailed,n);return}const c=e.kind==="video";let u;return c?u=new ZH(e,n,i,a):u=new QH(e,n,i,this.audioContext,this.audioOutput),u.source=s.source,u.isMuted=s.isMuted,u.setMediaStream(r),u.start(),s.setTrack(u),this.volumeMap.has(s.source)&&Fd(u)&&on(u)&&u.setVolume(this.volumeMap.get(s.source)),s}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,r=new Map;return e.tracks.forEach(i=>{var a,o;let s=this.getTrackPublicationBySid(i.sid);if(s)s.updateInfo(i);else{const c=B.kindFromProto(i.type);if(!c)return;s=new oK(c,i,(a=this.signalClient.connectOptions)===null||a===void 0?void 0:a.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(o=this.loggerOptions)===null||o===void 0?void 0:o.loggerName}),s.updateInfo(i),r.set(i.sid,s);const u=Array.from(this.trackPublications.values()).find(l=>l.source===(s==null?void 0:s.source));u&&s.source!==B.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(s.source),Object.assign(Object.assign({},this.logContext),{oldTrack:ue(u),newTrack:ue(s)})),this.addTrackPublication(s)}n.set(i.sid,s)}),this.trackPublications.forEach(i=>{n.has(i.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),ue(i))),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(Y.TrackPublished,i)}),!0}unpublishTrack(e,n){const r=this.trackPublications.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.trackPublications.delete(e),r.kind){case B.Kind.Audio:this.audioTrackPublications.delete(e);break;case B.Kind.Video:this.videoTrackPublications.delete(e);break}n&&this.emit(Y.TrackUnpublished,r)}setAudioOutput(e){return x(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTrackPublications.forEach(r=>{var i;on(r.track)&&Fd(r.track)&&n.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}var ve;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting",t.SignalReconnecting="signalReconnecting"})(ve||(ve={}));const sK=4*1e3;class oo extends fn.EventEmitter{get hasE2EESetup(){return this.e2eeManager!==void 0}constructor(e){var n,r,i,a;if(super(),n=this,this.state=ve.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=ae,this.bufferedEvents=[],this.isResuming=!1,this.rpcHandlers=new Map,this.connect=(o,s,c)=>x(this,void 0,void 0,function*(){var u;if(!$G())throw un()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const l=yield this.disconnectLock.lock();if(this.state===ve.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),l(),Promise.resolve();if(this.connectFuture)return l(),this.connectFuture.promise;this.setAndEmitConnectionState(ve.Connecting),((u=this.regionUrlProvider)===null||u===void 0?void 0:u.getServerUrl().toString())!==o&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Bd(new URL(o))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new Hd(o,s):this.regionUrlProvider.updateToken(s),this.regionUrlProvider.fetchRegionSettings().then(h=>{var m;(m=this.regionUrlProvider)===null||m===void 0||m.setServerReportedRegions(h)}).catch(h=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:h}))}));const d=(h,m,p)=>x(this,void 0,void 0,function*(){var v,b;this.abortController&&this.abortController.abort();const k=new AbortController;this.abortController=k,l==null||l();try{yield this.attemptConnection(p!=null?p:o,s,c,k),this.abortController=void 0,h()}catch(T){if(this.regionUrlProvider&&T instanceof Te&&T.reason!==pe.Cancelled&&T.reason!==pe.NotAllowed){let S=null;try{S=yield this.regionUrlProvider.getNextBestRegionUrl((v=this.abortController)===null||v===void 0?void 0:v.signal)}catch(g){if(g instanceof Te&&(g.status===401||g.reason===pe.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),m(g);return}}S&&!(!((b=this.abortController)===null||b===void 0)&&b.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(T.message,". Retrying with another region: ").concat(S),this.logContext),this.recreateEngine(),yield d(h,m,S)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Ty(T)),m(T))}else{let S=Ht.UNKNOWN_REASON;T instanceof Te&&(S=Ty(T)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,S),m(T)}}}),f=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Mt((h,m)=>{d(h,m,f)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(o,s,c,u,l,d)=>x(this,void 0,void 0,function*(){var f,h,m;const p=yield c.join(o,s,{autoSubscribe:u.autoSubscribe,adaptiveStream:typeof l.adaptiveStream=="object"?!0:l.adaptiveStream,maxRetries:u.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:u.websocketTimeout},d.signal);let v=p.serverInfo;if(v||(v={version:p.serverVersion,region:p.serverRegion}),this.serverInfo=v,this.log.debug("connected to Livekit Server ".concat(Object.entries(v).map(b=>{let[k,T]=b;return"".concat(k,": ").concat(T)}).join(", ")),{room:(f=p.room)===null||f===void 0?void 0:f.name,roomSid:(h=p.room)===null||h===void 0?void 0:h.sid,identity:(m=p.participant)===null||m===void 0?void 0:m.identity}),!v.version)throw new kG("unknown server version");return v.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),l.dynacast=!1),p}),this.applyJoinResponse=o=>{const s=o.participant;if(this.localParticipant.sid=s.sid,this.localParticipant.identity=s.identity,this.localParticipant.setEnabledPublishCodecs(o.enabledPublishCodecs),this.e2eeManager)try{this.e2eeManager.setSifTrailer(o.sifTrailer)}catch(c){this.log.error(c instanceof Error?c.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:c}))}this.handleParticipantUpdates([s,...o.otherParticipants]),o.room&&this.handleRoomUpdate(o.room)},this.attemptConnection=(o,s,c,u)=>x(this,void 0,void 0,function*(){var l,d;this.state===ve.Reconnecting||this.isResuming||!((l=this.engine)===null||l===void 0)&&l.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((d=this.regionUrlProvider)===null||d===void 0)&&d.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},Oh),c),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const f=yield this.connectSignal(o,s,this.engine,this.connOptions,this.options,u);this.applyJoinResponse(f),this.setupLocalParticipantEvents(),this.emit(z.SignalConnected)}catch(f){yield this.engine.close(),this.recreateEngine();const h=new Te("could not establish signal connection",pe.ServerUnreachable);throw f instanceof Error&&(h.message="".concat(h.message,": ").concat(f.message)),f instanceof Te&&(h.reason=f.reason,h.status=f.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:f})),h}if(u.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Te("Connection attempt aborted",pe.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,u)}catch(f){throw yield this.engine.close(),this.recreateEngine(),f}mt()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),mt()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(ve.Connected),this.emit(z.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return x(n,[...s],void 0,function(){var u=this;let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var d,f,h,m;const p=yield u.disconnectLock.lock();try{if(u.state===ve.Disconnected){u.log.debug("already disconnected",u.logContext);return}u.log.info("disconnect from room",Object.assign({},u.logContext)),(u.state===ve.Connecting||u.state===ve.Reconnecting||u.isResuming)&&(u.log.warn("abort connection attempt",u.logContext),(d=u.abortController)===null||d===void 0||d.abort(),(h=(f=u.connectFuture)===null||f===void 0?void 0:f.reject)===null||h===void 0||h.call(f,new Te("Client initiated disconnect",pe.Cancelled)),u.connectFuture=void 0),!((m=u.engine)===null||m===void 0)&&m.client.isDisconnected||(yield u.engine.client.sendLeave()),u.engine&&(yield u.engine.close()),u.handleDisconnect(l,Ht.CLIENT_INITIATED),u.engine=void 0}finally{p()}}()})},this.onPageLeave=()=>x(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>x(this,void 0,void 0,function*(){const o=[],s=Ct();if(s&&s.os==="iOS"){const c="livekit-dummy-audio-el";let u=document.getElementById(c);if(!u){u=document.createElement("audio"),u.id=c,u.autoplay=!0,u.hidden=!0;const l=qu();l.enabled=!0;const d=new MediaStream([l]);u.srcObject=d,document.addEventListener("visibilitychange",()=>{u&&(u.srcObject=document.hidden?null:d,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(u),this.once(z.Disconnected,()=>{u==null||u.remove(),u=null})}o.push(u)}this.remoteParticipants.forEach(c=>{c.audioTrackPublications.forEach(u=>{u.track&&u.track.attachedElements.forEach(l=>{o.push(l)})})});try{yield Promise.all([this.acquireAudioContext(),...o.map(c=>(c.muted=!1,c.play()))]),this.handleAudioPlaybackStarted()}catch(c){throw this.handleAudioPlaybackFailed(c),c}}),this.startVideo=()=>x(this,void 0,void 0,function*(){const o=[];for(const s of this.remoteParticipants.values())s.videoTrackPublications.forEach(c=>{var u;(u=c.track)===null||u===void 0||u.attachedElements.forEach(l=>{o.includes(l)||o.push(l)})});yield Promise.all(o.map(s=>s.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(s=>{s.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const o of this.remoteParticipants.values())this.handleParticipantDisconnected(o.identity,o);this.setAndEmitConnectionState(ve.Reconnecting)&&this.emit(z.Reconnecting)},this.handleSignalRestarted=o=>x(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(o.serverRegion),Object.assign(Object.assign({},this.logContext),{region:o.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(o);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(s){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:s}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:o.serverRegion}))}catch(s){return}this.setAndEmitConnectionState(ve.Connected),this.emit(z.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=o=>{o.forEach(s=>{var c;if(s.identity===this.localParticipant.identity){this.localParticipant.updateInfo(s);return}s.identity===""&&(s.identity=(c=this.sidToIdentity.get(s.sid))!==null&&c!==void 0?c:"");let u=this.remoteParticipants.get(s.identity);s.state===ri.DISCONNECTED?this.handleParticipantDisconnected(s.identity,u):u=this.getOrCreateParticipant(s.identity,s)})},this.handleActiveSpeakersUpdate=o=>{const s=[],c={};o.forEach(u=>{if(c[u.sid]=!0,u.sid===this.localParticipant.sid)this.localParticipant.audioLevel=u.level,this.localParticipant.setIsSpeaking(!0),s.push(this.localParticipant);else{const l=this.getRemoteParticipantBySid(u.sid);l&&(l.audioLevel=u.level,l.setIsSpeaking(!0),s.push(l))}}),c[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(u=>{c[u.sid]||(u.audioLevel=0,u.setIsSpeaking(!1))}),this.activeSpeakers=s,this.emitWhenConnected(z.ActiveSpeakersChanged,s)},this.handleSpeakersChanged=o=>{const s=new Map;this.activeSpeakers.forEach(u=>{const l=this.remoteParticipants.get(u.identity);l&&l.sid!==u.sid||s.set(u.sid,u)}),o.forEach(u=>{let l=this.getRemoteParticipantBySid(u.sid);u.sid===this.localParticipant.sid&&(l=this.localParticipant),l&&(l.audioLevel=u.level,l.setIsSpeaking(u.active),u.active?s.set(u.sid,l):s.delete(u.sid))});const c=Array.from(s.values());c.sort((u,l)=>l.audioLevel-u.audioLevel),this.activeSpeakers=c,this.emitWhenConnected(z.ActiveSpeakersChanged,c)},this.handleStreamStateUpdate=o=>{o.streamStates.forEach(s=>{const c=this.getRemoteParticipantBySid(s.participantSid);if(!c)return;const u=c.getTrackPublicationBySid(s.trackSid);if(!u||!u.track)return;const l=B.streamStateFromProto(s.state);u.track.setStreamState(l),l!==u.track.streamState&&(c.emit(Y.TrackStreamStateChanged,u,u.track.streamState),this.emitWhenConnected(z.TrackStreamStateChanged,u,u.track.streamState,c))})},this.handleSubscriptionPermissionUpdate=o=>{const s=this.getRemoteParticipantBySid(o.participantSid);if(!s)return;const c=s.getTrackPublicationBySid(o.trackSid);c&&c.setAllowed(o.allowed)},this.handleSubscriptionError=o=>{const s=Array.from(this.remoteParticipants.values()).find(u=>u.trackPublications.has(o.trackSid));if(!s)return;const c=s.getTrackPublicationBySid(o.trackSid);c&&c.setSubscriptionError(o.err)},this.handleDataPacket=(o,s)=>{const c=this.remoteParticipants.get(o.participantIdentity);if(o.value.case==="user")this.handleUserPacket(c,o.value.value,o.kind,s);else if(o.value.case==="transcription")this.handleTranscription(c,o.value.value);else if(o.value.case==="sipDtmf")this.handleSipDtmf(c,o.value.value);else if(o.value.case==="chatMessage")this.handleChatMessage(c,o.value.value);else if(o.value.case==="metrics")this.handleMetrics(o.value.value,c);else if(o.value.case==="streamHeader"||o.value.case==="streamChunk"||o.value.case==="streamTrailer")this.handleDataStream(o,s);else if(o.value.case==="rpcRequest"){const u=o.value.value;this.handleIncomingRpcRequest(o.participantIdentity,u.id,u.method,u.payload,u.responseTimeoutMs,u.version)}},this.handleUserPacket=(o,s,c,u)=>{this.emit(z.DataReceived,s.payload,o,c,s.topic,u),o==null||o.emit(Y.DataReceived,s.payload,c,u)},this.handleSipDtmf=(o,s)=>{this.emit(z.SipDTMFReceived,s,o),o==null||o.emit(Y.SipDTMFReceived,s)},this.handleTranscription=(o,s)=>{const c=s.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(s.transcribedParticipantIdentity),u=c==null?void 0:c.trackPublications.get(s.trackId),l=HG(s,this.transcriptionReceivedTimes);u==null||u.emit(G.TranscriptionReceived,l),c==null||c.emit(Y.TranscriptionReceived,l,u),this.emit(z.TranscriptionReceived,l,c,u)},this.handleChatMessage=(o,s)=>{const c=KG(s);this.emit(z.ChatMessage,c,o)},this.handleMetrics=(o,s)=>{this.emit(z.MetricsReceived,o,s)},this.handleDataStream=(o,s)=>{this.incomingDataStreamManager.handleDataStreamPacket(o,s)},this.bufferedSegments=new Map,this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(z.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=o=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:o})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(z.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(z.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(z.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>x(this,void 0,void 0,function*(){var o;((o=Ct())===null||o===void 0?void 0:o.os)!=="iOS"&&(yield this.selectDefaultDevices()),this.emit(z.MediaDevicesChanged)}),this.handleRoomUpdate=o=>{const s=this.roomInfo;this.roomInfo=o,s&&s.metadata!==o.metadata&&this.emitWhenConnected(z.RoomMetadataChanged,o.metadata),(s==null?void 0:s.activeRecording)!==o.activeRecording&&this.emitWhenConnected(z.RecordingStatusChanged,o.activeRecording)},this.handleConnectionQualityUpdate=o=>{o.updates.forEach(s=>{if(s.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(s.quality);return}const c=this.getRemoteParticipantBySid(s.participantSid);c&&c.setConnectionQuality(s.quality)})},this.onLocalParticipantMetadataChanged=o=>{this.emit(z.ParticipantMetadataChanged,o,this.localParticipant)},this.onLocalParticipantNameChanged=o=>{this.emit(z.ParticipantNameChanged,o,this.localParticipant)},this.onLocalAttributesChanged=o=>{this.emit(z.ParticipantAttributesChanged,o,this.localParticipant)},this.onLocalTrackMuted=o=>{this.emit(z.TrackMuted,o,this.localParticipant)},this.onLocalTrackUnmuted=o=>{this.emit(z.TrackUnmuted,o,this.localParticipant)},this.onTrackProcessorUpdate=o=>{var s;(s=o==null?void 0:o.onPublish)===null||s===void 0||s.call(o,this)},this.onLocalTrackPublished=o=>x(this,void 0,void 0,function*(){var s,c,u,l,d,f;(s=o.track)===null||s===void 0||s.on(G.TrackProcessorUpdate,this.onTrackProcessorUpdate),(c=o.track)===null||c===void 0||c.on(G.Restarted,this.onLocalTrackRestarted),(d=(l=(u=o.track)===null||u===void 0?void 0:u.getProcessor())===null||l===void 0?void 0:l.onPublish)===null||d===void 0||d.call(l,this),this.emit(z.LocalTrackPublished,o,this.localParticipant),pn(o.track)&&(yield o.track.checkForSilence())&&this.emit(z.LocalAudioSilenceDetected,o);const h=yield(f=o.track)===null||f===void 0?void 0:f.getDeviceId(!1),m=Vd(o.source);m&&h&&h!==this.localParticipant.activeDeviceMap.get(m)&&(this.localParticipant.activeDeviceMap.set(m,h),this.emit(z.ActiveDeviceChanged,m,h))}),this.onLocalTrackUnpublished=o=>{var s,c;(s=o.track)===null||s===void 0||s.off(G.TrackProcessorUpdate,this.onTrackProcessorUpdate),(c=o.track)===null||c===void 0||c.off(G.Restarted,this.onLocalTrackRestarted),this.emit(z.LocalTrackUnpublished,o,this.localParticipant)},this.onLocalTrackRestarted=o=>x(this,void 0,void 0,function*(){const s=yield o.getDeviceId(!1),c=Vd(o.source);c&&s&&s!==this.localParticipant.activeDeviceMap.get(c)&&(this.log.debug("local track restarted, setting ".concat(c," ").concat(s," active"),this.logContext),this.localParticipant.activeDeviceMap.set(c,s),this.emit(z.ActiveDeviceChanged,c,s))}),this.onLocalConnectionQualityChanged=o=>{this.emit(z.ConnectionQualityChanged,o,this.localParticipant)},this.onMediaDevicesError=(o,s)=>{this.emit(z.MediaDevicesError,o,s)},this.onLocalParticipantPermissionsChanged=o=>{this.emit(z.ParticipantPermissionsChanged,o,this.localParticipant)},this.onLocalChatMessageSent=o=>{this.emit(z.ChatMessage,o,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},TH),e),this.log=In((r=this.options.loggerName)!==null&&r!==void 0?r:Kt.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},sw),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},cw),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},SH),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.incomingDataStreamManager=new KH,this.outgoingDataStreamManager=new JH(this.engine,this.log),this.disconnectLock=new gt,this.localParticipant=new aK("","",this.engine,this.options,this.rpcHandlers,this.outgoingDataStreamManager),(this.options.e2ee||this.options.encryption)&&this.setupE2EE(),this.engine.e2eeManager=this.e2eeManager,this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Jn(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Jn(this.options.audioCaptureDefaults.deviceId)),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&this.switchActiveDevice("audiooutput",Jn(this.options.audioOutput.deviceId)).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),mt()){const o=new AbortController;(a=navigator.mediaDevices)===null||a===void 0||a.addEventListener("devicechange",this.handleDeviceChange,{signal:o.signal}),oo.cleanupRegistry&&oo.cleanupRegistry.register(this,()=>{o.abort()})}}registerTextStreamHandler(e,n){return this.incomingDataStreamManager.registerTextStreamHandler(e,n)}unregisterTextStreamHandler(e){return this.incomingDataStreamManager.unregisterTextStreamHandler(e)}registerByteStreamHandler(e,n){return this.incomingDataStreamManager.registerByteStreamHandler(e,n)}unregisterByteStreamHandler(e){return this.incomingDataStreamManager.unregisterByteStreamHandler(e)}registerRpcMethod(e,n){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,n)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setE2EEEnabled(e){return x(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;const n=!!this.options.encryption,r=this.options.encryption||this.options.e2ee;r&&("e2eeManager"in r?this.e2eeManager=r.e2eeManager:this.e2eeManager=new aH(r,n),this.e2eeManager.on(Gn.ParticipantEncryptionStatusChanged,(i,a)=>{YG(a)&&(this.isE2EEEnabled=i),this.emit(z.ParticipantEncryptionStatusChanged,i,a)}),this.e2eeManager.on(Gn.EncryptionError,i=>this.emit(z.EncryptionError,i)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}getSid(){return x(this,void 0,void 0,function*(){return this.state===ve.Disconnected?"":this.roomInfo&&this.roomInfo.sid!==""?this.roomInfo.sid:new Promise((e,n)=>{const r=i=>{i.sid!==""&&(this.engine.off(X.RoomUpdate,r),e(i.sid))};this.engine.on(X.RoomUpdate,r),this.once(z.Disconnected,()=>{this.engine.off(X.RoomUpdate,r),n("Room disconnected before room server id was available")})})})}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new VH(this.options),this.engine.e2eeManager=this.e2eeManager,this.engine.on(X.ParticipantUpdate,this.handleParticipantUpdates).on(X.RoomUpdate,this.handleRoomUpdate).on(X.SpeakersChanged,this.handleSpeakersChanged).on(X.StreamStateChanged,this.handleStreamStateUpdate).on(X.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(X.SubscriptionError,this.handleSubscriptionError).on(X.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(X.MediaTrackAdded,(e,n,r)=>{this.onTrackAdded(e,n,r)}).on(X.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(X.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(X.DataPacketReceived,this.handleDataPacket).on(X.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(ve.SignalReconnecting)&&this.emit(z.SignalReconnecting)}).on(X.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(ve.Connected)&&this.emit(z.Reconnected)}).on(X.SignalResumed,()=>{this.bufferedEvents=[],(this.state===ve.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(X.Restarting,this.handleRestarting).on(X.SignalRestarted,this.handleSignalRestarted).on(X.Offline,()=>{this.setAndEmitConnectionState(ve.Reconnecting)&&this.emit(z.Reconnecting)}).on(X.DCBufferStatusChanged,(e,n)=>{this.emit(z.DCBufferStatusChanged,e,n)}).on(X.LocalTrackSubscribed,e=>{const n=this.localParticipant.getTrackPublications().find(r=>{let{trackSid:i}=r;return i===e});if(!n){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(Y.LocalTrackSubscribed,n),this.emitWhenConnected(z.LocalTrackSubscribed,n,this.localParticipant)}).on(X.RoomMoved,e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach((n,r)=>{this.handleParticipantDisconnected(r,n)}),this.emit(z.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine),this.outgoingDataStreamManager&&this.outgoingDataStreamManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Qe.getInstance().getDevices(e,n)}prepareConnection(e,n){return x(this,void 0,void 0,function*(){if(this.state===ve.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Bd(new URL(e))&&n){this.regionUrlProvider=new Hd(e,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===ve.Disconnected&&(this.regionUrl=r,yield fetch(Ud(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(Ud(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return x(this,void 0,void 0,function*(){let r=()=>x(this,void 0,void 0,function*(){}),i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new Yt({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new Yt({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new Yt({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new Yt({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>x(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new Yt({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>x(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new Yt({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new Yt({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>x(this,void 0,void 0,function*(){const a=this.engine.client.onLeave;a&&a(new Yc({reason:Ht.CLIENT_INITIATED,action:ii.RECONNECT}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new Yt({scenario:{case:"subscriberBandwidth",value:fr(n)}});break;case"leave-full-reconnect":i=new Yt({scenario:{case:"leaveRequestFullReconnect",value:!0}})}i&&(yield this.engine.client.sendSimulateScenario(i),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){return x(this,arguments,void 0,function(r,i){var a=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return function*(){var s,c,u,l,d,f,h;let m=!0,p=!1;const v=o?{exact:i}:i;if(r==="audioinput"){p=a.localParticipant.audioTrackPublications.size===0;const b=(s=a.getActiveDevice(r))!==null&&s!==void 0?s:a.options.audioCaptureDefaults.deviceId;a.options.audioCaptureDefaults.deviceId=v;const k=Array.from(a.localParticipant.audioTrackPublications.values()).filter(S=>S.source===B.Source.Microphone);try{m=(yield Promise.all(k.map(S=>{var g;return(g=S.audioTrack)===null||g===void 0?void 0:g.setDeviceId(v)}))).every(S=>S===!0)}catch(S){throw a.options.audioCaptureDefaults.deviceId=b,S}const T=k.some(S=>{var g,y;return(y=(g=S.track)===null||g===void 0?void 0:g.isMuted)!==null&&y!==void 0?y:!1});m&&T&&(p=!0)}else if(r==="videoinput"){p=a.localParticipant.videoTrackPublications.size===0;const b=(c=a.getActiveDevice(r))!==null&&c!==void 0?c:a.options.videoCaptureDefaults.deviceId;a.options.videoCaptureDefaults.deviceId=v;const k=Array.from(a.localParticipant.videoTrackPublications.values()).filter(S=>S.source===B.Source.Camera);try{m=(yield Promise.all(k.map(S=>{var g;return(g=S.videoTrack)===null||g===void 0?void 0:g.setDeviceId(v)}))).every(S=>S===!0)}catch(S){throw a.options.videoCaptureDefaults.deviceId=b,S}const T=k.some(S=>{var g,y;return(y=(g=S.track)===null||g===void 0?void 0:g.isMuted)!==null&&y!==void 0?y:!1});m&&T&&(p=!0)}else if(r==="audiooutput"){if(p=!0,!$d()&&!a.options.webAudioMix||a.options.webAudioMix&&a.audioContext&&!("setSinkId"in a.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");a.options.webAudioMix&&(i=(u=yield Qe.getInstance().normalizeDeviceId("audiooutput",i))!==null&&u!==void 0?u:""),(l=(h=a.options).audioOutput)!==null&&l!==void 0||(h.audioOutput={});const b=(d=a.getActiveDevice(r))!==null&&d!==void 0?d:a.options.audioOutput.deviceId;a.options.audioOutput.deviceId=i;try{a.options.webAudioMix&&((f=a.audioContext)===null||f===void 0||f.setSinkId(i)),yield Promise.all(Array.from(a.remoteParticipants.values()).map(k=>k.setAudioOutput({deviceId:i})))}catch(k){throw a.options.audioOutput.deviceId=b,k}}return p&&(a.localParticipant.activeDeviceMap.set(r,i),a.emit(z.ActiveDeviceChanged,r,i)),m}()})}setupLocalParticipantEvents(){this.localParticipant.on(Y.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(Y.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(Y.AttributesChanged,this.onLocalAttributesChanged).on(Y.TrackMuted,this.onLocalTrackMuted).on(Y.TrackUnmuted,this.onLocalTrackUnmuted).on(Y.LocalTrackPublished,this.onLocalTrackPublished).on(Y.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(Y.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(Y.MediaDevicesError,this.onMediaDevicesError).on(Y.AudioStreamAcquired,this.startAudio).on(Y.ChatMessage,this.onLocalChatMessageSent).on(Y.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,n,r){if(this.state===ve.Connecting||this.state===ve.Reconnecting){const d=()=>{this.onTrackAdded(e,n,r),f()},f=()=>{this.off(z.Reconnected,d),this.off(z.Connected,d),this.off(z.Disconnected,f)};this.once(z.Reconnected,d),this.once(z.Connected,d),this.once(z.Disconnected,f);return}if(this.state===ve.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const i=NG(n.id),a=i[0];let o=i[1],s=e.id;if(o&&o.startsWith("TR")&&(s=o),a===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const c=Array.from(this.remoteParticipants.values()).find(d=>d.sid===a);if(!c){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(a),this.logContext);return}let u;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?u=this.options.adaptiveStream:u={});const l=c.addSubscribedMediaTrack(e,s,n,r,u);l!=null&&l.isEncrypted&&!this.e2eeManager&&this.emit(z.EncryptionError,new Error("Encrypted ".concat(l.source," track received from participant ").concat(c.sid,", but room does not have encryption enabled!")))}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.incomingDataStreamManager.clearHandlersAndControllers(),this.state!==ve.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(i=>{i.trackPublications.forEach(a=>{i.unpublishTrack(a.trackSid)})}),this.localParticipant.trackPublications.forEach(i=>{var a,o,s;i.track&&this.localParticipant.unpublishTrack(i.track,e),e?((a=i.track)===null||a===void 0||a.detach(),(o=i.track)===null||o===void 0||o.stop()):(s=i.track)===null||s===void 0||s.stopMonitor()}),this.localParticipant.off(Y.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(Y.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(Y.AttributesChanged,this.onLocalAttributesChanged).off(Y.TrackMuted,this.onLocalTrackMuted).off(Y.TrackUnmuted,this.onLocalTrackUnmuted).off(Y.LocalTrackPublished,this.onLocalTrackPublished).off(Y.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(Y.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(Y.MediaDevicesError,this.onMediaDevicesError).off(Y.AudioStreamAcquired,this.startAudio).off(Y.ChatMessage,this.onLocalChatMessageSent).off(Y.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),mt()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(ve.Disconnected),this.emit(z.Disconnected,n)}}}handleParticipantDisconnected(e,n){var r;this.remoteParticipants.delete(e),n&&(this.incomingDataStreamManager.validateParticipantHasNoActiveDataStreams(e),n.trackPublications.forEach(i=>{n.unpublishTrack(i.trackSid,!0)}),this.emit(z.ParticipantDisconnected,n),n.setDisconnected(),(r=this.localParticipant)===null||r===void 0||r.handleParticipantDisconnected(n.identity))}handleIncomingRpcRequest(e,n,r,i,a,o){return x(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,n),o!==1){yield this.engine.publishRpcResponse(e,n,null,Le.builtIn("UNSUPPORTED_VERSION"));return}const s=this.rpcHandlers.get(r);if(!s){yield this.engine.publishRpcResponse(e,n,null,Le.builtIn("UNSUPPORTED_METHOD"));return}let c=null,u=null;try{const l=yield s({requestId:n,callerIdentity:e,payload:i,responseTimeout:a});Eh(l)>uw?(c=Le.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(r))):u=l}catch(l){l instanceof Le?c=l:(console.warn("Uncaught error returned by RPC handler for ".concat(r,". Returning APPLICATION_ERROR instead."),l),c=Le.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,n,u,c)})}selectDefaultDevices(){return x(this,void 0,void 0,function*(){var e,n,r;const i=Qe.getInstance().previousDevices,a=yield Qe.getInstance().getDevices(void 0,!1),o=Ct();if((o==null?void 0:o.name)==="Chrome"&&o.os!=="iOS")for(let c of a){const u=i.find(l=>l.deviceId===c.deviceId);u&&u.label!==""&&u.kind===c.kind&&u.label!==c.label&&this.getActiveDevice(c.kind)==="default"&&this.emit(z.ActiveDeviceChanged,c.kind,c.deviceId)}const s=["audiooutput","audioinput","videoinput"];for(let c of s){const u=QG(c),l=this.localParticipant.getTrackPublication(u);if(l&&(!((e=l.track)===null||e===void 0)&&e.isUserProvided))continue;const d=a.filter(h=>h.kind===c),f=this.getActiveDevice(c);if(f===((n=i.filter(h=>h.kind===c)[0])===null||n===void 0?void 0:n.deviceId)&&d.length>0&&((r=d[0])===null||r===void 0?void 0:r.deviceId)!==f){yield this.switchActiveDevice(c,d[0].deviceId);continue}c==="audioinput"&&!ao()||c==="videoinput"||d.length>0&&!d.find(h=>h.deviceId===this.getActiveDevice(c))&&(c!=="audiooutput"||!ao())&&(yield this.switchActiveDevice(c,d[0].deviceId))}})}acquireAudioContext(){return x(this,void 0,void 0,function*(){var e,n;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=iw())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),vt(200)])}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(z.AudioPlaybackStatusChanged,r))})}createParticipant(e,n){var r;let i;return n?i=lc.fromParticipantInfo(this.engine.client,n,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):i=new lc(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(a=>this.log.warn("Could not set audio output: ".concat(a.message),this.logContext)),i}getOrCreateParticipant(e,n){if(this.remoteParticipants.has(e)){const i=this.remoteParticipants.get(e);return n&&i.updateInfo(n)&&this.sidToIdentity.set(n.sid,n.identity),i}const r=this.createParticipant(e,n);return this.remoteParticipants.set(e,r),this.sidToIdentity.set(n.sid,n.identity),this.emitWhenConnected(z.ParticipantConnected,r),r.on(Y.TrackPublished,i=>{this.emitWhenConnected(z.TrackPublished,i,r)}).on(Y.TrackSubscribed,(i,a)=>{i.kind===B.Kind.Audio?(i.on(G.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(G.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===B.Kind.Video&&(i.on(G.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(G.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(z.TrackSubscribed,i,a,r)}).on(Y.TrackUnpublished,i=>{this.emit(z.TrackUnpublished,i,r)}).on(Y.TrackUnsubscribed,(i,a)=>{this.emit(z.TrackUnsubscribed,i,a,r)}).on(Y.TrackMuted,i=>{this.emitWhenConnected(z.TrackMuted,i,r)}).on(Y.TrackUnmuted,i=>{this.emitWhenConnected(z.TrackUnmuted,i,r)}).on(Y.ParticipantMetadataChanged,i=>{this.emitWhenConnected(z.ParticipantMetadataChanged,i,r)}).on(Y.ParticipantNameChanged,i=>{this.emitWhenConnected(z.ParticipantNameChanged,i,r)}).on(Y.AttributesChanged,i=>{this.emitWhenConnected(z.ParticipantAttributesChanged,i,r)}).on(Y.ConnectionQualityChanged,i=>{this.emitWhenConnected(z.ConnectionQualityChanged,i,r)}).on(Y.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(z.ParticipantPermissionsChanged,i,r)}).on(Y.TrackSubscriptionStatusChanged,(i,a)=>{this.emitWhenConnected(z.TrackSubscriptionStatusChanged,i,a,r)}).on(Y.TrackSubscriptionFailed,(i,a)=>{this.emit(z.TrackSubscriptionFailed,i,r,a)}).on(Y.TrackSubscriptionPermissionChanged,(i,a)=>{this.emitWhenConnected(z.TrackSubscriptionPermissionChanged,i,a,r)}).on(Y.Active,()=>{this.emitWhenConnected(z.ParticipantActive,r),r.kind===ro.AGENT&&this.localParticipant.setActiveAgent(r)}),n&&r.updateInfo(n),r}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((r,i)=>(r.push(...i.getTrackPublications()),r),[]),n=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const n of e.videoTrackPublications.values())n.isSubscribed&&XG(n)&&n.emitTrackUpdate()}getRemoteParticipantBySid(e){const n=this.sidToIdentity.get(e);if(n)return this.remoteParticipants.get(n)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=nt.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Ht.STATE_MISMATCH))):e=0},sK)}clearConnectionReconcile(){this.connectionReconcileInterval&&nt.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(z.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[n,r]=e;this.emit(n,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(this.state===ve.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,r]);else if(this.state===ve.Connected)return this.emit(e,...r);return!1}simulateParticipants(e){return x(this,void 0,void 0,function*(){var n,r;const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),a=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Gc({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Ae.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Pr({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(z.SignalConnected),this.emit(z.Connected),this.setAndEmitConnectionState(ve.Connected),i.video){const o=new Xd(B.Kind.Video,new Xr({source:Be.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Wt.AUDIO,name:"video-dummy"}),new uc(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:Sy(160*((n=a.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(o),this.localParticipant.emit(Y.LocalTrackPublished,o)}if(i.audio){const o=new Xd(B.Kind.Audio,new Xr({source:Be.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Wt.AUDIO}),new cc(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:qu(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(o),this.localParticipant.emit(Y.LocalTrackPublished,o)}for(let o=0;o<a.count-1;o+=1){let s=new Pr({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(o),state:ri.ACTIVE,tracks:[],joinedAt:Ae.parse(Date.now())});const c=this.getOrCreateParticipant(s.identity,s);if(a.video){const u=Sy(160*((r=a.aspectRatios[o%a.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),l=new Xr({source:Be.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Wt.AUDIO});c.addSubscribedMediaTrack(u,l.sid,new MediaStream([u]),new RTCRtpReceiver),s.tracks=[...s.tracks,l]}if(a.audio){const u=qu(),l=new Xr({source:Be.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Wt.AUDIO});c.addSubscribedMediaTrack(u,l.sid,new MediaStream([u]),new RTCRtpReceiver),s.tracks=[...s.tracks,l]}c.updateInfo(s)}})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(e!==z.ActiveSpeakersChanged&&e!==z.TranscriptionReceived){const a=vw(r).filter(o=>o!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:a}))}return super.emit(e,...r)}}oo.cleanupRegistry=typeof FinalizationRegistry!="undefined"&&new FinalizationRegistry(t=>{t()});function vw(t){return t.map(e=>{if(e)return Array.isArray(e)?vw(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var qt;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(qt||(qt={}));class ar extends fn.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=qt.IDLE,this.logs=[],this.options={},this.url=e,this.token=n,this.name=this.constructor.name,this.room=new oo(r.roomOptions),this.connectOptions=r.connectOptions,this.options=r}run(e){return x(this,void 0,void 0,function*(){if(this.status!==qt.IDLE)throw Error("check is running already");this.setStatus(qt.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==qt.SKIPPED&&this.setStatus(this.isSuccess()?qt.SUCCESS:qt.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return x(this,void 0,void 0,function*(){return this.room.state===ve.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return x(this,void 0,void 0,function*(){this.room&&this.room.state!==ve.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(qt.SKIPPED)}switchProtocol(e){return x(this,void 0,void 0,function*(){let n=!1,r=!1;if(this.room.on(z.Reconnecting,()=>{n=!0}),this.room.once(z.Reconnected,()=>{r=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(a=>setTimeout(a,1e3)),!n)return;const i=Date.now()+1e4;for(;Date.now()<i;){if(r)return;yield vt(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class cK extends ar{get description(){return"Cloud regions"}perform(){return x(this,void 0,void 0,function*(){const e=new Hd(this.url,this.token);if(!e.isCloud()){this.skip();return}const n=[],r=new Set;for(let a=0;a<3;a++){const o=yield e.getNextBestRegionUrl();if(!o)break;if(r.has(o))continue;r.add(o);const s=yield this.checkCloudRegion(o);this.appendMessage("".concat(s.region," RTT: ").concat(s.rtt,"ms, duration: ").concat(s.duration,"ms")),n.push(s)}n.sort((a,o)=>(a.duration-o.duration)*.5+(a.rtt-o.rtt)*.5);const i=n[0];this.bestStats=i,this.appendMessage("best Cloud region: ".concat(i.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return x(this,void 0,void 0,function*(){var n,r;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const i=(n=this.room.serverInfo)===null||n===void 0?void 0:n.region;if(!i)throw new Error("Region not found");const a=yield this.room.localParticipant.streamText({topic:"test"}),o=1e3,c=1e6/o,u="A".repeat(o),l=Date.now();for(let m=0;m<c;m++)yield a.write(u);yield a.close();const d=Date.now(),f=yield(r=this.room.engine.pcManager)===null||r===void 0?void 0:r.publisher.getStats(),h={region:i,rtt:1e4,duration:d-l};return f==null||f.forEach(m=>{m.type==="candidate-pair"&&m.nominated&&(h.rtt=m.currentRoundTripTime*1e3)}),yield this.disconnect(),h})}}const Ju=1e4;class uK extends ar{get description(){return"Connection via UDP vs TCP"}perform(){return x(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),n=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-n.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-n.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=n):this.appendMessage("best connection quality via udp");const r=this.bestStats;this.appendMessage("upstream bitrate: ".concat((r.bitrateTotal/r.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((r.rttTotal/r.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((r.jitterTotal/r.count*1e3).toFixed(2)," ms")),r.packetsLost>0&&this.appendWarning("packets lost: ".concat((r.packetsLost/r.packetsSent*100).toFixed(2),"%")),r.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((r.qualityLimitationDurations.bandwidth/(Ju/1e3)*100).toFixed(2),"%")),r.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((r.qualityLimitationDurations.cpu/(Ju/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return x(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const n=document.createElement("canvas");n.width=1280,n.height=720;const r=n.getContext("2d");if(!r)throw new Error("Could not get canvas context");let i=0;const a=()=>{i=(i+1)%360,r.fillStyle="hsl(".concat(i,", 100%, 50%)"),r.fillRect(0,0,n.width,n.height),requestAnimationFrame(a)};a();const s=n.captureStream(30).getVideoTracks()[0],u=(yield this.room.localParticipant.publishTrack(s,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,l={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},d=setInterval(()=>x(this,void 0,void 0,function*(){const f=yield u.getRTCStatsReport();f==null||f.forEach(h=>{h.type==="outbound-rtp"?(l.packetsSent=h.packetsSent,l.qualityLimitationDurations=h.qualityLimitationDurations,l.bitrateTotal+=h.targetBitrate,l.count++):h.type==="remote-inbound-rtp"&&(l.packetsLost=h.packetsLost,l.rttTotal+=h.roundTripTime,l.jitterTotal+=h.jitter)})}),1e3);return yield new Promise(f=>setTimeout(f,Ju)),clearInterval(d),s.stop(),n.remove(),yield this.disconnect(),l})}}class lK extends ar{get description(){return"Can publish audio"}perform(){return x(this,void 0,void 0,function*(){var e;const n=yield this.connect(),r=yield nK();if(yield rw(r,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),n.localParticipant.publishTrack(r),yield new Promise(s=>setTimeout(s,3e3));const a=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!a)throw new Error("Could not get RTCStats");let o=0;if(a.forEach(s=>{s.type==="outbound-rtp"&&(s.kind==="audio"||!s.kind&&s.mediaType==="audio")&&(o=s.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," audio packets"))})}}class dK extends ar{get description(){return"Can publish video"}perform(){return x(this,void 0,void 0,function*(){var e;const n=yield this.connect(),r=yield tK();yield this.checkForVideo(r.mediaStreamTrack),n.localParticipant.publishTrack(r),yield new Promise(o=>setTimeout(o,5e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let a=0;if(i.forEach(o=>{o.type==="outbound-rtp"&&(o.kind==="video"||!o.kind&&o.mediaType==="video")&&(a+=o.packetsSent)}),a===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(a," video packets"))})}checkForVideo(e){return x(this,void 0,void 0,function*(){const n=new MediaStream;n.addTrack(e.clone());const r=document.createElement("video");r.srcObject=n,r.muted=!0,r.autoplay=!0,r.playsInline=!0,r.setAttribute("playsinline","true"),document.body.appendChild(r),yield new Promise(i=>{r.onplay=()=>{setTimeout(()=>{var a,o,s,c;const u=document.createElement("canvas"),l=e.getSettings(),d=(o=(a=l.width)!==null&&a!==void 0?a:r.videoWidth)!==null&&o!==void 0?o:1280,f=(c=(s=l.height)!==null&&s!==void 0?s:r.videoHeight)!==null&&c!==void 0?c:720;u.width=d,u.height=f;const h=u.getContext("2d");h.drawImage(r,0,0);const p=h.getImageData(0,0,u.width,u.height).data;let v=!0;for(let b=0;b<p.length;b+=4)if(p[b]!==0||p[b+1]!==0||p[b+2]!==0){v=!1;break}v?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),i()},1e3)},r.play()}),n.getTracks().forEach(i=>i.stop()),r.remove()})}}class fK extends ar{get description(){return"Resuming connection after interruption"}perform(){return x(this,void 0,void 0,function*(){var e;const n=yield this.connect();let r=!1,i=!1,a;const o=new Promise(u=>{setTimeout(u,5e3),a=u}),s=()=>{r=!0};n.on(z.SignalReconnecting,s).on(z.Reconnecting,s).on(z.Reconnected,()=>{i=!0,a(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const c=n.engine.client.onClose;if(c&&c(""),yield o,r){if(!i||n.state!==ve.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class hK extends ar{get description(){return"Can connect via TURN"}perform(){return x(this,void 0,void 0,function*(){var e,n;const r=new Ch,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let a=!1,o=!1,s=!1;for(let c of i.iceServers)for(let u of c.urls)u.startsWith("turn:")?(o=!0,s=!0):u.startsWith("turns:")&&(o=!0,s=!0,a=!0),u.startsWith("stun:")&&(s=!0);s?o&&!a&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||o?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(c=>setTimeout(c,0)))})}}class pK extends ar{get description(){return"Establishing WebRTC connection"}perform(){return x(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(z.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,a)=>{if(i.candidate){const o=new RTCIceCandidate(i);let s="".concat(o.protocol," ").concat(o.address,":").concat(o.port," ").concat(o.type);o.address&&(mK(o.address)?s+=" (private)":o.protocol==="tcp"&&o.tcpType==="passive"?(e=!0,s+=" (passive)"):o.protocol==="udp"&&(n=!0)),this.appendMessage(s)}r&&r(i,a)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),ae.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function mK(t){const e=t.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class gK extends ar{get description(){return"Connecting to signal connection via WebSocket"}perform(){return x(this,void 0,void 0,function*(){var e,n,r;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new Ch;const a=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(a.serverVersion,".")),((e=a.serverInfo)===null||e===void 0?void 0:e.edition)===ak.Cloud&&(!((n=a.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=a.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class QK extends fn.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=n,this.options=r}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:qt.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==qt.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return x(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new e(this.url,this.token,this.options),i=o=>{this.updateCheck(n,o)};r.on("update",i);const a=yield r.run();return r.off("update",i),a})}checkWebsocket(){return x(this,void 0,void 0,function*(){return this.createAndRunCheck(gK)})}checkWebRTC(){return x(this,void 0,void 0,function*(){return this.createAndRunCheck(pK)})}checkTURN(){return x(this,void 0,void 0,function*(){return this.createAndRunCheck(hK)})}checkReconnect(){return x(this,void 0,void 0,function*(){return this.createAndRunCheck(fK)})}checkPublishAudio(){return x(this,void 0,void 0,function*(){return this.createAndRunCheck(lK)})}checkPublishVideo(){return x(this,void 0,void 0,function*(){return this.createAndRunCheck(dK)})}checkConnectionProtocol(){return x(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(uK);if(e.data&&"protocol"in e.data){const n=e.data;this.options.protocol=n.protocol}return e})}checkCloudRegion(){return x(this,void 0,void 0,function*(){return this.createAndRunCheck(cK)})}}function le(t,e,n){return(e=yK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yK(t){var e=vK(t,"string");return typeof e=="symbol"?e:e+""}new TextEncoder;new TextDecoder;class lt extends Error{constructor(e,n){var r;super(e,n),le(this,"code","ERR_JOSE_GENERIC"),this.name=this.constructor.name,(r=Error.captureStackTrace)===null||r===void 0||r.call(Error,this,this.constructor)}}le(lt,"code","ERR_JOSE_GENERIC");class bK extends lt{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:r,reason:i,payload:n}}),le(this,"code","ERR_JWT_CLAIM_VALIDATION_FAILED"),le(this,"claim",void 0),le(this,"reason",void 0),le(this,"payload",void 0),this.claim=r,this.reason=i,this.payload=n}}le(bK,"code","ERR_JWT_CLAIM_VALIDATION_FAILED");class SK extends lt{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:r,reason:i,payload:n}}),le(this,"code","ERR_JWT_EXPIRED"),le(this,"claim",void 0),le(this,"reason",void 0),le(this,"payload",void 0),this.claim=r,this.reason=i,this.payload=n}}le(SK,"code","ERR_JWT_EXPIRED");class TK extends lt{constructor(){super(...arguments),le(this,"code","ERR_JOSE_ALG_NOT_ALLOWED")}}le(TK,"code","ERR_JOSE_ALG_NOT_ALLOWED");class kK extends lt{constructor(){super(...arguments),le(this,"code","ERR_JOSE_NOT_SUPPORTED")}}le(kK,"code","ERR_JOSE_NOT_SUPPORTED");class wK extends lt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"decryption operation failed",n=arguments.length>1?arguments[1]:void 0;super(e,n),le(this,"code","ERR_JWE_DECRYPTION_FAILED")}}le(wK,"code","ERR_JWE_DECRYPTION_FAILED");class CK extends lt{constructor(){super(...arguments),le(this,"code","ERR_JWE_INVALID")}}le(CK,"code","ERR_JWE_INVALID");class _K extends lt{constructor(){super(...arguments),le(this,"code","ERR_JWS_INVALID")}}le(_K,"code","ERR_JWS_INVALID");class xK extends lt{constructor(){super(...arguments),le(this,"code","ERR_JWT_INVALID")}}le(xK,"code","ERR_JWT_INVALID");class PK extends lt{constructor(){super(...arguments),le(this,"code","ERR_JWK_INVALID")}}le(PK,"code","ERR_JWK_INVALID");class OK extends lt{constructor(){super(...arguments),le(this,"code","ERR_JWKS_INVALID")}}le(OK,"code","ERR_JWKS_INVALID");class EK extends lt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"no applicable key found in the JSON Web Key Set",n=arguments.length>1?arguments[1]:void 0;super(e,n),le(this,"code","ERR_JWKS_NO_MATCHING_KEY")}}le(EK,"code","ERR_JWKS_NO_MATCHING_KEY");class AK extends lt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"multiple matching keys found in the JSON Web Key Set",n=arguments.length>1?arguments[1]:void 0;super(e,n),le(this,Symbol.asyncIterator,void 0),le(this,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS")}}le(AK,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS");class IK extends lt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"request timed out",n=arguments.length>1?arguments[1]:void 0;super(e,n),le(this,"code","ERR_JWKS_TIMEOUT")}}le(IK,"code","ERR_JWKS_TIMEOUT");class RK extends lt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"signature verification failed",n=arguments.length>1?arguments[1]:void 0;super(e,n),le(this,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED")}}le(RK,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED");function ZK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n;const r=Sr(t)?t.mediaStreamTrack:t,i=r.getSettings();let a={facingMode:(n=e.defaultFacingMode)!==null&&n!==void 0?n:"user",confidence:"low"};if("facingMode"in i){const o=i.facingMode;ae.trace("rawFacingMode",{rawFacingMode:o}),o&&typeof o=="string"&&NK(o)&&(a={facingMode:o,confidence:"high"})}if(["low","medium"].includes(a.confidence)){ae.trace("Try to get facing mode from device label: (".concat(r.label,")"));const o=DK(r.label);o!==void 0&&(a=o)}return a}const Fy=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),MK=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function DK(t){var e;const n=t.trim().toLowerCase();if(n!=="")return Fy.has(n)?Fy.get(n):(e=Array.from(MK.entries()).find(r=>{let[i]=r;return n.includes(i)}))===null||e===void 0?void 0:e[1]}function NK(t){return t===void 0||["user","environment","left","right"].includes(t)}export{zr as A,XK as B,ve as C,mn as D,Nr as E,KK as F,zi as G,Xd as L,oc as M,zK as P,z as R,B as T,mo as X,go as Y,FK as a,Dw as b,VK as c,BK as d,zy as e,GK as f,_e as g,Y as h,Jr as i,jo as j,ln as k,oo as l,UK as m,Ct as n,ZK as o,dc as p,oK as q,qK as r,$K as s,QH as t,Vn as u,Mu as v,WK as w,HK as x,e8 as y,Fc as z};
